<div *ngIf="showUpload">
    <app-leads-mainpage (completed)="leadSts($event)"></app-leads-mainpage>
</div>
<div *ngIf="!showUpload" class="container mt-1">

    <mat-card style=" overflow-x:scroll;">
        <div class="row">
            <div class="col-md-10">
                <h2>Leads Upload</h2>
            </div>
            <div class="col-md-2">
                <button type="button" class="btn btn-outline-success" (click)="goToUpload()">Upload Leads</button>
            </div>

        </div>
        <div *ngIf="showMain">

            <div>
                <form [formGroup]="LeadHistorySearchForm">
                    <div class="row">
                        <!-- <div class="col-sm-2">
                            <button type="button" class="btn btn-info" (click)="showFilter()" style="font-size: smaller; border-radius: 25px;margin-bottom: 3%;" >show filters</button>
                        </div> -->
                        <div class="col-sm-3" style="margin-left: 1%;">
                            <mat-form-field>
                                <mat-select formControlName="source_id" placeholder="Source" style="margin-left: 11%;">
                                    <mat-option *ngFor="let item of LeadHistoryObjects.SourceList" [value]="item.id">
                                        {{item.name}}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                        <div class="col-sm-3" >
                            <mat-form-field class="ml-2">
                                <mat-label>From Date</mat-label>
                                <input matInput [matDatepicker]="picker1" readonly autocomplete="off"
                                    formControlName="from_date" placeholder="From Date">
                                <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                                <mat-datepicker #picker1></mat-datepicker>
                            </mat-form-field>
                        </div>
                        <div class="col-sm-3" >
                            <mat-form-field class="ml-2">
                                <mat-label>To Date</mat-label>
                                <input matInput [matDatepicker]="picker2" readonly autocomplete="off"
                                    formControlName="to_date" placeholder="To Date">
                                <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                                <mat-datepicker #picker2></mat-datepicker>
                            </mat-form-field>
                        </div>
                        <div class="col-sm-3" style="margin-left: -1%;
                        padding-top: 1%;">
                            <button class="ml-2 sumBtn" mat-stroked-button type="button" id="buttonsSubmit"
                                aria-label="Search" (click)="LeadHistorySearch('')">
                                <mat-icon>search</mat-icon>
                            </button>
                            <button class="ml-2 sumBtn" mat-stroked-button type="button" id="buttonsWhite"
                                (click)="resetLeadHistory()">Clear</button>
                        </div>
                       
                    </div>
                </form>
            </div>


            <div class="col-sm-12 col-md-12 col-lg-12">

                <table class="table table-bordered" id="tableGlobal">
                    <thead class="table_header">
                        <tr>
                            <th rowspan="2">S.No</th>
                            <th rowspan="2">Source</th>
                            <th rowspan="2">Date</th>
                            <th colspan="3">Count</th>

                        </tr>
                        <tr>

                            <th scope="col">New</th>
                            <th scope="col">Duplicate</th>
                            <th scope="col">Reject</th>

                        </tr>
                    </thead>
                    <tbody>
                        <ng-container *ngFor="let type of LeadHistoryObjects.LeadHistoryList; let proindex = index">
                            <tr>
                                <td>{{(LeadHistoryObjects?.presentpageLeadHistory - 1)*10+proindex+1}}</td>

                                <td>{{type?.source.name}}</td>
                                <td>{{type?.date | date:'medium'}}</td>
                                <td style="cursor:pointer;--hover-color: blue" (click)="viewNewLead(type)">
                                    {{type?.new_count}}</td>
                                <td style="cursor:pointer;--hover-color: blue" (click)="viewDuplicate(type)">
                                    {{type?.duplicate_count}}</td>
                                <td style="cursor:pointer;--hover-color: blue" (click)="viewReject(type)">
                                    {{type?.reject_count}}</td>

                            </tr>

                        </ng-container>
                    </tbody>
                </table>
                <div *ngIf="LeadHistoryObjects.LeadHistoryList?.length==0 || LeadHistoryObjects.LeadHistoryList == undefined || LeadHistoryObjects.LeadHistoryList == '' ; else paginationpro"
                    class="NodataAlign text-center">No Records Found...</div>
                <ng-template #paginationpro>
                    <div class="col-sm-12" style="font-size: small;text-align: right;margin-bottom: 5%;">
                        <button type="button" mat-icon-button
                            [disabled]="LeadHistoryObjects.has_previousLeadHistory == false" color="primary"
                            (click)="LeadHistorySearch('previous')">
                            <mat-icon>arrow_back</mat-icon>
                        </button> {{LeadHistoryObjects?.presentpageLeadHistory}}
                        <button type="button" mat-icon-button
                            [disabled]="LeadHistoryObjects.has_nextLeadHistory === false" color="primary"
                            (click)="LeadHistorySearch('next')">
                            <mat-icon>arrow_forward</mat-icon>
                        </button>
                    </div>
                </ng-template>


            </div>

        </div>

        <div *ngIf="showNewleads">
            <button mat-icon-button (click)="backtoTable()">
                <mat-icon class="alignvertical">
                    arrow_back
                </mat-icon>
            </button>
            <table class="table">
                <tr class="table_header">
                    <th>Lead Name</th>
                    <th>Mail</th>
                    <th>Phone No.</th>
                    <th>Gender</th>
                    <th>DOB</th>
                    <th>Aadhaar</th>
                    <th>PAN</th>
                    <th>CIF No</th>
                    <th>Occupation</th>
                    <th>Marital Status</th>
                    <th>Address</th>
                    <th>City</th>
                    <th>District</th>
                    <th>State</th>
                    <th>Pincode</th>
                    <th>Bank</th>
                    <th>Branch</th>
                    <th>Account No</th>
                    <th>Father Name</th>
                    <th>Father DOB</th>
                    <th>Mother Name</th>
                    <th>Mother DOB</th>
                    <th>Spouse Name</th>
                    <th>Spouse DOB</th>
                </tr>
                <tr *ngFor="let sumsst of leadSummary;">

                    <td>{{sumsst?.first_name}}&nbsp;{{sumsst?.middle_name}}&nbsp;{{sumsst?.last_name}}</td>
                    <td>{{sumsst?.mail_id}}</td>
                    <td>{{sumsst?.ph_no}}</td>
                    <td>{{sumsst?.Gender}}</td>
                    <td>{{sumsst?.lead_dob}}</td>
                    <td>{{sumsst?.aadhaar_no}}</td>
                    <td>{{sumsst?.pan_no}}</td>
                    <td>{{sumsst?.cif_no}}</td>
                    <td>{{sumsst?.Occupation}}</td>
                    <td>{{sumsst.martial_status}}</td>
                    <td>{{sumsst.line1}}</td>
                    <td>{{sumsst?.city}}</td>
                    <td>{{sumsst?.district}}</td>
                    <td>{{sumsst?.state_name}}</td>
                    <td>{{sumsst?.pincode}}</td>
                    <td>{{sumsst?.branch}}</td>
                    <td>{{sumsst?.branch}}</td>
                    <td>{{sumsst?.account}}</td>
                    <td>{{sumsst.father_name}}</td>
                    <td>{{sumsst?.father_dob}}</td>
                    <td>{{sumsst.mother_name}}</td>
                    <td>{{sumsst?.mother_dob}}</td>
                    <td>{{sumsst.spouse_name}}</td>
                    <td>{{sumsst?.spouse_dob}}</td>
                </tr>
            </table>

        </div>
        <div *ngIf="showDuplicateleads">
            <button mat-icon-button (click)="backtoTable()">
                <mat-icon class="alignvertical">
                    arrow_back
                </mat-icon>
            </button>
            <button (click)="update(auto,merge)" mat-raised-button style="float:right;color:blue">
                <mat-icon class="ailgnvertical"> merge_type</mat-icon>Auto Merge
            </button>
            <button (click)="update(auto,reject)" mat-raised-button style="float:right;color:red">
                <mat-icon class="ailgnvertical"> clear</mat-icon>Auto Reject
            </button>
            <table class="table">
                <tr class="table_header">
                    <th>S.No</th>
                    <th>Lead Name</th>
                    <th>Mail</th>
                    <th>Phone No.</th>
                    <th>Gender</th>
                    <th>DOB</th>
                    <th>Aadhaar</th>
                    <th>PAN</th>
                    <th>CIF No</th>
                    <th>Occupation</th>
                    <th>Marital Status</th>
                    <th>Address</th>
                    <th>City</th>
                    <th>District</th>
                    <th>State</th>
                    <th>Pincode</th>
                    <th>Bank</th>
                    <th>Branch</th>
                    <th>Account No</th>
                    <th>Father Name</th>
                    <th>Father DOB</th>
                    <th>Mother Name</th>
                    <th>Mother DOB</th>
                    <th>Spouse Name</th>
                    <th>Spouse DOB</th>
                </tr>
                <tbody *ngFor="let sumsst of duplicateLeads;let ind = index">

                    <tr>
                        <td>{{ind+1}}</td>
                        <td>{{sumsst?.first_name}}&nbsp;{{sumsst?.middle_name}}&nbsp;{{sumsst?.last_name}}</td>
                        <td>{{sumsst?.mail_id}}</td>
                        <td>{{sumsst?.ph_no}}</td>
                        <td>{{sumsst?.Gender}}</td>
                        <td>{{sumsst?.lead_dob}}</td>
                        <td>{{sumsst?.aadhaar_no}}</td>
                        <td>{{sumsst?.pan_no}}</td>
                        <td>{{sumsst?.cif_no}}</td>
                        <td>{{sumsst?.Occupation}}</td>
                        <td>{{sumsst.martial_status}}</td>
                        <td>{{sumsst.line1}}</td>
                        <td>{{sumsst?.city}}</td>
                        <td>{{sumsst?.district}}</td>
                        <td>{{sumsst?.state_name}}</td>
                        <td>{{sumsst?.pincode}}</td>
                        <td>{{sumsst?.branch}}</td>
                        <td>{{sumsst?.branch}}</td>
                        <td>{{sumsst?.account}}</td>
                        <td>{{sumsst.father_name}}</td>
                        <td>{{sumsst?.father_dob}}</td>
                        <td>{{sumsst.mother_name}}</td>
                        <td>{{sumsst?.mother_dob}}</td>
                        <td>{{sumsst.spouse_name}}</td>
                        <td>{{sumsst?.spouse_dob}}</td>
                    </tr>
                </tbody>
            </table>

        </div>
        <div *ngIf="showRejectedleads">
            <button mat-icon-button (click)="backtoTable()">
                <mat-icon class="alignvertical">
                    arrow_back
                </mat-icon>
            </button>


            <div class="table-wrap">
                <table class="table">
                    <tr class="table_header">
                        <th>Lead Name</th>
                        <th>Mail</th>
                        <th>Phone No.</th>
                        <th>Gender</th>
                        <th>DOB</th>
                        <th>Aadhaar</th>
                        <th>PAN</th>
                        <th>CIF No</th>
                        <th>Occupation</th>
                        <th>Marital Status</th>
                        <th>Address</th>
                        <th>City</th>
                        <th>District</th>
                        <th>State</th>
                        <th>Pincode</th>
                        <th>Bank</th>
                        <th>Branch</th>
                        <th>Account No</th>
                        <th>Father Name</th>
                        <th>Father DOB</th>
                        <th>Mother Name</th>
                        <th>Mother DOB</th>
                        <th>Spouse Name</th>
                        <th>Spouse DOB</th>
                    </tr>
                    <tr *ngFor="let sumsst of leadSummary.reject_entry;">

                        <td>{{sumsst?.first_name}}&nbsp;{{sumsst?.middle_name}}&nbsp;{{sumsst?.last_name}}</td>
                        <td>{{sumsst?.mail_id}}</td>
                        <td>{{sumsst?.ph_no}}</td>
                        <td>{{sumsst?.Gender}}</td>
                        <td>{{sumsst?.lead_dob}}</td>
                        <td>{{sumsst?.aadhaar_no}}</td>
                        <td>{{sumsst?.pan_no}}</td>
                        <td>{{sumsst?.cif_no}}</td>
                        <td>{{sumsst?.Occupation}}</td>
                        <td>{{sumsst.martial_status}}</td>
                        <td>{{sumsst.line1}}</td>
                        <td>{{sumsst?.city}}</td>
                        <td>{{sumsst?.district}}</td>
                        <td>{{sumsst?.state_name}}</td>
                        <td>{{sumsst?.pincode}}</td>
                        <td>{{sumsst?.branch}}</td>
                        <td>{{sumsst?.branch}}</td>
                        <td>{{sumsst?.account}}</td>
                        <td>{{sumsst.father_name}}</td>
                        <td>{{sumsst?.father_dob}}</td>
                        <td>{{sumsst.mother_name}}</td>
                        <td>{{sumsst?.mother_dob}}</td>
                        <td>{{sumsst.spouse_name}}</td>
                        <td>{{sumsst?.spouse_dob}}</td>
                    </tr>
                </table>
            </div>

        </div>






    </mat-card>

</div>


<!-- <div class="modal" id="myModals">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">

            <div class="modal-body">
                <mat-expansion-panel>
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            NEW LEADS
                        </mat-panel-title>
                    
                    </mat-expansion-panel-header>
                    <table class="table">
                        <tr>
                      
                            <th>Leads</th>
                        </tr>
                        <tr  *ngFor="let sums of leadSummary.new_lead_id;">
                            <td>{{sums}}</td>
                        </tr>

                    </table>
                </mat-expansion-panel>
                <mat-expansion-panel>
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            DUPLICATE LEADS
                        </mat-panel-title>
                    
                    </mat-expansion-panel-header>
                    <table class="table">
                        <tr>
              
                            <th>Leads</th>
                        </tr>
                        <tr  *ngFor="let sumst of leadSummary.duplicated_entry;">
                            <td>{{sumst.lead_data}}</td>
                        </tr>

                    </table>
                </mat-expansion-panel>
                <mat-expansion-panel>
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            REJECTED LEADS
                        </mat-panel-title>
                    
                    </mat-expansion-panel-header>
                    <table class="table">
                        <tr>
                
                            <th>Leads</th>
                        </tr>
                        <tr  *ngFor="let sumss of leadSummary.reject_entry;">
                            <td>{{sumss}}</td>
                        </tr>

                    </table>
                </mat-expansion-panel>

            </div>

        </div>
    </div>
</div> -->