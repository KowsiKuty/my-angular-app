<div style="margin-left: 50px">
  <div>
    <h1 style="padding-left: 38%; margin-top: 20px">Invoice Data Entry</h1>
    <h3 style="margin-top: 2%; margin-bottom: -3%; margin-left: 14%">
      Branches are Advice to take utmost care in filling the data in invoice
      data entry as it plays vital role in the wage Calculations
    </h3>
    <form
      [formGroup]="updateInvoiceForm"
      style="margin-top: 3%; margin-bottom: 3%"
    >
      <table>
        <div
          class="table-responsive"
          style="margin-top: 2%; overflow-x: hidden; margin-left: 42%"
        >
          <table class="table table-bordered" fixed-header style="width: 100%">
            <tbody>
              <tr>
                <td>
                  <div style="color: blue; text-align: left">
                    Data Entry For Site
                  </div>
                </td>
                <td>
                  <mat-form-field
                    style="
                      width: 175px;
                      margin-bottom: -24px;
                      margin-top: -13px;
                    "
                  >
                    <mat-label>Site</mat-label>
                    <input
                      matInput
                      placeholder="Site"
                      [readonly]="true"
                      (keypress)="keyPressAlphanumeric($event)"
                      formControlName="dataentrysite"
                      autocomplete="off"
                      required
                    />
                  </mat-form-field>
                </td>
              </tr>
              <tr>
                <td>
                  <div style="color: blue; text-align: left">Invoice Month</div>
                </td>
                <td>
                  <mat-form-field
                    style="
                      width: 175px;
                      margin-bottom: -24px;
                      margin-top: -13px;
                    "
                  >
                    <mat-label>Month</mat-label>
                    <input
                      matInput
                      placeholder="Month"
                      [readonly]="true"
                      formControlName="invoicemonth"
                      (keypress)="only_char($event)"
                      autocomplete="off"
                      required
                    />
                  </mat-form-field>
                </td>
                <!-- <td>
                                    <mat-form-field style="width: 175px;margin-bottom: -24px;margin-top: -13px;">
                                        <input matInput readonly [matDatepicker]="picker1" formControlName="invoicemonth" 
                                        placeholder="invoicemonth">
                                        <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                                        <mat-datepicker #picker1></mat-datepicker>
                                    </mat-form-field>
                                </td> -->
              </tr>

              <tr>
                <td>
                  <div style="color: blue; text-align: left">Security PAN</div>
                </td>
                <td>
                  <mat-form-field
                    style="
                      width: 175px;
                      margin-bottom: -24px;
                      margin-top: -13px;
                    "
                  >
                    <mat-label>Security Pan</mat-label>
                    <input
                      matInput
                      placeholder="Security Pan"
                      [readonly]="true"
                      formControlName="securitypan"
                      autocomplete="off"
                      required
                    />
                  </mat-form-field>
                </td>
              </tr>
              <tr>
                <td>
                  <div style="color: blue; text-align: left">
                    Security Agence Name
                  </div>
                </td>
                <td>
                  <mat-form-field
                    style="
                      width: 175px;
                      margin-bottom: -24px;
                      margin-top: -13px;
                    "
                  >
                    <mat-label>Security Agence Name</mat-label>
                    <input
                      matInput
                      placeholder="Security Agence Name"
                      [readonly]="true"
                      formControlName="securityagencename"
                      autocomplete="off"
                      required
                    />
                  </mat-form-field>
                </td>
              </tr>
              <!-- <tr>
                                <td>
                                    <div style="color: blue;text-align: left;">Security Tax Number</div>
                                </td>
                                <td>
                                    <mat-form-field style="width: 175px;margin-bottom: -24px;margin-top: -13px;">
                                        <mat-label>Security Tax Number</mat-label>
                                        <input matInput placeholder="Security Tax Number" (keypress)="keyPressAlphanumeric($event)" formControlName="servicetaxno"
                                            autocomplete="off" required>
                                    </mat-form-field>
                                </td>
                            </tr> -->
              <tr>
                <td>
                  <div style="color: blue; text-align: left">GST Number</div>
                </td>
                <td>
                  <mat-form-field
                    style="
                      width: 175px;
                      margin-bottom: -24px;
                      margin-top: -13px;
                    "
                  >
                    <mat-label>GST Number</mat-label>
                    <input
                      matInput
                      placeholder="GST Number"
                      [readonly]="true"
                      (keypress)="keyPressAlphanumeric($event)"
                      formControlName="gst_no"
                      autocomplete="off"
                    />
                  </mat-form-field>
                </td>
              </tr>

              <tr>
                <td>
                  <div style="color: blue; text-align: left">
                    Invoice Number
                  </div>
                </td>
                <td>
                  <mat-form-field
                    style="
                      width: 175px;
                      margin-bottom: -24px;
                      margin-top: -13px;
                    "
                  >
                    <mat-label>Invoice Number</mat-label>
                    <input
                      matInput
                      placeholder="Invoice Number"
                      (keypress)="omit_ForwardSlash($event)"
                      maxlength="16"
                      formControlName="invoiceno"
                      autocomplete="off"
                      required
                    />
                  </mat-form-field>
                </td>
              </tr>
              <tr>
                <td>
                  <div style="color: blue; text-align: left">Invoice Date</div>
                </td>
                <td>
                  <mat-form-field
                    style="
                      width: 175px;
                      margin-bottom: -24px;
                      margin-top: -13px;
                    "
                  >
                    <input
                      matInput
                      readonly
                      [matDatepicker]="picker2"
                      formControlName="invoicedate"
                      placeholder="Invoicedate"
                    />
                    <mat-datepicker-toggle
                      matSuffix
                      [for]="picker2"
                    ></mat-datepicker-toggle>
                    <mat-datepicker #picker2></mat-datepicker>
                  </mat-form-field>
                </td>
              </tr>
              <tr>
                <td>
                  <div style="color: blue; text-align: left">
                    Number of Armed Guards - No of duties per day
                  </div>
                </td>
                <td>
                  <mat-form-field
                    style="
                      width: 175px;
                      margin-bottom: -24px;
                      margin-top: -13px;
                    "
                  >
                    <mat-label>Value</mat-label>
                    <input
                      matInput
                      placeholder="Value"
                      [readonly]="true"
                      (keypress)="numberOnly($event)"
                      formControlName="aguarddutiespday"
                      autocomplete="off"
                      required
                    />
                  </mat-form-field>
                </td>
              </tr>
              <tr>
                <td>
                  <div style="color: blue; text-align: left">
                    Total No.of duties for Whole Month - Armed Guards
                  </div>
                </td>
                <td>
                  <mat-form-field
                    style="
                      width: 175px;
                      margin-bottom: -24px;
                      margin-top: -13px;
                    "
                  >
                    <mat-label>Value</mat-label>
                    <input
                      matInput
                      placeholder="Value"
                      [readonly]="true"
                      (keypress)="numberOnly($event)"
                      formControlName="aguarddutiesmonth"
                      autocomplete="off"
                      required
                    />
                  </mat-form-field>
                </td>
              </tr>
              <tr>
                <td>
                  <div style="color: blue; text-align: left">
                    Bill Amount -Armed Guard
                  </div>
                </td>
                <td>
                  <mat-form-field
                    style="
                      width: 175px;
                      margin-bottom: -24px;
                      margin-top: -13px;
                    "
                  >
                    <mat-label>Value</mat-label>
                    <input
                      matInput
                      placeholder="Value"
                      [readonly]="true"
                      (keypress)="keyPressAmounts($event)"
                      formControlName="abillamt"
                      autocomplete="off"
                      required
                    />
                  </mat-form-field>
                </td>
              </tr>
              <tr>
                <td>
                  <div style="color: blue; text-align: left">
                    Number of Security Guards (Unarmed) - No of duties per day
                  </div>
                </td>
                <td>
                  <mat-form-field
                    style="
                      width: 175px;
                      margin-bottom: -24px;
                      margin-top: -13px;
                    "
                  >
                    <mat-label>Value</mat-label>
                    <input
                      matInput
                      placeholder="Value"
                      [readonly]="true"
                      (keypress)="numberOnly($event)"
                      formControlName="unaguarddutiespday"
                      autocomplete="off"
                      required
                    />
                  </mat-form-field>
                </td>
              </tr>
              <tr>
                <td>
                  <div style="color: blue; text-align: left">
                    Total no.of duties for Whole Month - Security Guards
                  </div>
                </td>
                <td>
                  <mat-form-field
                    style="
                      width: 175px;
                      margin-bottom: -24px;
                      margin-top: -13px;
                    "
                  >
                    <mat-label>Value</mat-label>
                    <input
                      matInput
                      placeholder="Value"
                      [readonly]="true"
                      (keypress)="numberOnly($event)"
                      formControlName="unaguarddutiesmonth"
                      autocomplete="off"
                      required
                    />
                  </mat-form-field>
                </td>
              </tr>
              <tr>
                <td>
                  <div style="color: blue; text-align: left">
                    Bill Amount - Security Guard
                  </div>
                </td>
                <td>
                  <mat-form-field
                    style="
                      width: 175px;
                      margin-bottom: -24px;
                      margin-top: -13px;
                    "
                  >
                    <mat-label>Value</mat-label>
                    <input
                      matInput
                      placeholder="Value"
                      [readonly]="true"
                      (keypress)="keyPressAmounts($event)"
                      formControlName="sbillamt"
                      autocomplete="off"
                      required
                    />
                  </mat-form-field>
                </td>
              </tr>
              <tr>
                <td>
                  <div style="color: blue; text-align: left">
                    Total Bill Amount (Security + Armed )
                  </div>
                </td>
                <td>
                  <mat-form-field
                    style="
                      width: 175px;
                      margin-bottom: -24px;
                      margin-top: -13px;
                    "
                  >
                    <mat-label>Total Bill Amount</mat-label>
                    <input
                      matInput
                      placeholder="Total Bill Amount"
                      [readonly]="true"
                      (keypress)="keyPressAmounts($event)"
                      formControlName="totlbillamt"
                      autocomplete="off"
                      required
                    />
                  </mat-form-field>
                </td>
              </tr>
              <tr>
                <td>
                  <div style="color: blue; text-align: left">CGST AMOUNT</div>
                </td>
                <td>
                  <mat-form-field
                    style="
                      width: 175px;
                      margin-bottom: -24px;
                      margin-top: -13px;
                    "
                  >
                    <mat-label>CGST Amount</mat-label>
                    <input
                      matInput
                      placeholder="Amount"
                      (keypress)="keyPressAmounts($event)"
                      formControlName="cgstamt"
                      autocomplete="off"
                      [readonly]="true"
                      (keyup)="Cgst($event)"
                      required
                    />
                  </mat-form-field>
                </td>
              </tr>
              <tr>
                <td>
                  <div style="color: blue; text-align: left">
                    SGST/UTGST AMOUNT
                  </div>
                </td>
                <td>
                  <mat-form-field
                    style="
                      width: 175px;
                      margin-bottom: -24px;
                      margin-top: -13px;
                    "
                  >
                    <mat-label>SGST Amount</mat-label>
                    <input
                      matInput
                      placeholder="Amount"
                      [readonly]="true"
                      (keyup)="Sgst($event)"
                      formControlName="sgstamt"
                      (keypress)="keyPressAmounts($event)"
                      autocomplete="off"
                      required
                    />
                  </mat-form-field>
                </td>
              </tr>
              <tr>
                <td>
                  <div style="color: blue; text-align: left">IGST AMOUNT</div>
                </td>
                <td>
                  <mat-form-field
                    style="
                      width: 175px;
                      margin-bottom: -24px;
                      margin-top: -13px;
                    "
                  >
                    <mat-label>IGST Amount</mat-label>
                    <input
                      matInput
                      placeholder="Amount"
                      (keypress)="keyPressAmounts($event)"
                      formControlName="igstamt"
                      [readonly]="true"
                      (keyup)="Igst($event)"
                      autocomplete="off"
                    />
                  </mat-form-field>
                </td>
              </tr>
              <tr>
                <td>
                  <div style="color: blue; text-align: left">
                    CGST + SGST / UTGST (TOTAL GST)
                  </div>
                </td>
                <td>
                  <mat-form-field
                    style="
                      width: 175px;
                      margin-bottom: -24px;
                      margin-top: -13px;
                    "
                  >
                    <mat-label>Total GST Amount</mat-label>
                    <input
                      matInput
                      placeholder="Value"
                      (keypress)="keyPressAmounts($event)"
                      formControlName="totalgst"
                      autocomplete="off"
                      [readonly]="true"
                      required
                    />
                  </mat-form-field>
                </td>
              </tr>
              <tr>
                <td>
                  <div style="color: blue; text-align: left">
                    Total Amount Payable
                  </div>
                </td>
                <td>
                  <mat-form-field
                    style="
                      width: 175px;
                      margin-bottom: -24px;
                      margin-top: -13px;
                    "
                  >
                    <mat-label>Total Amount</mat-label>
                    <input
                      matInput
                      placeholder="Value"
                      [readonly]="true"
                      (keypress)="keyPressAmounts($event)"
                      formControlName="totlamtpayable"
                      autocomplete="off"
                      required
                    />
                  </mat-form-field>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </table>

      <div style="margin-left: 23%">
        <table>
          <div>
            <tr>
              <!-- <td>
								<mat-form-field style="width: 250px;">
									<mat-label>Approval Branch</mat-label>
                                    <input matInput [readonly] = "true" [readonly] = "true" formControlName="approval_branch_name">
                                </mat-form-field>
							</td>
							<td>
								<mat-form-field style="width: 250px;margin-left: 50px;"
									(click)="approvername()">
                                    <mat-label>Approver</mat-label>
									<input #employeeInput placeholder="Approver" matInput [readonly] = "true"
										formControlName="approver" [matAutocomplete]="employee" required>
									<mat-autocomplete #employee="matAutocomplete"
										[displayWith]="displayFnEmployee">
										<mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
										<ng-container *ngIf="!isLoading">
											<mat-option *ngFor="let employee of employeeList" (focusout)="approver(employee)"
												[value]="employee">{{employee.name}}
											</mat-option>
										</ng-container>
									</mat-autocomplete>
								</mat-form-field>
							</td> -->

              <td>
                <mat-form-field
                  style="width: 250px"
                  (click)="approvalBranchClick()"
                >
                  <mat-label>Approval Branch</mat-label>
                  <input
                    #appBranchInput
                    placeholder="Approval Branch"
                    matInput
                    [readonly]="basedOnUpdate"
                    formControlName="approval_branch"
                    (click)="clearAppBranch()"
                    [matAutocomplete]="approvalBranch"
                    required
                  />
                  <mat-autocomplete
                    #approvalBranch="matAutocomplete"
                    (opened)="autocompleteapprovalBranchScroll()"
                    [displayWith]="displayFnappBranch"
                  >
                    <mat-option *ngIf="isLoading" class="is-loading"
                      >Loading...</mat-option
                    >
                    <ng-container *ngIf="!isLoading">
                      <mat-option
                        *ngFor="let appBranch of appBranchList"
                        [value]="appBranch"
                        (focusout)="FocusApprovalBranch(appBranch)"
                      >
                        ({{ appBranch.code }}){{ appBranch.name }}
                      </mat-option>
                    </ng-container>
                  </mat-autocomplete>
                </mat-form-field>
              </td>
              <td>
                <mat-form-field
                  style="width: 250px; margin-left: 50px"
                  (click)="approvername()"
                >
                  <mat-label>Approver</mat-label>
                  <input
                    #employeeInput
                    placeholder="Approver"
                    matInput
                    #ApproverContactInput
                    [readonly]="basedOnUpdate"
                    formControlName="approver"
                    [matAutocomplete]="employee"
                    required
                  />
                  <mat-autocomplete
                    #employee="matAutocomplete"
                    (opened)="autocompleteapprovernameScroll()"
                    [displayWith]="displayFnEmployeeApprover"
                  >
                    <mat-option *ngIf="isLoading" class="is-loading"
                      >Loading...</mat-option
                    >
                    <ng-container *ngIf="!isLoading">
                      <mat-option
                        *ngFor="let employee of employeeList"
                        [value]="employee"
                        >{{ employee.full_name }}
                      </mat-option>
                    </ng-container>
                  </mat-autocomplete>
                </mat-form-field>
              </td>
            </tr>
          </div>
          <tr>
            <td *ngIf="fileData">
              <tr *ngFor="let file of fileData; index as i">
                <span
                  class="btn-link"
                  style="cursor: pointer"
                  data-target="#my-modal"
                  data-toggle="modal"
                  (click)="docFile(file.id, file.file_name)"
                >
                  {{ i + 1 }}. {{ file.file_name }}
                </span>

                <td>
                  <mat-icon
                    style="color: gray; cursor: pointer"
                    (click)="update_fileDelete(file.id, i)"
                    >delete</mat-icon
                  >
                </td>
              </tr>
            </td>
          </tr>
        </table>

        <input
          type="file"
          #fileInput
          id="uploadFile"
          class="choose-file"
          (change)="onFileSelectForRaiseReq($event)"
          name="uploadFile"
          multiple="multiple"
        />

        <div class="btn-bottom">
          <button
            type="submit"
            style="border-radius: 40px"
            class="btn btn-outline-primary"
            (click)="onSubmitClick()"
          >
            Save
          </button>
          <button
            type="button"
            (click)="onCancelClick()"
            class="btn btn-outline-primary"
            style="border-radius: 40px; margin-left: 10px"
          >
            Cancel
          </button>
        </div>
      </div>
    </form>
  </div>

  <div
    *ngIf="showPopupImages"
    id="my-modal"
    class="modal fade"
    aria-labelledby="exampleModalLabel"
    aria-hidden="true"
    tabindex="-1"
    role="dialog"
  >
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title w-100" id="exampleModalLabel">
            Attachment View
          </h5>

          <button
            type="button"
            class="close"
            data-dismiss="modal"
            aria-label="Close"
          >
            <span aria-hidden="true"> × </span>
          </button>
        </div>
        <div class="modal-body">
          <img src="{{ jpgUrls }}" />
        </div>
        <div class="modal-footer"></div>
      </div>
    </div>
  </div>
</div>
<ngx-spinner
  bdColor="rgba(51, 51, 51, 0.8)"
  size="default"
  [fullScreen]="true"
  type="ball-spin-clockwise"
>
  <p style="color: white">Loading...</p>
</ngx-spinner>

<!-- <pre>{{updateInvoiceForm.value|json}}</pre> -->
