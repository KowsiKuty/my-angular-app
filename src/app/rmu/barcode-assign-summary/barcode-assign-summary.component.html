<main style="margin-top:1%;margin-left:35px">
    <h2>Barcode Assign Summary</h2>
    <button class="btn btn-outline-dark backbtn" (click)="returnHome()" id="rmubtn"
        style="margin-top: -3%;">Back</button>
    <form [formGroup]="assignform">
        <section role="search" class="row">
            <div class="col-md-3">
                <mat-form-field appearance="outline" style="width: 100%;">
                    <mat-label>Request Date</mat-label>
                    <input matInput readonly [matDatepicker]="picker3" placeholder="Date" autocomplete="off"
                        formControlName="reqDate" required>
                    <mat-datepicker-toggle matSuffix [for]="picker3">
                    </mat-datepicker-toggle>
                    <mat-datepicker #picker3></mat-datepicker>
                </mat-form-field>
            </div>
            <div class="col-md-3">
                <mat-form-field class="summaryformfield" appearance="outline" style="width: 100%;">
                    <mat-label>Barcode Type</mat-label>
                    <mat-select matInput formControlName="barcodetype">
                        <mat-option *ngFor="let item of barcodetype" [value]="item.value">
                            {{item.name}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="col-md-3">
                <mat-form-field appearance="outline" style="width: 100%;">
                    <mat-label>Barcode Category</mat-label>
                    <mat-select matInput formControlName="barcodecategory">
                        <mat-option *ngFor="let item of barcodecategory" [value]="item.value">
                            {{item.name}}

                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="col-md-3" style="margin-top: 1.5%;">
                <button matTooltip="Search Records" class="btn btn-outline-success" style="margin-left:5%" id="rmubtn"
                    color="primary"><i class="fa fa-search" aria-hidden="true"></i></button>
                <button style="margin-left:10px;" class="btn btn-outline-dark" matTooltip="Clear Entries"
                    id="rmubtn">Clear</button>
            </div>
        </section>
    </form>
    <div class="dataTable">
        <div class="table-responsive" style="width:98%;margin-top: 1%;text-align: center;">
            <table class="table table-bordered" style="margin-top: 10px; padding-left: 10px;width: 100%;"
                id='commonstyle'>
                <thead class="table_header">
                    <tr>
                        <th>Request No</th>
                        <th>Date</th>
                        <th>Branch/Dept</th>
                        <th>Barcode Type</th>
                        <th>Barcode Category</th>
                        <th>Barcode Count</th>
                        <th>Status</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tr *ngFor="let sum of assignsummarylist;index as ind">
                    <td>{{(pagination.index-1)*limit+ind+1}}</td>
                    <td>{{sum.date | date:'dd-MM-yyyy'}}</td>
                    <td>({{sum.barcode_request_data[0].requested_by.employee_branch.code}})&nbsp;{{sum.barcode_request_data[0].requested_by.employee_branch.name}}
                    </td>
                    <td>{{sum.barcode_request_data[0].barcode_type.name}}</td>
                    <td>{{sum.barcode_request_data[0].sticker_series.name}}</td>
                    <td>{{sum.barcode_request_data[0].request_count}}</td>
                    <td>{{sum.barcode_request_data[0].request_status.value}}</td>
                    <td><button type="button" class="btn btn-outline-secondary" style="border-radius:40px;"
                            data-toggle="modal" (click)="assignbarcode(sum)" >
                            Assign</button></td>
            </table>
            <div *ngIf="!assignsummarylist.length" style="margin-left: 42%;">
                <h3>Sorry no data found!... </h3>
            </div>

            <div class="col-sm-12" style="font-size: small;text-align:right;margin-bottom: 5%;">
                <button (click)="prevpage()" mat-icon-button [disabled]="pagination.has_previous === false"
                    color="primary">
                    <mat-icon>arrow_back</mat-icon>
                </button>
                {{pagination.index}}
                <button (click)="nextpage()" mat-icon-button [disabled]="pagination.has_next === false" color="primary">
                    <mat-icon>arrow_forward</mat-icon>
                </button>
            </div>
        </div>
    </div>


    <div
    class="modal fade"
    id="barcodeassignform"
    tabindex="-1"
    aria-labelledby="barcodeassignform"
    aria-hidden="true"
    >
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content" >
        <div class="modal-header">
          <p class="modal-title mb-0" id="barcodeassignform" style="font-weight: 600;">Barcode Assign</p>
          <button
            type="button"
            class="close"
            data-dismiss="modal"
            #closeretrivalpopup
            aria-label="Close"
            (click)="close()"
          >
            <i aria-hidden="true">&times;</i>
          </button>
        </div>
    
        <div class="modal-body">
            <form [formGroup]="assignBarCode">
                <section class="row">
                    <div class="col-md-3">
                        <mat-form-field appearance="outline" style="width: 100%;">
                            <mat-label>Branch/Dept</mat-label>
                            <input rows="1" style="max-height:60px;" matInput [value]="dept | titlecase"
                                readonly="true" required>
                        </mat-form-field>
                    </div>
                    <div class="col-md-3">
                        <mat-form-field appearance="outline" style="width: 100%;">
                            <mat-label>Barcode Type</mat-label>
                            <input matInput formControlName="barcode_type" required readonly="true">
                        </mat-form-field>
                    </div>
                    <div class="col-md-3">
                        <mat-form-field appearance="outline" style="width: 100%;">
                            <mat-label>Barcode Category</mat-label>
                            <input matInput formControlName="barcode_category" required readonly="true">
                        </mat-form-field>
                    </div>
                    <div class="col-md-3">
                        <mat-form-field appearance="outline" style="width: 100%;">
                            <mat-label>Requested Count</mat-label>
                            <input matInput formControlName="count" type="number" readonly="true">
                        </mat-form-field>
                    </div>
                </section>
                <div class="row">
                    <div class="col-md-3">
                        <mat-form-field appearance="outline" style="width: 100%;">
                            <mat-label>Vendor</mat-label>
                            <mat-select matInput formControlName="vendor" required
                                (selectionChange)="onChangeVendor($event.value)">
                                <mat-option *ngFor="let val of vendorlist" [value]="val.vendor_master_id">
                                    {{val.name}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                    <div class="col-md-3">
                        <mat-form-field appearance="outline" style="width: 100%;">
                            <mat-label> Barcodes from Series</mat-label>
                            <mat-select matInput formControlName="from_series" required
                                (selectionChange)="onChangeStartsWith($event.value)">
                                <mat-option *ngFor="let val of vendorlists" [value]="val.from_series">
                                    {{val.from_series}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                    <div class="col-md-3">
                        <mat-form-field appearance="outline" style="width: 100%;">
                            <mat-label> Barcodes To Series</mat-label>
                            <input matInput formControlName="to_series" required readonly="true">
                        </mat-form-field>
                    </div>
                </div>
                <div class="row">

                    <div class="col-md-3">
                        <mat-form-field appearance="outline" style="width: 100%;">
                            <mat-label>Available Barcodes</mat-label>
                            <input matInput formControlName="barcodeavailable" readonly>
                        </mat-form-field>
                    </div>

                    <div class="col-md-3">
                        <mat-form-field appearance="outline" style="width: 100%;">
                            <mat-label>Allot Barcodes</mat-label>
                            <input matInput formControlName="barcodealloted" required type="number" #bcend
                                (change)="changevalue(bcend.value); checkvalue(bcend.value)"
                                onkeydown="changevalue(bcend.value); checkvalue(bcend.value)"
                                onkeypress="changevalue(bcend.value);checkvalue(bcend.value)"
                                (keypress)="changevalue(bcend.value); checkvalue(bcend.value)">
                        </mat-form-field>
                    </div>
                    <div class="col-md-6">
                        <mat-form-field appearance="outline" style="width: 100%;">
                            <mat-label>Comments</mat-label>
                            <textarea rows="1" cols="10" matInput formControlName="comments"
                                required></textarea>
                        </mat-form-field>
                    </div>
                </div>
            </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline-success" *ngIf="this.isButtonVisible"
                                (click)="approvebarcode()">Submit</button>
                            <button data-dismiss="modal" #closeretrivalpopup (click)="close()" class="btn btn-outline-primary" 
                                >Close</button>
        </div>
      </div>
    </div>
    </div>

   
</main>