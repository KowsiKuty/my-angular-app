
<div class="container" style="margin-left: 15px;max-width: fit-content;margin-top: 2%;">
    <h3 style="color:black;font-size: 20px;font-weight: 500;margin-left: 20px;">
        Claim Submission
   </h3>
   <div *ngIf='value === 0'>
    <h3 style="color: black;font-size: 18px;font-weight: 500px;margin-left: 20px;">
        On BeHalf Employee - {{onbehalfname}}
    </h3>
    </div>
    <div style="margin-top: 15px;margin-left: 20px;">
        <div class="row">
            <div class="col-12">
                <form [formGroup]="memoSearchForm">
    
                    <mat-form-field style="width:10rem; margin-left: 20px; margin-left: 7px;">
                        <mat-label>Tour No</mat-label>
                        <input matInput placeholder="Tour No"  formControlName="tourno"
                          type="text" #inputRef 
                        >
                    </mat-form-field>
                    <mat-form-field style="width:210px;"  id="tasumspace">
                        <mat-label>Tour Requested Date</mat-label>
                        <input matInput readonly [matDatepicker]="picker1" (dateChange)="fromDateSelection($event.value)" 
                                placeholder="Request Date" autocomplete="off" formControlName="requestdate">
                                <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                                <mat-datepicker #picker1></mat-datepicker>
                    </mat-form-field>
                    <!-- <button mat-fab id="tasumspace" [disabled]="creatable"  (click)="tourMakerSearch()" color="primary" aria-label="Search">
                        <mat-icon>search</mat-icon>
                      </button>
                    -->
                    <button  type="button" class="btn btn-outline-success" [disabled]="creatable" (click)="tourMakerSearch()" 
                        style="border-radius:40px;margin-left:3%" color="primary" matTooltip=" Expense Search"><i class="fa fa-search" 
                            aria-hidden="true"></i></button>
                    <button class="btn btn-outline-success" type="clear" [disabled]="creatable" style="border-radius:40px;margin-left: 15px;"
                    color="primary" (click)=reset()>Clear</button>
                    <!-- <button class="btn btn-outline-success" [routerLink]='"/ta/ta_summary"' style="border-radius:40px;margin-left:3%"> Back

                    </button> -->
                </form>
            </div>
        </div>
    <table class="table table-bordered" fixed-header style="width: 100%;margin-top: 10px;">
        <thead class="table_header" style="text-align: left;">
    <tr>
    <th>S.No</th>
    <th>Tour No</th>
    <th>Tour Request Date</th>
    <th>CR Number</th>
    <th style="width: 8%;">Tour Start Date</th>
    <th  style="width: 8%;">Tour End Date</th>
    <th>Tour Reason</th>
    <th>Branch </th>
    <th>Employee</th>
    <th>Approver</th>
    <th>Status</th>
    <th>Expense Details</th>
    
    </tr>
    </thead>
    <tbody> 
        <tr *ngFor="let tourexpence of getexpenceList; index as i">
       <td scope="row"  style="vertical-align: middle;">{{(this.currentpage - 1)*pagesize +i+1 }}</td>
       
        <td>{{tourexpence.requestno}}</td>
        <td>{{tourexpence.requestdate}}</td>
        <td>{{tourexpence.crno?tourexpence.crno:''}}</td>
        <td>{{tourexpence.startdate}}</td>
        <td>{{tourexpence.enddate}}</td>
        <td>{{tourexpence.reason}}</td>
        <td>({{tourexpence.branch_code}}) {{tourexpence.branch_name}}</td>
        <td>({{tourexpence.employee_code}}) {{tourexpence.employee_name}}</td>
        <td *ngIf="tourexpence.approver_code"> ({{tourexpence.approver_code}}) {{tourexpence.approvedby}}</td>
        <td *ngIf="tourexpence.approver_code == null"></td>
        <td>
            <p *ngIf="tourexpence.claim_status_id == 1">
                Claim created</p>
    
                <p *ngIf="tourexpence.claim_status_id == 3 && tourexpence.max_applevel== 1">
                Tour claim Forwarder Approved</p>
    
                <p *ngIf="tourexpence.claim_status_id == 4  && tourexpence.max_applevel== 1">
                    Tour claim Rejected from Forwarder</p>
    
                  <p *ngIf="tourexpence.claim_status_id == 2 && tourexpence.max_applevel== 1">
                  Tour Claim Submitted To Forwarder</p>
    
                  <p *ngIf="tourexpence.claim_status_id == 5 && tourexpence.max_applevel== 1">
                    Tour Claim Returned from Forwarder</p>
    
                <p *ngIf="tourexpence.claim_status_id == 4  && tourexpence.max_applevel== 2">
                  Tour claim Rejected from Approver</p>
    
                <p *ngIf="tourexpence.claim_status_id == 2 && tourexpence.max_applevel== 2">
                Tour Claim Submitted To Approver</p>
    
                <p *ngIf="tourexpence.claim_status_id == 5 && tourexpence.max_applevel== 2">
                  Tour Claim Returned from Approver</p>
    
                  <p *ngIf="tourexpence.claim_status_id == 3 && tourexpence.max_applevel== 2">
                    Tour claim Approver Approved</p>

        </td>
        <td><button mat-icon-button matTooltip="Expense Edit" class="iconbutton" color="primary"
            (click)="expenceEdit(tourexpence)">
            
            <mat-icon style="color:green;font-size: 30px;" aria-label="Edit">edit</mat-icon>
        </button>
        </td>
            
        </tr>
    </tbody>
    </table>
    <div *ngIf="getexpenceList?.length == 0 "  style="margin-left: 42%;">
            <h3>Sorry data not found!..</h3>
    </div>  
          <div class="row" *ngIf="isTourMakerpage">
        <div class="col-sm-12" style="font-size: small;text-align:right;margin-bottom: 5%;">
            <button mat-icon-button [disabled]="has_previous === false" color="primary"
            (click)="TourmakerpreviousClick()">
            <mat-icon >arrow_back</mat-icon>
            </button>
            {{currentpage}}
            <button mat-icon-button [disabled]="has_next === false" color="primary"
            (click)="TourmakernextClick()">
            <mat-icon >arrow_forward</mat-icon>
            </button>
            </div>
    </div>
    </div>


</div>