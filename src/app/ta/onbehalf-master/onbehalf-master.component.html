<br>
<div  class="col-md-12">
    

<div class="row">
    <div style="margin-left:5px" class="col-12">
        <form [formGroup]="employeeSearchForm">
            <td>
            <mat-form-field style="width:250px;">
                <mat-label>Branch Name</mat-label>
               
              

                  <input type="text" #inputassetid placeholder="Select Branch" matInput [matAutocomplete]="conoffice"
                  formControlName="empbranchgid">
                <button mat-button matSuffix (click)="inputassetid.value = null" mat-icon-button aria-label="Clear">
                  <mat-icon>close</mat-icon>
                </button>
                <mat-autocomplete #assetid #conoffice="matAutocomplete" (opened)="autocompleteid()"[displayWith]="displayFnbr">
                  <mat-option *ngFor="let branch of branchlist" (click)="getbranches(branch.id)"
                    [value]="branch">
                    {{branch.code +'-'+branch.name}}
                  </mat-option>
                </mat-autocomplete>
            </mat-form-field>
            </td>
            <td>
                <mat-form-field style="width:250px; margin-left: 25px;">
                    <mat-label>Employee Name</mat-label>
                    <input type="text"  placeholder="Select Employee" matInput [matAutocomplete]="empc" #empinput
                  formControlName="approval" >
                  <mat-autocomplete  #empid #empc="matAutocomplete" [displayWith]="displayFn" (opened)="empScroll()">
                    <mat-option *ngFor="let emp of employeelist" [value]="emp"  >
                      ({{emp.code}}) {{emp.name}}
                    </mat-option>
                  </mat-autocomplete>
                </mat-form-field>
                 

                </td>   
                <td>
            <button class="btn btn-outline-success" type="submit" style="border-radius:40px;margin-left: 15px;"
                color="success"><i class="fa fa-search" (click)="employeeSearch()" aria-hidden="true"></i></button>
            <button class="btn btn-outline-success" type="clear" (click)="resetall()" style="border-radius:40px;margin-left: 15px;"
                color="success">Clear</button>
            
                <button type="button" class="btn btn-outline-success" data-toggle="modal"
                data-target="#myModal" style="border-radius:40px;margin-left: 15px"><span
                    class="fa fa-plus"></span>
            </button>
            </td> 
        </form>
    </div>
</div>

    <div class="col-md-12">
        <table class="table table-bordered">
            <tr class="table_header">
                <th>S.No</th>
                <th>Employee Name</th>
                <th>Branch Name </th>
                <th>Onbehalf Employee</th>
                <th>Status</th>

            </tr>
            <tr *ngFor="let t of datatable;index as i">
                <td>{{((currentpage -1)*10)+i+1}}</td>
                <td>{{t.employee_name}}</td>
                <td>{{t.branch_name}}</td>
                <td>{{t.onbehalf_employee_name}}</td>
                <td>
                    <button mat-icon-button [ngClass]="(t.status == 1)? 'statusbutton  ':'statusbuttoninactive'"
                        (click)=" activate(t)">
                        <mat-icon class="material-icons-outlined">wb_sunny</mat-icon>
                    </button>
                    <button class="fa fa-external-link" matTooltip="View" aria-hidden="true" mat-icon-button style="color:blue;font-size: 24px;margin-left: 20px;"  data-target="#my-modal" data-toggle="modal" (click)="ta_view_file(t,t)"></button>
                    <button  mat-icon-button color="primary"  (click)="ta_download(t,t)" >
                    
                        
                           
                        <mat-icon matTooltip="Click to Maker File Download" >download</mat-icon></button>
                    
                </td>
            </tr>
            <tr *ngIf="datatable?.length==0; else gstpagination" class="NodataAlign"><td colspan="19" style="text-align: center;">No Records Found...</td></tr>
                            <ng-template #gstpagination>
                           <tr>
                            <td colspan="4">Total Count:{{this.totalcount}}</td>
                           <td colspan="15">
                           <div style="text-align:right;">
                            <button mat-icon-button [disabled]="has_previous === false" color="primary" (click)="previousClick()">
                                   <mat-icon>arrow_back
                                   </mat-icon>
                                </button>  {{currentpage}}
                                <button mat-icon-button [disabled]="has_next === false" color="primary" (click)="nextClick()">
                                   <mat-icon>arrow_forward
                                   </mat-icon>
                               </button>
                           </div>
                           </td>
                           </tr>
                           </ng-template>
    
        </table>
    </div>

    <br>
    <br>
    <br>
</div>
<div id="myModal" class="modal fade col-md-12 " data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-xl">
        <div class='modal-content'>
            <div class="modal-header " style="background:#DDEFDD">
                <h3 class="modal-title   w-100" style="color: black; font-weight: 500;"> Add eClaim Onbehalf Employee</h3>
                <button type="button" #modalclose  (click)="resetall()" class="close" #closed data-dismiss="modal">&times;</button>

            </div>
            <div class="modal-body">
                <form [formGroup]="onbehalfform">
                    <table style="width: 70%;">
                        <tr>
                            <td>
                                <mat-form-field  floatLabel="always" style="width:20rem; ">
                                    <mat-label>Branch</mat-label>
                                    <input type="text" #inputassetid placeholder="Select Branch" matInput
                                        [matAutocomplete]="conoffice" formControlName="branch">
                                    <mat-autocomplete #assetid #conoffice="matAutocomplete" (opened)="autocompleteid()">
                                        <mat-option *ngFor="let branch of branchlist" (focusout)="branchname(branch)"
                                            [value]="branch.name">
                                            {{branch.code}}-{{branch.name}}
                                        </mat-option>
                                    </mat-autocomplete>
                                </mat-form-field>
                            </td>
                            <td>
                                <mat-form-field  floatLabel="always" style="width:20rem; ">
                                    <mat-label>Employee</mat-label>
                                    <input matInput  type="text" placeholder="Select Employee" [matAutocomplete]="empc1"#empinput1
                                        formControlName="employee" />

                                    <mat-autocomplete #empid1 #empc1="matAutocomplete" [displayWith]="displayFn" (opened)="emp1Scroll()">
                                       
                                        <mat-option *ngFor="let emp of employeelist" [value]="emp" (click)="getemployee(emp, 1)">
                                            ({{emp.code}}) {{emp.name}}
                                          </mat-option>  
                                
                            </mat-autocomplete>
                                </mat-form-field>
                            </td>
                        </tr>
                    </table>

                    <table mat-table #sortCol1="matSort" [dataSource]="dataSource" matSort style="width: 100%;">

                        <ng-container matColumnDef="sno">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header
                                style="width:20%;font-size: small;font-weight: bold;">S No</th>
                           
                              <td mat-cell *matCellDef="let element ;let i = index" class="left-text"> {{(onbehalf_currentpage-1)*limit+i+1}}</td>
                        </ng-container>
                        <ng-container matColumnDef="employee">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header
                                style="width:30%;font-size: small;font-weight: bold;">Employee</th>
                            <td mat-cell *matCellDef="let element" class="left-text"> {{element.full_name}} </td>
                        </ng-container>
                     
                        <ng-container matColumnDef="select">
                            <th mat-header-cell *matHeaderCellDef style="width:20%;font-size: small;font-weight: bold;">
                                Action
                                <!-- <mat-checkbox (change)="toggleAllRows($event)"
                                [checked]="selection.hasValue() && isAllSelected()"
                                    [checked]="selection.hasValue() && isAllSelected()">

                                </mat-checkbox> -->
                            </th>

                            <td mat-cell *matCellDef="let row">
                                <mat-checkbox (click)="$event.stopPropagation()"
                                (change)="$event ? selection.toggle(row) : null"
                                    [checked]="selection.isSelected(row)" (click)="selectedRow(row)">
                                </mat-checkbox>
                            </td>
                        </ng-container>
                        <ng-container  matColumnDef="fileUpload" >
                            <th mat-header-cell *matHeaderCellDef style="width:30%;font-size: small;font-weight: bold;">
                                Upload File
                            </th>
                            
                            <td mat-cell *matCellDef="let element">
                                <input type="file" #fileInput2 (change)="onFileUpload($event, element)" accept=".pdf,.doc,.docx,.png,.jpg" />
                            </td>
                        </ng-container>
                        <tr mat-header-row *matHeaderRowDef="displayedColumn"></tr>
                        <tr mat-row *matRowDef="let row; columns: displayedColumn;"></tr>
                        
                        <!-- <tr mat-header-row *matHeaderRowDef="displayedColumn1"></tr>
                        <tr mat-row *matRowDef="let row; columns: displayedColumn1;"></tr> -->
                          
                          
                       
                    </table>
                    <div>
                        <!-- <div *ngIf="dataSource?.data.length == 0; " style="text-align:center" >
                            <p>No data</p>
                        </div> -->
                        <div *ngIf="dataSource?.data.length != 0" #pagination style="float:right" >
                            <button type="button" mat-icon-button (click)="previousregion()" [disabled]="!onbehalf_hasprevious" color="primary"><mat-icon>arrow_back</mat-icon></button>
                            {{onbehalf_currentpage}}
                            <button type="button" mat-icon-button (click)="nextregion()" [disabled]="!onbehalf_hasnext" color="primary"><mat-icon> arrow_forward</mat-icon></button>
                        </div>
                    </div>  
                


                    <div style="text-align: center;margin-top : 20px;">
                        <button type="button" class="btn btn-outline-primary" (click)="submit()" style="border-radius: 40px;margin-left: 10px;margin: top 10px;" >Submit</button>
                        
                        <button type="button" class="btn btn-outline-danger" style="border-radius: 40px;margin-left: 10px;margin: top 10px;" (click)="resetall()" >Cancel</button>
                        
                    </div>
                </form>
            </div>

        </div>

    </div>

</div>
<div *ngIf="showimageHeaderAPI" id="my-modal" class="modal fade" aria-labelledby="my-modalLabel" aria-hidden="true"
   tabindex="-1" role="dialog">
   <div class="modal-dialog modal-xl" data-dismiss="modal" style="width: 60%;height: 80%;">
         <div class="modal-content">
            <div class="modal-header" style="background:#e6ffe6">
               <h2 class="modal-title">TA Onbehalf Attachments</h2>
                     <button type="button" class="text-right" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                     </button>
            </div>
            <div class="modal-body">
               <img src="{{jpgUrlsAPI}}" class="img-responsive" style="width: 100%;">
            
            </div>
         </div>
   </div>
</div>
<div *ngIf="showimagepdf" id="my-modal" class="modal fade" aria-labelledby="my-modalLabel" aria-hidden="true"
   tabindex="-1" role="dialog">
   <div class="modal-dialog modal-xl">
         <div class="modal-content">
            <div class="modal-header" style="background:#e6ffe6">
               <h2 class="modal-title">TA Onbehalf Attachments</h2>
               <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                     <span aria-hidden="true">&times;</span>
               </button>
            </div>
            <pdf-viewer [src]="pdfurl" [original-size]="false" [render-text]='false' [show-borders]="true"
               [fit-to-page]="true" [show-all]="true" style="display: block; height: 600px;" [fit-to-page]="true">
            </pdf-viewer>
         </div>
   </div>
</div>