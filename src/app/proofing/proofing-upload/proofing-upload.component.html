<div style="margin-left: 8px;">
    <mat-tab-group mat-stretch-tabs="false" mat-align-tabs="start">
        <mat-tab style="margin-left: -21px;" label="Excel Upload">
            <div style="margin:2%" *ngIf="file_upload_fieldenable">
                <!-- <mat-card style="margin:20px 12px 20px 20px;" class="mat-elevation-z0"> -->
                <form [formGroup]="uploadForm" (ngSubmit)="uploadDocument()">

                    <div class="row">
                        <div class="col-md-4">
                            <!-- <mat-label>Account</mat-label><br>
                        <mat-form-field class="matformfieldstyle" appearance="outline" style="width: 85%;">
                            <mat-select class="matformfieldinputstyle" placeholder="Account">
                                <mat-option *ngFor="let ac of AccountList" [value]="ac.id" (click)="getAccountTemplate(ac)">
                                    {{ac.name}} -- {{ac.account_number}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field> -->

                            <app-account-selection-dropdown></app-account-selection-dropdown>
                            </div>
                                
                        <div class="col-md-3">
                            <mat-label>From Date</mat-label>
                            <mat-form-field class="matformfieldstyle datewidth" appearance="outline">
                                <input [max]="previousDate" readonly matInput [matDatepicker]="picker4" formControlName="from_date"
                                    class="matformfieldinputstyle" (dateChange)="fromdateSelection($event.value)">
                                <mat-datepicker-toggle matSuffix class="maticonsize" [for]="picker4">
                                </mat-datepicker-toggle>
                                <mat-datepicker #picker4></mat-datepicker>
                            </mat-form-field>
                        </div>
                        <div class="col-md-3">
                            <mat-label>To Date</mat-label><br/>
                            <mat-form-field class="matformfieldstyle datewidth" appearance="outline">
                                <input [min]="select" [max]="previousDate" 
                                readonly matInput [matDatepicker]="picker3" formControlName="to_date"
                                    class="matformfieldinputstyle" (dateChange)="excelupload()" >
                                <mat-datepicker-toggle matSuffix class="maticonsize" [for]="picker3">
                                </mat-datepicker-toggle>
                                <mat-datepicker #picker3></mat-datepicker>
                            </mat-form-field>
                        </div>

                        <!-- <lib-vs-sep-dates-cmp
                        class="package-grid-width"
                        [DateInput]="frtoexeceldate"
                        (fromdate)="fromdateexcelfun($event)"
                        (todate)="todateexcelfun($event)"
                      ></lib-vs-sep-dates-cmp> -->
                    </div>


                       
                            <!-- <button *ngIf="this.accountid" type="button" class="btn btn-light" id="darkbtn"
                            (click)="getuploaddata($event)">View Uploaded Data</button> -->

                            <!-- <button type="submit" id="primarybtn" *ngIf="images"
                            style="border-color: black; background-color: #01A85A; color: white;margin-left: 50px;"
                            class="btn btn-light" (click)="Approve($event)">Appr ove</button> -->
                    <br>
                    <div class="row">
                       
                            <span>
                                {{templateText}}
                            </span>
                            <br>
                            <label class="btn btn-default btn-file" style="margin-top:5px">
                                <input type="file" [accept]="acceptfiles[templateText]"
                                    formControlName="images" (change)="fileChange($event,'notbulk')">
                            </label>
                       

                            
                            <!-- <label *ngIf="!uploadForm.invalid">Action</label> -->
                            
                            <button type="submit" class="btn btn-outline-success" matTooltip="Upload" style=" width: 50px;height:50px;margin-left:25px;
                            
                            border-radius: 25px;">
                            <span class="fa fa-upload"></span></button>
                                <!-- <mat-icon aria-label="Edit">upload</mat-icon></button> -->
                      

                            
                            <!-- <label *ngIf="!uploadForm.invalid">Action</label> -->
                            
                            <button class="btn btn-outline-warning"
                            style="border-radius: 25px;margin-left:25px;height:50px;width:50px" matTooltip="History"
                            (click)="checkHistory()" ><span class="fa fa-history"></span></button>
                            <button  class="btn btn-outline-warning" matTooltip="Check Uploaded File Status" style="width: 50px;height:50px;border-radius: 25px;margin-left:25px" (click)="enablefileinfo()"><span class="fa fa-info-circle" aria-hidden="true"> </span>
                            </button>
                            <!-- <div class="col-md-3"> -->
                                <button type="button" class="btn btn-outline-dark" data-toggle="modal"  matTooltip="Bulk Account Excel Upload"
                                    style="border-radius: 25px;cursor: pointer;margin-left: 25px;width: 50px;height:50px" (click)="popupopen()"><span class="fa fa-plus"></span>
                                </button>
                            
                           
                            
                        
                        
                        <button type="button" routerLink="/proofing/proofingtransaction" matTooltip="Back" class="btn btn-outline-success" style="border-radius:30px;height:40px;margin-left:125px "><span
                            class="fa fa-arrow-left back-button">Go Back</span></button>
                        
                      
                          

                    <!-- <div (scroll)="tablescrolled($event)" *ngIf="proofingList?.length" class="table-responsive"
                        style="height: 60vh;">
                        <table class="table scrolltable table-bordered" style="text-align:center;">
                            <thead class="table_header" style="position:sticky;top:0;z-index: 85;">
                                <tr>
                                    <th style="width: 3%;">S.No</th>
                                    <th *ngFor="let item of headerarray;index as i" [ngClass]="item?.class">
                                        {{item.column_name}}
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let temp of proofingList | slice:0:offsetlimit ; let i = index">
                                    <td>
                                        {{ i+1 }}
                                    </td>
                                    <td>{{ temp?.reference_no}}</td>
                                    <td>{{ temp?.date | date:'dd-MMM-yyyy'}}</td>
                                    <td>{{ temp?.description}}</td>
                                    <td>
                                        <div *ngIf="temp?.creditamount== 0 ">{{ temp?.debitamount|
                                            currency:"INR":'symbol':'0.2-6'}}</div>
                                    </td>
                                    <td>
                                        <div *ngIf="temp?.debitamount == 0">{{ temp?.creditamount|
                                            currency:"INR":'symbol':'0.2-6'}}</div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div> -->
                    <!-- <div *ngIf="!proofingList?.length" style="text-align:center">
                    <h2>Sorrry No Data Found..</h2>
                </div> -->
                </div>
                
                </form>
            <!-- <div class="col-md-3">
                <button type="button" class="btn btn-outline-dark" data-toggle="modal" data-target="#bulk_acexcelupload"
                    style="border-radius: 20px;cursor: pointer;margin-left: 50px;margin-top: 5px;"><span class="fa fa-plus"></span>
                    Bulk Account Excel Upload</button>
            </div> -->
           
                 
                <!-- </mat-card> -->
                <!-- <button  class="btn btn-outline-primary" (click)="autotriger()"><i class="fa fa-refresh"></i></button> -->
                
            </div>
            <div *ngIf="Showuploaddetailsenable" class="container" style="margin-top:10px;margin-left:10px">
                <div style="margin-left:5px">
                    <h2 >File Uploaded Summary</h2>
                </div>
                <div class=" row" style="margin-top:25px">
                <div class="col-md-4">
                    <app-account-selection-dropdown></app-account-selection-dropdown>
                </div>
                <div class="col-md-8"  style="margin-top:25px;">
                    <button class="btn btn-outline-primary" (click)="filesummary()" style="border-radius:25px" matTooltip="Check Status"><i class="fa fa-refresh"></i>Check Status</button>
                    <button type="button" (click)="back()" class="btn btn-outline-success" matTooltip="Back"
                        style="border-radius:30px;height:40px;margin-left:125px "><span class="fa fa-arrow-left back-button">Go Back</span></button>
                </div>
                </div>
                <div class="col-sm-12 col-lg-12 table-responsive" style="margin-left:-5px">
                     <table class="table table-bordered">
                        <thead class="table_header">
                            <tr>
                            <th>SI No</th>
                            <th>File Name</th>
                            <!-- <th (click)="filesummary()">Status <i class="fa fa-refresh"></i></th> -->
                            <th >Status </th>
                        </tr>
                        </thead>
                        <tbody >
                        <tr *ngFor="let a of Fileuploadsummary let i=index">
                            <th>{{(presentpage-1)*10+i+1}}</th>
                            <td>{{a?.filename}}</td>
                            <!-- <td> <i class="fa fa-file" aria-hidden="true"></i><span>File uploaded failed</span></td> -->
                            <td *ngIf="a?.status==4"><div style="color:green"><i class="fa fa-check" aria-hidden="true"  >
                                
                            </i> <span>File uploaded successfully</span></div><mat-progress-bar mode="determinate" value="100"></mat-progress-bar></td>
                            <td *ngIf="a?.status==5" style="color:red">File Uploaded Failed</td>
                            <td *ngIf="a?.status!=4 && a?.status!=5">
                            <mat-progress-bar mode="indeterminate" ></mat-progress-bar></td>
                        </tr>
                           <!-- <td><span><i  class="fa fa-check"></i></span><mat-progress-bar mode="indeterminate"></mat-progress-bar></td> -->
                           <!-- <td>Success</td> -->
                           <tr *ngIf="Fileuploadsummary?.length==0" >
                            <td colspan="3" class="text-center">Please select Account</td></tr>
                           </tbody> 
                     </table>  
                     <div class="row" *ngIf="Fileuploadsummary?.length>0" >
                        <div class="col-sm-12" style="font-size: small;text-align: right;">
                            <button mat-icon-button [disabled]="has_previous === false" color="primary"
                                (click)="previous_page()">
                                <mat-icon >arrow_back</mat-icon>
                            </button>
                            {{presentpage}}
                            <button mat-icon-button [disabled]="has_next === false" color="primary"
                                (click)="next_page()">
                                <mat-icon >arrow_forward</mat-icon>
                            </button>
                        </div>
                    </div>
                     
        </div>       
                            
            </div>
        </mat-tab>
        
        <mat-tab label="Data Fetch">

            <div style="margin:2%">
                <div class="row">
                    <div class="col-md-3">
                        <app-account-selection-dropdown></app-account-selection-dropdown>
                    </div>
                     
                    <div class="col-md-3">
                        <mat-label>From Date</mat-label><br>
                        <mat-form-field class="matformfieldstyle datewidth" appearance="outline">
                            <input [max]="previousDate" matInput [matDatepicker]="picker1" [(ngModel)]="from_date"
                                class="matformfieldinputstyle" (dateChange)="fromdateSelection($event.value)">
                            <mat-datepicker-toggle matSuffix class="maticonsize" [for]="picker1">
                            </mat-datepicker-toggle>
                            <mat-datepicker #picker1></mat-datepicker>
                        </mat-form-field>
                    </div>
                    <div class="col-md-3">
                        <mat-label>To Date</mat-label><br>
                        <mat-form-field  class="matformfieldstyle datewidth" appearance="outline">
                            <input [min]="select" [max]="previousDate" matInput [matDatepicker]="picker2" [(ngModel)]="to_date"
                                class="matformfieldinputstyle" (dateChange)="dataupload()">
                            <mat-datepicker-toggle matSuffix class="maticonsize" [for]="picker2">
                            </mat-datepicker-toggle>
                            <mat-datepicker #picker2></mat-datepicker>
                        </mat-form-field>
                    </div>

                    <div *ngIf="isshow" class="col-md-2">
                        <br>
                        <button style="margin-top: 2%;"
                         class="btn btn-outline-success"
                            (click)="fetchData()">
                            Fetch & Insert
                        </button>
                    </div> 
                    <div class="col-md-1">
                        <button class="btn btn-outline-warning"
                        style="border-radius: 7px;
                        margin-left: -30%;
                        margin-top: 47%;
                        font-size: medium;" 
                        (click)="checkHistorys()" >History</button>
                    </div>
                    <div>
                        <!-- <button mat-fab matTooltip="ageing report"
                                    style="border-radius:40px;margin-left:15px;background-color: white;"
                                    routerLink="/proofing/proofingtransaction">Back</button>  -->
                                    <button type="button" routerLink="/proofing/proofingtransaction" class="btn btn-outline-success" matTooltip="Back" style="border-radius:30px;height:40px;margin-top: 1.5rem;"><span
                                            class="fa fa-arrow-left back-button">Go Back</span></button>
                    </div>
              

                </div>
                <h3 *ngIf="fetchedData?.length">Total Records : {{this.fetchedData?.length}}</h3>
                <!-- <div (scroll)="tablescrolled($event)" *ngIf="fetchedData?.length" class="table-responsive"
                    style="height: 60vh;">
                    
                    <table class="table scrolltable table-bordered" style="text-align:center;">
                        <thead class="table_header" style="position:sticky;top:0;z-index: 85;">
                            <tr>
                                <th style="width: 3%;">S.No</th>
                                <th>CRN NO</th>
                                <th>Gl Date</th>
                                <th>Remarks</th>
                                <th>Debit</th>
                                <th>Credit</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let temp of fetchedData | slice:0:offsetlimit ; let i = index">
                                <td>
                                    {{ i+1 }}
                                </td>
                                <td>{{ temp?.entry_crno}}</td>
                                <td>{{ temp?.entry_transactiondate | date:'dd-MMM-yyyy'}}</td>
                                <td>{{ temp?.entry_glremarks}}</td>
                                <td>
                                    <div *ngIf="temp?.creditamt == 0">{{ temp?.debitamt |
                                        currency:"INR":'symbol':'0.2-6'}}</div>
                                </td>
                                <td>
                                    <div *ngIf="temp?.debitamt == 0">{{ temp?.creditamt |
                                        currency:"INR":'symbol':'0.2-6'}}</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>  -->
            </div>


        </mat-tab>
    </mat-tab-group>
</div>

<div class="modal fade bd-example-modal-lg" data-backdrop="static" data-keyboard="false" id="bulk_acexcelupload" tabindex="-1"
                        role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                        <div class="modal-dialog modal-lg" role="document">
                            <div class="modal-content">
                                <div class="modal-header" style="background-color: #DDEFDD;">
                                    <h2 class="modal-title" id="exampleModalLongTitle">Bulk Account Excel Upload</h2>
                                    <button type="button" class="close" #closebutton data-dismiss="modal" aria-label="Close"    #closeaddpopup
                                     (click)="bulkuploadclose()">
                                        <span aria-hidden="true">&times;</span>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <form [formGroup]="ac_excelform">
                                        <div class="row">
                                        <div class="col-md-3">
                                            <mat-label style="font-weight: bold;">Accounts</mat-label>
                                            <mat-form-field class="example-chip-list matformfieldstyle" style="font-size: 10px;" appearance="outline" (click)="check_para()">
                                                <mat-chip-list #chipList>
                                                    <mat-chip *ngFor="let chip of chiplist" [selectable]="selectable" [removable]=true (removed)="remove(chip)">
                                        
                                                        {{chip}}
                                                        <mat-icon matChipRemove>cancel</mat-icon>
                                                    </mat-chip>
                                                    <input class="matformfieldinput" placeholder="GL-20333" #withoutreportInput style="font-size: 15px;"
                                                        formControlName="accountno" [matAutocomplete]="account" [matChipInputFor]="chipList"
                                                        [matChipInputSeparatorKeyCodes]="separatorKeysCodes" [matChipInputAddOnBlur]=true required>
                                        
                                                </mat-chip-list>
                                                <mat-autocomplete #account="matAutocomplete" [displayWith]="acc_show">
                                                    <mat-option (click)="selectdropdown(acc)" *ngFor="let acc of chipSelected" [value]="acc"
                                                        (mouseenter)="open()">
                                                        {{acc.name}} --- {{acc.account_number}}
                                                    </mat-option>
                                                </mat-autocomplete>
                                            </mat-form-field>
                                        </div>
                                    <!-- <div class="col-md-3" style="margin-left:25px">
                                        <mat-label style="font-weight: bold;">From Date</mat-label>
                                        <mat-form-field class="matformfieldstyle datewidth" appearance="outline">
                                            <input [max]="previousDate" readonly matInput [matDatepicker]="picker5" formControlName="from_date"
                                                class="matformfieldinputstyle" (dateChange)="fromdateSelection($event.value)">
                                            <mat-datepicker-toggle matSuffix class="maticonsize" [for]="picker5">
                                            </mat-datepicker-toggle>
                                            <mat-datepicker #picker5></mat-datepicker>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-md-3" style="margin-left:75px">
                                        <mat-label style="font-weight: bold;">To Date</mat-label>
                                        <mat-form-field class="matformfieldstyle datewidth" appearance="outline">
                                            <input [min]="select" [max]="previousDate" 
                                            readonly matInput [matDatepicker]="picker6" formControlName="to_date"
                                                class="matformfieldinputstyle" (dateChange)="excelupload()" >
                                            <mat-datepicker-toggle matSuffix class="maticonsize" [for]="picker6">
                                            </mat-datepicker-toggle>
                                            <mat-datepicker #picker6></mat-datepicker>
                                        </mat-form-field>
                                    </div> -->
                                    <div style="margin-left: 24px;
                                    margin-top: 18px;
                                ">
                                <lib-vs-sep-dates-cmp
                                    class="package-grid-width"
                                    [DateInput]="frtodate"
                                    (fromdate)="fromdatefun($event)"
                                    (todate)="todatefun($event)"
                                  ></lib-vs-sep-dates-cmp>

                                    </div>
                                    
                                    </div>
                                    <div class="row">
                                            <div  class="col-md-4">
                                                <label class="btn btn-default btn-file">
                                                    <input type="file" [accept]="acceptfiles[templateText]"
                                                        formControlName="ac_ex_images" (change)="fileChange($event,'bulk')">
                                                </label>
                                            </div>
                                            <div class="col-md-4">
                                                <button mat-icon-button (click)="upload_exclel()">
                                                    <mat-icon>
                                                        upload
                                                    </mat-icon></button>
                                            </div>
                                    </div>
                                    </form>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-danger text-center" data-dismiss="modal" (click)="bulkuploadclose()">Close</button>
                                    <!--  <button type="button" class="btn btn-success">Add</button>
                                </div> -->
                                </div>
                            </div>
                        </div>
                    </div>