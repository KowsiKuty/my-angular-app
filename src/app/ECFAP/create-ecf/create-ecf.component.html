<header class="header-adjust">
    <div class="headingalign">
        <h3>
            <i class="fa fa-arrow-left" aria-hidden="true" (click)="backform()"></i>&nbsp; ECF Header
        </h3>
        <button *ngIf="ecfheaderidd != '' && ecfheaderidd != null && ecfheaderidd != undefined && ecfstatus?.id !=2"
            mat-icon-button matTooltip=" Edit" matTooltipClass="custom-tooltipnew" class="iconbutton"
            [disabled]="!readecfdata" (click)="showecfHdredit()" id="create-ecf-0008">
            <mat-icon [ngClass]="disableecfsave ? 'edit_disabled' : 'edit_enabled'" aria-label="Edit">edit</mat-icon>
        </button>
    </div>
    <div class="button-div">
        <!-- <button  type="submit"
        style="border-radius:40px;"
        class="btn btn-outline-primary" (click)="SubmitForm()"
        [disabled]="disableecfsave" id="create-ecf-0036">
        Save</button> -->
        <div *ngIf="showeditinvhdrform">
            <button style="border-radius:40px;" type="button" class="btn btn-outline-success" (click)="addclick()"
                #closeaddpopup>
                <!-- data-toggle="modal"
    data-target="#approversubmit" -->
                Submit
            </button>

            <!-- <button type="button"
      style="border-radius:40px;margin-left:10px"
      class="btn btn-outline-primary" (click)="backform()" id="create-ecf-0039">
      Back</button> -->
        </div>

        <!-- <div *ngIf="showback">
        <button type="button"
        style="border-radius:40px;"
        class="btn btn-outline-primary" (click)="backform()" id="create-ecf-0039">
        Back</button>
       </div> -->

    </div>
</header>

<div class="modal fade" id="approversubmit" tabindex="-1" aria-labelledby="exampleModalLongTitle" aria-hidden="true"
    role="dialog">
    <div class="modal-dialog modal-md">
        <div class="modal-content" style="width:550px">
            <div class="modal-header">
                <h3 class="modal-title mb-0">Approver Submit</h3>
                <button type="button" class="close" #closebuttonss data-dismiss="modal" aria-label="Close"
                    (click)="back()">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            <div class="modal-body">
                <form [formGroup]="OverallForm">
                    <!-- <td>
                    <mat-form-field style="width: 200px;">
                        <input type="text" matInput formControlName="payment_instruction" autocomplete="off"
                            placeholder="Payment Instructions" id="create-ecf-0089">
                    </mat-form-field> 
                </td>
                <td>
                    <section class="example-section ecfapcheck" style="margin-left:50px">
                        <mat-checkbox class="example-margin" formControlName="is_tds_applicable">Is TDS Applicable
                        
                        </mat-checkbox>
                    </section>
                </td> -->
                    <!-- <td *ngIf="ecfstatus?.text !='BATCH ECF RETURNED'">
                <mat-label style="margin-left: 50px;" >Batch wise <label style="color:red">*</label></mat-label>

                <mat-radio-group formControlName="batch_wise">
                    <mat-radio-button *ngFor="let n of yesorno" [value]="n.value" style="margin-left: 10px;margin-top: 10px;"
                        (click)="batchwiseSelect(n.value)">

                        {{n.display}}
                    </mat-radio-button>
                </mat-radio-group>
            </td> -->
                    <div *ngIf="ecfstatus?.text !='BATCH ECF RETURNED' && showApprover">
                        <!-- <lib-vs-depdropdown-cmp class="package-grid-width"
                [ParentObj]="ParentObj"
                [formGroup]="OverallForm"
                [ChildObj]="ChildObj"  
                  (dataEventParent)="approverdata($event)"
                (dataEventChild)="selectedvaluess($event)">
              </lib-vs-depdropdown-cmp> -->
                        <div class="searchs-expand">
                             <lib-vs-dynamicform-cmp id="matInput-size" [InputFields]="approverbranch"
                                [formGroup]="OverallForm"  (dataEvent)="approverbranchclick($event)"></lib-vs-dynamicform-cmp>

                            <lib-vs-dynamicform-cmp id="matInput-size" [InputFields]="approvernames"
                                [formGroup]="OverallForm" ></lib-vs-dynamicform-cmp>
                        </div>
                        <!-- <div class="searchs-expand">
                <lib-vs-depdropdown-cmp
                   id="matInput-size"
                  [ParentObj]="approverbranchfield"
                  [formGroup]="OverallForm"
                  [ChildObj]="approvernamefield"
                  [ResetForm]="restformdep"
                >
                </lib-vs-depdropdown-cmp>
                </div> -->
                        <!-- <mat-form-field appearance="outline" (click)="getbranchname()">
                    <mat-label>Approver Branch</mat-label>
                    <input #brInput placeholder="Approver Branch" matInput formControlName="branch_id"
                        [matAutocomplete]="branchmatAuto" id="create-ecf-0090">
                    <mat-autocomplete [panelWidth]="400" #branchmatAuto="matAutocomplete" (opened)="branchScroll()"
                        [displayWith]="displayFnBranch">
                        <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                        <ng-container *ngIf="!isLoading">
                            <mat-option *ngFor="let br of brList" matTooltip="{{br.code}}-{{br.name}}" matTooltipClass="custom-tooltipnew" [value]="br">
                                {{br.code}}-{{br.name}}
                            </mat-option>
                        </ng-container>
                    </mat-autocomplete>
                </mat-form-field> -->
                        <!-- <mat-form-field appearance="outline" (click)="approvername()">
                    <mat-label>Approver Name</mat-label>
                    <input #appInput  placeholder="Choose Approver" matInput
                    formControlName="approvedby" [matAutocomplete]="approver" required id="create-ecf-0091">
                    <mat-autocomplete [panelWidth]="400" #approver="matAutocomplete" (opened)="autocompleteapproverScroll()"
                    [displayWith]="displayFnapprover">
                        <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                        <ng-container *ngIf="!isLoading">
                            <mat-option *ngFor="let app of approverList" matTooltip="{{app.name}} -{{app.code}}-{{app.limit}}-{{app.designation}}" matTooltipClass="custom-tooltipnew" [value]="app">
                                {{app.name}}-{{app.code}} - {{app.limit}} - {{app.designation}}
                        </mat-option>
                        </ng-container>
                    </mat-autocomplete>
                </mat-form-field>  -->
                    </div>
                    <!-- <td *ngIf="ecfstatus?.text !='BATCH ECF RETURNED'">                
                <button type="button" style="border-radius:40px;margin-left: 10px;"
                                class="btn btn-outline-primary" (click)="OverallFormSubmits()" [disabled]="submitoverallbtn" id="create-ecf-0092">
        
                                Submit
                            </button>
                <button type="button" style="border-radius:40px;margin-left: 10px;"
                class="btn btn-outline-primary" (click)="backform()" id="create-ecf-0093">
                Back</button>
            </td>
            <td *ngIf="ecfstatus?.text =='BATCH ECF RETURNED'">                
                <button type="button" style="border-radius:40px;margin-left: 450px;"
                                class="btn btn-outline-primary" (click)="OverallFormSubmits()" [disabled]="submitoverallbtn" id="create-ecf-0094">
        
                                Submit
                            </button>
                <button type="button" style="border-radius:40px;margin-left: 10px;"
                class="btn btn-outline-primary" (click)="backform()" id="create-ecf-0095">
                Back</button>
            </td>
            <td *ngIf="ecfstatus?.text =='BATCH ECF RETURNED'">
                <button type="button" style="border-radius:40px;margin-left: 10px;" matTooltip="Remove from Batch" 
                matTooltipClass="custom-tooltipnew" class="btn btn-outline-primary" (click)="removefrom_batch()" id="create-ecf-0096">
                Remove from Batch</button>
            </td> -->
                </form>

                <div class="modal-footer">
                    <div *ngIf="ecfstatus?.text !='BATCH ECF RETURNED'">
                        <button type="button" style="border-radius:40px;margin-left: 10px;"
                            class="btn btn-outline-success" (click)="OverallFormSubmits()" [disabled]="submitoverallbtn"
                            id="create-ecf-0092">

                            Submit
                        </button>
                        <!-- <button type="button" style="border-radius:40px;margin-left: 10px;"
            class="btn btn-outline-primary" (click)="backform()" id="create-ecf-0093">
            Back</button> -->
                    </div>
                    <div *ngIf="ecfstatus?.text =='BATCH ECF RETURNED'">
                        <button type="button" style="border-radius:40px;margin-left:10px;"
                            class="btn btn-outline-success" (click)="OverallFormSubmits()" [disabled]="submitoverallbtn"
                            id="create-ecf-0094">

                            Submit
                        </button>
                        <!-- <button type="button" style="border-radius:40px;margin-left: 10px;"
            class="btn btn-outline-primary" (click)="backform()" id="create-ecf-0095">
            Back</button> -->
                    </div>
                    <div *ngIf="ecfstatus?.text =='BATCH ECF RETURNED'">
                        <button type="button" style="border-radius:40px;margin-left: 10px;"
                            matTooltip="Remove from Batch" matTooltipClass="custom-tooltipnew"
                            class="btn btn-outline-primary" (click)="removefrom_batch()" id="create-ecf-0096">
                            Remove from Batch</button>
                    </div>
                    <button type="button" class="btn btn-outline-primary" data-dismiss="modal" (click)="back()"
                        style="border-radius: 40px">
                        Back
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- -----ECF HEADER FORM---- -->
<div style="margin-top:20px">


    <!-- <h3 >
                ECF Header
                
            
                <button *ngIf="ecfheaderidd != '' && ecfheaderidd != null && ecfheaderidd != undefined" mat-icon-button 
                matTooltip=" Edit" matTooltipClass="custom-tooltipnew" class="iconbutton" [disabled]="!readecfdata"
                style ="margin-left:10px;margin-top: 10px;border-radius: 50%;" (click)="showecfHdredit()" id="create-ecf-0008">
                <mat-icon  [ngClass]="disableecfsave ? 'edit_disabled' : 'edit_enabled'" aria-label="Edit">edit</mat-icon>
                </button>
            </h3> -->

    <form [formGroup]="ecfheaderForm" autocomplete="off">


        <div class="search-auto-fit">
            <!-- <div [ngStyle]="{'pointer-events': (disableppx || readecfdata || ecfheaderForm.value.ppx?.id == 'E') ? 'none' : 'auto', 'opacity': (disableppx || readecfdata || ecfheaderForm.value.ppx?.id == 'E') ? '0.6' : '1'}">
                            <lib-vs-optiondd-cmp         
                             [InputFields]="ecf_field"
                             [formGroup]="ecfheaderForm"
                             (dataEvent)="getecf($event)">
                            </lib-vs-optiondd-cmp>
                        </div> -->

            <div [ngStyle]="{
                            'pointer-events':
                            (ecfheaderidd !='' && ecfheaderidd != undefined && ecfheaderidd != null) ? 
                            'none' : 'auto', 'opacity': 
                            (ecfheaderidd !='' && ecfheaderidd != undefined && ecfheaderidd != null) ? 
                            '0.6' : '1'}">
                <lib-vs-optiondd-cmp [InputFields]="ecf_field" [formGroup]="ecfheaderForm" (dataEvent)="getecf($event)">
                </lib-vs-optiondd-cmp>
            </div>

            <div *ngIf="showpayto" [ngStyle]="{
                'pointer-events':
                (readecfdata == true) ? 
                'none' : 'auto', 'opacity': 
                (readecfdata == true) ? 
                '0.6' : '1'}">
                <lib-vs-dynamicform-cmp [InputFields]="ecf_payment_to_field" [formGroup]="ecfheaderForm">
                </lib-vs-dynamicform-cmp>
                <!-- <mat-form-field appearance="outline">

                                <input #payto matInput formControlName="payto"
                                    [matAutocomplete]="paytofilterValue" placeholder="Payment For"
                                    [readonly]="readecfdata == true" required id="create-ecf-0010">
                                <mat-autocomplete #paytofilterValue="matAutocomplete"
                                    [displayWith]="displayFnpayFilter">
                                    <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                    <ng-container *ngIf="!isLoading">
                                        <mat-option *ngFor="let pay of payList" [value]="pay">
                                        </mat-option>
                                    </ng-container>
                                </mat-autocomplete>
                            </mat-form-field> -->
            </div>

            <div *ngIf="showpetty" [ngStyle]="{
                'pointer-events':
                (readecfdata == true) ? 
                'none' : 'auto', 'opacity': 
                (readecfdata == true) ? 
                '0.6' : '1'}">
                <lib-vs-dynamicform-cmp [InputFields]="ecf_petty_cash_field" [formGroup]="ecfheaderForm">
                </lib-vs-dynamicform-cmp>
                <!-- <mat-form-field  (click)="getpettydropdown()" appearance="outline">

                                <input #petty matInput formControlName="payto"
                                    [matAutocomplete]="pettyfilterValue" placeholder="Payment For"
                                    [readonly]="readecfdata == true" required id="create-ecf-0011">
                                <mat-autocomplete #pettyfilterValue="matAutocomplete"
                                    [displayWith]="displayFnpettyFilter">
                                    <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                    <ng-container *ngIf="!isLoading">
                                        <mat-option *ngFor="let petty of pettyList" [value]="petty">
                                        </mat-option>
                                    </ng-container>
                                </mat-autocomplete>
                            </mat-form-field> -->
            </div>

            <div *ngIf="showppx">
                <!-- <div [ngStyle]="{'pointer-events': disableppx ? 'none' : 'auto', 'opacity': disableppx ? '0.6' : '1'}"> -->
                <div [ngStyle]="{ 'pointer-events': (readecfdata == true) ? 'none' : 'auto',
                                 'opacity': (readecfdata == true) ? '0.6' : '1'}">
                    <lib-vs-dynamicform-cmp [InputFields]="ecf_payment_field" [formGroup]="ecfheaderForm"
                        (dataEvent)="getppx($event)">
                    </lib-vs-dynamicform-cmp>
                </div>
            </div>

            <div [ngStyle]="{
                            'pointer-events': (readecfdata == true) ? 'none' : 'auto',
                            'opacity': (readecfdata == true) ? '0.6' : '1'
                          }">
                <lib-vs-dynamicform-cmp [InputFields]="ecf_Commodity_field" [formGroup]="ecfheaderForm"
                    (dataEvent)="getcommoditydata($event)">
                </lib-vs-dynamicform-cmp>
            </div>

            <div id="matInput-size">
                <mat-form-field appearance="outline">
                    <mat-label>ECF Date</mat-label>
                    <input matInput [matDatepicker]="picker1" [max]="tomorrow" autocomplete="off"
                        formControlName="apdate" [disabled]="disabledate" id="create-ecf-0014">

                    <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                    <mat-datepicker #picker1></mat-datepicker>
                </mat-form-field>
            </div>

            <div id="matInput-size">

                <mat-form-field (click)="getheaderbranch()" appearance="outline">
                    <mat-label>Branch</mat-label>
                    <input #branchInput matInput formControlName="branch" [matAutocomplete]="branchtyperole" readonly
                        matTooltip="{{this.branchrole}}" matTooltipClass="custom-tooltipnew"
                        (focus)="onFocus($event,'branch')" id="create-ecf-0021">
                    <!-- <mat-icon matSuffix class="maticonsize">unfold_more</mat-icon> -->
                    <mat-autocomplete [panelWidth]="250" #branchtyperole="matAutocomplete"
                        [displayWith]="displayFnbranchrole" (opened)="branchroleScroll()">
                        <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                        <ng-container *ngIf="!isLoading">
                            <mat-option *ngFor="let branch of Branchlist" [value]="branch"
                                matTooltip="{{branch.code}}-{{branch.name}}" matTooltipClass="custom-tooltipnew">
                                {{branch.code}}-{{branch.name}}
                            </mat-option>
                        </ng-container>
                    </mat-autocomplete>
                </mat-form-field>
            </div>

            <!-- <div *ngIf="showadvance && showadvforemployee"> -->
            <div *ngIf="showadvance && showadvforemployee" [ngStyle]="{
                                'pointer-events': (readecfdata != false) ? 'none' : 'auto',
                                'opacity': (readecfdata != false) ? '0.6' : '1'
                              }">
                <lib-vs-optiondd-cmp id="matInput-size" [InputFields]="ecf_advance_field"
                    [formGroup]="ecfheaderForm"></lib-vs-optiondd-cmp>
            </div>


            <!-- <div *ngIf="showadvance && showadvforsupplier"> -->
            <div *ngIf="showadvance && showadvforsupplier" [ngStyle]="{
                                'pointer-events': (readecfdata != false) ? 'none' : 'auto',
                                'opacity': (readecfdata != false) ? '0.6' : '1'
                              }">
                <!-- <lib-vs-dynamicform-cmp 
                              id="matInput-size"
                              [InputFields]="ecf_advance_field"
                              [formGroup]="ecfheaderForm"
                            ></lib-vs-dynamicform-cmp> -->
                <lib-vs-optiondd-cmp id="matInput-size" [InputFields]="ecf_advance_supplier_field"
                    [formGroup]="ecfheaderForm"></lib-vs-optiondd-cmp>
            </div>

            <div id="matInput-size" *ngIf="ecfheaderForm.value.aptype != 7 && ecfheaderForm.value.aptype != 13">
                <mat-form-field appearance="outline">
                    <mat-label>ECF Amount</mat-label>
                    <input type="text" matInput formControlName="apamount" autocomplete="off" style="text-align:right"
                        (keypress)="getCharCode($event);numberOnlyandDot($event, ecfheaderForm.value.apamount)"
                        (input)="ecfhdrchangeToCurrency(apamount ,'apamount')" (focus)="onFocus($event,'ecfamount')"
                        #apamount (change)="ecfamtDecimalChg()"
                        [readonly]="this.ecfheaderidd != '' && this.ecfheaderidd != undefined && this.ecfheaderidd != null"
                        required id="create-ecf-0031">
                </mat-form-field>
            </div>

            <div id="matInput-size" *ngIf="ecfheaderForm.value.aptype == 7">
                <mat-form-field appearance="outline">
                    <mat-label>CRN Amount</mat-label>
                    <input type="text" matInput formControlName="apamount" style="text-align:right" autocomplete="off"
                        (keypress)="getCharCode($event);numberOnlyandDot($event, ecfheaderForm.value.apamount)"
                        (input)="ecfhdrchangeToCurrency(apamount ,'apamount')" (focus)="onFocus($event,'ecfamount')"
                        #apamount (change)="ecfamtDecimalChg()" [readonly]="readecfdata == true" required
                        id="create-ecf-0032">
                </mat-form-field>
            </div>

            <div id="matInput-size" *ngIf="ecfheaderForm.value.aptype == 13">
                <mat-form-field appearance="outline">
                    <mat-label>ECF Amount</mat-label>
                    <input type="text" matInput formControlName="apamount" style="text-align:right"
                        placeholder="ECF Amount" autocomplete="off" (focus)="onFocus($event,'ecfamount')" 
                        (keypress)="getCharCode($event);numberOnlyandDot($event, ecfheaderForm.value.apamount)"
                        (input)="ecfhdrchangeToCurrency(apamount ,'apamount')" (ngModelChange)="pettyamount($event)"
                        #apamount (change)="ecfamtDecimalChg()" [readonly]="readecfdata == true" required
                        id="create-ecf-0033">
                </mat-form-field>
            </div>

            <div id="matInput-size">
                <mat-form-field appearance="outline">
                    <mat-label>Remarks</mat-label>
                    <!-- placeholder="Remarks" -->
                    <input type="text" matInput formControlName="remark" autocomplete="off"
                        (change)="filterText(remark, 'remark')" #remark maxlength="60"
                        [matTooltip]="ecfheaderForm.value.remark" matTooltipClass="custom-tooltipnew"
                        [readonly]="readecfdata == true" (focus)="onFocus($event,'remarks')" id="create-ecf-0034">
                </mat-form-field>
            </div>

            <div class="filter-aling ">
                <!-- <div style="display: flex;justify-content: space-between;"> -->
                <h3 (click)="Notespopup()"
                    style="cursor: pointer;color:black;font-family: 'Montserrat';font-weight: bold;"
                    class="btn btn-link">Add Notes<label style="color:red">*</label>
                    <!-- data-toggle="modal"  data-target=".bd-example-modal-xl" -->
                </h3>
                <button type="submit" style="border-radius:40px;height: 37px;margin-top:5px"
                    class="btn btn-outline-success" (click)="SubmitForm()" [disabled]="disableecfsave"
                    id="create-ecf-0036">
                    Save</button>
                <!-- <div *ngIf="showbacks">
                                <button type="button"
                                style="border-radius:40px;"
                                class="btn btn-outline-primary" (click)="backform()" id="create-ecf-0039">
                                Back</button>
                                </div> -->
                <!-- </div> -->
            </div>

        </div>

        <!-- <table>
                        <div> -->
        <!-- <tr>
                                <td>
                                    <lib-vs-optiondd-cmp  [InputFields]="ecf_field" [formGroup]="ecfheaderForm"
                                    (dataEvent)="getecf($event)"></lib-vs-optiondd-cmp>
                                  -->
        <!-- </td>
                                <td *ngIf="showpayto">
                                    <mat-form-field style="width: 200px;margin-left: 50px" appearance="outline">

                                        <input #payto matInput formControlName="payto"
                                            [matAutocomplete]="paytofilterValue" placeholder="Payment For"
                                            [readonly]="readecfdata == true" required id="create-ecf-0010">
                                        <mat-autocomplete #paytofilterValue="matAutocomplete"
                                            [displayWith]="displayFnpayFilter">
                                            <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                            <ng-container *ngIf="!isLoading">
                                                <mat-option *ngFor="let pay of payList" [value]="pay">
                                                </mat-option>
                                            </ng-container>
                                        </mat-autocomplete>
                                    </mat-form-field>
                                </td>
                                <td *ngIf="showpetty">
                                    
                                    <mat-form-field style="width: 200px;margin-left: 50px" (click)="getpettydropdown()" appearance="outline">

                                        <input #petty matInput formControlName="payto"
                                            [matAutocomplete]="pettyfilterValue" placeholder="Payment For"
                                            [readonly]="readecfdata == true" required id="create-ecf-0011">
                                        <mat-autocomplete #pettyfilterValue="matAutocomplete"
                                            [displayWith]="displayFnpettyFilter">
                                            <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                            <ng-container *ngIf="!isLoading">
                                                <mat-option *ngFor="let petty of pettyList" [value]="petty">
                                                </mat-option>
                                            </ng-container>
                                        </mat-autocomplete>
                                    </mat-form-field>
                                </td>

                                <td *ngIf="showppx">
                                    <lib-vs-dynamicform-cmp [InputFields]="ecf_payment_field" [formGroup]="ecfheaderForm" (dataEvent)="getppx($event)"></lib-vs-dynamicform-cmp>
                                   <mat-form-field style="width: 200px;margin-left: 50px" appearance="outline">

                                        <input #ppx matInput formControlName="ppx"
                                            [matAutocomplete]="ppxfilterValue" placeholder="Payment For"
                                            [readonly]="readecfdata == true || ecfheaderForm.value.ppx.id =='E'" required>
                                        <mat-autocomplete #ppxfilterValue="matAutocomplete"
                                            [displayWith]="displayFnppxFilter">
                                            <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                            <ng-container *ngIf="!isLoading">
                                                <mat-option *ngFor="let ppx of ppxList" [value]="ppx"
                                                    (click)="getppx(ppx)">{{ppx.text}}
                                                </mat-option>
                                            </ng-container>
                                        </mat-autocomplete>
                                    </mat-form-field> -->
        <!-- </td>  -->


        <!-- <td>
                                    <mat-form-field style="margin-left: 50px;width:200px">
                                        <mat-select placeholder="Supplier Type" formControlName="supplier_type"
                                            [disabled]="readecfdata != false" required (focus)="onFocus($event,'suppliertype')" id="create-ecf-0012">
                                            <mat-option *ngFor="let stype of SupptypeList" [value]="stype.id" 
                                                matTooltip="{{stype.text}}">
                                                {{stype.text}}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>

                                </td> -->

        <!-- <td> -->
        <!-- <mat-label style="margin-left: 50px">Commodity Name<label
                                            style="color:red">*</label></mat-label><br> -->
        <!-- <lib-vs-dynamicform-cmp  [InputFields]="ecf_Commodity_field" [formGroup]="ecfheaderForm"
                                    (dataEvent)="getcommoditydata($event)"></lib-vs-dynamicform-cmp> -->
        <!-- <mat-form-field style="width: 200px;margin-left: 50px"
                                        (click)="getcommoditydd()" appearance="outline">

                                        <mat-label>Commodity Name</mat-label>
                                        <input #commodityInput  matInput
                                            formControlName="commodity_id" [matAutocomplete]="commoditytype"
                                            [matTooltip]="ecfheaderForm.value.commodity_id.name" matTooltipClass="custom-tooltipnew"
                                            [readonly]="readecfdata == true" required (focus)="onFocus($event,'commodity')" id="create-ecf-0013"> -->
        <!-- <mat-icon matSuffix class="maticonsize">unfold_more</mat-icon> -->
        <!-- <mat-autocomplete [panelWidth]="300" #commoditytype="matAutocomplete"
                                            [displayWith]="displayFncommodity" (opened)="commodityScroll()">
                                            <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                            <ng-container *ngIf="!isLoading">
                                                <mat-option *ngFor="let commodity of commodityList"
                                                    [value]="commodity" (click)="getcommoditydata(commodity)"
                                                    matTooltip="{{commodity.name}}" matTooltipClass="custom-tooltipnew">
                                                    {{commodity.name}}
                                                </mat-option>
                                            </ng-container>
                                        </mat-autocomplete>
                                    </mat-form-field> -->
        <!-- </td>
                                <td> -->
        <!-- <mat-label style="margin-left: 50px">ECF Request Date</mat-label><br> -->
        <!-- <mat-form-field style="width: 175px;margin-left: 50px" appearance="outline">
                                          <mat-label>ECF Date</mat-label>
                                        <input matInput [matDatepicker]="picker1" [max]="tomorrow" 
                                            autocomplete="off" formControlName="apdate" [disabled]="disabledate" id="create-ecf-0014">

                                        <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                                        <mat-datepicker #picker1></mat-datepicker>
                                    </mat-form-field> -->
        <!-- </td>
                            </tr> -->

        <!-- <tr *ngIf="showfornonpo">
                                <td *ngIf="showdate">
                                    <mat-form-field style="width: 175px">
                                        <mat-label>ECF Date</mat-label>
                                        <input matInput [matDatepicker]="picker1" readonly [max]="tomorrow"
                                            autocomplete="off" formControlName="apdate" [disabled]="disabledate" id="create-ecf-0015">
                                        <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                                        <mat-datepicker #picker1></mat-datepicker>
                                    </mat-form-field>
                                </td>

                                <td *ngIf="showbranchdata">
                                    <mat-form-field style="width: 200px;">
                                        <input type="text" matInput formControlName="branch" autocomplete="off"
                                            placeholder="Branch Name" id="create-ecf-0016">
                                    </mat-form-field>

                                </td>
                              
                                 <td *ngIf="showbranch">

                                    <mat-form-field style="width: 200px; " (click)="getheaderbranch()">

                                        <input #branchInput matInput formControlName="branch"
                                            [matAutocomplete]="branchtyperole" required
                                            [readonly]="readecfdata == true" placeholder="Choose Branch" (focus)="onFocus($event,'branch')" id="create-ecf-0017">
                                        <mat-autocomplete [panelWidth]="400" #branchtyperole="matAutocomplete"
                                            [displayWith]="displayFnbranchrole" (opened)="branchScroll()">
                                            <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                            <ng-container *ngIf="!isLoading">
                                                <mat-option *ngFor="let branch of Branchlist" [value]="branch"
                                                    matTooltip="{{branch.code}}-{{branch.name}}">
                                                    {{branch.code}}-{{branch.name}}
                                                </mat-option>
                                            </ng-container>
                                        </mat-autocomplete>
                                    </mat-form-field>
                                </td>

                                <td *ngIf="ecfheaderForm?.value?.branch?.name == 'PRECIOUS METALS DIVISION' || ecfheaderForm?.value?.branch ==  this.branchroleid ">
                                    
                                    <mat-form-field style="width: 200px;margin-left: 50px; " (click)="getlocation()">

                                        <input #locationInput matInput formControlName="location"
                                            [matAutocomplete]="loctype" 
                                            [readonly]="readecfdata == true" placeholder="Choose Location" (focus)="onFocus($event,'location')" id="create-ecf-0018">
                                        <mat-autocomplete [panelWidth]="400" #loctype="matAutocomplete"
                                            [displayWith]="displayFnlocation" (opened)="locationScroll()">
                                            <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                            <ng-container *ngIf="!isLoading">
                                                <mat-option *ngFor="let loc of Locationlist" [value]="loc"
                                                    matTooltip="{{loc.location}}" >
                                                    {{loc.location}}
                                                </mat-option>
                                            </ng-container>
                                        </mat-autocomplete>
                                    </mat-form-field>


                                </td>
                                <td>
                                    <mat-form-field style="margin-left: 50px;width:200px">
                                        <mat-select placeholder="Is Original Document" formControlName="is_originalinvoice"
                                            [disabled]="readecfdata != false" required (focus)="onFocus($event,'orginv')" id="create-ecf-0019">
                                            <mat-option *ngFor="let inv of invoiceyesno" [value]="inv.value"
                                                >
                                                {{inv.display}}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>

                                </td>
                            </tr> -->

        <!-- <tr> -->
        <!-- 
                                <td *ngIf="showdate">
                                    <mat-form-field style="width: 175px">
                                        <mat-label>ECF Date</mat-label>
                                        <input matInput [matDatepicker]="picker1" readonly [max]="tomorrow"
                                            autocomplete="off" formControlName="apdate" [disabled]="disabledate" id="create-ecf-0020">
                                        <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                                        <mat-datepicker #picker1></mat-datepicker>
                                    </mat-form-field>
                                </td> -->
        <!-- <td> -->

        <!-- <mat-label style="margin-left: 50px">Choose Branch</mat-label><br> -->
        <!-- <mat-form-field style="width: 200px;" (click)="getheaderbranch()" appearance="outline">
                                    <mat-label>Branch</mat-label>
                                        <input #branchInput matInput formControlName="branch"
                                            [matAutocomplete]="branchtyperole" readonly matTooltip="{{this.branchrole}}"  matTooltipClass="custom-tooltipnew"
                                             (focus)="onFocus($event,'branch')" id="create-ecf-0021"> -->
        <!-- <mat-icon matSuffix class="maticonsize">unfold_more</mat-icon> -->
        <!-- <mat-autocomplete [panelWidth]="250" #branchtyperole="matAutocomplete"
                                            [displayWith]="displayFnbranchrole" (opened)="branchroleScroll()">
                                            <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                            <ng-container *ngIf="!isLoading">
                                                <mat-option *ngFor="let branch of Branchlist" [value]="branch"
                                                    matTooltip="{{branch.code}}-{{branch.name}}"  matTooltipClass="custom-tooltipnew">
                                                    {{branch.code}}-{{branch.name}}
                                                </mat-option>
                                            </ng-container>
                                        </mat-autocomplete>
                                    </mat-form-field> -->
        <!-- (click)="branchtest(branch)" -->
        <!-- </td> -->
        <!-- <td *ngIf="ecfheaderForm?.value?.branch?.name == 'PRECIOUS METALS DIVISION' || ecfheaderForm?.value?.branch ==  this.branchroleid ">
                                    
                                    <mat-form-field style="width: 200px;margin-left: 50px; " (click)="getlocation()">

                                        <input #locationInput matInput formControlName="location"
                                            [matAutocomplete]="loctype" 
                                            [readonly]="readecfdata == true" placeholder="Choose Location" (focus)="onFocus($event,'location') id="create-ecf-0022">
                                        <mat-autocomplete [panelWidth]="400" #loctype="matAutocomplete"
                                            [displayWith]="displayFnlocation" (opened)="locationScroll()">
                                            <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                            <ng-container *ngIf="!isLoading">
                                                <mat-option *ngFor="let loc of Locationlist" [value]="loc" 
                                                    matTooltip="{{loc.location}}"  matTooltipClass="custom-tooltipnew">
                                                    {{loc.location}}
                                                </mat-option>
                                            </ng-container>
                                        </mat-autocomplete>
                                    </mat-form-field>


                                </td> -->
        <!-- <td>
                                    <mat-form-field style="margin-left: 50px;width:200px">
                                        <mat-select placeholder="Is Original Document" formControlName="is_originalinvoice"
                                            [disabled]="readecfdata != false" required (focus)="onFocus($event,'orginv')" id="create-ecf-0023">
                                            <mat-option *ngFor="let inv of invoiceyesno" [value]="inv.value"
                                                >
                                                {{inv.display}}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>

                                </td> -->
        <!-- <td *ngIf="showadvance && showadvforemployee">  
                                    <lib-vs-optiondd-cmp  [InputFields]="ecf_advance_field" [formGroup]="ecfheaderForm"
                                    ></lib-vs-optiondd-cmp>  -->
        <!-- <mat-form-field style="width:200px;margin-left: 50px" appearance="outline">
                                        <mat-label>Advance Type</mat-label>
                                        <mat-select  formControlName="advancetype" required 
                                            [disabled]="readecfdata != false"  matTooltip="{{this.advemployeelist}}"  matTooltipClass="custom-tooltipnew" id="create-ecf-0024">
                                            <mat-option *ngFor="let advtype of advancetypeList"
                                                [value]="advtype.id">
                                                {{advtype.text}}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field> -->
        <!-- </td>
                                <td *ngIf="showadvance && showadvforsupplier">
                                    <lib-vs-dynamicform-cmp  [InputFields]="ecf_advance_field" [formGroup]="ecfheaderForm"
                                    ></lib-vs-dynamicform-cmp>
                                    <mat-form-field style="width:200px;margin-left: 50px" [matTooltip]="selectedAdvanceType" matTooltipClass="custom-tooltipnew" appearance="outline">
                                        <mat-label>Advance Type</mat-label>
                                        <mat-select  formControlName="advancetype" required 
                                            [disabled]="readecfdata != false"  (selectionChange)="onSelectionChange($event)" id="create-ecf-0025">
                                            <mat-option *ngFor="let advtype of advancefilterlist"
                                                [value]="advtype.id"  matTooltip="{{advtype.text}}"  matTooltipClass="custom-tooltipnew">
                                               {{advtype.text}}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </td> -->

        <!-- <td>

                                    <mat-label style="margin-left: 50px;">Client Name</mat-label><label
                                        style="color: red;">*</label><br>
                                    <mat-form-field class="matformfieldstyle" style="width: 200px;margin-left:50px "
                                        appearance="outline" (click)="getclientdd()">

                                        <input #clientInput class="matformfieldinputstyle" matInput
                                            formControlName="client_code" [matAutocomplete]="clientrole"
                                            placeholder="Select Client" required [readonly]="readecfdata == true" id="create-ecf-0026">
                                        <mat-icon matSuffix class="maticonsize">unfold_more</mat-icon>
                                        <mat-autocomplete [panelWidth]="400" #clientrole="matAutocomplete"
                                            [displayWith]="displayFnclient" (opened)="clientScroll()">
                                            <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                            <ng-container *ngIf="!isLoading">
                                                <mat-option *ngFor="let code of clientlist" [value]="code" matTooltip="{{code.client_name}}">
                                                    {{code.client_name}}
                                                </mat-option>
                                            </ng-container>
                                        </mat-autocomplete>
                                    </mat-form-field>


                                </td> -->
        <!-- *ngIf="showrmforcreate" -->
        <!-- <td>

                                    <mat-label style="margin-left: 50px;">RM Name</mat-label><label
                                        style="color: red;">*</label><br>
                                    <mat-form-field class="matformfieldstyle" style="width: 200px;margin-left:50px "
                                        appearance="outline" (click)="getrmdd()">

                                        <input #rmInput class="matformfieldinputstyle" matInput
                                            formControlName="rmcode" [matAutocomplete]="rmrole"
                                            placeholder="Select RM" required [readonly]="readecfdata == true" id="create-ecf-0027">
                                        <mat-icon matSuffix class="maticonsize">unfold_more</mat-icon>
                                        <mat-autocomplete [panelWidth]="400" #rmrole="matAutocomplete" [displayWith]="displayFnrm"
                                            (opened)="rmScroll()">
                                            <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                            <ng-container *ngIf="!isLoading">
                                                <mat-option *ngFor="let rmname of rmlist" [value]="rmname" matTooltip=" {{rmname.full_name}}">
                                                    {{rmname.full_name}}
                                                </mat-option>
                                            </ng-container>
                                        </mat-autocomplete>
                                    </mat-form-field>


                                </td> -->

        <!-- <td *ngIf="showrmforedit">

                                    <mat-label style="margin-left: 50px;">RM Name</mat-label><label style="color:red">*</label><br>

                                    <mat-form-field class="matformfieldstyle"
                                    style="width: 200px;margin-left: 50px;" appearance="outline">
                                    <input type="text" matInput formControlName="rmcode" autocomplete="off"
                                        class="matformfieldinputstyle" (click)="showrm()" [readonly]="readecfdata == true" id="create-ecf-0028">
                                    </mat-form-field> -->

        <!-- <mat-form-field class="matformfieldstyle" style="width: 200px;margin-left:50px "
                                        appearance="outline">

                                        <input #rmInput class="matformfieldinputstyle" matInput
                                            formControlName="rmcode" [matAutocomplete]="rmrole"
                                            placeholder="Select RM" required id="create-ecf-0029">
                                        <mat-icon matSuffix class="maticonsize">unfold_more</mat-icon>
                                        <mat-autocomplete #rmrole="matAutocomplete" [displayWith]="displayFnrmedit"
                                            (opened)="rmScroll()">
                                            <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                            <ng-container *ngIf="!isLoading">
                                                <mat-option *ngFor="let rmname of rmlist" [value]="rmname"
                                                    (click)="showrm()">
                                                    {{rmname.name}}
                                                </mat-option>
                                            </ng-container>
                                        </mat-autocomplete>
                                    </mat-form-field> -->


        <!-- </td> -->
        <!-- </tr> -->
        <!-- <tr *ngIf="showadvance">
                                <td>

                                    <mat-label>PPX No</mat-label><br>
                                    <mat-form-field class="matformfieldstyle" style="width: 200px;"
                                        appearance="outline">
                                        <input type="text" matInput placeholder="Select PPX Po Number"
                                            formControlName="ppxno" autocomplete="off"
                                            class="matformfieldinputstyle" [readonly]="readecfdata == true" id="create-ecf-0030">
                                    </mat-form-field>

                                </td>
                              
                            </tr> -->
        <!-- <tr>
                                <td *ngIf="ecfheaderForm.value.aptype != 7 && ecfheaderForm.value.aptype != 13"> -->

        <!-- <mat-label>ECF Amount<label style="color:red">*</label></mat-label><br> -->
        <!-- <mat-form-field style="width: 200px;" appearance="outline">
                                        <mat-label>ECF Amount</mat-label>
                                        <input type="text" matInput formControlName="apamount" 
                                            autocomplete="off" style="text-align:right"
                                            (keypress)="getCharCode($event);numberOnlyandDot($event, ecfheaderForm.value.apamount)" (input)="ecfhdrchangeToCurrency(apamount ,'apamount')" 
                                           (focus)="onFocus($event,'ecfamount')"  #apamount (change)="ecfamtDecimalChg()"
                                            [readonly]="this.ecfheaderidd != '' && this.ecfheaderidd != undefined && this.ecfheaderidd != null" required id="create-ecf-0031">
                                    </mat-form-field> -->
        <!--  (input)="changeToCurrency(ecfamt,'ecfamt',0)" #ecfamt -->
        <!--  getCharCode($event)-->
        <!--  -->
        <!-- appNumberwithcommas -->

        <!-- </td>
                                <td *ngIf="ecfheaderForm.value.aptype == 7">


                                    <mat-label>CRN Amount<label style="color:red">*</label></mat-label><br> -->
        <!-- <mat-form-field style="width: 200px;" appearance="outline">
                                        <mat-label>CRN Amount</mat-label>
                                        <input type="text" matInput formControlName="apamount" style="text-align:right" autocomplete="off"   
                                            (keypress)="getCharCode($event);numberOnlyandDot($event, ecfheaderForm.value.apamount)" (input)="ecfhdrchangeToCurrency(apamount ,'apamount')" 
                                            (focus)="onFocus($event,'ecfamount')" #apamount (change)="ecfamtDecimalChg()"
                                            [readonly]="readecfdata == true" required id="create-ecf-0032">
                                    </mat-form-field>
                                </td> -->

        <!-- <td *ngIf="ecfheaderForm.value.aptype == 13">
                                <mat-form-field style="width: 200px;" appearance="outline">
                                    <mat-label>ECF Amount</mat-label>
                                    <input type="text" matInput formControlName="apamount"  style="text-align:right"
                                        placeholder="ECF Amount" autocomplete="off"  (focus)="onFocus($event,'ecfamount')" maxlength="7"
                                        (keypress)="getCharCode($event);numberOnlyandDot($event, ecfheaderForm.value.apamount)" (input)="ecfhdrchangeToCurrency(apamount ,'apamount')" 
                                         (ngModelChange)="pettyamount($event)" #apamount (change)="ecfamtDecimalChg()"
                                        [readonly]="readecfdata == true" required id="create-ecf-0033">
                                </mat-form-field>
                            </td>
                                <td>
                                    <!-- <mat-label style="margin-left: 50px;">Purpose</mat-label><br> -->
        <!-- <mat-form-field style="width: 200px;margin-left: 50px;" appearance="outline">
                                        <input type="text" matInput formControlName="remark" placeholder="Remarks"
                                            autocomplete="off" (change)="filterText(remark, 'remark')" #remark   maxlength="60" 
                                            [matTooltip]="ecfheaderForm.value.remark" matTooltipClass="custom-tooltipnew"
                                            [readonly]="readecfdata == true" (focus)="onFocus($event,'remarks')" id="create-ecf-0034">
                                    </mat-form-field>

                                    &nbsp;
                                </td>   
                                <td>  -->
        <!-- <label style="margin-left: 50px;">Add Notes</label>
                                      <span class="material-icons" type="button" data-toggle="modal"
                                        data-target=".bd-example-modal-xl" matTooltip="Add Notes">description</span> -->

        <!-- <h3 data-toggle="modal" data-target=".bd-example-modal-xl"
                                        style="cursor: pointer;color:black;font-family: 'Montserrat';margin-bottom: -2%;margin-left: 40px;font-weight: bold;"
                                        class="btn btn-link">Add Notes<label style="color:red
                                        ">*</label></h3> -->



        <!-- <button *ngIf="ecfheaderForm.value.ecftype != 3 || this.hrFlag == false" type="submit" style="border-radius:10px;margin-bottom:-65px;margin-left:35px;
                            border-color: #f5c68b;
                            background-color: #f5c68b;" (click)="SubmitForm()" [disabled]="disableecfsave"
                                    class="btn btn-light" id="create-ecf-0035">Save</button> -->

        <!-- <button  type="submit"
                                        style="border-radius:40px;margin-left:40px;"
                                        class="btn btn-outline-primary" (click)="SubmitForm()"
                                        [disabled]="disableecfsave" id="create-ecf-0036">
                                        Save</button>
                                </td>
                                <td > -->

        <!-- <button type="button" class="btn btn-light" style="border-radius:7px;margin-left:15px;margin-bottom: -65px;
                              border-color: black; 
                              background-color: white;" (click)="ecfreset()"
                                    [disabled]="disableecfsave" id="create-ecf-0037">Reset</button>&nbsp;&nbsp;&nbsp; -->

        <!-- <button  *ngIf="ecfheaderForm.value.aptype != 3 || this.hrFlag == false" type="button"
                                        style="border-radius:40px;margin-left:5px;"
                                        class="btn btn-outline-primary" (click)="ecfreset()"
                                        [disabled]="disableecfsave" id="create-ecf-0038">
                                        Reset</button> -->

        <!-- <button type="button"
                                        style="border-radius:40px;margin-left:5px;"
                                        class="btn btn-outline-primary" (click)="backform()" id="create-ecf-0039">
                                        Back</button>&nbsp;&nbsp;&nbsp; -->

        <!-- <button *ngIf="showviewinvoice" mat-fab
                                    style="background-color: #f5c68b; bottom: -30px"
                                    (click)="viewinvheader()" id="create-ecf-0040">
                                    <mat-icon matTooltip="View Invoice Header">add</mat-icon>
                                </button> -->

        <!-- <button *ngIf="showviewinvoice && (ecfheaderForm.value.aptype != 3 || this.hrFlag == false)" type="button" class="btn btn-outline-success"
                                        matTooltip="View Invoice Header" style="border-radius:40px;margin-left:0px;"
                                        (click)="viewinvheader()" id="create-ecf-0041">&nbsp;&nbsp;View Invoice Header</button>

                                    <button *ngIf="showviewinvoices && (ecfheaderForm.value.aptype != 3 || this.hrFlag == false)" type="button" class="btn btn-outline-success"
                                        matTooltip="View Invoice Header" style="border-radius:40px;margin-left:0px;"
                                        (click)="viewinvheader()" id="create-ecf-0042">&nbsp;&nbsp;View Invoice Header</button> -->


        <!-- <button *ngIf="showviewinvoices" mat-fab
                                    style="background-color: #f5c68b;bottom: -30px;"
                                    (click)="viewinvheaders()" id="create-ecf-0043">
                                    <mat-icon matTooltip="View Invoice Header">add</mat-icon>
                                </button>
                                </td> -->


        <!-- -------notepad------ -->


        <!-- </tr> -->
        <!-- 
                            <tr *ngIf="ecfheaderForm.value.aptype == 3 && this.hrFlag == true ">
                                <td>
                                    <mat-label>Behalf of Self</mat-label><br>
                                    <mat-radio-group formControlName="is_raisedby_self">
                                        <mat-radio-button *ngFor="let n of behalfyesorno" [value]="n.value"
                                            style="margin-left: 10px;" (click)="getBehalf(n)"
                                            [class.disabled]="readecfdata == true">
                                            {{n.display}}
                                        </mat-radio-button>
                                    </mat-radio-group>
                                </td>
                                <td *ngIf="ecfheaderForm.value.is_raisedby_self == false">
                                    <mat-form-field style="width: 200px;margin-left:50px " (click)="getbehalfemp()">

                                        <input #behalfInput matInput formControlName="raised_by"
                                            [matAutocomplete]="behalfEmp" placeholder="Select Employee"
                                            [readonly]="readecfdata == true" id="create-ecf-0046">
                                        <mat-autocomplete [panelWidth]="400" #behalfEmp="matAutocomplete"
                                            [displayWith]="displayFnEmp" (opened)="behalfEmpScroll()">
                                            <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                            <ng-container *ngIf="!isLoading">
                                                <mat-option *ngFor="let name of emplist" [value]="name"
                                                    matTooltip=" {{name.name}}" matTooltipClass="custom-tooltipnew">
                                                    {{name.name}}
                                                </mat-option>
                                            </ng-container>
                                        </mat-autocomplete>
                                    </mat-form-field>


                                </td>

                                <td>

                                    <button type="submit"
                                        style="border-radius:40px;margin-left:40px;"
                                        class="btn btn-outline-primary" (click)="SubmitForm()"
                                        [disabled]="disableecfsave" id="create-ecf-0047">
                                        Save</button>
                                        <button   type="button"
                                        style="border-radius:40px;margin-left:5px;"
                                        class="btn btn-outline-primary" (click)="backform()" id="create-ecf-0048">
                                        Back</button>&nbsp;&nbsp;&nbsp;
                                </td>
                            </tr> -->

        <!-- </div>
                    </table> -->

        <div class="modal fade bd-example-modal-xl" tabindex="-1" role="dialog" data-keyboard="false"
            data-backdrop="static" aria-labelledby="myExtraLargeModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 id="create-ecf-0001">
                            Note Pad
                        </h3>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"
                            id="create-ecf-0044">
                            <span aria-hidden="true">&times;</span>
                        </button>
                        <!-- <button type="button" style="border-radius:40px;margin-left: 980px; border-color: black; 
                                    background-color: white;color:black" class="btn btn-light"
                                        data-dismiss="modal" id="create-ecf-0044">
                                        X</button> -->

                    </div>
                    <br>
                    <div style="margin-left: 50px;width:90%;height: 70%;">
                        <div>

                            <div [ngxSummernote]="config" [ngxSummernoteDisabled]="editorDisabled" (blur)="onBlur()"
                                (mediaDelete)="onDelete($event)" (summernoteInit)="summernoteInit($event)"
                                formControlName="notename">
                            </div>

                        </div>
                    </div>
                    <br>
                    <div class="modal-footer">


                        <!-- <button type="button" style="border-radius:40px;margin-left: 10px; border-color: blue; 
                                background-color: white;color:blue" class="btn btn-light"
                                    data-dismiss="modal" id="create-ecf-0045">
                                    Submit</button> -->

                        <button type="button" style="border-radius: 40px" class="btn btn-outline-success"
                            data-dismiss="modal" id="create-ecf-0045">
                            Submit
                        </button>

                    </div>
                </div>
            </div>
        </div>
    </form>


    <!-- --------------------Invoice Header Begins --------------------- -->
    <div *ngIf="showeditinvhdrform">
        <h3 *ngIf="this.ecftypeid != 7">Invoice Header
            <!-- <button mat-icon-button matTooltip="From Template" matTooltipClass="custom-tooltipnew" class="iconbutton"
                color="primary" style="margin-top: 10px; margin-left: 20px;" [disabled]="this.InvoiceHeader.length >0"
                (click)="getTemplates()" *ngIf="this.server_environment != 'PROD' && ecftypeid != 4"
                id="create-ecf-0144">
                <i class="fa fa-clone" aria-hidden="true" style="font-size: 24px;font-weight:bolder;"> -->
                    <!-- data-toggle="modal" data-target="#create-ecf-0152"  -->
                    <!-- data-toggle="modal" data-target="#create-ecf-0152"  -->
                <!-- </i>
            </button> -->
        </h3>

        <h3 *ngIf="this.ecftypeid == 7" style="margin-bottom: 7px">Credit Note Header
            <button mat-icon-button matTooltip="From Template" matTooltipClass="custom-tooltipnew" class="iconbutton"
                color="primary" style="margin-top: 10px; margin-left: 20px" [disabled]="this.InvoiceHeader.length >0"
                (click)="getTemplates()" *ngIf="this.server_environment == 'PROD'" id="create-ecf-0145">
                <i class="fa fa-clone" aria-hidden="true" style="font-size: 20px;font-weight:bolder;">
                    <!-- data-toggle="modal" data-target="#create-ecf-0152" -->
                    <!-- data-toggle="modal" data-target="#create-ecf-0152" -->
                </i>
            </button>
        </h3>
        <!-- <button *ngIf="this.ecftypeid != 7" type="button" class="btn btn-outline-success" 
                matTooltip="Add Invoice Header" matTooltipClass="custom-tooltipnew" style="border-radius:40px;margin-left:170px;margin-top: -80px;" data-toggle="modal" data-target="#ecfpaydetails"
                (click)="addSection()" id="create-ecf-0049"><span class="fa fa-plus"></span>&nbsp;&nbsp;Invoice Header</button>
                <button *ngIf="this.ecftypeid == 7" type="button" class="btn btn-outline-success" 
                matTooltip="Add Invoice Header" matTooltipClass="custom-tooltipnew" style="border-radius:40px;margin-left:190px;margin-top: -80px;" data-toggle="modal" data-target="#ecfpaydetails"
                (click)="addSection()" id="create-ecf-0050"><span class="fa fa-plus"></span>&nbsp;&nbsp;Invoice Header</button> -->

        <div>
            <form [formGroup]="InvoiceHeaderForm" autocomplete="off">
                <!-- <table>

                            <div>
                                <tr> -->
                <!-- <td *ngIf="this.ecfheaderForm?.value?.aptype == 2 || this.ecfheaderForm?.value?.aptype == 7 ||this.ecfheaderForm?.value?.aptype == 3||this.ecfheaderForm?.value?.aptype == 13|| this.ecfheaderForm?.value?.aptype == 14">
                                        <div style="margin-left: 5px;">
                                            <mat-label>GST Applicable <label style="color:red">*</label></mat-label>

                                            <mat-radio-group formControlName="invoicegst">
                                                <mat-radio-button *ngFor="let n of yesorno" [value]="n.value"
                                                    style="margin-left: 10px;" (click)="GSTstatus(n)"
                                                    [disabled]="showgstapply">

                                                    {{n.display}}
                                                </mat-radio-button>
                                            </mat-radio-group>
                                        </div> -->

                <!-- <div style="margin-left: 5px;" *ngIf="this.ecfheaderForm?.value?.ecftype == 13">
                                            <mat-label>GST Applicable</mat-label>

                                            <mat-radio-group formControlName="invoicegst">
                                                <mat-radio-button *ngFor="let n of yesorno" [value]="n.value"
                                                    style="margin-left: 10px;" (click)="GSTstatus(n)"
                                                    [disabled]="showgstapply">

                                                    {{n.display}}
                                                </mat-radio-button>
                                            </mat-radio-group>
                                        </div> -->

                <!-- </td> -->
                <!-- <td>

                                        
                                    
                                        <span (click)="addSection()" style="margin-left: 20px;">
                                            <mat-icon matTooltip="Add Invoice Header">add_circle_outline</mat-icon>
                                        </span>
                                        
                                    </td>
                                </tr>
                            </div>
                        </table> -->

                <div class="table-responsive">
                    <div class="comp-table t-resposive t-bdr-line t-HoverZoom" id="summary-table">
                    <table>
                        <thead>
                            <tr>


                                <!-- <div class="card" style="margin-bottom: 3%;margin-right: 20px;margin-left: 10px;">
                                            <div class="card-body">
                                        <div class="tableFixHead">
                                            <table class="table table-bordered  table-sm">
                                                <thead style='font-family:"Times New Roman"'>
                                    <tr  class="table_header" fixed-header> -->
                                <th>
                                    S.No</th>
                                <th>GST Applicable<label style="color:red">*</label></th>
                                <th *ngIf="show_suppdetails">Supplier Name<label style="color:red">*</label></th>
                                <th *ngIf="show_suppdetails">Supplier GST</th>
                                <th *ngIf="show_suppdetails ">State</th>
                                <!-- <th>Place Of Supply</th> -->
                                <th>Branch<label style="color:red">*</label></th>
                                <th *ngIf="this.PMDbranchdata.length >0">Is PMD<label style="color:red">*</label></th>
                                <th *ngIf="PMDyesno =='Y'">PMD Location<label style="color:red">*</label></th>
                                <th
                                    *ngIf="this.ecfheaderForm?.value?.aptype != 3 && this.ecfheaderForm?.value?.aptype != 13 && this.ecfheaderForm?.value?.aptype != 14">
                                    Invoice No<label style="color:red">*</label>
                                </th>
                                <th *ngIf="this.ecfheaderForm?.value?.aptype == 14">Acc No<label
                                        style="color:red">*</label></th>
                                <th *ngIf="this.ecftypeid == 7">Credit Ref No<label style="color:red">*</label>
                                <th *ngIf="this.ecftypeid == 7">Invoice CR No<label style="color:red">*</label>
                                </th>
                                <th
                                    *ngIf="this.ecfheaderForm?.value?.aptype != 3 && this.ecfheaderForm?.value?.aptype != 13 && this.ecfheaderForm?.value?.aptype != 14">
                                    Invoice Date<label style="color:red">*</label>
                                </th>
                                <th *ngIf="this.ecfheaderForm?.value?.aptype == 14">Date of Transaction<label
                                        style="color:red">*</label></th>
                                <th *ngIf="this.ecftypeid == 2">Is PCA<label style="color:red">*</label></th>
                                <th *ngIf="PCAyesno == 1">PCA No.<label style="color:red">*</label></th>
                                <th *ngIf="this.ecftypeid == 7">CRN Total Amount<label style="color:red">*</label></th>
                                <th *ngIf="this.ecftypeid != 7">Invoice Amount<label style="color:red">*</label></th>
                                <!-- <th *ngIf="this.ecftypeid == 14"></th> -->
                                <th *ngIf="this.ecftypeid != 14">Taxable Amount<label style="color:red">*</label></th>
                                <!-- <th
                                            *ngIf="((this.ecftypeid == 2 || this.ecftypeid == 7 ||   this.ecftypeid == 14 || this.ecftypeid == 3 ) && (showtaxforgst == true))">
                                            Tax Amount<label style="color:red">*</label></th>
                                        <th
                                            *ngIf="((this.ecftypeid == 2 || this.ecftypeid == 7 ||  this.ecftypeid == 14 || this.ecftypeid == 3 ) && (showtaxforgst == false))">
                                            Tax Amount
                                        </th> -->
                                <!-- <th>Round Off</th>
                                        <th>Other Adjustment</th> -->

                                <th>Purpose<label style="color:red">*</label></th>
                                <th>Is Recurring<label style="color:red">*</label></th>
                                <th>Recurring Type<label style="color:red">*</label></th>
                                <th *ngIf="showRecurDates && showRecurMonth == true">Recurring Month<label
                                        style="color:red">*</label></th>
                                <th *ngIf="showRecurDates && showRecurMonth == false">Recurring From<label
                                        style="color:red">*</label></th>
                                <th *ngIf="showRecurDates && showRecurMonth == false">Recurring To<label
                                        style="color:red">*</label></th>
                                <th>Invoice Status</th>
                                <th>Upload File<label style="color:red">*</label></th>
                                <!-- <th *ngIf="ecftypeid == 2">Is Capitalized</th> --> 
                                <th>Action</th>
                                <!-- <th *ngIf="invoicestatus == 'INVOICE COMPLETED' || invoicestatus == 'INVOICE APPROVED' 
                                        || invoicestatus == 'PENDING IN ECF APPROVAL' ">Create Template</th> -->
                                <th *ngIf="this.ecftypeid !=4 && this.ecftypeid !=7">View
                                </th>
                                <th *ngIf="this.ecftypeid ==4 ">View Debit Detail</th>
                                <th *ngIf="this.ecftypeid ==7 ">View CRN Detail</th>
                            </tr>
                        </thead>

                        <ng-container formArrayName="invoiceheader"
                            *ngFor="let section of getSections(InvoiceHeaderForm); let i = index">
                            <tr [formGroupName]="i">
                                <td style="text-align: center; vertical-align: middle;">
                                    {{i+1}}</td>
                                <td id="matInput-size">
                                    <mat-form-field appearance="outline">
                                        <mat-select placeholder="GST Applicable" formControlName="invoicegst"
                                            [disabled]="this.ppxid =='S' || this.ppxid =='E' || this.paytoid =='E' || this.ecftypeid == 14"
                                            required id="create-ecf-0051">
                                            <mat-option *ngFor="let gst of yesorno" [value]="gst.value"
                                                (click)="GSTstatus(gst,i);">
                                                {{gst.display}}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>

                                </td>

                                <!-- <td *ngIf="this.ecfheaderForm?.value?.aptype == 3">
                                            <mat-form-field style="width:150px;">
                                                <input matInput placeholder="Supplier GST" formControlName="manual_gstno"  autocomplete="off"
                                                maxlength="15"  [ngModel]="this.InvoiceHeaderForm.value.invoiceheader[i].manual_gstno" required (click)="getheaderedit(i)" [readonly]="this.InvoiceHeaderForm.value.invoiceheader[i].invoicegst == '' || this.InvoiceHeaderForm.value.invoiceheader[i].invoicegst =='N'"
                                                    (ngModelChange)="this.InvoiceHeaderForm.value.invoiceheader[i].manual_gstno = $event.toUpperCase()" (keydown.space)="$event.preventDefault();"  (input)="validationGstNo($event,i)" id="create-ecf-0052">
                                            </mat-form-field>
                                        </td>
                                        <td *ngIf="this.ecfheaderForm?.value?.aptype == 3">
                                            <mat-form-field style="width:150px;">
                                                <input matInput placeholder="Supplier Name" readonly
                                                    formControlName="manualsupp_name"  autocomplete="off"  id="create-ecf-0053">
                                            </mat-form-field>
                                        </td> -->

                                <!-- <div *ngIf="showsupppopup"> -->
                                <td id="matInput-size" *ngIf="show_suppdetails">
                                    <!-- <table style="border-collapse: collapse;">
                                                <tbody style="border: none;"> -->
                            <!-- <tr> -->
                                <div style="display:flex">
                                <div style="margin-top:5px;">
                                    <button type="button" class="btn btn-outline-primary" matTooltip="Select Supplier"
                                        matTooltipClass="custom-tooltipnew" (click)="getsuppindex(i);"
                                        [disabled]="SupplierTypeID == 1 && i != 0"
                                        style="border-radius:40px;" id="create-ecf-0054"><i
                                            class="fa fa-arrow-up"></i>
                                        <!-- data-toggle="modal" data-target="#create-ecf-0003" -->
                                    </button>
                                </div>
                                <div style="margin-left:10px;">
                                    <mat-form-field  appearance="outline">

                                        <input matInput placeholder="Supplier Name" formControlName="suppname" readonly
                                            class="nowrap" autocomplete="off" id="create-ecf-0055">

                                    </mat-form-field>
                                </div>
                                </div>
                            <!-- </tr> -->
                            <!-- </tbody>
                                            </table> -->

                            </td>
                            <!-- </div> -->
                            <!-- <div *ngIf="showsuppdropdown">
                                <td>

                                    <mat-form-field
                                        style="width:180px;font-family: 'Times New Roman', Times, serif;">

                                        <mat-label>Supplier Namesssssssss</mat-label>
                                        <input #suppInput placeholder="Supplier Name" matInput
                                            formControlName="suppname" [matAutocomplete]="Suppliertype" id="create-ecf-0056">
                                        <mat-autocomplete #Suppliertype="matAutocomplete" [displayWith]="displayFn"
                                            (opened)="supplierScroll()">
                                            <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                            </mat-option>
                                            <ng-container *ngIf="!isLoading">
                                                <mat-option *ngFor="let suppliername of getsuplist"
                                                    [value]="suppliername">

                                                    {{suppliername.name}}
                                                </mat-option>
                                            </ng-container>
                                        </mat-autocomplete>
                                    </mat-form-field>

                                </td>
                            </div> -->
                            <td id="matInput-size" *ngIf="show_suppdetails">
                                <mat-form-field appearance="outline">
                                    <input matInput placeholder="Supplier GST" formControlName="suppliergst" readonly
                                        autocomplete="off" id="create-ecf-0057">
                                </mat-form-field>
                            </td>
                            <td id="matInput-size" *ngIf="show_suppdetails">
                                <mat-form-field appearance="outline">
                                    <input matInput placeholder="State" formControlName="suppstate"
                                        placeholder="Supplier State" readonly autocomplete="off" id="create-ecf-0058">
                                </mat-form-field>
                            </td>
                            <!-- <td>
                                            <mat-form-field style="width: 200px;" (click)="getposbranch()">
                                                <mat-label>Place Of Supply</mat-label>
                                                <input #posInput  placeholder="Place of Supply" matInput 
                                                formControlName="place_of_supply" [matAutocomplete]="pos" readonly id="create-ecf-0059">
                                                <mat-autocomplete [panelWidth]="400" #pos="matAutocomplete" (opened)="posScroll()"
                                                [displayWith]="displayFnplace">
                                                <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                                <ng-container *ngIf="!isLoading">
                                                <mat-option *ngFor="let pos of poslist" matTooltip="{{pos.code}}-{{pos.name}}"
                                                [value]="pos"> {{pos.code}}-{{pos.name}}
                                            </mat-option>
                                        </ng-container>
                                            </mat-autocomplete>
                                            </mat-form-field>
                                        </td> -->

                            <td id="matInput-size">
                                <mat-form-field (click)="getbranchdropdown()" appearance="outline">
                                    <input #invbranchInput matInput formControlName="branchdetails_id"
                                        [matAutocomplete]="branchAutocomplete"
                                        [readonly]="readinvhdrdata == true || this.roledata == false"
                                        placeholder="Branch" (focus)="onFocus($event,'branch')" id="create-ecf-0060">
                                    <!-- <mat-icon matSuffix class="maticonsize">unfold_more</mat-icon> -->
                                    <mat-autocomplete [panelWidth]="400" #branchAutocomplete="matAutocomplete"
                                        [displayWith]="displayFninvbranch" (opened)="branchinvScroll()">
                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                        <ng-container *ngIf="!isLoading">
                                            <mat-option *ngFor="let branch of Branchlist" [value]="branch"
                                                (onSelectionChange)="onBranchChange(branch)"
                                                matTooltip="{{branch.code}}-{{branch.name}}"
                                                matTooltipClass="custom-tooltipnew">
                                                {{branch.code}} - {{branch.name}}
                                            </mat-option>
                                        </ng-container>
                                    </mat-autocomplete>
                                </mat-form-field>
                            </td>
                            <td id="matInput-size" *ngIf="PMDbranchdata.length >0">
                                <mat-form-field appearance="outline">
                                    <mat-select placeholder="Is PMD" formControlName="is_pmd" required
                                        id="create-ecf-0061">
                                        <mat-option *ngFor="let opt of yesorno" [value]="opt.value"
                                            [disabled]="readinvhdrdata == true" (click)="setPMD(opt);">
                                            {{opt.display}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </td>
                            <td id="matInput-size" *ngIf="PMDyesno =='Y'">
                                <mat-form-field appearance="outline">
                                    <input #pmdlocationInput matInput formControlName="pmdlocation_id"
                                        [matAutocomplete]="pmdlocationAutocomplete" [readonly]="readinvhdrdata == true"
                                        placeholder="PMD Location" id="create-ecf-0062">
                                    <mat-autocomplete [panelWidth]="150" #pmdlocationAutocomplete="matAutocomplete"
                                        [displayWith]="displayFnPmdLoc" (opened)="pmdLocatonScroll()">
                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                        <ng-container *ngIf="!isLoading">
                                            <mat-option *ngFor="let loc of PMDLocationlist" [value]="loc"
                                                matTooltip="{{loc.location}}" matTooltipClass="custom-tooltipnew">
                                                {{loc.location}}
                                            </mat-option>
                                        </ng-container>
                                    </mat-autocomplete>
                                </mat-form-field>
                            </td>
                            <td id="matInput-size"
                                *ngIf="this.ecfheaderForm?.value?.aptype != 3 && this.ecfheaderForm?.value?.aptype != 13 && this.ecfheaderForm?.value?.aptype != 14">
                                <mat-form-field appearance="outline">
                                    <input matInput placeholder="Invoice No" formControlName="invoiceno"
                                        autocomplete="off" maxlength="28"
                                        matTooltip="{{this.InvoiceHeaderForm.value.invoiceheader[i].invoiceno}}"
                                        matTooltipClass="custom-tooltipnew"
                                        #invoiceno (keypress)="invNoFilter($event);"
                                        [readonly]="readinvhdrdata == true || this.InvoiceHeaderForm.value.invoiceheader[i].invoicegst == '' "
                                        id="create-ecf-0063">
                                </mat-form-field>
                            </td>
                            <td id="matInput-size" *ngIf="this.ecfheaderForm?.value?.aptype == 14">
                                <mat-form-field appearance="outline">
                                    <input matInput placeholder="Acc No" formControlName="invoiceno" autocomplete="off"
                                        maxlength="16"
                                        matTooltip="{{this.InvoiceHeaderForm.value.invoiceheader[i].invoiceno}}"
                                        matTooltipClass="custom-tooltipnew"
                                        (change)="filterTexts(invoiceno, 'invoiceno',i);icrAccno(i,section)" #invoiceno
                                        [readonly]="readinvhdrdata == true || this.InvoiceHeaderForm.value.invoiceheader[i].invoicegst == '' "
                                        id="create-ecf-0064">
                                </mat-form-field>
                            </td>

                            <td id="matInput-size" *ngIf="this.ecftypeid == 7">
                                <mat-form-field appearance="outline">
                                    <input matInput placeholder="Credit Ref No" formControlName="creditrefno"
                                        autocomplete="off" (change)="filterTexts(creditrefno, 'creditrefno',i)"
                                        #creditrefno
                                        [readonly]="readinvhdrdata == true || this.InvoiceHeaderForm.value.invoiceheader[i].invoicegst == ''"
                                        id="create-ecf-0065">
                                </mat-form-field>
                            </td>

                            <td id="matInput-size" *ngIf="this.ecftypeid == 7">
                                <mat-form-field appearance="outline">
                                    <input matInput placeholder="Invoice CR No" formControlName="refinv_crno"
                                        autocomplete="off" (change)="filterTextsunder(refinv_crno, 'refinv_crno',i)"
                                        #refinv_crno
                                        [readonly]="readinvhdrdata == true || this.InvoiceHeaderForm.value.invoiceheader[i].invoicegst == ''"
                                        id="create-ecf-0066">
                                </mat-form-field>
                            </td>
                            <!-- <td *ngIf="this.ecftypeid != 2 ">
                                            <mat-form-field style="width:110px;">
                                                <input matInput placeholder="Invoice No" formControlName="invoiceno"
                                                    (keypress)="characterandnumberonly($event)" autocomplete="off" id="create-ecf-0067">
                                            </mat-form-field>
                                        </td> -->
                            <td id="matInput-size"
                                *ngIf="this.ecfheaderForm?.value?.aptype != 3 && this.ecfheaderForm?.value?.aptype != 13">
                                <mat-form-field appearance="outline">
                                    <mat-label>Date</mat-label>
                                    <input matInput [matDatepicker]="picker1" placeholder="Date"
                                        (dateChange)="onDateChange($event)" formControlName="invoicedate"
                                        [max]="tomorrow" readonly id="create-ecf-0068">
                                    <!-- [readonly]="readinvhdrdata == true" -->
                                    <mat-datepicker-toggle matSuffix [for]="picker1">
                                    </mat-datepicker-toggle>
                                    <mat-datepicker #picker1></mat-datepicker>
                                </mat-form-field>
                            </td>
                            <td id="matInput-size" *ngIf="ecftypeid == 2">
                                <mat-form-field appearance="outline">
                                    <mat-select placeholder="Is PCA" formControlName="is_pca" required
                                        id="create-ecf-0069">
                                        <mat-option *ngFor="let opt of PCAYesorno" [value]="opt.value"
                                            [disabled]="readinvhdrdata == true" (click)="setPCA(opt);">
                                            {{opt.display}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </td>
                            <!-- <td  id="matInput-size" *ngIf="PCAyesno == 1">
                                           
                                                <mat-form-field appearance="outline" >
                                                    <input #pcaInput matInput formControlName="pca_no"
                                                        [matAutocomplete]="pcaAutocomplete" [readonly]="readinvhdrdata == true"
                                                        placeholder="PCA No." id="create-ecf-0070">
                                                    <mat-autocomplete [panelWidth]="150" #pcaAutocomplete="matAutocomplete"
                                                        [displayWith]="displayFnPCA" (opened)="PCAScroll()">
                                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                                        <ng-container *ngIf="!isLoading">
                                                            <mat-option *ngFor="let pca of PCAList" [value]="pca" (click)="PCAselected();"  (focusout)="PCAselected();"
                                                                matTooltip="{{pca.pca_no}} - {{pca.balance_amount}}" matTooltipClass="custom-tooltipnew" > 
                                                        {{pca.pca_no}}
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>
                                                </mat-form-field>&nbsp;
                                                <i class="fa fa-info-circle" style="font-size:24px;color:#0077ff;margin-top: 10px;" *ngIf="this.PCA_Det.length >0"
                                                matTooltip="{{PCA_Det[0]?.pca_no}} - {{PCA_Det[0]?.balance_amount}}" matTooltipClass="custom-tooltipnew" ></i>

                                           
                                        </td> -->
                            <td id="matInput-size" *ngIf="PCAyesno == 1">
                                <div style="display: flex; align-items: center;">
                                    <mat-form-field appearance="outline">
                                        <input #pcaInput matInput formControlName="pca_no"
                                            [matAutocomplete]="pcaAutocomplete" [readonly]="readinvhdrdata == true"
                                            placeholder="PCA No." id="create-ecf-0070">
                                        <mat-autocomplete [panelWidth]="150" #pcaAutocomplete="matAutocomplete"
                                            [displayWith]="displayFnPCA" (opened)="PCAScroll()">
                                            <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                            <ng-container *ngIf="!isLoading">
                                                <mat-option *ngFor="let pca of PCAList" [value]="pca"
                                                    (click)="PCAselected();" (focusout)="PCAselected();"
                                                    matTooltip="{{pca.pca_no}} - {{pca.balance_amount}}"
                                                    matTooltipClass="custom-tooltipnew">
                                                    {{pca.pca_no}}
                                                </mat-option>
                                            </ng-container>
                                        </mat-autocomplete>
                                    </mat-form-field>

                                    <i class="fa fa-info-circle"
                                        style="font-size:24px;color:#0077ff;margin-left:10px"
                                        *ngIf="this.PCA_Det.length > 0"
                                        matTooltip="{{PCA_Det[0]?.pca_no}} - {{PCA_Det[0]?.balance_amount}}"
                                        matTooltipClass="custom-tooltipnew"></i>
                                </div>
                            </td>

                            <td id="matInput-size">
                                <mat-form-field appearance="outline">
                                    <mat-label *ngIf="this.ecftypeid == 7">CRN Total Amount</mat-label>
                                    <mat-label *ngIf="this.ecftypeid != 7">Invoice Amount</mat-label>
                                    <input matInput style="text-align: right;" formControlName="totalamount"
                                        autocomplete="off"
                                        [readonly]="readinvhdrdata == true || this.InvoiceHeaderForm.value.invoiceheader[i].invoicegst == ''"
                                        (keypress)="getCharCode($event);numberOnlyandDot($event, this.InvoiceHeaderForm.value.invoiceheader[i].totalamount)"
                                        (input)="invhdrChangeToCurrency(totalamount ,'totalamount',i)"
                                        (click)="datasums();" #totalamount (focusout)="invamount(i,section)"
                                        id="create-ecf-0071" appCleardirective
                                        (change)="invhdramtDecimalChg(totalamount ,'totalamount',i)">
                                </mat-form-field>
                            </td>
                            <!-- <td *ngIf="this.ecftypeid == 14"></td> -->
                            <td id="matInput-size" *ngIf="this.ecftypeid != 14">
                                <mat-form-field appearance="outline">
                                    <mat-label>Amount </mat-label>
                                    <input matInput style="text-align:right" formControlName="invoiceamount"
                                        #invoiceamount (change)="invhdramtDecimalChg(invoiceamount ,'invoiceamount',i)"
                                        [readonly]="readinvhdrdata == true || this.InvoiceHeaderForm.value.invoiceheader[i].invoicegst == '' "
                                        autocomplete="off" appCleardirective
                                        (keypress)="getCharCode($event);numberOnlyandDot($event, this.InvoiceHeaderForm.value.invoiceheader[i].invoiceamount)"
                                        (input)="invhdrChangeToCurrency(invoiceamount ,'invoiceamount',i)"
                                        (ngModelChange)="taxableAmount($event,i,section)"
                                        (focusout)="taxableAmount1(i,section)" id="create-ecf-0072">
                                    <!-- (blur)="$event.target.value=removeSpaces($event.target.value)" value="" -->
                                    <!-- [ngModel]="InvoiceHeaderForm?.value?.invoiceheader[i]?.invoiceamount| currency:'USD':'symbol':'2.2'"
                                                    (ngModelChange)="InvoiceHeaderForm?.value?.invoiceheader[i]?.invoiceamount.value=$event"
                                                [ngModelOptions]="{updateOn:'blur'}"  -->
                                </mat-form-field>
                            </td>
                            <!-- <td
                                            *ngIf="((this.ecftypeid==2 || this.ecftypeid == 7 || this.ecftypeid == 14 || this.ecftypeid == 3 ) && (InvoiceHeaderForm?.value?.invoicegst == 'Y'))">
                                            <mat-form-field>
                                                <mat-label>Tax Amount</mat-label>
                                                <input type="tel" matInput  style="text-align:right"
                                                    formControlName="taxamount"
                                                    (keypress)="numberOnlyandDot($event)"  (click)="getheaderedit(i)"
                                                    (ngModelChange)="Taxamount($event,i)" autocomplete="off"
                                                    [readonly]="readinvhdrdata == true" id="create-ecf-0073">
                                            </mat-form-field>
                                        </td>
                                        <td
                                            *ngIf="((this.ecftypeid==2 || this.ecftypeid == 7 || this.ecftypeid == 14 || this.ecftypeid == 3) && (InvoiceHeaderForm?.value?.invoicegst == 'N'))">
                                            <mat-form-field>
                                                <mat-label>Tax Amount</mat-label>
                                                <input matInput  formControlName="taxamount"
                                                    (keypress)="numberOnlyandDot($event)" style="text-align:right"
                                                    (ngModelChange)="Taxamount($event,i)" autocomplete="off" readonly id="create-ecf-0074">
                                            </mat-form-field>
                                        </td> -->
                            <!-- <td>
                                            <mat-form-field style="width:50px;">
                                                <input matInput type="number" [min]="min" [max]="max"
                                                    placeholder="roundoff" (ngModelChange)="RoundingOFF($event)"
                                                    formControlName="roundoffamt" autocomplete="off"
                                                    (keypress)="numberOnlyandDotminus($event)" [readonly]="readinvhdrdata == true" id="create-ecf-0075">
                                            </mat-form-field>

                                        </td>
                                        <td>
                                            <mat-form-field style="width:50px;">
                                                <input matInput type="number" [min]="min" [max]="max"
                                                    placeholder="other adjustment"
                                                    (ngModelChange)="OtherAdjustment($event)"
                                                    formControlName="otheramount" autocomplete="off"
                                                    (keypress)="numberOnlyandDot($event)" [readonly]="readinvhdrdata == true" id="create-ecf-0076">
                                            </mat-form-field>

                                        </td> -->

                            <td id="matInput-size">
                                <mat-form-field appearance="outline">
                                    <mat-label>Purpose</mat-label>
                                    <input matInput type="text" maxlength="65"
                                        [readonly]="readinvhdrdata == true || this.InvoiceHeaderForm.value.invoiceheader[i].invoicegst == ''"
                                        formControlName="remarks" autocomplete="off" (keypress)="only_numalpha($event)"
                                        [matTooltip]="InvoiceHeaderForm.value.invoiceheader[i].remarks"
                                        matTooltipClass="custom-tooltipnew" id="create-ecf-0077">
                                </mat-form-field>
                            </td>
                            <td id="matInput-size">
                                <mat-form-field appearance="outline">
                                    <mat-select placeholder="Is Recurring" formControlName="is_recur"
                                        [disabled]="readinvhdrdata" id="create-ecf-0078">
                                        <mat-option *ngFor="let rrr of RecurYesorno" [value]="rrr.value"
                                            (click)="isRecurChanged(rrr);">
                                            {{rrr.display}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>

                            </td>
                            <td id="matInput-size" *ngIf="InvoiceHeaderForm.value.invoiceheader[i].is_recur ==1">
                                <mat-form-field appearance="outline">
                                    <mat-select placeholder="Recurring Type" formControlName="service_type"
                                        [disabled]="readinvhdrdata" id="create-ecf-0079">
                                        <mat-option *ngFor="let rr of RecurringTypes" [value]="rr.id"
                                            (click)="serviceTypeChanged(rr);">
                                            {{rr.text}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </td>
                            <td id="matInput-size" *ngIf="InvoiceHeaderForm.value.invoiceheader[i].is_recur ==0">
                                <mat-form-field appearance="outline">
                                    <mat-select placeholder="Recurring Type" formControlName="service_type"
                                        [disabled]="readinvhdrdata" id="create-ecf-0080">
                                        <mat-option *ngFor="let rr of RecurringTypes1" [value]="rr.id"
                                            (click)="serviceTypeChanged(rr);">
                                            {{rr.text}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </td>
                            <td id="matInput-size"
                                *ngIf="this.InvoiceHeaderForm.value.invoiceheader[i].service_type == 2 && showRecurDates">
                                <mat-form-field appearance="outline">
                                    <mat-label>Recurring Month</mat-label>
                                    <input matInput [matDatepicker]="picker1" required autocomplete="off"
                                        formControlName="recur_fromdate" [disabled]="readinvhdrdata"
                                        id="create-ecf-0081">

                                    <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                                    <mat-datepicker #picker1 startView="multi-year"
                                        (monthSelected)="setMonthAndYear($event, picker1, i )"
                                        panelClass="example-month-picker"></mat-datepicker>
                                </mat-form-field>
                            </td>
                            <!-- <td *ngIf ="this.InvoiceHeaderForm.value.invoiceheader[i].service_type == 2 && showRecurDates">
                                            <mat-form-field>
                                                <mat-label>Recurring To</mat-label>
                                                <input matInput [matDatepicker]="picker2" required [min]="this.InvoiceHeaderForm.value.invoiceheader[i].recur_fromdate" 
                                                    autocomplete="off" formControlName="recur_todate" disabled id="create-ecf-0082">

                                                <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                                                <mat-datepicker #picker2 startView="multi-year"></mat-datepicker>
                                            </mat-form-field>
                                        </td> -->
                            <td id="matInput-size"
                                *ngIf="this.InvoiceHeaderForm.value.invoiceheader[i].service_type == 3 && showRecurDates">
                                <mat-form-field appearance="outline">
                                    <mat-label>Recurring From</mat-label>
                                    <input matInput [matDatepicker]="picker1" required autocomplete="off"
                                        formControlName="recur_fromdate" [disabled]="readinvhdrdata"
                                        id="create-ecf-0083">

                                    <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                                    <mat-datepicker #picker1></mat-datepicker>
                                </mat-form-field>
                            </td>
                            <td id="matInput-size"
                                *ngIf="this.InvoiceHeaderForm.value.invoiceheader[i].service_type == 3 && showRecurDates">
                                <mat-form-field appearance="outline">
                                    <mat-label>Recurring To</mat-label>
                                    <input matInput [matDatepicker]="picker2" required
                                        [min]="this.InvoiceHeaderForm.value.invoiceheader[i].recur_fromdate"
                                        autocomplete="off" formControlName="recur_todate" [disabled]="readinvhdrdata"
                                        id="create-ecf-0084">

                                    <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                                    <mat-datepicker #picker2></mat-datepicker>
                                </mat-form-field>
                            </td>
                            <td id="matInput-size">
                                <div style="margin-left:3px; margin-bottom: 16px;">
                                    {{section?.value?.invoicestatus}}
                                </div>
                            </td>
                            <td>
                            <div style="display: flex">
                                <!-- <tr> -->
                                    <div style="margin-left:10px">
                                        <i (click)="UploadPopupOpens(i)" class="fa fa-cloud-upload"
                                            matTooltip="Upload file" matTooltipClass="custom-tooltipnew"
                                            aria-hidden="true" style="font-size: 25px;color: blue;"></i>
                                        <!-- data-target="#fileUploaddpopup" data-toggle="modal" -->
                                        <!-- <div
                                                *ngFor="let files of InvoiceHeaderForm?.value?.invoiceheader[i]?.filevalue; let index = index">
                                                <p (click)="filepreview(files)" data-toggle="modal"
                                                    data-target="#my-modalpreview"
                                                    style="color: #0000EE;cursor: pointer;">
                                                    {{index+1}}.{{files?.name}} </p>
                                                <span
                                                    (click)="deletefileUpload(InvoiceHeaderForm?.value?.invoiceheader[i],index)"
                                                    [class.disabled]="readinvhdrdata != false">
                                                    <mat-icon matTooltip="Delete">delete
                                                    </mat-icon>
                                                </span>

                                            </div> -->
                                        </div>

                                    <div style="margin-left:10px;"
                                        *ngIf="InvoiceHeaderForm?.value?.invoiceheader[i]?.file_key?.length > 0 
                                        || InvoiceHeaderForm?.value?.invoiceheader[i]?.filekey?.length > 0 ">

                                        <div>
                                            <i matTooltip="view" matTooltipClass="custom-tooltipnew"
                                                class=" fa fa-eye create " (click)="getfiledetails(section,i)"
                                                style="cursor: pointer;color:blue;margin-left: 5px;"
                                                [class.disabled] = "this.InvoiceHeaderForm.value.invoiceheader[i].invoicegst == ''">
                                                <!-- data-target="#create-ecf-0004" data-toggle="modal" -->
                                            </i>
                                        </div>
                                    </div>
                                    <!-- <div
                                                *ngIf="InvoiceHeaderForm?.value?.invoiceheader[i]?.filekey?.length > 0"> -->
                                    <!-- <h3 (click)="getfiledetails(section,i)"
                                                    data-target="#create-ecf-0004"
                                                    style="cursor: pointer;color:blue;margin-left: 5px;"
                                                    class="btn btn-link" data-toggle="modal">Previously Attached
                                                    Files</h3> -->


                                    <!-- </div> -->


                                <!-- </tr> -->





                            </div>
                            <!-- <td style="text-align: center;" *ngIf="ecftypeid == 2">
                                <section class="example-section" style="margin-bottom:6px;">
                                    <mat-checkbox class="example-margin" formControlName="captalisedflag"
                                        [disabled]="readinvhdrdata || this.ecftypeid != 2"></mat-checkbox>
                                </section>
                            </td> -->






                            <td>
                                <button mat-icon-button type="button" style="margin-bottom:13px"
                                    [class.disabled]="readinvhdrdata != false || ecfstatus?.id ==2"
                                    id="create-ecf-0085">
                                    <mat-icon style="color: green;" aria-label="Edit"
                                        (click)="deleteinvheader(InvoiceHeaderForm.value,section,i)">
                                        delete</mat-icon>
                                </button>
                            </td>
                            <!-- <td *ngIf="invoicestatus == 'INVOICE COMPLETED' || invoicestatus == 'INVOICE APPROVED' 
                                        || invoicestatus == 'PENDING IN ECF APPROVAL' ">
                                            <button mat-fab matTooltip="Create Template" matTooltipClass="custom-tooltipnew" 
                                            style="background-color:coral;border-color: brown;font-size: medium;"
                                            data-toggle="modal" data-target="#create-ecf-0147" id="create-ecf-0085"
                                            (click)="createTemp(section)">
                                                <span class="fa fa-plus"> </span>
                                            </button>
                                        </td> -->
                            <!-- (click)=deleteinvheader(InvoiceHeaderForm.value,section,i) -->

                            <td>

                                <button [disabled]="invhdrsaved || ecfstatus?.id ==2" type="button"
                                    class="btn btn-outline-success" matTooltip="Save & Continue"
                                    matTooltipClass="custom-tooltipnew" style="border-radius:40px;margin-bottom:13px;"
                                    (click)="gotodetail(section,i)" id="create-ecf-0086">
                                    <i class="fa fa-arrow-right"></i>
                                </button>
                                <!-- (click)="Addinvoice(section,InvoiceHeaderForm.value,i)" -->

                                <!-- <button *ngIf="showaddbtns" type="button"
                                                class="btn btn-outline-primary" matTooltip="Save & Continue"
                                                style="border-radius:40px;margin-left:5px;color: mediumblue;" (click)="gotodetail(section,i)" id="create-ecf-0087">
                                                <span
                                                    class="fa fa-arrow-right"></span>
                                            </button> -->
                                <!-- <mat-icon>chevron_right</mat-icon> -->

                            </td>


                            </tr>



                        </ng-container>
                        <tr>
                            <td class="totaldisplay" [attr.colspan]="InvHdrColCount" style="text-align: end;">Net
                                Amount:</td>
                            <td style="text-align: right;">{{sum | currency:'INR'}}</td>
                        </tr>
                        <!-- <tr *ngIf="this.ecftypeid == 7">
                                    <th class="totaldisplay" colspan="10" style="text-align: end;">Net Amount:</th>
                                    <td style="text-align: right;">{{sum | currency:'INR'}}</td>


                                </tr> -->
                        <!-- <tr *ngIf="!show_suppdetails">
                                    <th class="totaldisplay" colspan="3" style="text-align: end;">
                                        Net Amount:</th>
                                    <td style="text-align: right;">{{sum | currency:'INR'}}</td>


                                </tr> -->

                    </table>
                    </div>

                    <!-- <tr> -->
                    <!-- <td *ngIf="this.ecftypeid == 2 || this.ecftypeid == 14"> -->

                    <!-- <button type="submit"
                                        style="border-radius:40px;margin-left: 1730px;"
                                        class="btn btn-outline-primary" (click)="submitinvoiceheader()"
                                        [disabled]="invheadersave" id="create-ecf-0088">
                                        Save</button> -->


                    <!-- <div style="margin-top: 20px;">
                                            <form [formGroup]="OverallForm"> 
                                            <table>
                                            <tr> -->
                    <!-- <td>
                                                    <mat-form-field style="width: 200px;">
                                                        <input type="text" matInput formControlName="payment_instruction" autocomplete="off"
                                                            placeholder="Payment Instructions" id="create-ecf-0089">
                                                    </mat-form-field> 
                                                </td>
                                                <td>
                                                    <section class="example-section ecfapcheck" style="margin-left:50px">
                                                        <mat-checkbox class="example-margin" formControlName="is_tds_applicable">Is TDS Applicable
                                                        
                                                        </mat-checkbox>
                                                    </section>
                                                </td> -->
                    <!-- <td *ngIf="ecfstatus?.text !='BATCH ECF RETURNED'">
                                                <mat-label style="margin-left: 50px;" >Batch wise <label style="color:red">*</label></mat-label>
                            
                                                <mat-radio-group formControlName="batch_wise">
                                                    <mat-radio-button *ngFor="let n of yesorno" [value]="n.value" style="margin-left: 10px;margin-top: 10px;"
                                                        (click)="batchwiseSelect(n.value)">
                            
                                                        {{n.display}}
                                                    </mat-radio-button>
                                                </mat-radio-group>
                                            </td> -->
                    <!-- <div  id="matInput-size" style="display: flex;gap: 10px;" *ngIf="ecfstatus?.text !='BATCH ECF RETURNED' && showApprover"> -->
                    <!-- <lib-vs-depdropdown-cmp class="package-grid-width"
                                                [ParentObj]="ParentObj"
                                                [formGroup]="OverallForm"
                                                [ChildObj]="ChildObj"  
                                                  (dataEventParent)="approverdata($event)"
                                                (dataEventChild)="selectedvaluess($event)">
                                              </lib-vs-depdropdown-cmp> -->
                    <!-- <lib-vs-dynamicform-cmp
                                                     id="matInput-size"
                                                    [InputFields]="approverbranch"
                                                    [formGroup]="OverallForm"
                                                    [ResetForm]="restformdep"
                                                    ></lib-vs-dynamicform-cmp>
                                                   <lib-vs-dynamicform-cmp
                                                      id="matInput-size"
                                                    [InputFields]="approvernames"
                                                    [formGroup]="OverallForm"
                                                    [ResetForm]="restformdep"
                                                   ></lib-vs-dynamicform-cmp> -->
                    <!-- <div class="searchs-expand">
                                                <lib-vs-depdropdown-cmp
                                                   id="matInput-size"
                                                  [ParentObj]="approverbranchfield"
                                                  [formGroup]="OverallForm"
                                                  [ChildObj]="approvernamefield"
                                                  [ResetForm]="restformdep"
                                                >
                                                </lib-vs-depdropdown-cmp>
                                                </div> -->
                    <!-- <mat-form-field appearance="outline" (click)="getbranchname()">
                                                    <mat-label>Approver Branch</mat-label>
                                                    <input #brInput placeholder="Approver Branch" matInput formControlName="branch_id"
                                                        [matAutocomplete]="branchmatAuto" id="create-ecf-0090">
                                                    <mat-autocomplete [panelWidth]="400" #branchmatAuto="matAutocomplete" (opened)="branchScroll()"
                                                        [displayWith]="displayFnBranch">
                                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                                        <ng-container *ngIf="!isLoading">
                                                            <mat-option *ngFor="let br of brList" matTooltip="{{br.code}}-{{br.name}}" matTooltipClass="custom-tooltipnew" [value]="br">
                                                                {{br.code}}-{{br.name}}
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>
                                                </mat-form-field> -->
                    <!-- <mat-form-field appearance="outline" (click)="approvername()">
                                                    <mat-label>Approver Name</mat-label>
                                                    <input #appInput  placeholder="Choose Approver" matInput
                                                    formControlName="approvedby" [matAutocomplete]="approver" required id="create-ecf-0091">
                                                    <mat-autocomplete [panelWidth]="400" #approver="matAutocomplete" (opened)="autocompleteapproverScroll()"
                                                    [displayWith]="displayFnapprover">
                                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                                        <ng-container *ngIf="!isLoading">
                                                            <mat-option *ngFor="let app of approverList" matTooltip="{{app.name}} -{{app.code}}-{{app.limit}}-{{app.designation}}" matTooltipClass="custom-tooltipnew" [value]="app">
                                                                {{app.name}}-{{app.code}} - {{app.limit}} - {{app.designation}}
                                                        </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>
                                                </mat-form-field>  -->
                    <!-- </div> -->
                    <!-- <td *ngIf="ecfstatus?.text !='BATCH ECF RETURNED'">                
                                                <button type="button" style="border-radius:40px;margin-left: 10px;"
                                                                class="btn btn-outline-primary" (click)="OverallFormSubmits()" [disabled]="submitoverallbtn" id="create-ecf-0092">
                                        
                                                                Submit
                                                            </button>
                                                <button type="button" style="border-radius:40px;margin-left: 10px;"
                                                class="btn btn-outline-primary" (click)="backform()" id="create-ecf-0093">
                                                Back</button>
                                            </td>
                                            <td *ngIf="ecfstatus?.text =='BATCH ECF RETURNED'">                
                                                <button type="button" style="border-radius:40px;margin-left: 450px;"
                                                                class="btn btn-outline-primary" (click)="OverallFormSubmits()" [disabled]="submitoverallbtn" id="create-ecf-0094">
                                        
                                                                Submit
                                                            </button>
                                                <button type="button" style="border-radius:40px;margin-left: 10px;"
                                                class="btn btn-outline-primary" (click)="backform()" id="create-ecf-0095">
                                                Back</button>
                                            </td>
                                            <td *ngIf="ecfstatus?.text =='BATCH ECF RETURNED'">
                                                <button type="button" style="border-radius:40px;margin-left: 10px;" matTooltip="Remove from Batch" 
                                                matTooltipClass="custom-tooltipnew" class="btn btn-outline-primary" (click)="removefrom_batch()" id="create-ecf-0096">
                                                Remove from Batch</button>
                                            </td> -->
                    <!-- </tr>
                                            </table>
                                            </form>
                                        </div>   -->

                    <!-- 
                                    <button type="button" style="border-radius:40px;margin-left:1800px;;margin-bottom: 10px;"
                                        class="btn btn-outline-primary" (click)="backform()" id="create-ecf-0097">
                                        Back</button> -->


                    <!-- 
                                    <button type="submit" style="border-radius:10px;margin-left: 1651px;margin-bottom:2%;
                                border-color: #f5c68b;
                                background-color: #f5c68b;" (click)="submitinvoiceheader()" class="btn btn-light"
                                        [disabled]="invheadersave"  id="create-ecf-0098">Save</button> -->

                    <!-- <button type="button" class="btn btn-light" style="border-radius:7px;margin-left:1723px;margin-bottom: -18px;
                                    margin-top :-151px;
                                    border-color: black; 
                                    background-color: white;" (click)="backform()" id="create-ecf-0099">Back</button> -->

                    <!-- </td>
                                <td *ngIf="this.ecftypeid == 7 "> -->

                    <!-- <button type="submit"
                                        style="border-radius:40px;margin-left: 1800px;margin-bottom:2%;"
                                        class="btn btn-outline-primary" (click)="submitinvoiceheader()"
                                        [disabled]="invheadersave" id="create-ecf-0100">
                                        Save</button> -->

                    <!-- <button type="button" style="border-radius:40px;margin-left:1873px;;margin-bottom: 10px;"
                                        class="btn btn-outline-primary" (click)="backform()" id="create-ecf-0101">
                                        Back</button> -->

                    <!-- <button type="submit" style="border-radius:10px;margin-left: 1800px;margin-bottom:2%;
                                border-color: #f5c68b;
                                background-color: #f5c68b;" (click)="submitinvoiceheader()" class="btn btn-light"
                                        [disabled]="invheadersave" id="create-ecf-0102">Save</button>

                                    <button type="button" class="btn btn-light" style="border-radius:7px;margin-left:1873px;margin-bottom: -18px;
                                    margin-top :-161px;
                                    border-color: black; 
                                    background-color: white;" (click)="backform()" id="create-ecf-0103">Back</button> -->

                    <!-- </td>

                                <td *ngIf="(this.ecftypeid == 3 && this.paytoid == 'E' && gstyesno == 'N') || this.ecftypeid == 13 "> -->

                    <!-- <button type="submit"
                                        style="border-radius:40px;margin-left: 1150px;margin-bottom:2%;"
                                        class="btn btn-outline-primary" (click)="submitinvoiceheader()"
                                        [disabled]="invheadersave" id="create-ecf-0104">
                                        Save</button> -->
                    <!-- 
                                    <button type="button" style="border-radius:40px;margin-left:1220px;;margin-bottom: 10px;"
                                        class="btn btn-outline-primary" (click)="backform()" id="create-ecf-0105">
                                        Back</button> -->


                    <!-- <button type="submit" style="border-radius:10px;margin-left: 950px;margin-bottom:2%;
                                border-color: #f5c68b;
                                background-color: #f5c68b;" (click)="submitinvoiceheader()" class="btn btn-light"
                                        [disabled]="invheadersave" id="create-ecf-0106">Save</button>

                                    <button type="button" class="btn btn-light" style="border-radius:7px;margin-left:1023px;margin-bottom: -45px;
                                    margin-top :-160px;
                                    border-color: black; 
                                    background-color: white;" (click)="backform()" id="create-ecf-0107">Back</button> -->

                    <!-- </td>
                                <td *ngIf="this.ecftypeid == 3 && this.paytoid == 'E' && gstyesno == 'Y'"> -->

                    <!-- <button type="submit"
                                        style="border-radius:40px;margin-left: 1500px;margin-bottom:2%;"
                                        class="btn btn-outline-primary" (click)="submitinvoiceheader()"
                                        [disabled]="invheadersave" id="create-ecf-0108">
                                        Save</button> -->

                    <!-- <button type="button" style="border-radius:40px;margin-left:1575px;;margin-bottom: 10px;"
                                        class="btn btn-outline-primary" (click)="backform()" id="create-ecf-0109">
                                        Back</button>

                                <td *ngIf="this.ecftypeid == 4 && this.ppxid == 'S'"> -->

                    <!-- <button type="submit"
                                        style="border-radius:40px;margin-left: 1451px;margin-bottom:2%;"
                                        class="btn btn-outline-primary" (click)="submitinvoiceheader()"
                                        [disabled]="invheadersave" id="create-ecf-0110">
                                        Save</button> -->
                    <!-- 
                                    <button type="button" style="border-radius:40px;margin-left:1525px;margin-bottom: 10px;"
                                        class="btn btn-outline-primary" (click)="backform()" id="create-ecf-0111">
                                        Back</button> -->

                    <!-- 
                                    <button type="submit" style="border-radius:10px;margin-left: 1451px;margin-bottom:2%;
                                border-color: #f5c68b;
                                background-color: #f5c68b;" (click)="submitinvoiceheader()" class="btn btn-light"
                                        [disabled]="invheadersave" id="create-ecf-0112">Save</button>

                                    <button type="button" class="btn btn-light" style="border-radius:7px;margin-left:1525px;margin-bottom: 0px;
                                    margin-top :-127px;
                                    border-color: black; 
                                    background-color: white;" (click)="backform()" id="create-ecf-0113">Back</button> -->

                    <!-- </td>
                                <td *ngIf="this.ecftypeid == 4 && this.ppxid == 'E'"> -->

                    <!-- <button type="submit"
                                        style="border-radius:40px;margin-left: 951px;margin-bottom:2%;"
                                        class="btn btn-outline-primary" (click)="submitinvoiceheader()"
                                        [disabled]="invheadersave" id="create-ecf-0114">
                                        Save</button> -->

                    <!-- <button type="button" style="border-radius:40px;margin-left:1025px;margin-bottom: 10px;"
                                        class="btn btn-outline-primary" (click)="backform()" id="create-ecf-0115">
                                        Back</button> -->

                    <!-- <button type="submit" style="border-radius:10px;margin-left: 951px;margin-bottom:2%;
                                border-color: #f5c68b;
                                background-color: #f5c68b;" (click)="submitinvoiceheader()" class="btn btn-light"
                                        [disabled]="invheadersave" id="create-ecf-0116">Save</button>

                                    <button type="button" class="btn btn-light" style="border-radius:7px;margin-left:1025px;margin-bottom: 1px;
                                    margin-top :-110px;
                                    border-color: black; 
                                    background-color: white;" (click)="backform()" id="create-ecf-0117">Back</button> -->

                    <!-- </td> -->
                    <!-- </tr> -->

                    <!-- </div>
                        </div> -->
                </div>

            </form>
        </div>



    </div>

    <!-- ------------------------------------ -->


</div>




<!-- ----supplier popup----- -->
<div *ngIf="showsupppopup">
    <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true"
        data-keyboard="false" data-backdrop="static" id="create-ecf-0003">
        <div class="modal-dialog modal-xl" style="width: 80%; height: 200%">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Find Supplier</h3>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="create-ecf-0118">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <!-- <br> -->
                <div class="modal-body">
                    <!-- <form
              [formGroup]="SelectSupplierForm"
              (ngSubmit)="SelectSuppliersearch()"
            > -->
                    <form [formGroup]="SelectSupplierForm">
                        <div class="search-auto-fit" style="margin-left:20px">
                            <lib-vs-search-cmp id="matInput-size" [SearchArr]="suppliersearch" [Outputtype]="searchvar"
                                (dataoutput)="SelectSuppliersearch($event)" [SeparateReset]="true" 
                                (ResetOutput)="dataclear($event)">
                            </lib-vs-search-cmp>
                        </div>

                        <table style="margin-left: 20px">
                            <div>
                                <!-- <tr style="display: flex; align-items: center; gap: 15px">
                    <td  id="matInput-size">
                      <mat-form-field appearance="outline">
                        <mat-label>Supplier GST Number</mat-label>
                        <input
                          matInput
                          placeholder="GST No"
                          formControlName="gstno"
                          autocomplete="off"
                          (keypress)="only_numalpha($event)"
                          maxlength="15"
                          id="create-ecf-0119"
                        />
                      </mat-form-field>
                    </td> -->

                                <!-- <td  id="matInput-size">
                      <mat-form-field appearance="outline">
                        <mat-label>Supplier Code</mat-label>
                        <input
                          matInput
                          placeholder="Supplier"
                          formControlName="code"
                          autocomplete="off"
                          (keypress)="only_numalpha($event)"
                          maxlength="10"
                          id="create-ecf-0120"
                        />
                      </mat-form-field>
                    </td> -->
                                <!-- [disabled]="showsuppliercode"  -->

                                <!-- <td  id="matInput-size">
                      <mat-form-field appearance="outline">
                        <mat-label>PAN Number</mat-label>
                        <input
                          matInput
                          placeholder="PAN"
                          formControlName="panno"
                          autocomplete="off"
                          (keypress)="only_numalpha($event)"
                          id="create-ecf-0121"
                        />
                      </mat-form-field>
                    </td> -->
                                <!--  [disabled]="true" -->
                                <!-- <button
                      class="btn btn-outline-primary"
                      type="submit"
                      style="border-radius: 40px; margin-bottom: 25px"
                      color="primary"
                      id="create-ecf-0122"
                    >
                    


                    
                      <i class="fa fa-search" aria-hidden="true"></i>
                    </button> -->

                                <!-- <button type="button" style="border-radius:10px;margin-left: 15px; border-color: black; 
                                      background-color: white;" class="btn btn-light" (click)="dataclear()" id="create-ecf-0123">
                                          Reset</button> -->

                                <!-- <button
                      type="button"
                      style="border-radius: 40px; margin-bottom: 25px"
                      class="btn btn-outline-primary"
                      (click)="dataclear()"
                      id="create-ecf-0124"
                    >
                      Reset
                    </button>
                  </tr> -->
                                <tr>
                                    <div *ngIf="default">
                                        <lib-vs-dynamicform-cmp id="matInput-size" [formGroup]="SelectSupplierForm"
                                            (dataEvent)="choosesupplierdata($event)" [InputFields]="choosesupplierfield"
                                            [ResetForm]="restformfile"></lib-vs-dynamicform-cmp>
                                        <!-- 
                      <td  id="matInput-size" style="width: 427px">
                        <mat-form-field
                          appearance="outline"
                          (click)="getsuppdd()"
                        >
                          <mat-label>Choose Supplier</mat-label>
                          <input
                            #suppInput
                            placeholder="Choose Supplier"
                            matInput
                            formControlName="name"
                            [matAutocomplete]="Suppliertype"
                            id="create-ecf-0125"
                          />
                          <mat-autocomplete
                            [panelWidth]="400"
                            #Suppliertype="matAutocomplete"
                            [displayWith]="displayFn"
                            (opened)="supplierScroll()"
                          >
                            <mat-option *ngIf="isLoading" class="is-loading"
                              >Loading...
                            </mat-option>
                            <ng-container *ngIf="!isLoading"> -->
                                        <!-- ngDefaultControl [(ngModel)]="inputSUPPLIERValue"
                                                              [ngModelOptions]="{standalone: true}"
                                                              (ngModelChange)="inputSUPPLIERValue = $event.toUpperCase()" -->
                                        <!-- <mat-option
                                *ngFor="let suppliername of supplierNameData"
                                (onSelectionChange)="getsuppView(suppliername)"
                                [value]="suppliername"
                                matTooltip="{{ suppliername.name }}"
                                matTooltipClass="custom-tooltipnew"
                              >
                                {{ suppliername.name }}
                              </mat-option>
                            </ng-container>
                          </mat-autocomplete>
                        </mat-form-field>
                      </td> -->
                                    </div>

                                    <div *ngIf="alternate">
                                        <lib-vs-dynamicform-cmp id="matInput-size" [formGroup]="SelectSupplierForm"
                                            (dataEvent)="choosesupplierdata1($event)"
                                            [InputFields]="choosesupplierfield1"
                                            [ResetForm]="restformfile1"></lib-vs-dynamicform-cmp>

                                        <!-- <td  id="matInput-size" style="width: 478px">
                        <mat-form-field
                          appearance="outline"
                          (click)="getsuppdd()"
                        >
                          <mat-label>Choose Supplier</mat-label>
                          <input
                            #name
                            placeholder="Choose Supplier"
                            matInput
                            formControlName="name"
                            [matAutocomplete]="autosupp2"
                            id="create-ecf-0126"
                          />
                          <mat-autocomplete
                            [panelWidth]="400"
                            #autosupp2="matAutocomplete"
                            [displayWith]="displaytest"
                          > -->
                                        <!-- [(ngModel)]="inputSUPPLIERValue" [ngModelOptions]="{standalone: true}" 
                                                      
                                                              ngDefaultControl
                                                              (ngModelChange)="inputSUPPLIERValue = $event.toUpperCase()" -->
                                        <!-- <mat-option *ngIf="isLoading" class="is-loading"
                              >Loading...
                            </mat-option>
                            <ng-container *ngIf="!isLoading">
                              <mat-option
                                *ngFor="let suppliername of selectsupplierlist"
                                (onSelectionChange)="getsuppView(suppliername)"
                                [value]="suppliername"
                                matTooltip="{{ suppliername.name }}"
                                matTooltipClass="custom-tooltipnew"
                              >
                                {{ suppliername.name }}
                              </mat-option>
                            </ng-container>
                          </mat-autocomplete>
                        </mat-form-field>
                      </td> -->
                                    </div>
                                </tr>
                            </div>
                        </table>

                        <!-- <form [formGroup]="supplierchooseForm"></form> -->
                        <table width="100%" style="margin-top: 2%; margin-bottom: 5%">
                            <tbody>
                                <tr>
                                    <td valign="top">
                                        <table style="font-size: 14px; margin-left: 20px">
                                            <tbody>
                                                <tr>
                                                    <td style="
                                color: #808080;
                                width: 170px;
                                font-size: medium;
                                height: 50px;vertical-align: top;
                              ">
                                                        Supplier Name:
                                                    </td>
                                                    <td style="width: 400px; height: 50px; vertical-align: top">
                                                        {{ SupplierName }}
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td style="
                                color: #808080;
                                width: 170px;
                                font-size: medium;
                                height: 50px;vertical-align: top">
                                                        Supplier Code:
                                                    </td>
                                                    <td style="width: 400px; height: 50px;vertical-align: top">
                                                        {{ SupplierCode }}
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td style="
                                color: #808080;
                                width: 190px;
                                font-size: medium;
                                height: 50px;vertical-align: top
                              ">
                                                        Supplier GST Number:
                                                    </td>
                                                    <td style="width: 400px; height: 50px;vertical-align: top">
                                                        {{ SupplierGSTNumber }}
                                                    </td>
                                                </tr>
                                                <!-- <p style="color: #808080; margin: 0px 0 4px;">
                                                          Supplier Name:
                                                          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span
                                                              style="color: black;margin-left: 2.5em;">{{SupplierName }}
                                                          </span>
                                                      </p>
                                                      <p style="color: #808080; margin: 0px 0 4px;margin-top: 3%;">
                                                          Supplier Code:
                                                          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                                          <span style="color: black;margin-left: 3.8em;">{{SupplierCode}}
                                                          </span>
                                                      </p>
                                                      <p style="color: #808080; margin: 0px 0 4px;margin-top: 3%;">
                                                          Supplier GST Number:
                                                          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                                          <span
                                                              style="color: black;margin-left: 0.2em;">{{SupplierGSTNumber}}
                                                          </span>
                                                      </p> -->
                                            </tbody>
                                        </table>
                                    </td>
                                    <td valign="top">
                                        <table style="font-size: 14px;">
                                            <tbody></tbody>
                                            <tbody>
                                                <tr>
                                                    <td style="
                                color: #808080;
                                width: 170px;
                                font-size: medium;
                                height: 50px;vertical-align: top
                              ">
                                                        PAN Number:
                                                    </td>
                                                    <td style="width: 300px; height: 50px;vertical-align: top">
                                                        {{ SupplierPANNumber }}
                                                    </td>
                                                </tr>
                                                <!-- <tr>
                                                    <td style="
                                color: #808080;
                                width: 170px;
                                font-size: medium;
                                height: 50px;vertical-align: top
                              ">
                                                        Address:
                                                    </td>
                                                    <td style="width: 300px; height: 50px;vertical-align: top">
                                                        {{ line1 }}, {{ line2 }},
                                                        {{ line3 }}
                                                    </td>
                                                </tr> -->
                                                <tr>
                                                    <td style="color: #808080; width: 170px; font-size: medium; height: 50px; vertical-align: top">
                                                      Address:
                                                    </td>
                                                    <td style="width: 300px; height: 50px; vertical-align: top">
                                                      <span *ngIf="line1">{{ line1 }}</span>
                                                      <span *ngIf="line1 && line2">, </span>
                                                      <span *ngIf="line2">{{ line2 }}</span>
                                                      <span *ngIf="(line1 || line2) && line3">, </span>
                                                      <span *ngIf="line3">{{ line3 }}</span>
                                                    </td>
                                                  </tr>
                                                  
                                                <tr>
                                                    <td style="
                                color: #808080;
                                width: 120px;
                                font-size: medium;
                                height: 50px;vertical-align: top
                              ">
                                                        City:
                                                    </td>
                                                    <td style="width: 300px; height: 50px;vertical-align: top">
                                                        {{ City }}
                                                    </td>
                                                </tr>
                                                <!-- <tr>
                                                      <p style="color: #808080; margin: 0px 0 4px;">
                                                          PAN Number:
                                                          &nbsp;&nbsp;&nbsp;<span
                                                              style="color: black;margin-left: 0em;">{{SupplierPANNumber}}
                                                          </span>
                                                      </p>
                                                      <p style="color: #808080; margin: 0px 0 4px;margin-top: 3%;">
                                                          Address:
                                                          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                                          <span style="color: black;margin-left: 0.3em;"> {{line1}},
                                                              {{line2}},
                                                              {{line3}}</span>
                                                      </p>
                                                      <p style="color: #808080; margin: 0px 0 4px;margin-top: 3%;">
                                                          City:
                                                          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                                          <span style="color: black;margin-left: -0.4em;">{{City}} </span>
                                                      </p>
                                                  </tr> -->
                                            </tbody>
                                        </table>
                                    </td>
                                </tr>
                                <!-- <br><br>
                                  <div style="margin-left: 20px; ">
                                      <tr style="text-align: end;">
                                          <button type="button" data-dismiss="modal" style="border-radius:10px;margin-left: 500px;border-color: #f5c68b;
                                          background-color: #f5c68b;" class="btn btn-light"
                                              (click)="Branchcallingfunction()" id="create-ecf-0127">
                                              Submit</button> -->

                                <!-- <button type="button" data-dismiss="modal" [disabled]="!submitbutton"
                                              style="border-radius:40px;"
                                              class="btn btn-outline-primary" (click)="Branchcallingfunction()" id="create-ecf-0128">
                                              Submit</button>
                                          <button type="button" data-dismiss="modal"
                                          style="border-radius:40px;margin-left: 10px;"
                                          class="btn btn-outline-primary"  id="create-ecf-0129">Back</button>
  
  
                                      </tr>
                                  </div> -->
                            </tbody>
                        </table>
                    </form>
                </div>

                <div class="modal-footer">
                    <!-- <div style="text-align: end;"> -->
                    <!-- <button type="button" data-dismiss="modal" style="border-radius:10px;margin-left: 500px;border-color: #f5c68b;
                          background-color: #f5c68b;" class="btn btn-light"
                              (click)="Branchcallingfunction()" id="create-ecf-0127">
                              Submit</button> -->

                    <button type="button" data-dismiss="modal" [disabled]="!submitbutton" style="border-radius: 40px"
                        class="btn btn-outline-success" (click)="Branchcallingfunction()" id="create-ecf-0128">
                        Submit
                    </button>
                    <button type="button" data-dismiss="modal" style="border-radius: 40px; margin-left: 10px"
                        class="btn btn-outline-primary" id="create-ecf-0129" (click)="dataclear($event)">
                        Back
                    </button>

                    <!-- </div> -->
                </div>
            </div>
        </div>
    </div>
</div>

<!-- <div>
    <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true" 
        id="create-ecf-0004">
        <div class="modal-dialog modal-lg " style="width: 70%;">
            <div class="modal-content">
                <div class="modal-header" >
                    <h3 class="modal-title">Attachments
                    </h3>
                    <button type="button" class="close" data-dismiss="modal" #closedbuttons aria-label="Close" id="create-ecf-0130">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>

                <div class="modal-body">
                  
                        <div class="row">
                            <div class="table-responsive" style="width:100%;margin-top: 1%;">
                                <h3 >Currently Attached Files</h3>

                                <lib-vs-cbox-summary
                                [SummaryDetails]="SummaryCurrentlyAttechedFiles"
                                [SummaryApiObj]="SummaryApiCurrentlyAttechedFilesObjNew"
                              ></lib-vs-cbox-summary>

                                <table class="table table-bordered" >
                                    <thead class="table_header" style="text-align: left;">
                                    <tr>
                                        <th style="text-align: center;">S.No</th>
                                        <th style="text-align: center;">File Name</th>
                                        <th style="text-align: center;">View</th>
                                        <th style="text-align: center;">Delete</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                         <tr  *ngFor="let files of file_process_data['file'+fileindex]; let index = index">
                                            <td>{{index+1}}</td>
                                            <td> -->
<!-- <p (click)="filepreview(files)" data-toggle="modal"
                                                data-target="#my-modalpreview"
                                                style="color: #0000EE;cursor: pointer;"> -->
<!-- {{files?.name}}  -->
<!-- </p> -->
<!-- </td>
                                            <td style="text-align: center">
                                                <i
                                                  class="fa fa-external-link"
                                                  aria-hidden="true"
                                                  style="
                                                    color: blue;
                                                    font-size: 24px;
                                                    margin-left: 20px;
                                                  "
                                                  (click)="filepreview(files)"
                                                > -->
<!-- data-toggle="modal"
                                                data-target="#create-ecf-0005" -->
<!-- </i>
                                              </td>
                                            <td style="text-align: center;">
                                                
                                                <span (click)="deletefileUpload(InvoiceHeaderForm?.value?.invoiceheader[this.fileindex],index)"
                                                    [class.disabled]="readinvhdrdata != false">
                                                    <mat-icon matTooltip="Delete" matTooltipClass="custom-tooltipnew">delete
                                                    </mat-icon>
                                                </span>
                                            </td>
                                         </tr>
                                        
                                    </tbody>
                                </table> -->

<!-- <div
                                *ngFor="let files of InvoiceHeaderForm?.value?.invoiceheader[this.fileindex]?.filevalue; let index = index">
                                <p (click)="filepreview(files)" data-toggle="modal"
                                    data-target="#my-modalpreview"
                                    style="color: #0000EE;cursor: pointer;">
                                    {{index+1}}.{{files?.name}} </p>
                                <span
                                    (click)="deletefileUpload(InvoiceHeaderForm?.value?.invoiceheader[this.fileindex],index)"
                                    [class.disabled]="readinvhdrdata != false">
                                    <mat-icon matTooltip="Delete">delete
                                    </mat-icon>
                                </span>

                            </div> -->
<!--                           
                            <h3>Previously Attached Files</h3>
                                <table class="table table-bordered" fixed-header style="width: 99%;margin-top: 10px;">
                                    <thead class="table_header" style="text-align: left;">

                                        <tr>
                                            <th style="text-align: center;">S.No</th>
                                            <th style="text-align: center;">File Name</th>
                                            <th style="text-align: center;">View</th>
                                            <th style="text-align: center;">Download</th>
                                            <th style="text-align: center;">Delete </th>


                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let attach of filedatas; index as i">
                                            <td style="text-align: center;">{{i+1}}</td>
                                            <td>{{attach.file_name}}</td>
                                            <td style="text-align: center;" >
                                                <i class="fa fa-external-link" aria-hidden="true" style="color:blue;font-size: 24px;margin-left: 20px;" (click)="data1(attach)"></i>
                                                </td> -->
<!-- <td style="text-align: center;color:blue;">
                          <div matTooltip="View" class="fa fa-arrow-up" aria-hidden="true" 
                            data-toggle="modal"
                            (click)="data(attach.file_id)" >

                           
                          </div>
                        </td> -->

<!-- <td style="text-align: center;">
                                                <button class="btn btn-outline-primary" type="submit"
                                                    (click)="getfiles(attach)"
                                                    style="border-radius:40px;margin-left: 15px;" color="primary" id="create-ecf-0131">
                                                    <i matTooltip="Download" matTooltipClass="custom-tooltipnew" class="fa fa-download" matTooltipClass="custom-tooltipnew"
                                                        aria-hidden="true"></i>
                                                </button>
                                            </td>
                                            <td style="text-align:center">
                                                <mat-icon style="color: black;cursor: pointer;"
                                                    (click)="fileDeletes(attach.file_id,i)">delete</mat-icon>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>

                            </div> -->
<!-- <tr>
                                <td>

                                   

                                </td>
                            </tr> -->
<!-- </div>
                  


                </div>

                <div class="modal-footer">
                    <button type="button"
                     class="btn btn-outline-primary" 
                     style="border-radius:40px;"
                      (click)="fileback()" 
                      id="create-ecf-0132">
                      Back
                    </button>
                </div>
            </div>
        </div>
    </div>
</div> -->




<div *ngIf="showimageHeaderPreview" id="create-ecf-0005" class="modal fade" aria-labelledby="my-modalLabel"
    aria-hidden="true" tabindex="-1" role="dialog" data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog modal-xl" data-dismiss="modal" style="width: 60%;height: 80%;">
        <div class="modal-content">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="create-ecf-0133">
                <span aria-hidden="true">&times;</span>
            </button>
            <div class="modal-body">
                <img src="{{jpgUrls}}" class="img-responsive" style="width: 100%;">

            </div>
        </div>
    </div>
</div>

<div *ngIf="showimageHeaderPreviewPDF" id="create-ecf-0006" class="modal fade" aria-labelledby="my-modalLabel"
    aria-hidden="true" tabindex="-1" role="dialog" data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header" style="background: rgba(23, 204, 23, 0.288);">
                <h2 class="modal-title"> ECF Attachments</h2>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="create-ecf-0134">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <pdf-viewer [src]="pdfurl" [original-size]="false" [render-text]='false' [show-borders]="true"
                [fit-to-page]="true" [show-all]="true" style="display: block; height: 600px;" [fit-to-page]="true">
            </pdf-viewer>
        </div>
    </div>
</div>

<div *ngIf="showecfupdate">
    <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true"
        aria-hidden="true" data-backdrop="static" data-keyboard="false" id="create-ecf-0007" data-keyboard="false"
        data-backdrop="static">
        <div class="modal-dialog modal-xl " style="width: 30%;">
            <div class="modal-content">
                <div class="modal-header text-center" style="background: rgba(23, 204, 23, 0.288);">
                    <h2 class="modal-title w-100 font-weight-bold"
                        style="color:black ;height:2px;font-family: 'Times New Roman', Times, serif;">ECF Updation
                    </h2>
                    <button type="button" class="close" #closedpaybutton data-dismiss="modal" aria-label="Close"
                        id="create-ecf-0135">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>

                <div style="margin-left: 70px;margin-right: 80%;margin-top: 2%; width: 80%;">


                    <form [formGroup]="ECFUpdateForm">
                        <table>
                            <div>

                                <tr>
                                    <td>
                                        <mat-form-field
                                            style="width:250px;font-family: 'Times New Roman', Times, serif;margin-left: 50px;">
                                            <mat-label>ECF Amount</mat-label>
                                            <input matInput formControlName="apamount" autocomplete="off"
                                                style="text-align:right"
                                                (keypress)="getCharCode($event);numberOnlyandDot($event, ECFUpdateForm.value.apamount)"
                                                (input)="ecfUpdatechangeToCurrency(apamount,'apamount')"
                                                (change)="filterAmount(apamount, 'apamounts')" #apamount required
                                                id="create-ecf-0136">
                                        </mat-form-field>
                                    </td>

                                </tr>
                            </div>
                        </table>

                        <tr>
                            <div style="margin-bottom: 3%;">
                                <td>
                                    <button type="submit"
                                        style="border-radius:40px;margin-left: 80px;font-family: 'Times New Roman', Times, serif;"
                                        class="btn btn-outline-success" (click)="ecfupdatesubmit()"
                                        id="create-ecf-0137">
                                        Submit</button>

                                </td>

                                <td>
                                    <button type="button"
                                        style="border-radius:40px;margin-left:10px;font-family: 'Times New Roman', Times, serif;"
                                        class="btn btn-outline-primary" (click)="ecfupdateback()" id="create-ecf-0138">
                                        Back</button>

                                </td>
                            </div>
                        </tr>
                    </form>
                </div>



            </div>
        </div>
    </div>
</div>

<div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true"
    aria-hidden="true" data-backdrop="static" data-keyboard="false" id="create-ecf-0146" data-keyboard="false"
    data-backdrop="static">
    <div class="modal-dialog modal-xl " style="width: 37%;">
        <div class="modal-content">
            <div class="modal-header text-center" style="background: rgba(23, 204, 23, 0.288);">
                <h2 class="modal-title w-100 font-weight-bold"
                    style="color:black ;height:2px;font-family: 'Times New Roman', Times, serif;">
                    Templates
                </h2>
                <button type="button" class="close" #closetempbutton data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div style="margin-left: 75px;margin-right: 70px;margin-top: 7%; margin-bottom: 7%;">
                <form [formGroup]="chooseTempForm">
                    <table>
                        <div>
                            <tr>
                                <td>
                                    <mat-form-field style="width: 200px;" (click)="getTemplates()">
                                        <input #templateInput placeholder="Select Template" matInput
                                            id="create-ecf-0151" formControlName="template"
                                            [matAutocomplete]="templatetype" required>
                                        <mat-autocomplete [panelWidth]="300" #templatetype="matAutocomplete"
                                            [displayWith]="displayFnTemplate" (opened)="templateScroll()">
                                            <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                            <ng-container *ngIf="!isLoading">
                                                <mat-option *ngFor="let temp of templatesList" [value]="temp"
                                                    (click)="templateSelect(temp)" matTooltip="{{temp.name}}"
                                                    matTooltipClass="custom-tooltipnew">
                                                    {{temp.name}}
                                                </mat-option>
                                            </ng-container>
                                        </mat-autocomplete>
                                    </mat-form-field>
                                </td>
                                <td>
                                    <button type="button" style="border-radius:40px;margin-left: 20px;"
                                        class="btn btn-outline-secondary" (click)="resetTemp()">
                                        Reset</button>
                                </td>
                                <td>
                                    <button type="submit" style="border-radius:40px;margin-left: 10px;"
                                        class="btn btn-outline-success" (click)="submitTemplate()">
                                        Submit</button>
                                    <!-- data-toggle="modal" data-target="#create-ecf-0152" -->
                                    <!-- data-toggle="modal" data-target="#create-ecf-0152" -->
                                </td>
                                <td>
                                    <button type="button" data-dismiss="modal"
                                        style="border-radius:40px;margin-left:10px;" class="btn btn-outline-primary"
                                        (click)="tempBack()">
                                        Back</button>
                                </td>
                            </tr>
                        </div>
                    </table>
                </form>
            </div>


        </div>
    </div>
</div>

<!-- <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true" aria-hidden="true" data-backdrop = "static" data-keyboard="false"
        id="create-ecf-0147">
        <div class="modal-dialog modal-xl " style="width: 35%;">
            <div class="modal-content">
                <div class="modal-header text-center" style="background: rgba(23, 204, 23, 0.288);">
                    <h2 class="modal-title w-100 font-weight-bold" style="color:black ;height:2px;font-family: 'Times New Roman', Times, serif;">
                        Create Template
                    </h2>
                    <button type="button" class="close" #closetempbutton data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div style="margin-left: 70px;margin-right: 70px;margin-top: 5%;margin-bottom: 5%;">
                   
                    <form [formGroup]="createTempForm">
                        <table>
                            <div>
                                <tr>
                                    <td>
                                        <mat-form-field style="width:150px;">
                                            <input matInput placeholder="Template Name" 
                                                formControlName="name" autocomplete="off">
                                        </mat-form-field>
                                    </td>
                                    <td>
                                        <button type="submit" data-dismiss="modal"
                                        style="border-radius:40px;margin-left: 50px;font-family: 'Times New Roman', Times, serif;"
                                        class="btn btn-outline-primary" (click)="submitCreateTemp()">
                                        Submit</button>
                                    </td>
                                    <td>
                                        <button type="button" data-dismiss="modal"
                                        style="border-radius:40px;margin-left:10px;margin-right:70px;font-family: 'Times New Roman', Times, serif;"
                                        class="btn btn-outline-primary" (click)="createtempBack()">
                                        Back</button>    
                                    </td>
                                </tr>
                            </div>
                        </table>
                    </form>
                </div>
               
                
            </div>
        </div>
</div> -->

<div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true"
    aria-hidden="true" data-backdrop="static" data-keyboard="false" id="create-ecf-0152">
    <div class="modal-dialog modal-lg ">
        <div class="modal-content">
            <div class="modal-header text-center">
                <h3> Invoice Header Details
                </h3>
                <button type="button" class="close" #closeInvHdrDet data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">

                <form [formGroup]="frmInvHdrDet">
                    <div>
                        <div *ngIf="this.ecfheaderForm?.value?.aptype != 3 && this.ecfheaderForm?.value?.aptype != 13">
                            <div style="display: flex;gap: 10px;">
                                <div id="matInput-size">
                                    <mat-form-field appearance="outline" (click)="getTemplates()">
                                        <mat-label>Select Template </mat-label>
                                        <input #templateInput matInput id="create-ecf-0151" formControlName="template"
                                            [matAutocomplete]="templatetype" required>
                                        <mat-autocomplete [panelWidth]="300" #templatetype="matAutocomplete"
                                            [displayWith]="displayFnTemplate" (opened)="templateScroll()">
                                            <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                            <ng-container *ngIf="!isLoading">
                                                <mat-option *ngFor="let temp of templatesList" [value]="temp"
                                                    (click)="templateSelect(temp)" matTooltip="{{temp.name}}"
                                                    matTooltipClass="custom-tooltipnew">
                                                    {{temp.name}}
                                                </mat-option>
                                            </ng-container>
                                        </mat-autocomplete>
                                    </mat-form-field>
                                </div>

                                <!-- <lib-vs-dynamicform-cmp
                                id="matInput-size"
                               [formGroup]="frmInvHdrDet"
                               [InputFields]="selecttemplate"
                               ></lib-vs-dynamicform-cmp> -->

                                <div id="matInput-size" *ngIf=" this.ecfheaderForm?.value?.aptype != 14">
                                    <mat-form-field appearance="outline">
                                        <mat-label>Invoice No</mat-label>
                                        <input matInput formControlName="invoiceno"  
                                        autocomplete="off" maxlength="16" required (keypress)="invNoFilter($event);" #invoiceno>
                                    </mat-form-field>
                                </div>
                                <div id="matInput-size" *ngIf="this.ecfheaderForm?.value?.aptype == 14">
                                    <mat-form-field appearance="outline">
                                        <mat-label>Acc No</mat-label>
                                        <input matInput formControlName="invoiceno" autocomplete="off" maxlength="16"
                                            required
                                            (change)="filterTexts(invoiceno, 'invoiceno',0, frmInvHdrDet);icrAccno(0,invoiceno,frmInvHdrDet)"
                                            #invoiceno>
                                    </mat-form-field>
                                </div>
                                <!-- <td *ngIf="this.ecftypeid == 7">
                                    <mat-form-field style="width:110px;">
                                        <input matInput placeholder="Credit Ref No" 
                                            formControlName="creditrefno" autocomplete="off"
                                            (change)="filterTexts(creditrefno, 'creditrefno',i)" #creditrefno>
                                    </mat-form-field>
                                </td>
                                <td *ngIf="this.ecftypeid == 7">
                                    <mat-form-field style="width:110px;">
                                        <input matInput placeholder="Invoice CR No" 
                                            formControlName="refinv_crno" autocomplete="off"
                                            (change)="filterTextsunder(refinv_crno, 'refinv_crno',i)" #refinv_crno>
                                    </mat-form-field>
                                </td> -->

                                <div id="matInput-size">
                                    <mat-form-field appearance="outline">
                                        <mat-label>Date</mat-label>
                                        <input matInput [matDatepicker]="picker1" placeholder="Date"
                                            (dateChange)="onDateChange($event)" required formControlName="invoicedate"
                                            [max]="tomorrow" readonly>
                                        <mat-datepicker-toggle matSuffix [for]="picker1">
                                        </mat-datepicker-toggle>
                                        <mat-datepicker #picker1></mat-datepicker>
                                    </mat-form-field>
                                </div>
                                <!-- <td>
                                    <mat-form-field style="margin-left: 20px;">
                                        <mat-label *ngIf="this.ecftypeid == 7">CRN Total Amount</mat-label>
                                        <mat-label *ngIf="this.ecftypeid != 7">Invoice Amount</mat-label>
                                        <input matInput style="text-align: right;" formControlName="totalamount" autocomplete="off" 
                                            (keypress)="getCharCode($event);numberOnlyandDot($event, this.frmInvHdrDet.value.totalamount)" 
                                            (input)="invhdrTempChngeToCurrency(totalamount ,'totalamount')" 
                                            #totalamount (focusout)="invamount(0,totalamount, frmInvHdrDet)" (change)="invhdramtDecimalChg(totalamount ,'totalamount',0, frmInvHdrDet)">
                                    </mat-form-field>
                                </td> -->
                            </div>
                            <div style="display: flex;gap: 10px;">
                                <div id="matInput-size">
                                    <mat-form-field appearance="outline">
                                        <mat-label *ngIf="this.ecftypeid == 7">CRN Total Amount</mat-label>
                                        <mat-label *ngIf="this.ecftypeid != 7">Invoice Amount</mat-label>
                                        <input matInput style="text-align: right;" formControlName="totalamount"
                                            autocomplete="off" appCleardirective
                                            (keypress)="getCharCode($event);numberOnlyandDot($event, this.frmInvHdrDet.value.totalamount)"
                                            (input)="invhdrTempChngeToCurrency(totalamount ,'totalamount')" required
                                            #totalamount (focusout)="invamount(0,totalamount, frmInvHdrDet)"
                                            (change)="invhdramtDecimalChg(totalamount ,'totalamount',0, frmInvHdrDet)">
                                    </mat-form-field>
                                </div>
                                <div id="matInput-size">
                                    <mat-form-field appearance="outline">
                                        <mat-label>Taxable Amount </mat-label>
                                        <input matInput style="text-align:right" required
                                            formControlName="invoiceamount" #invoiceamount appCleardirective
                                            (change)="invhdramtDecimalChg(invoiceamount ,'invoiceamount',0, frmInvHdrDet)"
                                            (keypress)="getCharCode($event);numberOnlyandDot($event, this.frmInvHdrDet.value.invoiceamount)"
                                            (input)="invhdrTempChngeToCurrency(invoiceamount ,'invoiceamount')"
                                            (ngModelChange)="taxableAmount($event,0,invoiceamount, frmInvHdrDet)"
                                            (focusout)="taxableAmount1(0,invoiceamount, frmInvHdrDet )">
                                    </mat-form-field>
                                </div>

                                <div style="border:0px">
                                    <!-- <input #fileInput type="file" multiple style="width: 108px;" hidden   (change)="getFileDetails(-1,$event)">
                                    <i (click)="fileInput.click()"  class="fa fa-cloud-upload" matTooltip="Upload file"
                                     matTooltipClass="custom-tooltipnew" aria-hidden="true" style="font-size: 25px;color: blue;margin-top: 10px;"></i> -->
                                    <i (click)="UploadPopupOpen(-1)" class="fa fa-cloud-upload" matTooltip="Upload file"
                                        matTooltipClass="custom-tooltipnew" aria-hidden="true"
                                        style="font-size: 25px;color: blue;margin-top: 10px;"></i><label
                                        style="color:red;margin-left: 5px;">*</label>
                                    <!-- data-target="#copyfilepopup" data-toggle="modal" -->
                                </div>
                                <div style="border:0px" *ngIf="frmInvHdrDet.value?.filevalue?.length > 0">
                                    <i matTooltip="view" matTooltipClass="custom-tooltipnew" class=" fa fa-eye create "
                                        (click)="getfiledetails(frmInvHdrDet, 0, 'frmInvHdrDet')"
                                        style="cursor: pointer;color:blue;margin-top:17px">
                                        <!-- data-target="#create-ecf-0004" data-toggle="modal" -->
                                    </i>
                                </div>
                            </div>

                            <!-- <div style="display: flex;gap: 10px;">
                                  <div style="border:0px">
                                  <input #fileInput type="file" multiple style="width: 108px;" hidden   (change)="getFileDetails(-1,$event)">  
                                  <i (click)="fileInput.click()"  class="fa fa-cloud-upload" matTooltip="Upload file"
                                   matTooltipClass="custom-tooltipnew" aria-hidden="true" style="font-size: 25px;color: blue;margin-top: 10px;"></i>
                                    </div>
                                    <div style="border:0px" *ngIf="frmInvHdrDet.value?.filevalue?.length > 0">
                                   
                                        <div>
                                        <i matTooltip="view" matTooltipClass="custom-tooltipnew" class=" fa fa-eye create "
                                        (click)="getfiledetails(frmInvHdrDet, 0, 'frmInvHdrDet')"
                                       style="cursor: pointer;color:blue;margin-left: 5px;margin-top:15px">
                                       data-target="#create-ecf-0004" data-toggle="modal" -->
                            <!-- </i>
                                    </div>
                                  </div>
                                </div> -->

                        </div>
                        <div *ngIf="this.ecfheaderForm?.value?.aptype == 3 || this.ecfheaderForm?.value?.aptype == 13">
                            <div style="display: flex;gap: 10px;">
                                <div id="matInput-size">
                                    <mat-form-field appearance="outline" (click)="getTemplates()">
                                        <mat-label>Select Template</mat-label>
                                        <input #templateInput placeholder="Select Template" matInput
                                            id="create-ecf-0151" formControlName="template"
                                            [matAutocomplete]="templatetype" required>
                                        <mat-autocomplete [panelWidth]="300" #templatetype="matAutocomplete"
                                            [displayWith]="displayFnTemplate" (opened)="templateScroll()">
                                            <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                            <ng-container *ngIf="!isLoading">
                                                <mat-option *ngFor="let temp of templatesList" [value]="temp"
                                                    (click)="templateSelect(temp)" matTooltip="{{temp.name}}"
                                                    matTooltipClass="custom-tooltipnew">
                                                    {{temp.name}}
                                                </mat-option>
                                            </ng-container>
                                        </mat-autocomplete>
                                    </mat-form-field>
                                </div>

                                <!-- <lib-vs-dynamicform-cmp
                                id="matInput-size"
                               [formGroup]="frmInvHdrDet"
                               [InputFields]="selecttemplate"
                               ></lib-vs-dynamicform-cmp> -->

                                <div id="matInput-size">
                                    <mat-form-field appearance="outline">
                                        <mat-label>Invoice Amount</mat-label>
                                        <input matInput style="text-align: right;" formControlName="totalamount"
                                            autocomplete="off" appCleardirective
                                            (keypress)="getCharCode($event);numberOnlyandDot($event, this.frmInvHdrDet.value.totalamount)"
                                            (input)="invhdrTempChngeToCurrency(totalamount ,'totalamount')" required
                                            #totalamount (focusout)="invamount(0,totalamount, frmInvHdrDet)"
                                            (change)="invhdramtDecimalChg(totalamount ,'totalamount',0, frmInvHdrDet)">
                                    </mat-form-field>
                                </div>
                                <div id="matInput-size" *ngIf="this.ecftypeid != 14">
                                    <mat-form-field appearance="outline">
                                        <mat-label>Taxable Amount </mat-label>
                                        <input matInput style="text-align:right" required
                                            formControlName="invoiceamount" #invoiceamount appCleardirective
                                            (change)="invhdramtDecimalChg(invoiceamount ,'invoiceamount',0, frmInvHdrDet)"
                                            (keypress)="getCharCode($event);numberOnlyandDot($event, this.frmInvHdrDet.value.invoiceamount)"
                                            (input)="invhdrTempChngeToCurrency(invoiceamount ,'invoiceamount')"
                                            (ngModelChange)="taxableAmount($event,0,invoiceamount, frmInvHdrDet)"
                                            (focusout)="taxableAmount1(0,invoiceamount, frmInvHdrDet )">
                                    </mat-form-field>
                                </div>

                            </div>
                            <div>
                                <div style="display: flex;gap: 10px;">
                                    <div style="border:0px">
                                        <i (click)="UploadPopupOpen(-1)" class="fa fa-cloud-upload"
                                            matTooltip="Upload file" matTooltipClass="custom-tooltipnew"
                                            aria-hidden="true"
                                            style="font-size: 25px;color: blue;margin-top: 10px;"></i><label
                                            style="color:red;margin-left: 5px;">*</label>
                                        <!-- data-target="#copyfilepopup" data-toggle="modal" -->
                                    </div>
                                    <div style="border:0px" *ngIf="frmInvHdrDet.value?.filevalue?.length > 0">
                                        <div>
                                            <i matTooltip="view" matTooltipClass="custom-tooltipnew"
                                                class=" fa fa-eye create "
                                                (click)="getfiledetails(frmInvHdrDet, 0, 'frmInvHdrDet')"
                                                style="cursor: pointer;color:blue;margin-top:17px">
                                                <!-- data-target="#create-ecf-0004" data-toggle="modal" -->
                                            </i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="submit" style="border-radius:40px;" class="btn btn-outline-success"
                    (click)="submitInvHdrTemp()">
                    Submit</button>

                <button type="button" style="border-radius:40px;" class="btn btn-outline-secondary"
                    (click)="resetInvHdrTemp()">
                    Reset</button>

                <button type="button" data-dismiss="modal" style="border-radius:40px;" class="btn btn-outline-primary"
                    (click)="invHdrDetBack()">
                    Back</button>
            </div>
        </div>


    </div>
</div>


<div class="modal
 fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true" data-keyboard="false"
    data-backdrop="static" id="create-ecf-0004">
    <div class="modal-dialog modal-lg " style="width: 60%;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Attachments
                </h3>
                <button type="button" class="close" data-dismiss="modal" #closesbuttons aria-label="Close"
                    id="create-ecf-0130">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" style="padding:2rem">

                <div class="row">
                    <div class="table-responsive">
                        <h3>Currently Attached Files</h3>
                        <!-- <lib-vs-cbox-summary
                                [SummaryDetails]="SummaryCurrentlyAttechedFiles"
                                [SummaryApiObj]="SummaryApiCurrentlyAttechedFilesObjNew"
                              ></lib-vs-cbox-summary> -->
                    <!-- <div class="comp-table t-resposive t-bdr-line t-HoverZoom" id="summary-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>S.No</th>
                                    <th>Document Type</th>
                                    <th>File Name</th>
                                    <th>Delete</th>
                                </tr>
                            </thead>
                            <tbody>
                                <ng-container *ngFor="let type of uploadFileTypes; let ind = index">
                                    <tr *ngFor="let files of file_process_data[type]; let index = index">
                                        <td>
                                            {{ind+1}}.{{index+1}}
                                        </td>
                                        <td>
                                            {{type}}
                                        </td>
                                        <td  style="width: 303px;">
                                            <div  style="width: 300px;overflow: hidden" matTooltip="{{files?.name}}" matTooltipClass="custom-tooltipnew">
                                                {{files?.name}}
                                            </div>
                                        </td>
                                        <td style="text-align: left;color:red">
                                            <span *ngIf="this.invhdrForm != 'frmInvHdrDet'"
                                                (click)="deletefileUpload(InvoiceHeaderForm?.value?.invoiceheader[this.fileindex], index, type)"
                                                [class.disabled]="readinvhdrdata != false">
                                                <mat-icon matTooltip="Delete" matTooltipClass="custom-tooltipnew" style="font-size: 18px;">delete
                                                </mat-icon>
                                            </span>
                                            <span *ngIf="this.invhdrForm == 'frmInvHdrDet'"
                                                (click)="deletefileUpload('frmInvHdrDet',index, type)">
                                                <mat-icon matTooltip="Delete" matTooltipClass="custom-tooltipnew">delete
                                                </mat-icon>
                                            </span>
                                        </td>
                                    </tr>
                                </ng-container>

                            </tbody>
                        </table>
                    </div>
                     <div class="row" *ngIf="isPymtAdvpage" style="width:85%">
            <div class="col-sm-9" style="margin-bottom: 5%;font-size: small;text-align:right;left: 42%">
                <mat-paginator (page)="handlePymtAdvPageEvent($event)" [length]="length_PymtAdv"
                    [pageSize]="pagesize_PymtAdv" [showFirstLastButtons]="showFirstLastButtons"
                    [pageSizeOptions]="pageSizeOptions" [pageIndex]="pageIndexPymtAdv" [hidePageSize]="true"
                    aria-label="Select page">
                </mat-paginator>
            </div>
            <div class="col-sm-3"
                style="margin-bottom: 0%;font-size: small;text-align: right;margin-top: 18px;left: -15%;font-weight:bold">
                Page: {{pymtAdvpresentpage}}
            </div>
        </div> -->

        <div class="comp-table t-resposive t-bdr-line t-HoverZoom" id="summary-table">
            <table>
                <thead>
                <tr>
                    <th>S.No</th>
                    <th>Document Type</th>
                    <th>File Name</th>
                    <th>Delete</th>
                </tr>
                </thead>
                <tbody>
                <tr *ngFor="let row of pagedFiles; let i = index">
                    <td>{{ (pageIndexPymtAdv * pagesize_PymtAdv) + (i + 1) }}</td>
                    <td>{{ row.type }}</td>
                    <td style="width: 303px;">
                    <div style="width: 300px; overflow: hidden"
                        matTooltip="{{ row.file?.name }}"
                        matTooltipClass="custom-tooltipnew">
                        {{ row.file?.name }}
                    </div>
                    </td>
                    <td style="text-align: left;color:red">
                    <span *ngIf="this.invhdrForm != 'frmInvHdrDet'"
                            (click)="deletefileUpload(InvoiceHeaderForm?.value?.invoiceheader[this.fileindex], i, row.type)"
                            [class.disabled]="readinvhdrdata != false">
                        <mat-icon matTooltip="Delete" matTooltipClass="custom-tooltipnew" style="font-size: 18px;">delete</mat-icon>
                    </span>
                    <span *ngIf="this.invhdrForm == 'frmInvHdrDet'"
                            (click)="deletefileUpload('frmInvHdrDet', i, row.type)">
                        <mat-icon matTooltip="Delete" matTooltipClass="custom-tooltipnew">delete</mat-icon>
                    </span>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <!-- paginator -->
        <div  *ngIf="isPymtAdvpage">
            <!-- <div class="col-sm-9"> -->
                <mat-paginator (page)="handlePymtAdvPageEvent($event)"
                            [length]="length_PymtAdv"
                            [pageSize]="pagesize_PymtAdv"
                            [pageSizeOptions]="pageSizeOptions"
                            [pageIndex]="pageIndexPymtAdv"
                            aria-label="Select page" [hidePageSize]="true" >
                            <!-- [showFirstLastButtons]="showFirstLastButtons" -->
                </mat-paginator>
            <!-- </div>
            <div class="col-sm-3">
                Page: {{ pymtAdvpresentpage }}
            </div> -->
        </div>
                        <!-- <div
                                *ngFor="let files of InvoiceHeaderForm?.value?.invoiceheader[this.fileindex]?.filevalue; let index = index">
                                <p (click)="filepreview(files)" data-toggle="modal"
                                    data-target="#my-modalpreview"
                                    style="color: #0000EE;cursor: pointer;">
                                    {{index+1}}.{{files?.name}} </p>
                                <span
                                    (click)="deletefileUpload(InvoiceHeaderForm?.value?.invoiceheader[this.fileindex],index)"
                                    [class.disabled]="readinvhdrdata != false">
                                    <mat-icon matTooltip="Delete">delete
                                    </mat-icon>
                                </span>
                            </div> -->
                        <div *ngIf="this.invhdrForm != 'frmInvHdrDet'">

                        </div>
                        <h3>Previously Attached Files</h3>
                        <lib-vs-cbox-summary [SummaryDetails]="SummarypreviousAttechedFiles"
                            [SummaryApiObj]="SummaryApipreviouslyAttechedFilesObjNew"></lib-vs-cbox-summary>
                        <!-- <table class="table table-bordered" fixed-header style="width: 99%;margin-top: 10px;">
                                    <thead class="table_header" style="text-align: left;">
                                        <tr>
                                            <th style="text-align: center;">S.No</th>
                                            <th style="text-align: center;">Document Type</th>
                                            <th style="text-align: center;">File Name</th>
                                            <th style="text-align: center;">Action</th>
                                            <th style="text-align: center;">Delete </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let attach of filedatas; index as i">
                                            <td style="text-align: center;">{{i+1}}</td>
                                            <td>{{attach.document_type}}</td>
                                            <td>{{attach.file_name}}</td>
                                            <td style="text-align: center;" >
                                                <button type="button" class="btn btn-outline-primary"
                                                matTooltip="View / Open" matTooltipClass="custom-tooltipnew" 
                                                (click)="data1(attach)"
                                                style="border-radius:40px;color: mediumblue;">
                                                <i class=" fa fa-arrow-right "
                                               style="cursor: pointer;color:blue;"></i>
                                               </button>
                                            </td> -->
                        <!-- <td style="text-align: center;color:blue;">
                                            <div matTooltip="View" class="fa fa-arrow-up" aria-hidden="true" 
                                                data-toggle="modal"
                                                (click)="data(attach.file_id)" >
                                            
                                            </div>
                                            </td> -->
                        <!-- <td style="text-align: center;">
                                                <button class="btn btn-outline-primary" type="submit"
                                                    (click)="getfiles(attach)"
                                                    style="border-radius:40px;margin-left: 15px;" color="primary" id="create-ecf-0131">
                                                    <i matTooltip="Download" matTooltipClass="custom-tooltipnew" class="fa fa-download" matTooltipClass="custom-tooltipnew"
                                                        aria-hidden="true"></i>
                                                </button>
                                            </td> -->
                        <!-- <td style="text-align:center">
                                                <mat-icon style="color: black;cursor: pointer;"
                                                    (click)="fileDeletes(attach.file_id,i)">delete</mat-icon>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>  -->
                    </div>
                    <!-- <tr>
                                <td>
                                   
                                </td>
                            </tr> -->
                </div>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline-primary" style="border-radius:40px;" (click)="fileback()"
                    id="create-ecf-0132" data-dismiss="modal">
                    Back
                    <!-- data-target="#create-ecf-0152" data-toggle="modal" -->
                </button>
            </div>
        </div>
    </div>
</div>
<!-- <div *ngIf="showTempInvHdrForm">
    
</div> -->

<!-- <div *ngIf="uploadPopShow"> -->
<div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true"
    data-keyboard="false" data-backdrop="static" id="copyfilepopup">
    <div class="modal-dialog modal-lg ">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Upload File
                </h3>
                <button type="button" class="close" data-dismiss="modal" #closedbuttons aria-label="Close"
                    id="create-ecf-0140">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>


            <div class="modal-body" *ngIf="uploadPopShow">
                <div class="table-responsive">
                    <div class="comp-table t-resposive t-bdr-line t-HoverZoom" id="summary-table">
                    <table>
                        <thead>
                            <tr>
                                <th>S.No</th>
                                <th>Document Type</th>
                                <th>Upload</th>
                                <th>Selected Files</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let type of uploadFileTypes; let index = index">
                                <td>{{index+1}}</td>
                                <td>
                                    {{type}}
                                </td>
                                <td>
                                    <input #fileInput id="create-ecf-0002" type="file" multiple style="width: 108px;"
                                        hidden (change)="getFileDetails( $event, type)">
                                    <i (click)="fileInput.click()" class="fa fa-cloud-upload" matTooltip="Upload file"
                                        matTooltipClass="custom-tooltipnew" aria-hidden="true"
                                        style="font-size: 18px;color: blue;"></i>
                                </td>
                                <td  style="width: 303px;">
                                    <div *ngFor="let file of file_process_data2[type]; let j = index"
                                    style="border: 0cm;width: 300px;overflow: hidden" matTooltip="{{file.name}}"
                                     matTooltipClass="custom-tooltipnew">
                                        <div>{{j+1}}.{{file.name}}</div>
                                    </div>
                                </td>
                            </tr>

                        </tbody>
                    </table>
                    </div>
                </div>

            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-outline-success" style="border-radius:40px;
                        " (click)="uploadSubmit()" data-target="#create-ecf-0152" data-toggle="modal"
                    id="create-ecf-0153">Submit</button>
                <button type="button" class="btn btn-outline-primary" style="border-radius:40px;
                         " (click)="uploadback()">Back</button>
            </div>


        </div>
    </div>
</div>
<!-- </div> -->
<div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true"
    data-keyboard="false" data-backdrop="static" id="fileUploaddpopup">
    <div class="modal-dialog modal-lg ">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Upload File
                </h3>
                <button type="button" class="close" data-dismiss="modal" #uploadclose aria-label="Close"
                    id="create-ecf-0140">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>


            <div class="modal-body">
                <div class="table-responsive">
                    <div class="comp-table t-resposive t-bdr-line t-HoverZoom" id="summary-table">
                    <table>
                        <thead>
                            <tr>
                                <th>S.No</th>
                                <th>Document Type</th>
                                <th>Upload</th>
                                <th>Selected Files</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let type of uploadFileTypes; let index = index">
                                <td>{{index+1}}</td>
                                <td>
                                    {{type}}
                                </td>
                                <td>
                                    <input #fileInput id="create-ecf-0002" type="file" multiple style="width: 108px;"
                                        hidden (change)="getFileDetails( $event, type)">
                                    <i (click)="fileInput.click()" class="fa fa-cloud-upload" matTooltip="Upload file"
                                        matTooltipClass="custom-tooltipnew" aria-hidden="true"
                                        style="font-size:18px;color: blue;cursor: pointer;"></i>
                                </td>
                                <td  style="width: 303px;">
                                    <div *ngFor="let file of file_process_data2[type]; let j = index"
                                    style="border: 0cm;width: 300px;overflow: hidden" matTooltip="{{file.name}}"
                                     matTooltipClass="custom-tooltipnew">
                                        <div>{{j+1}}.{{file.name}}</div>
                                    </div>
                                </td>
                            </tr>

                        </tbody>
                    </table>
                    </div>
                </div>

            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-outline-success" style="border-radius:40px;margin-left:40%;
                        margin-bottom: 20px; " (click)="uploadSubmit()" id="create-ecf-0153">Submit</button>
                <button type="button" class="btn btn-outline-primary" style="border-radius:40px;margin-left:10px;
                        margin-bottom: 20px; " data-dismiss="modal" (click)="uploadback()">Back</button>
            </div>


        </div>
    </div>
</div>
<!-- ------------- -->

<!-- <ngx-spinner bdColor="rgba(51, 51, 51, 0.8)" size="default" [fullScreen]="true" type="ball-spin-clockwise">
    <p style="color: white">Please Wait. </p>
</ngx-spinner> -->

<!-- <pre>{{InvoiceHeaderForm.value|json}}</pre> -->