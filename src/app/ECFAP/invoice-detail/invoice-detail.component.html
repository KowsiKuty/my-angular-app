<section>
    <div>
        <div *ngIf="modificationFlag == 'modification'">
            <h3>AP Modification </h3>
        </div>
        <div>
            <div *ngIf="showinvoicediv">
                <header class="header-adjust">
                    <div class="headingalign">
                        <i class="fa fa-arrow-left" aria-hidden="true" (click)="overallback()"></i>
                        <!-- Invoice & Credit Details -->
                         <div *ngIf="this.aptypeid == 4 ">
                            <h3 *ngIf="movedata == 'ECF'">Invoice Header ({{crno}})</h3>
                            <h3 *ngIf="movedata != 'ECF'">Invoice Header ({{crno}})</h3> 
                        </div>

                         <div *ngIf="!showPOdiv && this.aptypeid !=4">
                            <h3 *ngIf="movedata == 'ECF'">Invoice Header ({{crno}})</h3>
                            <h3 *ngIf="movedata != 'ECF'">Invoice Header ({{crno}})</h3>
                        </div>
                        <div *ngIf="showPOdiv">
                            <h3 *ngIf="movedata == 'ECF'">Invoice Header ({{crno}})</h3>
                            <h3 *ngIf="movedata != 'ECF'">Invoice Header ({{crno}})</h3>
                        </div>
                        <button *ngIf="movedata != 'ECF' && movedata != 'apapproverview'" mat-icon-button
                            matTooltip=" Edit" matTooltipClass="custom-tooltipnew" class="iconbutton"
                            color="primary" (click)="showinvhededit()" id="invoice-detail-0023">
                            <mat-icon [ngClass]="inveditFlag ==false ? 'edit_disabled' : 'edit_enabled'"
                                aria-label="Edit">edit</mat-icon>
                        </button>

                    </div>
                    <!-- <strong>{{movedata}}</strong> -->
                    <!-- <div class="button-div">
                        <button *ngIf="movedata == 'ECF' && !showPOdiv" type="button" style="border-radius:40px"
                            class="btn btn-outline-success" (click)="InvoiceFormSubmit()" [disabled]="submitoverallbtn"
                            id="invoice-detail-0166">

                            Submit
                        </button>

                         <button type="button"
                    style="border-radius:40px;"
                    class="btn btn-outline-primary" (click)="overallback()" id="invoice-detail-0167">
                    Back</button> -->

                    <!-- <button type="button" *ngIf="movedata == 'AP' && !showPOdiv" style="border-radius:40px;"
                            class="btn btn-outline-success" (click)="OverallAPFormSubmit()" id="invoice-detail-0169">
                            Submit
                        </button>

                        <button *ngIf="movedata == 'apapproverview'" type="button" style="border-radius:40px;"
                            class="btn btn-outline-success" (click)="approverpopup()" id="invoice-detail-0172">
                            Approve & Pay</button>
                        <button *ngIf="movedata == 'apapproverview'" type="button" style="border-radius:40px;"
                            class="btn btn-outline-success" (click)="modify()" id="invoice-detail-0172">
                            Modify</button>
                        <button *ngIf="movedata == 'apapproverview'" type="button" style="border-radius:40px;"
                            class="btn btn-outline-success" (click)="reauditappopup()" id="invoice-detail-0173">
                            Re-Audit</button>

                    </div> -->
                    <div class="button-div">
                        <button *ngIf="movedata == 'ECF' && !showPOdiv" type="button" style="border-radius:40px"
                            class="btn btn-outline-success" (click)="InvoiceFormSubmit()" [disabled]="submitoverallbtn"
                            id="invoice-detail-0166">

                            Submit
                        </button>

                        <!-- <button type="button"
                        style="border-radius:40px;"
                        class="btn btn-outline-primary" (click)="overallback()" id="invoice-detail-0167">
                        Back</button> -->
                        <button type="button" *ngIf="movedata == 'AP' && !showPOdiv" style="border-radius:40px;"
                            class="btn btn-outline-success" (click)="OverallAPFormSubmit()" id="invoice-detail-0169">
                            Submit
                        </button>
                        <button *ngIf="movedata == 'apapproverview'" type="button" style="border-radius:40px;"
                            class="btn btn-outline-success" (click)="approverpopup()" id="invoice-detail-0172">
                            Approve & Pay</button>
                        <button *ngIf="movedata == 'apapproverview'" type="button" style="border-radius:40px;"
                            class="btn btn-outline-success" (click)="modify()" id="invoice-detail-0172">
                            Modify</button>
                        <button *ngIf="movedata == 'apapproverview'" type="button" style="border-radius:40px;"
                            class="btn btn-outline-success" (click)="reauditappopup()" id="invoice-detail-0173">
                            Re-Audit</button>

                    </div>
                </header>
                <div *ngIf="this.aptypeid == 4">
                    <div *ngIf="movedata == 'ECF'" style="text-align: end;">
                        <!-- <h3> Invoice Header ({{crno}})
                        </h3> -->
                        <i class="fa fa-clock-o" matTooltip="View Transaction" style="font-size: 28px; cursor: pointer"
                            aria-hidden="true" (click)="viewtrn()"></i>
                    </div>
                    <div *ngIf="movedata != 'ECF'" style="text-align: end;">
                        <!-- <h3> Invoice Header ({{crno}})
                        </h3> -->
                        <i class="fa fa-clock-o" matTooltip="View Transaction" style="font-size: 28px; cursor: pointer"
                            aria-hidden="true" (click)="viewtrn()"></i>
                    </div>
                </div>
                <div *ngIf="!showPOdiv && this.aptypeid !=4">
                    <div *ngIf="movedata == 'ECF'" style="text-align: end;">
                        <!-- <h3> Invoice Header ({{crno}})
                        </h3> -->
                        <i class="fa fa-clock-o" matTooltip="View Transaction" style="font-size: 28px; cursor: pointer"
                            aria-hidden="true" (click)="viewtrn()"></i>
                    </div>
                    <div *ngIf="movedata != 'ECF'" style="text-align: end;">
                        <!-- <h3> Invoice Header ({{crno}})
                        </h3> -->
                        <i class="fa fa-clock-o" matTooltip="View Transaction" style="font-size: 28px; cursor: pointer"
                            aria-hidden="true" (click)="viewtrn()"></i>
                    </div>
                </div>

                <div *ngIf="inveditFlag == false && this.movedata != 'AP'">
                    <mat-accordion>
                        <mat-expansion-panel [expanded]="true" class="expansion-conatiner">
                            <mat-expansion-panel-header>
                                <!-- <h3 class="component-title ">Tour</h3> -->
                                <!-- <h3 class="expansion-title mb-0">Invoice Header</h3> -->
                            </mat-expansion-panel-header>
                            <div class="expansition-div">
                                <div>
                                    <!-- <h3 class="expansion-title mb-0">Invoice Details</h3> -->
                                    <div class="card-container">
                                        <div class="card-view">
                                            <div class="card-point">
                                                <h4 id="invoice-detail-0024">Raiser Name</h4>
                                                <p>{{ this.viewrsrEmp }}</p>
                                            </div>
                                            <div class="card-point">
                                                <h4 id="invoice-detail-0025">Branch</h4>
                                                <p>{{ this.viewrsrBr }}</p>
                                            </div>
                                            <div class="card-point">
                                                <h4 id="invoice-detail-0026">Branch GST</h4>
                                                <p>{{ this.viewbranchGST }}</p>
                                            </div>
                                            <div *ngIf="this.invHdrRes?.pmd_data != undefined" class="card-point">
                                                <h4 id="invoice-detail-0027">PMD Location</h4>
                                                <p>{{ this.viewpmd }}</p>
                                            </div>
                                            <div class="card-point">
                                                <h4 id="invoice-detail-0028">ECF Type</h4>
                                                <p>{{ this.viewecftypeText }}</p>
                                            </div>
                                            <div *ngIf="this.invHdrRes?.pmd_data == undefined" class="card-point">
                                                <h4 id="invoice-detail-0029">Purpose</h4>
                                                <p>{{ this.viewremarks }}</p>
                                            </div>
                                            <div *ngIf="this.aptypeid != 13 && this.aptypeid != 14" class="card-point">
                                                <h4 id="invoice-detail-0030">Invoice No</h4>
                                                <p>{{ this.viewinvoiceno }}</p>
                                            </div>
                                            <div *ngIf="this.aptypeid == 14" class="card-point">
                                                <h4 id="invoice-detail-0302">Account No</h4>
                                                <p>{{ this.viewinvoiceno }}</p>
                                            </div>
                                            <div class="card-point">
                                                <h4 id="invoice-detail-0031">Date</h4>
                                                <p>{{ this.viewinvoicedate | date : "dd-MMM-yyyy" }}</p>
                                            </div>
                                            <div class="card-point">
                                                <h4 id="invoice-detail-0032">Invoice Amount</h4>
                                                <p>{{ this.viewtotalamount }}</p>
                                            </div>
                                            <div class="card-point">
                                                <h4 id="invoice-detail-0033">Taxable Amount</h4>
                                                <p>{{ this.viewinvoiceamount }}</p>
                                            </div>
                                            <div class="card-point">
                                                <h4 id="invoice-detail-0034">Commodity Name</h4>
                                                <p>{{ this.viewcommodity_id }}</p>
                                            </div>
                                            <!-- <div> -->
                                            <!-- *ngIf="show_view_card" -->
                                            <!-- <mat-expansion-panel-header> -->
                                            <!-- <h3 class="component-title ">Tour</h3> -->
                                            <!-- <h3 class="expansion-title mb-0">Supplier Details</h3> -->
                                            <!-- </mat-expansion-panel-header> -->
                                            <!-- <div class="card-container"> -->
                                            <!-- <div class="card-view"> -->
                                            <div class="card-point" *ngIf="paytoid =='S'">
                                                <h4 id="invoice-detail-0035">Supplier</h4>
                                                <div>
                                                    <p>{{ this.viewsupplier }}
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="card-point" *ngIf="paytoid =='S'">
                                                <h4 id="invoice-detail-0037">Supplier GST</h4>
                                                <div>
                                                    <p>{{ this.viewsuppliergst }}
                                                        <i class="fa fa-check-circle"
                                                            *ngIf="!SupGSTChecked && movedata != 'ECF'  && inveditFlag"
                                                            style="font-size:36px;color:darkblue;cursor: pointer;"
                                                            matTooltip="validate" matTooltipClass="custom-tooltipnew"
                                                            (click)="suppGstValidChk()"></i>
                                                        <i *ngIf="SupGSTChecked && movedata != 'ECF'" matTooltip="View "
                                                            matTooltipClass="custom-tooltipnew"
                                                            class=" fa fa-eye create " (click)="supplier_popup()"
                                                            data-toggle="modal" style="cursor: pointer;color:blue;">
                                                        </i>
                                                        <!-- data-target="invoice-detail-0303" -->
                                                    </p>
                                                </div>
                                                <button type="button" class="btn btn-outline-primary"
                                                    matTooltip="Select Supplier" matTooltipClass="custom-tooltipnew"
                                                    *ngIf="aptypeid == 14 && inveditFlag" (click)="getsuppindex()"
                                                    style="border-radius: 40px; margin-left: 10px"
                                                    id="invoice-detail-0036">
                                                    <!-- data-toggle="modal"
                           data-target="#invoice-detail-0022" -->
                                                    <i class="fa fa-arrow-up"></i>
                                                </button>
                                            </div>
                                            <div class="card-point" *ngIf="movedata == 'ECF' && paytoid =='S'">
                                                <h4 id="invoice-detail-0038">Invoice Status</h4>
                                                <p>{{ this.viewstatus }}</p>
                                            </div>
                                            <div class="card-point" *ngIf="movedata != 'ECF'">
                                                <h4 id="invoice-detail-0039">Physical Verification</h4>
                                                <p>{{ this.viewphysical_verif }}</p>
                                            </div>
                                            <div class="card-point" *ngIf="this.aptypeid == 2">
                                                <h4 id="invoice-detail-0040">Is PCA</h4>
                                                <p>{{ this.viewis_pca }}</p>
                                            </div>
                                            <div class="card-point" *ngIf="this.aptypeid == 2 && (PCAyesno == 1 || frmInvHdr.get('is_recur').value ==1)">
                                                <h4 id="invoice-detail-0041">PCA No</h4>
                                                <div style="display: flex;gap: 10px;">
                                                    <p>{{ this.viewpca_no }}</p>
                                                    <i class="fa fa-info-circle" style="font-size:20px;color:#0077ff"
                                                        *ngIf="this.PCA_Det.length >0"
                                                        matTooltip="{{PCA_Det[0]?.pca_no}} - {{PCA_Det[0]?.balance_amount}}"
                                                        matTooltipClass="custom-tooltipnew"></i>
                                                </div>
                                            </div>
                                            <div class="card-point">
                                                <h4 id="invoice-detail-0042">Is Recurring</h4>
                                                <p>{{ this.viewis_recur }}</p>
                                            </div>
                                            <div class="card-point" *ngIf="frmInvHdr.get('is_recur').value ==1">
                                                <h4 id="invoice-detail-0043">Recurring Type</h4>
                                                <p>{{ this.viewservice_type }}</p>
                                            </div>
                                            <!-- <div class="card-point" *ngIf="frmInvHdr.get('is_recur').value ==0">
                                                <h4 id="invoice-detail-0044">Recurring Type</h4>
                                                <p>{{ this.viewservice_type }}</p>
                                            </div> -->
                                            <div class="card-point"
                                                *ngIf="frmInvHdr.get('service_type').value == 2 && showRecurDates">
                                                <h4 id="invoice-detail-0045">Recurring Month</h4>
                                                <p>{{ this.viewrecur_fromdate | date : "dd-MMM-yyyy" }}</p>
                                            </div>
                                            <div class="card-point"
                                                *ngIf="frmInvHdr.get('service_type').value == 3 && showRecurDates">
                                                <h4 id="invoice-detail-0046">Recurring From</h4>
                                                <p>{{ this.viewrecur_fromdate | date : "dd-MMM-yyyy" }}</p>
                                            </div>
                                            <div class="card-point"
                                                *ngIf="frmInvHdr.get('service_type').value == 3 && showRecurDates">
                                                <h4 id="invoice-detail-0047">Recurring To</h4>
                                                <p>{{ this.viewrecur_todate | date : "dd-MMM-yyyy" }}</p>
                                            </div>

                                            <!-- <div class="card-point" *ngIf=" aptypeid == 7 && frmInvHdr.get('service_type').value != 3">
                                                <mat-form-field appearance="outline">
                                                    <mat-label>Credit Ref No</mat-label>
                                                    <input type="text" matInput formControlName="credit_refno" readonly placeholder="Credit Ref No">
                                                </mat-form-field>
                                            </div> -->

                                              <div class="card-point" *ngIf=" aptypeid == 7 && frmInvHdr.get('service_type').value != 3">
                                                <h4>Credit Ref No</h4>
                                                <p>{{ this.creditrefno }}</p>
                                            </div>

                                            <div class="card-point" *ngIf="movedata == 'ECF'">
                                                <h4 id="invoice-detail-0048">GST Applicable</h4>
                                                <p>{{ this.view_invoicegst }}</p>
                                            </div>
                                            <!-- <div class="card-point" *ngIf="movedata == 'ECF' && aptypeid ==2">
                                                <h4 id="invoice-detail-0048">Is Capitalized</h4>
                                                <p>{{ this.view_is_captalized }}</p> -->
                                                 <!-- <section class="example-section" style="margin-top:10px;">
                                                    Is Capitalized
                                                </section> -->
                                                <!-- <mat-checkbox formControlName="captalisedflag" style="margin-bottom: 10px"
                                                    >
                                                </mat-checkbox> -->
                                                <!-- <mat-form-field style="margin-left: 10px;">
                                                <input type="text" matInput formControlName="captalisedflag" readonly placeholder="Is Capitalized" >
                                                <mat-label>Is Capitalized</mat-label>
                                            </mat-form-field> -->
                                            <!-- </div> -->
 <!-- <div id="matInput-size" *ngIf="movedata != 'ECF' && aptypeid == 2">
                                <section class="example-section" style="margin-top:10px;">
                                    <mat-checkbox formControlName="captalisedflag" style="margin-bottom: 10px"
                                        [disabled]="!inveditFlag">Is Capitalized
                                    </mat-checkbox>
                                </section>
                            </div> -->
                                            <!-- <div class="card-point" *ngIf=" aptypeid == 7 && frmInvHdr.get('service_type').value == 3">
                                                <mat-form-field style="margin-left: 10px;">
                                                    <mat-label>Credit Ref No</mat-label>
                                                    <input type="text" matInput formControlName="credit_refno" readonly placeholder="Credit Ref No">
                                                </mat-form-field>
                                            </div>  -->
                                             <div class="card-point" *ngIf=" aptypeid == 7 && frmInvHdr.get('service_type').value == 3">
                                                <h4>Credit Ref No</h4>
                                                <p>{{ this.creditrefno }}</p>
                                            </div>

                                            <div class="card-point" *ngIf="movedata == 'ECF' && paytoid !='S'">
                                                <h4 id="invoice-detail-0050">Invoice Status</h4>
                                                <p>{{ this.viewstatus }}</p>
                                            </div>
                                            <div class="card-point" *ngIf="movedata != 'ECF'">
                                                <h4>GST Applicable</h4>
                                                <p>{{view_invoicegst}}</p>
                                                <!-- <p>Checkbox will come here ----- formcontrolname = invoicegst</p> -->
                                              
                                            </div>
                                            <div class="card-point" *ngIf="movedata != 'ECF'">
                                                <h4>Prepaid Expense</h4>
                                                <p>{{view_prepaid_expense}}</p>
                                                <!-- <p>Checkbox will come here ----- formcontrolname = prepaid_expense</p> -->
                                            </div>

                                            <div class="card-point" *ngIf="movedata != 'ECF'">
                                                <h4>GST KeyIn</h4>
                                                <p>{{view_gst_key_in}}</p>
                                                <!-- <p>Checkbox will come here ----- formcontrolname = gst_keyin</p> -->
                                            </div>
                                            <div class="card-point">
                                                <h4>MSME</h4>
                                                <p>{{ this.msme }}</p>
                                            </div>
                                            <div class="card-point" *ngIf="showreg">
                                                <h4>MSME Reg No</h4>
                                                <p>{{ this.msme_reg_no }}</p>
                                            </div>
                                            <!-- <div class="card-point" *ngIf="movedata != 'ECF' && aptypeid == 2">
                                                <h4>Is Capitalized</h4>
                                                <p>{{view_captalisedflag}}</p> -->
                                                <!-- <p>Checkbox will come here ----- formcontrolname = captalisedflag</p> -->

                                            <!-- </div> -->
                                            <!-- <div class="card-point" *ngIf="this.frmInvHdr?.value.file_key?.length > 0 || this.attachedFile.length > 0">
                            <h4>View File</h4>
                            <div> 
                                <i matTooltip="View File" matTooltipClass="custom-tooltipnew" class=" fa fa-eye create "
                                (click)="invoice_detail_0019()"
                                style="cursor: pointer;color:blue;"> -->
                                            <!-- data-target="#invoice-detail-0019" data-toggle="modal" -->
                                            <!-- </i>
                                <i (click)="UploadPopupOpen()" class="fa fa-cloud-upload" matTooltip="Upload file" matTooltipClass="custom-tooltipnew"
                                aria-hidden="true" style="font-size: 25px;color: blue;" data-target="#create-ecf-0139" data-toggle="modal"
                                ></i>
                                <button type="submit" *ngIf="movedata != 'ECF' && inveditFlag"
                                style="border-radius:40px;margin-left:10px;"
                                class="btn btn-outline-primary" (click)="SubmitInvHdr()"
                                [disabled]="disableinvhdrsave" id="invoice-detail-0051">
                                Save</button>
                            </div>
                          </div> -->
                                            <div class="card-point"
                                                *ngIf="this.frmInvHdr?.value.file_key?.length > 0 || this.attachedFile.length > 0">
                                                <h4>View File</h4>
                                                <div>
                                                    <i matTooltip="View File" matTooltipClass="custom-tooltipnew"
                                                        class=" fa fa-eye create " (click)="getfiledetails()"
                                                        style="cursor: pointer;color:blue;">
                                                        <!-- data-target="#create-ecf-0004" data-toggle="modal" -->
                                                    </i>
                                                    <button type="submit" *ngIf="movedata != 'ECF' && inveditFlag"
                                                        style="border-radius:40px;margin-left:10px;"
                                                        class="btn btn-outline-primary" (click)="SubmitInvHdr()"
                                                        [disabled]="disableinvhdrsave" id="invoice-detail-0051">
                                                        Save</button>
                                                </div>
                                            </div>

                                            <div class="card-point" *ngIf="movedata == 'ECF'">
                                                <h4>View Notes</h4>
                                                <i matTooltip="View Notes" matTooltipClass="custom-tooltipnew"
                                                        class=" fa fa-eye create "  (click)="notespopup()"
                                                        style="cursor: pointer;color:blue;">
                                                        <!-- data-toggle="modal" data-target="#invoice-detail-0304" -->
                                                    </i>
                                            </div>
                                            <div class="card-point" *ngIf="inveditFlag">
                                                <h4>Upload file</h4>
                                                <div>
                                                    <i (click)="UploadPopupOpen()" class="fa fa-cloud-upload"
                                                        matTooltip="Upload file" matTooltipClass="custom-tooltipnew"
                                                        aria-hidden="true" style="font-size: 25px;color: blue;">
                                                        <!-- data-target="#create-ecf-0139" data-toggle="modal" -->
                                                    </i>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- </div> -->
                                <!-- </div> -->
                                <!-- </div> -->
                            </div>
                        </mat-expansion-panel>
                    </mat-accordion>
                </div>

                <!-- <br> -->

                <div *ngIf="inveditFlag == true || this.movedata == 'AP'">
                    <form [formGroup]="frmInvHdr" autocomplete="off">
                        <div class="search-auto-fit">


                            <div id="matInput-size">
                                <mat-form-field appearance="outline">
                                    <input type="text" [value]="frmInvHdr.get('rsrEmp').value" matInput
                                        formControlName="rsrEmp" readonly placeholder="Raiser"
                                        matTooltip="{{frmInvHdr.get('rsrEmp').value}}"
                                        matTooltipClass="custom-tooltipnew" readonly id="invoice-detail-0024">
                                    <mat-label>Raiser Name</mat-label>
                                </mat-form-field>
                            </div>
                            <div id="matInput-size">
                                <mat-form-field appearance="outline">
                                    <input type="text" [value]="frmInvHdr.get('rsrBr').value" matInput
                                        formControlName="rsrBr" readonly placeholder="Raiser Branch"
                                        matTooltip="{{frmInvHdr.get('rsrBr').value}}"
                                        matTooltipClass="custom-tooltipnew" id="invoice-detail-0025">
                                    <mat-label>Branch</mat-label>
                                </mat-form-field>
                            </div>
                            <div id="matInput-size">
                                <mat-form-field appearance="outline">
                                    <input type="text" matInput formControlName="branchGST" readonly
                                        placeholder="Branch GST" id="invoice-detail-0026">
                                    <mat-label>Branch GST</mat-label>
                                </mat-form-field>
                            </div>
                            <div id="matInput-size" *ngIf="this.invHdrRes?.pmd_data != undefined">
                                <mat-form-field appearance="outline">
                                    <input type="text" matInput formControlName="pmd" readonly
                                        placeholder="PMD Location" id="invoice-detail-0027">
                                    <mat-label>PMD Location</mat-label>
                                </mat-form-field>
                            </div>
                            <!-- <div  id="matInput-size">
                            <mat-form-field appearance="outline">
                                <mat-label>ECF Type</mat-label>
                                <mat-select formControlName="ecftype" [disabled]="true" id="invoice-detail-0028">
                                    <mat-option *ngFor="let type of TypeList" [value]="type.id">
                                        {{type.text}}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>  -->
                            <div [ngStyle]="{'pointer-events': true ? 'none' : 'auto', 'opacity': true ? '0.6' : '1'}">
                                <lib-vs-optiondd-cmp id="matInput-size" [InputFields]="ecf_field"
                                    [formGroup]="frmInvHdr">
                                </lib-vs-optiondd-cmp>
                            </div>
                            <div id="matInput-size" *ngIf="this.invHdrRes?.pmd_data == undefined">
                                <mat-form-field appearance="outline">
                                    <input type="text" matInput formControlName="remarks" [readonly]="!inveditFlag"
                                        placeholder="Purpose" [matTooltip]="frmInvHdr.value.remarks"
                                        matTooltipClass="custom-tooltipnew" id="invoice-detail-0029">
                                    <mat-label>Purpose</mat-label>
                                </mat-form-field>
                            </div>

                            <div id="matInput-size" *ngIf="this.aptypeid != 13 && this.aptypeid != 14">
                                <mat-form-field appearance="outline">
                                    <input type="text" matInput formControlName="invoiceno" [readonly]="!inveditFlag"  placeholder="Invoice No"
                                    id="invoice-detail-0030" maxlength="16" (keypress)="invNoFilter($event);">
                                    <mat-label>Invoice No</mat-label>
                                </mat-form-field>
                            </div>
                            <div id="matInput-size" *ngIf="this.aptypeid == 14">
                                <mat-form-field appearance="outline">
                                    <input type="text" matInput formControlName="invoiceno" [readonly]="!inveditFlag"
                                        placeholder="Account No" id="invoice-detail-0302" maxlength="16"
                                        (change)="icrAccno()">
                                    <mat-label>Account No</mat-label>
                                </mat-form-field>
                            </div>

                            <div id="matInput-size">
                                <mat-form-field appearance="outline">
                                    <mat-label>
                                        <div style="text-align: right;color: red;font-size:large;"
                                            *ngIf="this.invHdrRes?.highlight =='YES'">More than six month</div>
                                    </mat-label>
                                    <input matInput [matDatepicker]="picker1" (dateChange)="onDateChange($event)"
                                        formControlName="invoicedate" [max]="tomorrow" [readonly]="!inveditFlag"
                                        id="invoice-detail-0031">
                                    <mat-datepicker-toggle matSuffix [for]="picker1" [class.disabled]="!inveditFlag">
                                    </mat-datepicker-toggle>
                                    <mat-datepicker #picker1></mat-datepicker>
                                </mat-form-field>
                            </div>
                            <div id="matInput-size">
                                <mat-form-field appearance="outline">
                                    <input type="text" matInput formControlName="totalamount" readonly
                                        placeholder="Invoice Amount" style="text-align: right;" id="invoice-detail-0032"
                                        #totalamount (change)="invhdramtDecimalChg(totalamount ,'totalamount')">
                                    <mat-label>Invoice Amount</mat-label>
                                </mat-form-field>
                            </div>
                            <div id="matInput-size">
                                <mat-form-field appearance="outline">
                                    <input matInput formControlName="invoiceamount" [readonly]="!inveditFlag"
                                        placeholder="Taxable Amount"
                                        (keypress)="getCharCode($event);numberOnlyandDot($event, frmInvHdr.value.invoiceamount)"
                                        (input)="invHdrChangeToCurrency('invoiceamount')" style="text-align: right;"
                                        id="invoice-detail-0033" #invoiceamount
                                        (change)="invhdramtDecimalChg(invoiceamount ,'invoiceamount')">
                                    <mat-label>Taxable Amount</mat-label>
                                </mat-form-field>
                            </div>
                            <div id="matInput-size">
                                <mat-form-field appearance="outline" (click)="getcommodity()">
                                    <mat-label>Commodity Name</mat-label>
                                    <input #commodityInput placeholder="Commodity Name" matInput
                                        formControlName="commodity_id" [matAutocomplete]="commoditytype"
                                        [readonly]="!inveditFlag|| this.movedata == 'AP'" required
                                        [matTooltip]="frmInvHdr.value.commodity_id.name"
                                        matTooltipClass="custom-tooltipnew" id="invoice-detail-0034">
                                    <!-- <mat-icon matSuffix class="maticonsize">unfold_more</mat-icon> -->
                                    <mat-autocomplete [panelWidth]="250" #commoditytype="matAutocomplete"
                                        [displayWith]="displayFncommodity" (opened)="commodityScroll()">
                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                        <ng-container *ngIf="!isLoading">
                                            <mat-option *ngFor="let commodity of commodityList" [value]="commodity"
                                                matTooltip="{{commodity.name}}" matTooltipClass="custom-tooltipnew">
                                                {{commodity.name}}
                                            </mat-option>
                                        </ng-container>
                                    </mat-autocomplete>
                                </mat-form-field>
                            </div>

                            <div id="matInput-size" *ngIf="paytoid =='S'" colspan="2">
                                <mat-form-field appearance="outline">
                                    <input type="text" matInput formControlName="supplier" readonly
                                        placeholder="Supplier" [matTooltip]="frmInvHdr.value.supplier"
                                        matTooltipClass="custom-tooltipnew" id="invoice-detail-0035">
                                    <mat-label>Supplier </mat-label>
                                </mat-form-field>
                                <button type="button" class="btn btn-outline-primary" matTooltip="Select Supplier"
                                    matTooltipClass="custom-tooltipnew" *ngIf="aptypeid == 14 && inveditFlag"
                                    data-toggle="modal" (click)="getsuppindex();"
                                    style="border-radius:40px;margin-left:10px;margin-bottom:25px"
                                    id="invoice-detail-0036"><i class="fa fa-arrow-up"></i></button>
                                <!-- data-target="#invoice-detail-0022" -->
                            </div>
                            <div *ngIf="paytoid =='S'" id="matInput-size" style="display:flex; gap:10px">
                                <mat-form-field appearance="outline">
                                    <input type="text" matInput formControlName="suppliergst" readonly
                                        placeholder="Supplier GST" id="invoice-detail-0037">
                                    <mat-label>Supplier GST</mat-label>
                                </mat-form-field>
                                <i class="fa fa-check-circle" *ngIf="!SupGSTChecked && movedata != 'ECF' && inveditFlag"
                                    style="font-size:35px;color:darkblue;margin-left:10px;cursor: pointer;margin-top:5px;"
                                    matTooltip="validate" matTooltipClass="custom-tooltipnew"
                                    (click)="suppGstValidChk()"></i>
                                <i *ngIf="SupGSTChecked && movedata != 'ECF'" matTooltip="View "
                                    matTooltipClass="custom-tooltipnew" class=" fa fa-eye create "
                                    (click)="supplier_popup()" data-toggle="modal"
                                    style="cursor: pointer;color:blue;margin-left: 10px;margin-top:15px"></i>
                            </div>
                            <div id="matInput-size" *ngIf="movedata == 'ECF' && paytoid =='S'">
                                <mat-form-field appearance="outline">
                                    <input type="text" matInput formControlName="status" readonly
                                        placeholder="Invoice Status" id="invoice-detail-0038">
                                    <mat-label>Invoice Status</mat-label>
                                </mat-form-field>
                            </div>
                            <div id="matInput-size" *ngIf="movedata != 'ECF'&& paytoid =='S'">
                                <mat-form-field appearance="outline">
                                    <input type="text" matInput formControlName="physical_verif" readonly
                                        placeholder="Physical Verification" id="invoice-detail-0039">
                                    <mat-label>Physical Verification</mat-label>
                                </mat-form-field>
                            </div>
                            <div id="matInput-size" *ngIf="movedata == 'ECF'&& aptypeid != 2">
                                <mat-form-field style="margin-left: 10px;">
                                    <input type="text" matInput formControlName="invoicegst" readonly
                                        placeholder="GST Applicable" id="invoice-detail-0048">
                                    <mat-label>GST Applicable</mat-label>
                                </mat-form-field>
                            </div>
                            <div id="matInput-size" *ngIf="this.aptypeid == 2"
                                [ngStyle]="{'pointer-events': !inveditFlag ? 'none' : 'auto', 'opacity': !inveditFlag ? '0.6' : '1'}">
                                <!-- <mat-form-field appearance="outline">
                                    <mat-label>Is PCA</mat-label>
                                    <mat-select placeholder="Is PCA" formControlName="is_pca" [disabled]="!inveditFlag"
                                        required id="invoice-detail-0040">
                                        <mat-option *ngFor="let opt of PCAYesorno" [value]="opt.value"
                                            (click)="setPCA(opt);">
                                            {{opt.display}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field> -->
                                <lib-vs-optiondd-cmp id="matInput-size" [InputFields]="pca_field" (dataEvent)="setPCA($event)"
                                    [formGroup]="frmInvHdr"></lib-vs-optiondd-cmp>
                            </div>

                            <div id="matInput-size"  *ngIf="PCAyesno == 1 || frmInvHdr.get('is_recur').value ==1" >
                                <div style="display: flex; align-items: center;" *ngIf="PCAyesno == 1">
                                    <mat-form-field appearance="outline">
                                        <mat-label>PCA No.</mat-label>
                                        <input #pcaInput matInput formControlName="pca_no"
                                            [matAutocomplete]="pcaAutocomplete" [readonly]="!inveditFlag"
                                            placeholder="PCA No." id="invoice-detail-0041">
                                        <mat-autocomplete [panelWidth]="150" #pcaAutocomplete="matAutocomplete"
                                            [displayWith]="displayFnPCA" (opened)="PCAScroll()">
                                            <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                            <ng-container *ngIf="!isLoading">
                                                <mat-option *ngFor="let pca of PCAList" [value]="pca"
                                                    (click)="PCAselected();" (focusout)="PCAselected();"
                                                    matTooltip="{{pca.pca_no}} - {{pca.balance_amount}}"
                                                    matTooltipClass="custom-tooltipnew">
                                                    {{pca.pca_no}}
                                                </mat-option>
                                            </ng-container>
                                        </mat-autocomplete>
                                    </mat-form-field>&nbsp;
                                    <i class="fa fa-info-circle"
                                        style="font-size:24px;color:#0077ff;margin-bottom:20px;margin-left:10px"
                                        *ngIf="this.PCA_Det.length >0"
                                        matTooltip="{{PCA_Det[0]?.pca_no}} - {{PCA_Det[0]?.balance_amount}}"
                                        matTooltipClass="custom-tooltipnew"></i>

                                </div>
                            </div>
                            <!-- <div id="matInput-size">
                            <mat-form-field  appearance="outline">
                                <mat-label>Is Recurring</mat-label>
                                <mat-select placeholder="Is Recurring" formControlName="is_recur" [disabled]="!inveditFlag"  id="invoice-detail-0042">
                                    <mat-option *ngFor="let rrr of RecurYesorno" [value]="rrr.value"
                                    (click)="isRecurChanged(rrr);" >
                                        {{rrr.display}}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>    -->
                            <div *ngIf="this.aptypeid !== 1" id="matInput-size"
                                [ngStyle]="{'pointer-events': !inveditFlag ? 'none' : 'auto', 'opacity': !inveditFlag ? '0.6' : '1'}">
                                <lib-vs-optiondd-cmp [InputFields]="Recurring_field"
                                    [formGroup]="frmInvHdr"></lib-vs-optiondd-cmp>
                            </div>

                            <!-- <div id="matInput-size" *ngIf="frmInvHdr.get('is_recur').value ==1">
                            <mat-form-field  appearance="outline">
                                <mat-label>Recurring Type</mat-label>
                                <mat-select placeholder="Recurring Type" formControlName="service_type" [disabled]="!inveditFlag" id="invoice-detail-0043">
                                    <mat-option *ngFor="let rr of RecurringTypes" [value]="rr.id" (click)="serviceTypeChanged(rr);">
                                        {{rr.text}}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div> -->
                            <!-- <div id="matInput-size" *ngIf="frmInvHdr.get('is_recur').value ==1"
                                [ngStyle]="{'pointer-events': !inveditFlag ? 'none' : 'auto', 'opacity': !inveditFlag ? '0.6' : '1'}">
                                <lib-vs-optiondd-cmp [InputFields]="Recurring_type_field2"
                                    [formGroup]="frmInvHdr"></lib-vs-optiondd-cmp>
                            </div>
                            <div id="matInput-size" *ngIf="frmInvHdr.get('is_recur').value ==0">
                                <mat-form-field appearance="outline">
                                    <mat-label>Recurring Type</mat-label>
                                    <mat-select placeholder="Recurring Type" formControlName="service_type"
                                        [disabled]="!inveditFlag" id="invoice-detail-0044">
                                        <mat-option *ngFor="let rr of RecurringTypes1" [value]="rr.id"
                                            (click)="serviceTypeChanged(rr);">
                                            {{rr.text}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div> -->

                            <!-- <td *ngIf="frmInvHdr.get('is_recur').value ==1">
                                <mat-form-field style="width:180px;margin-left: 10px;">
                                    <mat-select placeholder="Recurring Type" formControlName="service_type" [disabled]="!inveditFlag" id="invoice-detail-0043">
                                        <mat-option *ngFor="let rr of RecurringTypes" [value]="rr.id" (click)="serviceTypeChanged(rr);">
                                            {{rr.text}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </td> -->

                        

                        
                            <div id="matInput-size" *ngIf="frmInvHdr.get('is_recur').value ==1 && this.aptypeid !== 1"
                                [ngStyle]="{'pointer-events': !inveditFlag ? 'none' : 'auto', 'opacity': !inveditFlag ? '0.6' : '1'}">
                                <lib-vs-optiondd-cmp [InputFields]="Recurring_type_field" [formGroup]="frmInvHdr" (dataEvent)="isRecurChanged($event)">
                                </lib-vs-optiondd-cmp>
                            </div>

                            <!-- <td  *ngIf="frmInvHdr.get('is_recur').value ==0">
                                <mat-form-field style="width:180px;margin-left: 10px;">
                                    <mat-select placeholder="Recurring Type" formControlName="service_type" [disabled]="!inveditFlag" id="invoice-detail-0044">
                                        <mat-option *ngFor="let rr of RecurringTypes1" [value]="rr.id" (click)="serviceTypeChanged(rr);">
                                            {{rr.text}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </td> -->

                            <div id="matInput-size" *ngIf="frmInvHdr.get('is_recur').value ==0 && this.aptypeid !== 1"
                                [ngStyle]="{'pointer-events': !inveditFlag ? 'none' : 'auto', 'opacity': !inveditFlag ? '0.6' : '1'}">
                                <lib-vs-optiondd-cmp [InputFields]="Recurring_type_field2" [formGroup]="frmInvHdr">
                                </lib-vs-optiondd-cmp>
                            </div>

                            <div id="matInput-size" *ngIf="frmInvHdr.get('service_type').value == 2 && showRecurDates">
                                <mat-form-field appearance="outline">
                                    <mat-label>Recurring Month</mat-label>
                                    <input matInput [matDatepicker]="picker1" required autocomplete="off"
                                        formControlName="recur_fromdate" [disabled]="!inveditFlag"
                                        id="invoice-detail-0045">

                                    <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                                    <mat-datepicker #picker1 startView="multi-year"
                                        (monthSelected)="setMonthAndYear($event, picker1)"
                                        panelClass="example-month-picker"></mat-datepicker>
                                </mat-form-field>
                            </div>
                            <div id="matInput-size" *ngIf="frmInvHdr.get('service_type').value == 3 && showRecurDates">
                                <mat-form-field appearance="outline">
                                    <mat-label>Recurring From</mat-label>
                                    <input matInput [matDatepicker]="picker1" required autocomplete="off"
                                        formControlName="recur_fromdate" [disabled]="!inveditFlag"
                                        id="invoice-detail-0046">

                                    <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                                    <mat-datepicker #picker1></mat-datepicker>
                                </mat-form-field>
                            </div>
                            <div id="matInput-size" *ngIf="frmInvHdr.get('service_type').value == 3 && showRecurDates">
                                <mat-form-field appearance="outline">
                                    <mat-label>Recurring To</mat-label>
                                    <input matInput [matDatepicker]="picker2" required
                                        [min]="frmInvHdr.value.recur_fromdate" autocomplete="off"
                                        formControlName="recur_todate" [disabled]="!inveditFlag"
                                        id="invoice-detail-0047">

                                    <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                                    <mat-datepicker #picker2></mat-datepicker>
                                </mat-form-field>
                            </div>
                        
                             <div id="matInput-size">
                                <mat-form-field appearance="outline">
                                    <mat-label>MSME</mat-label>
                                    <input type="text" matInput formControlName="msme" readonly placeholder="MSME">
                                </mat-form-field>
                            </div>
                             <div id="matInput-size" *ngIf="showreg">
                                <mat-form-field appearance="outline">
                                    <mat-label>MSME Reg No</mat-label>
                                    <input type="text" matInput formControlName="msme_reg_no" readonly placeholder="MSME Reg No">
                                </mat-form-field>
                            </div>
                            <div id="matInput-size" *ngIf=" aptypeid == 7 && frmInvHdr.get('service_type').value != 3">
                                <mat-form-field appearance="outline">
                                    <mat-label>Credit Ref No</mat-label>
                                    <input type="text" matInput formControlName="credit_refno" readonly placeholder="Credit Ref No">
                                </mat-form-field>
                            </div>
                            <div id="matInput-size" *ngIf="movedata == 'ECF'&& aptypeid == 2">
                                <mat-form-field appearance="outline">
                                    <input type="text" matInput formControlName="invoicegst" readonly
                                        placeholder="GST Applicable" id="invoice-detail-0048">
                                    <mat-label>GST Applicable</mat-label>
                                </mat-form-field>
                            </div>
                            <div *ngIf="movedata == 'ECF' && aptypeid ==2">
                                <mat-form-field style="margin-left: 10px;">
                                    <input type="text" matInput formControlName="captalisedflag" readonly
                                        placeholder="Is Capitalized">
                                    <mat-label>Is Capitalized</mat-label>
                                </mat-form-field>
                            </div>
                            <div id="matInput-size" *ngIf=" aptypeid == 7 && frmInvHdr.get('service_type').value == 3">
                                <mat-form-field style="margin-left: 10px;">
                                    <mat-label>Credit Ref No</mat-label>
                                    <input type="text" matInput formControlName="credit_refno" readonly placeholder="Credit Ref No">
                                </mat-form-field>
                            </div> 
                            <div id="matInput-size" *ngIf="this.invHdrRes?.pmd_data != undefined">
                                <mat-form-field appearance="outline">
                                    <input type="text" matInput formControlName="remarks" [readonly]="!inveditFlag"
                                        placeholder="Purpose" [matTooltip]="frmInvHdr.value.remarks"
                                        matTooltipClass="custom-tooltipnew" id="invoice-detail-0049">
                                    <mat-label>Purpose</mat-label>
                                </mat-form-field>
                            </div>
                            <div style="margin-top:10px;" id="matInput-size" *ngIf="movedata != 'ECF'">
                                <section class="example-section">
                                    <mat-checkbox formControlName="invoicegst" [disabled]="!inveditFlag">GST Applicable
                                    </mat-checkbox>
                                </section>
                            </div>
                            <div id="matInput-size" *ngIf="movedata != 'ECF' && aptypeid == 2">
                                <section class="example-section" style="margin-top:10px;">
                                    <mat-checkbox formControlName="captalisedflag" style="margin-bottom: 10px"
                                        [disabled]="!inveditFlag">Is Capitalized
                                    </mat-checkbox>
                                </section>
                            </div>
                            <div id="matInput-size" *ngIf="movedata == 'ECF' && paytoid !='S'">
                                <mat-form-field appearance="outline">
                                    <input type="text" matInput formControlName="status" readonly
                                        placeholder="Invoice Status" id="invoice-detail-0050">
                                    <mat-label>Invoice Status</mat-label>
                                </mat-form-field>
                            </div>
                            <div id="matInput-size" *ngIf="movedata != 'ECF' && this.aptypeid !== 1" >
                                <section class="example-section" style="margin-top:10px;">
                                    <mat-checkbox (change)="onselectionchangepr($event)"
                                        [checked]="frmInvHdr.controls['prepaid_expense'].value"
                                        formControlName="prepaid_expense"
                                        style="margin-left: 10px;margin-right: 5px;margin-bottom: 15px"
                                        [disabled]="!inveditFlag">Prepaid Expense
                                    </mat-checkbox>
                                </section>
                            </div>
                            <div id="matInput-size" *ngIf="movedata != 'ECF' && this.aptypeid !== 1">
                                <section class="example-section" style="margin-left: 10px;margin-top:10px;">
                                    <mat-checkbox (change)="onselectionchangegst($event)"
                                        [checked]="frmInvHdr.controls['gst_keyin'].value" formControlName="gst_keyin"
                                        style="margin-left: 5px;margin-right: 5px;margin-bottom: 15px"
                                        [disabled]="!inveditFlag">GST KeyIn
                                    </mat-checkbox>
                                </section>
                            </div>
                            <div id="matInput-size" *ngIf="movedata != 'ECF'&& paytoid !='S'">
                                <mat-form-field appearance="outline">
                                    <mat-label>Physical Verification</mat-label>
                                    <input type="text" matInput formControlName="physical_verif" readonly
                                        placeholder="Physical Verification" id="invoice-detail-0039">
                                </mat-form-field>
                            </div>
                            <!-- <div id="matInput-size" *ngIf="PCAyesno ==0 && frmInvHdr.get('is_recur').value == 0">
                                <mat-form-field appearance="outline">
                                    <mat-label>Is Recurring</mat-label>
                                    <mat-select placeholder="Is Recurring" formControlName="is_recur" [disabled]="!inveditFlag"  id="invoice-detail-0042">
                                        <mat-option *ngFor="let rrr of RecurYesorno" [value]="rrr.value"
                                        (click)="isRecurChanged(rrr);" >
                                            {{rrr.display}}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>  -->
                            <div style="display:flex">

                                <div *ngIf="inveditFlag" style="width: 25px;margin-top:10px">
                                    <i (click)="UploadPopupOpen()" class="fa fa-cloud-upload" matTooltip="Upload file"
                                        matTooltipClass="custom-tooltipnew" aria-hidden="true"
                                        style="font-size: 25px;color: blue;" data-target="#create-ecf-0139"
                                        data-toggle="modal"></i>
                                        <!-- <i (click)="UploadPopupOpen()" class="fa fa-cloud-upload" matTooltip="Upload file"
                                        matTooltipClass="custom-tooltipnew" aria-hidden="true"
                                        style="font-size: 25px;color: blue;"></i> -->
                                </div>
                                <div *ngIf="this.frmInvHdr?.value.file_key?.length > 0 || this.attachedFile.length > 0"
                                    style="margin-left: 10px; width: 140px;margin-top:5px">
                                    <i matTooltip="View File" matTooltipClass="custom-tooltipnew"
                                        class=" fa fa-eye create " (click)="invoice_detail_0019()" data-toggle="modal"
                                        style="cursor: pointer;color:blue;margin-left: 15px;"></i>
                                </div>
                                <button type="submit" *ngIf="movedata != 'ECF' && inveditFlag"
                                    style="border-radius:40px;margin-left:10px;" class="btn btn-outline-primary"
                                    (click)="SubmitInvHdr()" [disabled]="disableinvhdrsave"
                                    id="invoice-detail-0051">
                                Save</button>

                            </div>




                        </div>
                    </form>
                </div>
                <form [formGroup]="frmInvHdr">
                <!-- <form [formGroup]="frmInvHdr">  
                <table>
                <div>
                <tr>
                <td>
                    <mat-form-field style="margin-left: 10px;">
                        <input type="text" [value]="frmInvHdr.get('rsrEmp').value" matInput formControlName="rsrEmp" readonly placeholder="Raiser"
                         matTooltip="{{frmInvHdr.get('rsrEmp').value}}" matTooltipClass="custom-tooltipnew" readonly id="invoice-detail-0024">
                        <mat-label>Raiser Name</mat-label>
                    </mat-form-field>
                </td>
                <td>
                    <mat-form-field style="margin-left: 10px;">
                        <input type="text" [value]="frmInvHdr.get('rsrBr').value" matInput formControlName="rsrBr" readonly placeholder="Raiser Branch" 
                        matTooltip="{{frmInvHdr.get('rsrBr').value}}" matTooltipClass="custom-tooltipnew" id="invoice-detail-0025">
                        <mat-label>Branch</mat-label>
                    </mat-form-field>
                </td>
                <td>
                    <mat-form-field style="margin-left: 10px;">
                        <input type="text" matInput formControlName="branchGST" readonly placeholder="Branch GST" id="invoice-detail-0026">
                        <mat-label>Branch GST</mat-label>
                    </mat-form-field>
                </td>
                <td *ngIf="this.invHdrRes?.pmd_data != undefined">
                   <mat-form-field style="margin-left: 10px;">
                       <input type="text" matInput formControlName="pmd" readonly placeholder="PMD Location" id="invoice-detail-0027">
                       <mat-label>PMD Location</mat-label>
                   </mat-form-field>
                 </td> 
                <td>
                    <mat-form-field style="margin-left: 10px;">
                        <mat-label>ECF Type</mat-label>
                        <mat-select formControlName="ecftype" [disabled]="true" id="invoice-detail-0028">
                            <mat-option *ngFor="let type of TypeList" [value]="type.id">
                                {{type.text}}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                </td> 
                <td *ngIf="this.invHdrRes?.pmd_data == undefined">
                    <mat-form-field style="margin-left: 10px;">
                        <input type="text" matInput formControlName="remarks"  [readonly]="!inveditFlag" placeholder="Purpose"
                         [matTooltip]="frmInvHdr.value.remarks" matTooltipClass="custom-tooltipnew" id="invoice-detail-0029">
                        <mat-label>Purpose</mat-label>
                    </mat-form-field>
                </td> 
            </tr>
            <tr>
                <td *ngIf="this.aptypeid != 13 && this.aptypeid != 14">
                    <mat-form-field  style="margin-left: 10px;">
                        <input type="text" matInput formControlName="invoiceno" [readonly]="!inveditFlag"  placeholder="Invoice No" id="invoice-detail-0030">
                        <mat-label>Invoice No</mat-label>
                    </mat-form-field>
                </td>   
                <td *ngIf="this.aptypeid == 14">
                    <mat-form-field  style="margin-left: 10px;">
                        <input type="text" matInput formControlName="invoiceno" [readonly]="!inveditFlag"  placeholder="Account No" id="invoice-detail-0302"
                        maxlength="16"  (change)="icrAccno()">
                        <mat-label>Invoice No</mat-label>
                    </mat-form-field>
                </td> 
               
               <td>
                <mat-form-field style="margin-left: 10px;width: 180px;">
                    <mat-label><div style="text-align: right;color: red;font-size:large;" *ngIf="this.invHdrRes?.highlight =='YES'">More than six month</div></mat-label>
                    <input matInput [matDatepicker]="picker1" (dateChange)="onDateChange($event)"
                        formControlName="invoicedate" [max]="tomorrow" [readonly]="!inveditFlag" id="invoice-detail-0031">
                    <mat-datepicker-toggle matSuffix [for]="picker1" [class.disabled]="!inveditFlag">
                    </mat-datepicker-toggle>
                    <mat-datepicker #picker1></mat-datepicker>
                </mat-form-field>
               </td>
               <td>
                   <mat-form-field style="margin-left: 10px;">
                       <input type="text" matInput formControlName="totalamount" readonly placeholder="Invoice Amount" style="text-align: right;" 
                       id="invoice-detail-0032" #totalamount  (change)="invhdramtDecimalChg(totalamount ,'totalamount')">
                       <mat-label>Invoice Amount</mat-label>
                   </mat-form-field>
               </td>         
               <td>
                <mat-form-field style="margin-left: 10px;">
                    <input matInput formControlName="invoiceamount" [readonly]="!inveditFlag" placeholder="Taxable Amount"  
                    (keypress)="getCharCode($event);numberOnlyandDot($event, frmInvHdr.value.invoiceamount)" (input)="invHdrChangeToCurrency('invoiceamount')" 
                    style="text-align: right;" id="invoice-detail-0033" #invoiceamount  (change)="invhdramtDecimalChg(invoiceamount ,'invoiceamount')">
                    <mat-label>Taxable Amount</mat-label>
                </mat-form-field>
            </td>  
            <td>
                <mat-form-field style="margin-left: 10px;"
                                (click)="getcommodity()">
                                <input #commodityInput placeholder="Commodity Name" matInput
                                    formControlName="commodity_id" [matAutocomplete]="commoditytype"
                                    [readonly]="!inveditFlag" required
                                    [matTooltip]="frmInvHdr.value.commodity_id.name" matTooltipClass="custom-tooltipnew" id="invoice-detail-0034">
                                 <mat-icon matSuffix class="maticonsize">unfold_more</mat-icon> -->
                <!-- <mat-autocomplete [panelWidth]="250" #commoditytype="matAutocomplete"
                                    [displayWith]="displayFncommodity" (opened)="commodityScroll()">
                                    <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                    <ng-container *ngIf="!isLoading">
                                        <mat-option *ngFor="let commodity of commodityList"
                                            [value]="commodity"
                                            matTooltip="{{commodity.name}}" matTooltipClass="custom-tooltipnew">
                                            {{commodity.name}}
                                        </mat-option>
                                    </ng-container>
                                </mat-autocomplete>
                            </mat-form-field>
            </td>     
            </tr>    
            <tr>
                <td *ngIf="paytoid =='S'" colspan="2">
                    <mat-form-field style="width: 370px;margin-left: 10px;">
                        <input type="text" matInput formControlName="supplier" readonly placeholder="Supplier"
                        [matTooltip]="frmInvHdr.value.supplier" matTooltipClass="custom-tooltipnew" id="invoice-detail-0035">
                        <mat-label>Supplier </mat-label>
                    </mat-form-field>
                    <button type="button" class="btn btn-outline-primary" matTooltip="Select Supplier" matTooltipClass="custom-tooltipnew"
                    *ngIf="aptypeid == 14 && inveditFlag"
                    data-toggle="modal" data-target="#invoice-detail-0022" (click)="getsuppindex();"
                        style="border-radius:40px;margin-left:5px;" id="invoice-detail-0036"><i class="fa fa-arrow-up"></i></button>
                </td>
                <td *ngIf="paytoid =='S'">
                    <mat-form-field style="margin-left: 10px;">
                        <input type="text" matInput formControlName="suppliergst" readonly placeholder="Supplier GST" id="invoice-detail-0037">
                        <mat-label>Supplier GST</mat-label>
                    </mat-form-field>
                </td> 
                <td *ngIf="movedata == 'ECF' && paytoid =='S'">
                    <mat-form-field style="margin-left: 10px;">
                        <input type="text" matInput formControlName="status" readonly placeholder="Status" id="invoice-detail-0038">
                        <mat-label>Status</mat-label>
                    </mat-form-field>
                </td>  
                <td *ngIf="movedata != 'ECF'">
                    <mat-form-field style="margin-left: 10px;">
                        <input type="text" matInput formControlName="physical_verif" readonly placeholder="Physical Verification" id="invoice-detail-0039">
                        <mat-label>Physical Verification</mat-label>
                    </mat-form-field>
                </td> 
                <td *ngIf="this.aptypeid == 2">
                    <mat-form-field style="margin-left: 10px;width:180px">
                        <mat-select placeholder="Is PCA" formControlName="is_pca" [disabled]="!inveditFlag"
                           required id="invoice-detail-0040">
                            <mat-option *ngFor="let opt of PCAYesorno" [value]="opt.value"
                            (click)="setPCA(opt);" >
                                {{opt.display}}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                </td>
            </tr>
            <tr>
                <td *ngIf="PCAyesno == 1">
                    <div style="width: 180px; margin-left: 10px;">
                        <mat-form-field style="width: 150px; " >
                            <input #pcaInput matInput formControlName="pca_no"
                                [matAutocomplete]="pcaAutocomplete" [readonly]="!inveditFlag"
                                placeholder="PCA No." id="invoice-detail-0041">
                            <mat-autocomplete [panelWidth]="150" #pcaAutocomplete="matAutocomplete"
                                [displayWith]="displayFnPCA" (opened)="PCAScroll()">
                                <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                <ng-container *ngIf="!isLoading">
                                    <mat-option *ngFor="let pca of PCAList" [value]="pca" (click)="PCAselected();"  (focusout)="PCAselected();"
                                        matTooltip="{{pca.pca_no}} - {{pca.balance_amount}}" matTooltipClass="custom-tooltipnew" > 
                                   {{pca.pca_no}}
                                    </mat-option>
                                </ng-container>
                            </mat-autocomplete>
                        </mat-form-field>&nbsp;
                        <i class="fa fa-info-circle" style="font-size:24px;color:#0077ff" *ngIf="this.PCA_Det.length >0"
                        matTooltip="{{PCA_Det[0]?.pca_no}} - {{PCA_Det[0]?.balance_amount}}" matTooltipClass="custom-tooltipnew" ></i>

                    </div>
                </td>
                <td>
                    <mat-form-field style="margin-left: 10px;width:180px">
                        <mat-select placeholder="Is Recurring" formControlName="is_recur" [disabled]="!inveditFlag"  id="invoice-detail-0042">
                            <mat-option *ngFor="let rrr of RecurYesorno" [value]="rrr.value"
                            (click)="isRecurChanged(rrr);" >
                                {{rrr.display}}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                </td>   
                <td *ngIf="frmInvHdr.get('is_recur').value ==1">
                    <mat-form-field style="width:180px;margin-left: 10px;">
                        <mat-select placeholder="Recurring Type" formControlName="service_type" [disabled]="!inveditFlag" id="invoice-detail-0043">
                            <mat-option *ngFor="let rr of RecurringTypes" [value]="rr.id" (click)="serviceTypeChanged(rr);">
                                {{rr.text}}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                </td>
                <td  *ngIf="frmInvHdr.get('is_recur').value ==0">
                    <mat-form-field style="width:180px;margin-left: 10px;">
                        <mat-select placeholder="Recurring Type" formControlName="service_type" [disabled]="!inveditFlag" id="invoice-detail-0044">
                            <mat-option *ngFor="let rr of RecurringTypes1" [value]="rr.id" (click)="serviceTypeChanged(rr);">
                                {{rr.text}}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                </td>
                <td *ngIf ="frmInvHdr.get('service_type').value == 2 && showRecurDates">
                    <mat-form-field style="width:180px;margin-left: 10px;">
                          <mat-label>Recurring Month</mat-label>
                        <input matInput [matDatepicker]="picker1" required
                            autocomplete="off" formControlName="recur_fromdate" [disabled]="!inveditFlag" id="invoice-detail-0045">

                        <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                        <mat-datepicker #picker1 startView="multi-year"
                        (monthSelected)="setMonthAndYear($event, picker1)"
                        panelClass="example-month-picker"></mat-datepicker>
                    </mat-form-field>
                </td>
                <td *ngIf ="frmInvHdr.get('service_type').value == 3 && showRecurDates">
                    <mat-form-field style="width:180px;margin-left: 10px;">
                          <mat-label>Recurring From</mat-label>
                        <input matInput [matDatepicker]="picker1" required
                            autocomplete="off" formControlName="recur_fromdate" [disabled]="!inveditFlag" id="invoice-detail-0046">

                        <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                        <mat-datepicker #picker1></mat-datepicker>
                    </mat-form-field>
                </td>
                <td *ngIf ="frmInvHdr.get('service_type').value == 3 && showRecurDates">
                    <mat-form-field style="width:180px;margin-left: 10px;">
                          <mat-label>Recurring To</mat-label>
                        <input matInput [matDatepicker]="picker2" required [min]="frmInvHdr.value.recur_fromdate" 
                            autocomplete="off" formControlName="recur_todate" [disabled]="!inveditFlag" id="invoice-detail-0047">

                        <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                        <mat-datepicker #picker2></mat-datepicker>
                    </mat-form-field>
                </td>    
            </tr>  
            <tr> 
                <td *ngIf="movedata == 'ECF'">
                   <mat-form-field style="margin-left: 10px;">
                       <input type="text" matInput formControlName="invoicegst" readonly placeholder="GST Applicable" id="invoice-detail-0048">
                       <mat-label>GST Applicable</mat-label>
                   </mat-form-field>
               </td>
                <td *ngIf="this.invHdrRes?.pmd_data != undefined">
                    <mat-form-field style="margin-left: 10px;">
                        <input type="text" matInput formControlName="remarks"  [readonly]="!inveditFlag" placeholder="Purpose"
                         [matTooltip]="frmInvHdr.value.remarks" matTooltipClass="custom-tooltipnew" id="invoice-detail-0049">
                        <mat-label>Purpose</mat-label>
                    </mat-form-field>
                </td>  
                <td *ngIf="movedata != 'ECF'"><section class="example-section" style ="margin-top:10px;">
                    <mat-checkbox
                    formControlName="invoicegst" style="margin-right: 5px;margin-bottom: 15px"
                    [disabled] = "!inveditFlag">GST Applicable
                    </mat-checkbox>
                    </section>
                </td> 
                <td *ngIf="movedata == 'ECF' && paytoid !='S'">
                    <mat-form-field style="margin-left: 10px;">
                        <input type="text" matInput formControlName="status" readonly placeholder="Status" id="invoice-detail-0050">
                        <mat-label>Status</mat-label>
                    </mat-form-field>
                </td>  
                <td *ngIf="movedata != 'ECF'"><section class="example-section" style ="margin-top:10px;">
                    <mat-checkbox 
                    (change)="onselectionchangepr($event)" [checked]="frmInvHdr.controls['prepaid_expense'].value" formControlName="prepaid_expense" style="margin-left: 10px;margin-right: 5px;margin-bottom: 15px"
                    [disabled] = "!inveditFlag">Prepaid Expense
                    </mat-checkbox>
                    </section>
                </td>
                <td *ngIf="movedata != 'ECF'"><section class="example-section" style ="margin-left: 10px;margin-top:10px;">
                    <mat-checkbox  
                    (change)="onselectionchangegst($event)" [checked]="frmInvHdr.controls['gst_keyin'].value" formControlName="gst_keyin" style="margin-left: 5px;margin-right: 5px;margin-bottom: 15px"
                    [disabled] = "!inveditFlag">GST KeyIn
                    </mat-checkbox>
                    </section>
                </td>
                <td>
                    <tr>
                    <td  *ngIf="inveditFlag" style="width: 30px;">
                    <input #fileInput id="invoice-detail-0001" hidden type="file" multiple style="margin-left: 20px;"  (change)="getFileDetails(0,$event)">
                        <i  (click)="fileInput.click()" style="margin-left: 10px" class="fa fa-cloud-upload" 
                        matTooltip="Upload file" matTooltipClass="custom-tooltipnew" aria-hidden="true" matTooltipClass="custom-tooltipnew"
                        style="font-size: 25px;color: blue;margin-left: 10px;"></i>
                    </td>
                    <td  *ngIf="this.frmInvHdr?.value.file_key?.length > 0 || this.attachedFile.length > 0" style="margin-left: 10px; width: 140px;">
                        <i matTooltip="View File" matTooltipClass="custom-tooltipnew" class=" fa fa-eye create "
                       data-target="#invoice-detail-0019" data-toggle="modal"
                       style="cursor: pointer;color:blue;margin-left: 15px;"></i> 
                       <button type="submit" *ngIf="movedata != 'ECF' && inveditFlag"
                       style="border-radius:40px;margin-left:10px;"
                       class="btn btn-outline-primary" (click)="SubmitInvHdr()"
                       [disabled]="disableinvhdrsave" id="invoice-detail-0051">
                       Save</button>
                    </td>
                    </tr>
            </td>
            </tr>    
             
            
                </div>  
                </table>
            </form> -->

            <!-- <td style="align-items: center;"> -->
                                        <!-- <input #fileInput id="ecfview-0002" type="file" multiple style="width: 108px;" hidden (change)="getFileDetails($event)">
                                            <i  (click)="fileInput.click()"  class="fa fa-cloud-upload" matTooltip="Upload file"
                                            matTooltipClass="custom-tooltipnew" aria-hidden="true" style="font-size: 25px;color: blue;"
                                           ></i> -->
                                            <!-- <span class=" fa fa-eye create " style="cursor: pointer;" matTooltipClass="custom-tooltipnew"
                                            matTooltip="View File" style="color: blue;cursor: pointer;padding:10px"
                                            data-toggle="modal" data-target="#ecfview-0007" (click)="getFileDetails(section,i)"></span> -->
                                        <!-- <button type="button" class="btn btn-outline"  #fileInput id="ecfview-0003" type="file" multiple
                                            style="border-radius: 40px;border-color:blueviolet;cursor:pointer"
                                            matTooltip="Upload file"  (change)="getFileDetails(i,$event)">
                                            <i  (click)="fileInput.click()" class="fa fa-upload" aria-hidden="true" style="color:blueviolet"></i>
                                        </button>
                                        <input type="file" #fileInput style="display:none;"
                                         id="ecfview-0041"> -->
                                    <!-- </td> -->






<!-- <i (click)="UploadPopupOpen()" class="fa fa-cloud-upload" matTooltip="Upload file"
                                        matTooltipClass="custom-tooltipnew" aria-hidden="true"
                                        style="font-size: 25px;color: blue;"></i> -->

<div class="modal fade" tabindex="-1" role="dialog" id="invoice-detail-0304"
    data-keyboard="false" data-backdrop="static" aria-labelledby="myExtraLargeModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title">
                        Note Pad
                    </h2>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                </div>

                <div class="modal-body">
                    <div>
                         <div [ngxSummernote]="config"
                            [ngxSummernoteDisabled]="editorDisabled"    
                            (blur)="onBlur()" (mediaDelete)="onDelete($event)"
                            (summernoteInit)="summernoteInit($event)"
                            formControlName="notename">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" style="border-radius:40px;"
                        class="btn btn-outline-primary"
                        data-dismiss="modal" id="create-ecf-0045">
                        Back</button>
                </div>
            </div>
        </div>
    </div>
    </form>
                <!-- ----------Debit detail if aptype is advance--------- -->

                <div *ngIf="this.aptypeid == 4" style="margin: 20px 0;">
                    <tr style="display: flex;gap: 10px;align-items: center;margin-bottom: 10px;">
                        <!-- <td> -->
                            <h3>Debit Details</h3>
                        <!-- </td> -->
                        <!-- <td> -->
                        <!-- <td>
                <button type="button" class="btn btn-outline-success" matTooltip="Add debit details" matTooltipClass="custom-tooltipnew" 
                [class.disabled]="debitsaved" *ngIf="movedata != 'apapproverview'"
                style="border-radius:30px;margin-left:30px;" (click)="adddebitSection()" id="invoice-detail-0052">
                    <span class="fa fa-plus">&nbsp;&nbsp;Debit Details</span>
                </button>
                </td> -->
                        <!-- <td> -->
                            <button mat-icon-button *ngIf="movedata != 'apapproverview'" matTooltip=" Edit"
                                matTooltipClass="custom-tooltipnew" class="iconbutton" color="primary"
                                 (click)="showdebitedit()"
                                id="invoice-detail-0053">
                                <mat-icon [ngClass]="debitsaved ? 'edit_disabled' : 'edit_enabled'"
                                    aria-label="Edit">edit</mat-icon>
                            </button>
                        <!-- </td> -->
                        <!-- <td *ngIf="movedata != 'AP'" >
                                    <button type="button" class="btn btn-outline-primary" style="border-radius:50px;margin-left : 620px;font-size: medium;"
                                        data-toggle="modal" data-target="#invoice-detail-0008" (click)="viewtrn()" id="invoice-detail-0054">View Transaction
                                        </button> 
                                </td> -->
                        <td *ngIf="movedata != 'ECF'" style="width: 61%;">
                            <div style="float: right">
                                <!-- <button type="button" class="btn btn-outline-primary" style="border-radius:50px;margin-left : 10px;font-size: medium;"
                                    data-toggle="modal" data-target="#invoice-detail-0008" (click)="viewtrn()" id="invoice-detail-0055">View Transaction
                                    </button> -->
                                <button type="button" class="btn btn-outline-primary" style="
                                      margin-left: 10px;
                                      border-radius: 50px;
                                      font-size: medium;
                                    " (click)="getquestion()" id="invoice-detail-0056">
                                    <!-- data-toggle="modal"
                                  data-target="#invoice-detail-0012" -->
                                    Audit Checklist
                                </button>
                                <button type="button" class="btn btn-outline-primary" style="
                      margin-left: 10px;
                      border-radius: 50px;
                      font-size: medium;
                    " (click)="getdedup()" id="invoice-detail-0076">
                                    <!-- data-toggle="modal"
                  data-target="#invoice-detail-0011" -->
                                    Dedupe Check
                                </button>
                            </div>
                        </td>
                    </tr>
                    <div>
                        <form [formGroup]="DebitDetailForm">
                            <div class="comp-table t-resposive t-bdr-line t-HoverZoom" id="summary-table">
                                <table class="table" fixed-header>
                                    <thead class="table_header">
                                        <tr>
                                            <th>S.No</th>
                                            <th>Category<label style="color:red">*</label></th>
                                            <th>Sub Category <label style="color:red">*</label></th>
                                            <th>GL Number</th>
                                            <!-- <th>Business Product Code</th> -->
                                            <th *ngIf="movedata != 'apapproverview'">Split</th>
                                            <th>BS <label style="color:red">*</label></th>
                                            <th>CC<label style="color:red">*</label></th>
                                            <th>CCBS Percentage</th>
                                            <th>Amount<label style="color:red">*</label></th>
                                            <th>Adjust Amount</th>
                                            <th>Debit Amount</th>
                                            <th *ngIf="movedata != 'apapproverview'">Action</th>

                                        </tr>
                                    </thead>
                                    <ng-container formArrayName="debitdtl"
                                        *ngFor="let section of getDebitSections(DebitDetailForm); let i = index">
                                        <tr [formGroupName]="i">
                                            <!-- <td *ngIf="showaltslno == false">{{creditslno}}</td>
                            <td *ngIf="showaltslno == true">{{creditslnos}}</td> -->
                                            <td>{{i+1}}</td>
                                            <td id="matInput-size">
                                                <mat-form-field appearance="outline" (click)="getcat('')">
                                                    <mat-label>Category</mat-label>
                                                    <input #categoryInput placeholder="Category" matInput [readonly]="this.readonlydebit[i] || debitsaved || movedata == 'apapproverview'"
                                                     formControlName="category_code" 
                                                        [matAutocomplete]="cattype" id="invoice-detail-0058">
                                                    <mat-autocomplete [panelWidth]="250" #cattype="matAutocomplete"
                                                        [displayWith]="displaycatFn"
                                                        (opened)="categoryScroll(i, cattype)">
                                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                        </mat-option>
                                                        <ng-container *ngIf="!isLoading">
                                                            <mat-option *ngFor="let categoryname of categoryNameData"
                                                                (onSelectionChange)="cid(categoryname, '',i)"
                                                                [value]="categoryname">
                                                                {{categoryname.code}}
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>
                                                    <mat-icon matSuffix *ngIf="DebitDetailForm?.value?.debitdtl[i]?.category_code?.code != 'GST Tax' && !debitsaved 
                                    && movedata != 'apapproverview'" style="color: red !important;" 
                                    matTooltip="Clear" matTooltipClass="custom-tooltipnew" (click)="categoryClear(i);">clear</mat-icon> 
                                                </mat-form-field>
                                                <p *ngIf="DebitDetailForm?.value?.debitdtl[i].category_code !='' && DebitDetailForm?.value?.debitdtl[i].category_code != 0 && DebitDetailForm?.value?.debitdtl[i].category_code != null && DebitDetailForm?.value?.debitdtl[i].category_code !=undefined"
                                                    style="color: blue;font: size 11px;">
                                                    {{section?.value?.category_code?.name}}</p>
                                            </td>
                                            <td id="matInput-size">
                                                <mat-form-field appearance="outline">
                                                    <mat-label>Sub Category</mat-label>
                                                    <input #subcategoryInput placeholder="Sub Category" matInput  (focus)="getsubcatDebit(i,'')"
                                     [readonly]="this.readonlydebit[i] ||debitsaved || movedata == 'apapproverview'" formControlName="subcategory_code"
                                            (click)="getsubcatDebit(i,'')" [matAutocomplete]="subcategorytype" id="invoice-detail-0059">
                                                    <mat-autocomplete [panelWidth]="250"
                                                        #subcategorytype="matAutocomplete"
                                                        [displayWith]="displaysubcatFn"
                                                        (opened)="subcategoryScroll(i, subcategorytype)">
                                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                        </mat-option>
                                                        <ng-container *ngIf="!isLoading">
                                                            <mat-option
                                                                *ngFor="let subcategoryname of subcategoryNameData"
                                                                [value]="subcategoryname"
                                                                (onSelectionChange)="getGLNumber(subcategoryname,i)">
                                                                {{subcategoryname.code}}
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>
                                                    <mat-icon matSuffix style="color: red !important;"  *ngIf="DebitDetailForm?.value?.debitdtl[i]?.subcategory_code?.code != 'GST Tax' && !debitsaved 
                                    && movedata != 'apapproverview'"
                                matTooltip="Clear" matTooltipClass="custom-tooltipnew" (click)="subcatClear(i);">clear</mat-icon>
                                                </mat-form-field>
                                                <p *ngIf="DebitDetailForm?.value?.debitdtl[i].subcategory_code !='' && DebitDetailForm?.value?.debitdtl[i].subcategory_code != 0 && DebitDetailForm?.value?.debitdtl[i].subcategory_code != null && DebitDetailForm?.value?.debitdtl[i].subcategory_code !=undefined"
                                                style="color: blue;font: size 11px;">{{section?.value?.subcategory_code?.name}}</p>
                                            </td>
                                            <td id="matInput-size">
                                                <mat-form-field appearance="outline">

                                                    <input matInput placeholder="GL Number" type="text"
                                                        formControlName="glno" autocomplete="off"
                                                        (keypress)="only_numalpha($event)" [readonly]="true"
                                                        id="invoice-detail-0060">
                                                </mat-form-field>
                                                <p *ngIf="DebitDetailForm?.value?.debitdtl[i].glno !='' && DebitDetailForm?.value?.debitdtl[i].glno != 0 && DebitDetailForm?.value?.debitdtl[i].glno != null && DebitDetailForm?.value?.debitdtl[i].glno !=undefined"
                                                    style="color: blue;font: size 11px;">{{section?.value?.gldesc}}</p>
                                            </td>
                                            <!-- <td>
                                <mat-form-field style="font-size:15px" (click)="getbpdropdown()">
                                    <mat-label>Business Product Code</mat-label>
        
        
                                    <input #bsproductInput matInput formControlName="bsproduct_code"
                                        [matAutocomplete]="producttype"  id="invoice-detail-0061">
                                    <mat-icon matSuffix class="maticonsize">unfold_more</mat-icon>
                                    <mat-autocomplete  [panelWidth]="400" #producttype="matAutocomplete" [displayWith]="displayFnbp"
                                        (opened)="bpScroll()">
                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                        </mat-option>
                                        <ng-container *ngIf="!isLoading">
                                            <mat-option *ngFor="let data of businesslist"  [value]="data">
                                                {{data.bsproduct_name}}
                                            </mat-option>
                                        </ng-container>
                                    </mat-autocomplete>
                                </mat-form-field>
                            </td> -->
                                            <td
                                            *ngIf="movedata != 'apapproverview' && ! this.readonlydebit[i] && !debitsaved">
                                                <i (click)="adddsplit(section, i)" class="fa fa-code-fork"
                                                    style="font-size: 30px;margin-top: 15px;margin-left: 7px;"></i>
                                                <!-- <mat-icon (click)="adddsplit(section, i)">fork_right</mat-icon> -->
                                            </td>
                                            <td
                                            *ngIf="movedata != 'apapproverview' && (this.readonlydebit[i]==true || debitsaved)">
                                            </td>
                                            <td id="matInput-size">
                                                <mat-form-field appearance="outline" (click)="getbsdropdown()">


                                                    <mat-label>BS</mat-label>

                                                    <input #bsInput placeholder="BS" matInput formControlName="bs_code" 
                                                    [readonly]="this.readonlydebit[i] ||debitsaved || movedata == 'apapproverview'"
                                                        [matAutocomplete]="bstype"  id="invoice-detail-0062">
                                                    <mat-autocomplete [panelWidth]="250" #bstype="matAutocomplete"
                                                        [displayWith]="displaybsFn" (opened)="bsScroll(i, bstype)">
                                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                        </mat-option>
                                                        <ng-container *ngIf="!isLoading">
                                                            <mat-option *ngFor="let bsname of bsNameData"
                                                                [value]="bsname"
                                                                (onSelectionChange)="bsid(bsname,bsname.code,i)">
                                                                {{bsname.name}}
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>&nbsp; &nbsp;
                                                  <mat-icon matSuffix  *ngIf="movedata != 'apapproverview' && !debitsaved && ! readonlydebit[i]" 
                                      style="color: red !important;" matTooltip="Clear"
                                    matTooltipClass="custom-tooltipnew" (click)="bsClear(i);">clear</mat-icon>

                                                </mat-form-field>
                                            </td>
                                            <td id="matInput-size">
                                                <mat-form-field appearance="outline" >
                                                    <mat-label>CC</mat-label>
                                                    <input #ccinput placeholder="CC" matInput formControlName="cc_code"  style="width: 160px;" (focus)="getccDebit('',i)"
                                                    [readonly]="this.readonlydebit[i] ||debitsaved || movedata == 'apapproverview'"  (click)="getccDebit('',i)"
                                                        [matAutocomplete]="cctype"  id="invoice-detail-0063">
                                                    <mat-autocomplete [panelWidth]="250" #cctype="matAutocomplete"
                                                        [displayWith]="displayccFn" (opened)="ccScroll(i, cctype)">
                                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                        </mat-option>
                                                        <ng-container *ngIf="!isLoading">
                                                            <mat-option *ngFor="let ccname of ccNameData"
                                                                [value]="ccname"
                                                                (onSelectionChange)="getccdata(ccname.code,ccname.id)">
                                                                {{ccname.name}}
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>&nbsp; &nbsp;
                                                    <mat-icon matSuffix *ngIf="!debitsaved && ! readonlydebit[i] && movedata != 'apapproverview'" 
                                      style="color: red !important;" matTooltip="Clear" matTooltipClass="custom-tooltipnew"
                                      (click)="CCclear(i);">clear</mat-icon>
                                                </mat-form-field>
                                            </td>
                                            <td id="matInput-size">
                                                <mat-form-field appearance="outline">

                                                    <input matInput placeholder="%" formControlName="ccbspercentage"
                                                        [readonly]="this.readonlydebit[i] || debitsaved" appCleardirective
                                                        autocomplete="off" (keypress)="numberOnlyandDot($event,DebitDetailForm.value.debitdtl[i].ccbspercentage)"
                                                        (change)="valPercent( i)" (input)="calcCCBSAmt(i)"(click)="addondebindex(i)"
                                                        id="invoice-detail-0064">
                                                </mat-form-field>
                                            </td>
                                            <td id="matInput-size">

                                                <mat-form-field appearance="outline">
                                                    <input matInput placeholder="Amount" #amt type="text"
                                                        autocomplete="off"
                                                        [readonly]="this.readonlydebit[i] || debitsaved"
                                                        formControlName="amt" maxlength="10"
                                                        (keypress)="getCharCode($event);numberOnlyandDot($event, DebitDetailForm.value.debitdtl[i].amt)"
                                                        (input)="debitChangeToCurrency(i);calcCCBSPerc(i)"
                                                        (change)="debitamt(i)" style="text-align: right;"
                                                        (change)="debitamtDecimalChg(amt ,'amt', i)"
                                                        id="invoice-detail-0065">
                                                </mat-form-field>
                                            </td>
                                            <td id="matInput-size">
                                                <mat-form-field appearance="outline">


                                                    <input matInput placeholder="Adjust" type="text"
                                                        [readonly]="this.readonlydebit[i] || debitsaved" [min]="min"
                                                        [max]="max" #deductionamount formControlName="deductionamount"
                                                        autocomplete="off" [value]="0"
                                                        (change)="debitamtDecimalChg(deductionamount ,'deductionamount', i)"
                                                        (keypress)="numberOnlyandDotminus($event, InvoiceDetailForm.value.debitdtl[i].deductionamount)" style="text-align: right;" 
                                                        (ngModelChange)="AdjustAmount($event,i)" id="invoice-detail-0066">
                                                </mat-form-field>

                                            </td>
                                            <td id="matInput-size">
                                                <mat-form-field appearance="outline">
                                                    <input matInput placeholder="Debit" type="text"
                                                        formControlName="amount" readonly style="text-align: right;"
                                                        id="invoice-detail-0067">
                                                </mat-form-field>
                                            </td>
                                            <td
                                                *ngIf="movedata != 'apapproverview' && this.readonlydebit[i]==false && DebitDetailForm?.value?.debitdtl[i]?.category_code?.code != 'GST Tax' && !debitsaved">
                                                <button mat-icon-button type="button" id="invoice-detail-0068">
                                                    <mat-icon style="color:black;" aria-label="Edit" matTooltip="delete"
                                                        matTooltipClass="custom-tooltipnew"
                                                        (click)="deletedebitdetail(section,i)">
                                                        delete</mat-icon>
                                                </button>
                                            </td>

                                            <td
                                                *ngIf="movedata != 'apapproverview' && (this.readonlydebit[i] || DebitDetailForm?.value?.debitdtl[i]?.category_code?.code == 'GST Tax' || debitsaved)">
                                                <button mat-icon-button type="button" id="invoice-detail-0068">
                                                    <mat-icon style="color: grey;" aria-label="Edit">
                                                        delete</mat-icon>
                                                </button>
                                            </td>

                                            <!-- <td *ngIf="this.readonlydebit[i]==true || DebitDetailForm?.value?.debitdtl[i]?.category_code?.code == 'GST Tax' || debitsaved">
                            </td>                         -->
                                        </tr>
                                    </ng-container>
                                    <tr id="matInput-size">

                                        <td *ngIf="movedata !='apapproverview'" class="totaldisplay" colspan="10"
                                            style="text-align: right;">Net Amount:
                                        </td>

                                        <td *ngIf="movedata =='apapproverview'" class="totaldisplay" colspan="9"
                                            style="text-align: right;">Net Amount:
                                        </td>

                                        <td style="text-align: end;">{{debitsum | currency:'INR'}}</td>
                                        <td *ngIf="movedata != 'apapproverview'"></td>
                                    </tr>
                                    <tr *ngIf="movedata != 'apapproverview'">
                                        <td colspan="13">
                                            <button type="button" style="border-radius:40px;float: right;"
                                                class="btn btn-outline-success" (click)="debitform()"
                                                [disabled]="debitsaved" id="invoice-detail-0069">
                                                Save
                                            </button>
                                        </td>
                                    </tr>
                                </table>
                            </div>

                        </form>
                    </div>
                </div>
                <!-- -------------- -->
                <div *ngIf="!showPOdiv">
                    <form [formGroup]="InvoiceDetailForm">
                        <!-- ----------Invoice detail if aptype other than advance--------- -->

                        <div *ngIf="this.aptypeid !=4">
                            <div class="header-container">
                                <h3>
                                    Invoice Details
                                    <button *ngIf="movedata != 'apapproverview' &&aptypeid!=1 " type="button"
                                        class="btn btn-outline-success" matTooltip="Add invoice details"
                                        matTooltipClass="custom-tooltipnew" [class.disabled]="invdtlsaved"
                                        style="border-radius:40px;margin-left: 30px;font-size:medium;"
                                        (click)="addinvdtlSection()" id="invoice-detail-0070">
                                        <i class="fa fa-plus">&nbsp;&nbsp;Invoice Details</i>
                                    </button>
                                    <button *ngIf="movedata != 'apapproverview'" mat-icon-button matTooltip=" Edit"
                                        matTooltipClass="custom-tooltipnew" class="iconbutton" color="primary"
                                        style="margin-left:10px;margin-top: 10px;border-radius: 40%;"
                                        (click)="showdtledit()" id="invoice-detail-0071">
                                        <mat-icon [ngClass]="invdtlsaved ? 'edit_disabled' : 'edit_enabled'"
                                            aria-label="Edit">edit</mat-icon>
                                    </button>
                                    <button *ngIf="aptypeid==1 " type="button"
                                        class="btn btn-outline-success" matTooltip="Add TCS"
                                        matTooltipClass="custom-tooltipnew" 
                                        style="border-radius:40px;margin-left: 30px;font-size:medium;"
                                        (click)="addinvdtltcs()" id="invoice-detail-0070" [disabled]="tcsAdded || movedata=='apapproverview'">
                                        <i class="fa fa-plus">&nbsp;&nbsp;TCS</i>
                                    </button>
                                    <!-- <button *ngIf="movedata == 'ECF'" type="button" class="btn btn-outline-primary"
                                    style="border-radius:50px;margin-left : 620px;font-size: medium;"
                                    data-toggle="modal" (click)="viewtrn()" id="invoice-detail-0072">View
                                    Transaction
                                </button> -->
                                </h3>
                                <div class="button-div" *ngIf="movedata != 'ECF'">
                                    <!-- <button type="button" class="btn btn-outline-primary" style="border-radius:50px;margin-left : 10px;font-size: medium;"
                                data-toggle="modal"  (click)="viewtrn()" id="invoice-detail-0073">View Transaction
                                </button> -->
                                    <button type="button" *ngIf="movedata == 'AP' || movedata == 'apapproverview'"
                                        class="btn btn-outline-primary"
                                        style="margin-left: 10px;border-radius:50px; font-size:medium;"
                                        data-toggle="modal" (click)="getquestion()" id="invoice-detail-0074">Audit
                                        Checklist
                                    </button>
                                    <!-- <button type="button" *ngIf="movedata == 'apapproverview'" class="btn btn-outline-primary" style="margin-left: 10px;border-radius:50px; font-size:medium;"
                                data-toggle="modal" data-target="#auditCheckView" (click)="getquestionView()"   id="invoice-detail-0075">Audit Checklist
                                                              </button>   -->
                                    <button type="button" class="btn btn-outline-primary"
                                        style="margin-left: 10px;border-radius:50px;font-size: medium;"
                                        data-toggle="modal" (click)="getdedup()" id="invoice-detail-0076">Dedupe Check
                                    </button>
                                </div>
                            </div>
                            <br>
                            <div class="comp-table t-resposive t-bdr-line t-HoverZoom" id="summary-table">
                                <table class="table" fixed-header>
                                    <thead class="table_header">
                                        <tr>
                                            <th>S.No</th>
                                            <th>Particulars<span style="color:red">*</span></th>
                                            <th *ngIf="aptypeid == 1">GRN Code</th>
                                            <th>Product Name<span style="color:red">*</span></th>
                                            <!-- <th style="width: 50px;">Is RCM</th> -->
                                            <th *ngIf="this.aptypeid == 13 || this.aptypeid == 3">Supplier<span
                                                    style="color:red">*</span></th>
                                            <!-- <th style="width: 70px;">UOM</th>    -->
                                            <th *ngIf=" this.aptypeid !== 4 && this.aptypeid !== 8" style="width:80px">
                                                HSN Code<span style="color:red">*</span></th>
                                            <th *ngIf=" this.aptypeid !== 4 && this.aptypeid !== 8" style="width:30px">
                                                HSN %<span style="color:red">*</span></th>
                                            <th style="width:100px">Unit Price<span style="color:red">*</span></th>
                                            <th style="width:50px">Quantity<span style="color:red">*</span></th>
                                            <th style="width:100px">Amount</th>
                                            <th style="width:100px" *ngIf="this.aptypeid !== 4 && this.aptypeid !== 8">
                                                Discount</th>
                                            <th style="width:100px">Taxable Amount</th>
                                            <th style="width:100px" *ngIf="this.aptypeid !== 4 && this.aptypeid !== 8">
                                                CGST</th>
                                            <th style="width:100px" *ngIf="this.aptypeid !== 4 && this.aptypeid !== 8">
                                                SGST</th>
                                            <th style="width:100px" *ngIf="this.aptypeid !== 4 && this.aptypeid !== 8">
                                                IGST</th>
                                            <th style="width:100px" *ngIf="this.aptypeid !== 4 && this.aptypeid !== 8">
                                                Tax Amount</th>
                                            <th style="width:100px">Total Amount</th>
                                            <th *ngIf="aptypeid != 13">Is Capitalized</th>
                                            <th *ngIf="showSubCategoryHeader">Capitalized Type</th> 
                                            <th *ngIf="movedata != 'apapproverview'">Action</th>
                                            <th>View</th>
                                        </tr>
                                    </thead>
                                    <ng-container formArrayName="invoicedtls"
                                        *ngFor="let section of InvoiceDetailForm.controls.invoicedtls['controls']; let invdtlindex = index">
                                        <tr [formGroupName]="invdtlindex">
                                            <td>
                                                {{invdtlindex+1}}</td>
                                            <td id="matInput-size">
                                                <mat-form-field appearance="outline">
                                                    <input matInput formControlName="description" #desc
                                                        (change)="filterText(desc, 'desc', invdtlindex)" maxlength="50"
                                                        autocomplete="off" [readonly]="invdtlsaved"
                                                        [matTooltip]="InvoiceDetailForm.value.invoicedtls[invdtlindex].description"
                                                        matTooltipClass="custom-tooltipnew" id="invoice-detail-0077">
                                                    <mat-label>Particulars</mat-label>
                                                </mat-form-field>
                                            </td>
                                            <td *ngIf="aptypeid ==1" id="matInput-size">
                                                <div style="display: flex; align-items: center; gap: 8px;">
                                                <mat-form-field appearance="outline">
                                                    <input matInput formControlName="grn_code" readonly
                                                        [matTooltip]="InvoiceDetailForm.value.invoicedtls[invdtlindex].grn_code"
                                                        matTooltipClass="custom-tooltipnew" id="invoice-detail-0078">
                                                    <mat-label>GRN Code</mat-label>
                                                </mat-form-field>
                                                  <button  *ngIf="aptypeid == 1 && !invdtlsaved && (!ispocomponentsavedFlags[invdtlindex] && movedata !== 'apapproverview')" type="button"
                                                    class="btn btn-outline-success" matTooltip="Add Component"
                                                    matTooltipClass="custom-tooltipnew"
                                                    style="border-radius:40px;margin-left: 30px;font-size:medium;"
                                                    (click)="addpodetails(invdtlindex)" id="invoice-detail-0070"
                                                      [disabled]="section.get('productname')?.value.name === 'Tax collected at source'">
                                                    <i class="fa fa-plus"></i>
                                                </button>
                                                <button  *ngIf="aptypeid == 1 && (invdtlsaved || ispocomponentsavedFlags[invdtlindex] || movedata === 'apapproverview')" type="button"
                                                    class="btn btn-outline-success" matTooltip="View Component"
                                                    matTooltipClass="custom-tooltipnew"
                                                    style="border-radius:40px;margin-left: 30px;font-size:medium;"
                                                     (click)="addpodetails(invdtlindex)" id="invoice-detail-0070"
                                                       [disabled]="section.get('productname')?.value.name === 'Tax collected at source'">
                                                    <i class="fa fa-eye"></i>
                                                </button>
                                                </div>
                                            </td>
                                            <td id="matInput-size">
                                                <mat-form-field appearance="outline">

                                                    <mat-label>Product</mat-label>
                                                    <input #productInput placeholder="Product" matInput
                                                        formControlName="productname" [readonly]="invdtlsaved"
                                                        [matAutocomplete]="prodAutocom" (click)="getindex(invdtlindex)"
                                                        id="invoice-detail-0079">
                                                    <mat-autocomplete [panelWidth]="250" #prodAutocom="matAutocomplete"
                                                        [displayWith]="displayFnProduct">
                                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                        </mat-option>
                                                        <ng-container *ngIf="!isLoading">
                                                            <mat-option *ngFor="let prod of prodList" [value]="prod"
                                                                (onSelectionChange)="productChange(prod,invdtlindex)"
                                                                matTooltip="{{prod.name}}"
                                                                matTooltipClass="custom-tooltipnew">

                                                                {{prod.name}}
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>
                                                    <!-- &nbsp;&nbsp;
                                        <mat-icon [class.disabled]="invdtlsaved" style="color: red;font-size:20px" matTooltip="Clear Product" matTooltipClass="custom-tooltipnew" (click)="productClear(invdtlindex);">clear</mat-icon> -->
                                                </mat-form-field>

                                                <h3 *ngIf="showrcm[invdtlindex] == true">Is RCM :<span
                                                        [ngStyle]=" this.prodRcm[invdtlindex] == 'Yes'?{'color':'green','font-weight':'bold'}: {'color': 'red','font-weight':'bold'}">{{prodRcm[invdtlindex]}}</span>&nbsp;&nbsp;Is
                                                    Blocked:<span
                                                        [ngStyle]=" this.prodBlock[invdtlindex] == 'Yes'?{'color':'green','font-weight':'bold'}: {'color': 'red','font-weight':'bold'}">{{this.prodBlock
                                                        [invdtlindex]}}</span></h3>
                                            </td>
                                            <!-- <td>
                                        <mat-form-field style="width: 30px;">
                                            <input matInput formControlName="is_rcmproduct" placeholder="Is RCM" 
                                                autocomplete="off" readonly id="invoice-detail-0080">
                                        </mat-form-field>
                                    </td> -->
                                            <!-- <td *ngIf="this.aptypeid == 13" style="text-align: center;">
                                        <i class="fa fa-arrow-up" aria-hidden="true" style="color: darkviolet;" (click)="getsupplierindex(invdtlindex,section)"
                                            data-toggle="modal" data-target="#supplierdetailpopup"></i> -->

                                            <!-- <td
                                            *ngIf="this.aptypeid == 13 || this.aptypeid == 3"
                                              id="matInput-size"
                                          >
                                            <i
                                              matTooltip="Supplier Details"
                                              matTooltipClass="custom-tooltipnew"
                                              class="fa fa-arrow-up"
                                              style="color: darkviolet; padding: 10px"
                                              (click)="getsupplierindex(invdtlindex, section)"
                                            > -->
                                            <!-- data-toggle="modal"
                                              data-target="#invoice-detail-0006" -->
                                            <!-- </i>
                                          </td> -->
                                            <!-- <td *ngIf="this.aptypeid == 13 || this.aptypeid == 3" style="text-align: center;">
                                            <i *ngIf="this.InvoiceDetailForm.value.invoicedtls[invdtlindex].supplier_name == '' ||
                                            this.InvoiceDetailForm.value.invoicedtls[invdtlindex].supplier_name == null ||
                                            this.InvoiceDetailForm.value.invoicedtls[invdtlindex].supplier_name == undefined"
                                            matTooltip="Supplier Details" matTooltipClass="custom-tooltipnew" class="fa fa-arrow-up" 
                                            style="color: darkviolet;padding:10px"  (click)="getsupplierindex(invdtlindex,section)"
                                                data-toggle="modal" data-target="#invoice-detail-0006"></i>
                                            <i *ngIf="this.InvoiceDetailForm.value.invoicedtls[invdtlindex].supplier_name != '' &&
                                            this.InvoiceDetailForm.value.invoicedtls[invdtlindex].supplier_name != null &&
                                            this.InvoiceDetailForm.value.invoicedtls[invdtlindex].supplier_name != undefined"
                                            matTooltip="Supplier Details" matTooltipClass="custom-tooltipnew" class="fa fa-eye create " 
                                            style="color: darkviolet;padding:10px"
                                                data-toggle="modal" data-target="#invoice-detail-0006"   (click)="getsupplierindex(invdtlindex,section)"></i>
                                            </td> -->
                                            <td *ngIf="this.aptypeid == 13 || this.aptypeid == 3"
                                                style="text-align: center;">
                                                <i *ngIf="this.InvoiceDetailForm.value.invoicedtls[invdtlindex].supplier_name == '' ||
                                                this.InvoiceDetailForm.value.invoicedtls[invdtlindex].supplier_name == null ||
                                                this.InvoiceDetailForm.value.invoicedtls[invdtlindex].supplier_name == undefined"
                                                    matTooltip="Supplier Details" matTooltipClass="custom-tooltipnew"
                                                    class="fa fa-arrow-up" style="color: darkviolet;padding:10px"
                                                    (click)="getsupplierindex(invdtlindex,section)"
                                                    data-toggle="modal"></i>
                                                <i *ngIf="this.InvoiceDetailForm.value.invoicedtls[invdtlindex].supplier_name != '' &&
                                                this.InvoiceDetailForm.value.invoicedtls[invdtlindex].supplier_name != null &&
                                                this.InvoiceDetailForm.value.invoicedtls[invdtlindex].supplier_name != undefined"
                                                    matTooltip="Supplier Details" matTooltipClass="custom-tooltipnew"
                                                    class="fa fa-eye create " style="color: darkviolet;padding:10px"
                                                    data-toggle="modal"
                                                    (click)="getsupplierindex(invdtlindex,section)"></i>
                                            </td>
                                            <!-- <td>
                                        <mat-form-field style="width: 55px;">
                                            <input matInput formControlName="uom" placeholder="UOM" 
                                                autocomplete="off" id="invoice-detail-0081">
                                        </mat-form-field>
                                    </td> -->
                                            <!-- [readonly]="!gstAppl" -->
                                            <td *ngIf="this.aptypeid !== 4 && this.aptypeid !== 8" id="matInput-size">
                                                <mat-form-field (click)="gethsn('')" appearance="outline">

                                                    <mat-label>HSN Code</mat-label>
                                                    <input #hsnInput placeholder="HSN" matInput formControlName="hsn"
                                                        [readonly]="invdtlsaved" [matAutocomplete]="hsntype"
                                                        (click)="getindex(invdtlindex)" id="invoice-detail-0082">
                                                    <mat-autocomplete [panelWidth]="200" #hsntype="matAutocomplete"
                                                        [displayWith]="displayFnhsn" (opened)="hsnScroll()"
                                                        (optionSelected)="getgst(invdtlindex);">
                                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                        </mat-option>
                                                        <ng-container *ngIf="!isLoading">
                                                            <mat-option *ngFor="let hsn of hsnList" [value]="hsn"
                                                                (click)="gethsncode(hsn,invdtlindex)">
                                                                {{hsn.code}}
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>
                                                </mat-form-field>
                                            </td>

                                            <td *ngIf=" this.aptypeid !== 4 && this.aptypeid !== 8" id="matInput-size">
                                                <mat-form-field appearance="outline">
                                                    <input matInput formControlName="hsn_percentage" placeholder="HSN %"
                                                        readonly autocomplete="off" id="invoice-detail-0083">
                                                </mat-form-field>
                                            </td>

                                            <td *ngIf=" this.aptypeid !== 1"  id="matInput-size">
                                                <mat-form-field appearance="outline">
                                                    <input matInput placeholder="Unit Price" formControlName="unitprice"
                                                        #unitprice style="text-align: right;" [readonly]="invdtlsaved|| ispocomponentsavedFlags[invdtlindex]||aptypeid == 1"
                                                        (keypress)="getCharCode($event);numberOnlyandDot($event, InvoiceDetailForm.value.invoicedtls[invdtlindex].unitprice)"
                                                        (input)="invDtlChangeToCurrency('unitprice', invdtlindex)"
                                                        (change)="invdtlamtDecimalChg(unitprice ,'unitprice', invdtlindex)"
                                                        autocomplete="off" (change)="getgst(invdtlindex)" appCleardirective
                                                        id="invoice-detail-0084">
                                                    <!-- (click)="indexvalueOninvdetails(invdtlindex)" -->
                                                </mat-form-field>
                                            </td>
                                            <td *ngIf=" this.aptypeid == 1" id="matInput-size">
                                                <mat-form-field appearance="outline">
                                                    <input matInput placeholder="Unit Price" formControlName="unitprice"
                                                        #unitprice style="text-align: right;" [readonly]="invdtlsaved|| ispocomponentsavedFlags[invdtlindex]||(aptypeid == 1&& section.get('productname')?.value.name !== 'Tax collected at source')"
                                                        (keypress)="getCharCode($event);numberOnlyandDot($event, InvoiceDetailForm.value.invoicedtls[invdtlindex].unitprice)"
                                                        (input)="invDtlChangeToCurrency('unitprice', invdtlindex)"
                                                        (change)="invdtlamtDecimalChg(unitprice ,'unitprice', invdtlindex)"
                                                        autocomplete="off" (change)="getgst(invdtlindex)"
                                                        id="invoice-detail-0084">
                                                    <!-- (click)="indexvalueOninvdetails(invdtlindex)" -->
                                                </mat-form-field>
                                            </td>
                                            <td *ngIf=" this.aptypeid != 1" id="matInput-size">
                                                <mat-form-field appearance="outline">

                                                    <input matInput placeholder="Quantity" formControlName="quantity"
                                                        (keypress)="getCharCode($event);numberOnlyandDot($event,InvoiceDetailForm.value.invoicedtls[invdtlindex].quantity)"
                                                        (input)="invDtlChangeToCurrency('quantity', invdtlindex)" appCleardirective
                                                        #quantity autocomplete="off" [readonly]="invdtlsaved|| ispocomponentsavedFlags[invdtlindex]||aptypeid == 1"
                                                        (change)="getgst(invdtlindex)" id="invoice-detail-0085">

                                                </mat-form-field>
                                            </td>
                                            <td *ngIf=" this.aptypeid == 1" id="matInput-size">
                                                <mat-form-field appearance="outline">

                                                    <input matInput placeholder="Quantity" formControlName="quantity"
                                                        (keypress)="getCharCode($event);numberOnlyandDot($event,InvoiceDetailForm.value.invoicedtls[invdtlindex].quantity)"
                                                        (input)="invDtlChangeToCurrency('quantity', invdtlindex)"
                                                        #quantity autocomplete="off" [readonly]="invdtlsaved|| ispocomponentsavedFlags[invdtlindex]||aptypeid == 1"
                                                        (change)="getgst(invdtlindex)" id="invoice-detail-0085">

                                                </mat-form-field>
                                            </td>
                                            <td id="matInput-size">
                                                <mat-form-field appearance="outline">
                                                    <input matInput placeholder="Amount" formControlName="amount"
                                                        autocomplete="off" readonly style="text-align: right;"
                                                        id="invoice-detail-0086">
                                                </mat-form-field>
                                            </td>
                                            <td *ngIf=" this.aptypeid !== 4 && this.aptypeid !== 8 && this.aptypeid !== 1" id="matInput-size">
                                                <mat-form-field appearance="outline">
                                                    <input matInput placeholder="Discount" #discount
                                                        formControlName="discount"
                                                        (change)="getgst(invdtlindex);invdtlamtDecimalChg(discount ,'discount', invdtlindex)"
                                                        (keypress)="getCharCode($event);numberOnlyandDot($event,InvoiceDetailForm.value.invoicedtls[invdtlindex].discount)"
                                                        (input)="invDtlChangeToCurrency('discount', invdtlindex)"
                                                        autocomplete="off" style="text-align: right;" appCleardirective
                                                        [readonly]="invdtlsaved||aptypeid == 1" id="invoice-detail-0094">
                                                </mat-form-field>
                                            </td>
                                            <td *ngIf="this.aptypeid == 1" id="matInput-size">
                                                <mat-form-field appearance="outline">
                                                    <input matInput placeholder="Discount" #discount
                                                        formControlName="discount"
                                                        (change)="getgst(invdtlindex);invdtlamtDecimalChg(discount ,'discount', invdtlindex)"
                                                        (keypress)="getCharCode($event);numberOnlyandDot($event,InvoiceDetailForm.value.invoicedtls[invdtlindex].discount)"
                                                        (input)="invDtlChangeToCurrency('discount', invdtlindex)"
                                                        autocomplete="off" style="text-align: right;" 
                                                        [readonly]="invdtlsaved||aptypeid == 1" id="invoice-detail-0094">
                                                </mat-form-field>
                                            </td>
                                            <td id="matInput-size">
                                                <mat-form-field appearance="outline">
                                                    <input matInput placeholder="Taxable Amount"
                                                        formControlName="taxable_amount" autocomplete="off" readonly
                                                        style="text-align: right;" id="invoice-detail-0286">
                                                </mat-form-field>
                                            </td>
                                            <td *ngIf="this.aptypeid !== 4 && this.aptypeid !== 8" id="matInput-size">
                                                <mat-form-field appearance="outline">
                                                    <input matInput placeholder="CGST" formControlName="cgst" readonly
                                                        style="text-align: right;" id="invoice-detail-0087">
                                                    <!-- <input matInput placeholder="CGST" formControlName="cgst" [readonly]=" invdtlsaved || !(gsttype == 'IGST' && frmInvHdr.value.gst_keyin == true)" style ="text-align: right;"
                                            (keypress)="getCharCode($event);numberOnlyandDot($event)"  (input)="invDtlChangeToCurrency('cgst', invdtlindex);gstamtchange(invdtlindex)" id="invoice-detail-0088"> -->
                                                </mat-form-field>
                                            </td>
                                            <td *ngIf="this.aptypeid !== 4 && this.aptypeid !== 8" id="matInput-size">
                                                <mat-form-field appearance="outline">
                                                    <input matInput placeholder="SGST" formControlName="sgst" readonly
                                                        style="text-align: right;" id="invoice-detail-0089">
                                                    <!-- <input matInput placeholder="SGST" formControlName="sgst" [readonly]="invdtlsaved || !(gsttype == 'IGST' && frmInvHdr.value.gst_keyin == true)" style="text-align: right;"
                                            (keypress)="getCharCode($event);numberOnlyandDot($event)"  (input)="invDtlChangeToCurrency('sgst', invdtlindex);gstamtchange(invdtlindex)" id="invoice-detail-0090"> -->
                                                </mat-form-field>
                                            </td>
                                            <td *ngIf=" this.aptypeid !== 4 && this.aptypeid !== 8" id="matInput-size">
                                                <mat-form-field appearance="outline">
                                                    <input matInput placeholder="IGST" formControlName="igst" readonly
                                                        id="invoice-detail-0091">
                                                    <!-- <input matInput placeholder="IGST" formControlName="igst" [readonly]="invdtlsaved || !(gsttype == 'SGST & CGST' && frmInvHdr.value.gst_keyin == true)" style="text-align: right;"
                                            (keypress)="getCharCode($event);numberOnlyandDot($event)"  (input)="invDtlChangeToCurrency('igst', invdtlindex);gstamtchange(invdtlindex)" id="invoice-detail-0092"> -->
                                                </mat-form-field>
                                            </td>
                                            <td *ngIf="this.aptypeid !== 4 && this.aptypeid !== 8" id="matInput-size">
                                                <mat-form-field appearance="outline">
                                                    <input matInput placeholder="Tax" formControlName="taxamount"
                                                        readonly style="text-align: right;" id="invoice-detail-0093">
                                                </mat-form-field>
                                            </td>
                                            <td id="matInput-size">
                                                <mat-form-field appearance="outline">
                                                    <input matInput placeholder="Total" formControlName="totalamount"
                                                        autocomplete="off" readonly
                                                        (keypress)="getCharCode($event);numberOnlyandDot($event,InvoiceDetailForm.value.invoicedtls[invdtlindex].totalamount)"
                                                        (input)="invDtlChangeToCurrency('totalamount', invdtlindex)"
                                                        (click)="INVdatasums()" style="text-align: right;"
                                                        id="invoice-detail-0095">
                                                </mat-form-field>
                                            </td>
                                            <td style="text-align: center; vertical-align: middle; transform: translateY(-9px);" *ngIf="aptypeid != 13" 
                                                id="matInput-size">
                                                <section class="example-section">
                                                    <mat-checkbox class="example-margin"
                                                        formControlName="is_capitalized"
                                                        [disabled]="invdtlsaved ||!(aptypeid == 1 || aptypeid == 2)"  (change)="isfacapitalizedchecked($event,invdtlindex)"></mat-checkbox>
                                                </section>
                                            </td>
                                            <td *ngIf="showSubCategoryHeader" id="matInput-size">
                                                <mat-form-field  appearance="outline">
                                                    <mat-label>Capitalized Type</mat-label>
                                                    <input #subcategoryInput placeholder="Capitalized Type" matInput
                                     [readonly]="invdtlsaved ||!isshowsub[invdtlindex]" formControlName="is_capitalized_type"
                                            (click)="getfasubcatDebit(invdtlindex,'')" [matAutocomplete]="subcategorytype" id="invoice-detail-0059">
                                                    <mat-autocomplete [panelWidth]="250"
                                                        #subcategorytype="matAutocomplete"
                                                        [displayWith]="displaysubcatFn"
                                                        (opened)="capitalizedsubcategoryScroll(invdtlindex, subcategorytype)">
                                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                        </mat-option>
                                                        <ng-container *ngIf="!isLoading">
                                                            <mat-option
                                                                *ngFor="let subcategoryname of fa_subcategoryNameData"
                                                                [value]="subcategoryname">
                                                                {{subcategoryname.code}}
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>
                                                    <!-- <mat-icon matSuffix style="color: red !important;"  *ngIf="DebitDetailForm?.value?.debitdtl[i]?.subcategory_code?.code != 'GST Tax' && !debitsaved 
                                    && movedata != 'apapproverview'"
                                matTooltip="Clear" matTooltipClass="custom-tooltipnew" (click)="subcatClear(i);">clear</mat-icon> -->
                                                </mat-form-field>
                                            </td>
                                            <td *ngIf="movedata != 'apapproverview'">
                                                <button mat-icon-button type="button" *ngIf="!invdtlsaved"
                                                    id="invoice-detail-0096">
                                                    <mat-icon 
                                                    style="text-align: center; vertical-align: middle; transform: translateY(4px);color: green" aria-label="Edit"
                                                        (click)="deleteinvdetail(section,invdtlindex)"
                                                        matTooltip="delete" matTooltipClass="custom-tooltipnew">
                                                        delete</mat-icon>
                                                </button>
                                                <button mat-icon-button type="button" *ngIf="invdtlsaved">
                                                    <mat-icon style="text-align: center; vertical-align: middle; transform: translateY(4px);color: black" >

                                                        delete</mat-icon>
                                                </button>
                                            </td>

                                            <td *ngIf="debitSectionSaved[invdtlindex]">
                                                <button type="button" class="btn btn-outline-primary"
                                                    matTooltip="View/Edit Debit" matTooltipClass="custom-tooltipnew"
                                                    (click)="adddebit(section,InvoiceDetailForm.value,invdtlindex)"
                                                    style="text-align: center; vertical-align: middle; transform: translateY(8px);border-radius:40px" 
                                                    id="invoice-detail-0097">

                                                    <i class="fa fa-eye create "></i></button>

                                            </td>
                                            <td *ngIf="!debitSectionSaved[invdtlindex]">
                                                <button type="button" class="btn btn-outline-primary"
                                                    matTooltip="Add Debit" matTooltipClass="custom-tooltipnew"
                                                    (click)="adddebit(section,InvoiceDetailForm.value,invdtlindex)"
                                                    style="text-align: center; vertical-align: middle; transform: translateY(8px);border-radius:40px" 
                                                    id="invoice-detail-0098">

                                                    <i class="fa fa-arrow-right"></i></button>

                                            </td>
                                        </tr>
                                    </ng-container>
                                    <tr>
                                        <td class="totaldisplay" colspan="10" style="text-align: end;"
                                            *ngIf="this.aptypeid ==1 ">
                                            Total Taxable Amount:</td>
                                        <td class="totaldisplay" colspan="9" style="text-align: end;"
                                            *ngIf="this.aptypeid !=1 && this.aptypeid !=4 && this.aptypeid != 8 && this.aptypeid !=13 && this.aptypeid !=3">
                                            Total Taxable Amount:</td>
                                        <td class="totaldisplay" colspan="6" style="text-align: end;"
                                            *ngIf=" this.aptypeid == 8">
                                            Total Taxable Amount:</td>
                                        <td class="totaldisplay" colspan="10" style="text-align: end;"
                                            *ngIf=" this.aptypeid ==13|| this.aptypeid ==3">
                                            Total Taxable Amount:</td>
                                        <td style="text-align: end;width: 100px;">{{totaltaxable | currency:'INR'}}</td>

                                        <td class="totaldisplay" colspan="4" style="text-align: end;"
                                            *ngIf="this.aptypeid ==1">
                                            Other Adjustment:</td>
                                        <td class="totaldisplay" colspan="4" style="text-align: end;"
                                            *ngIf="this.aptypeid !=1 && this.aptypeid !=4 && this.aptypeid != 8 && this.aptypeid != 13 && this.aptypeid != 3 ">
                                            Other Adjustment:</td>
                                        <!-- <th class="totaldisplay" colspan="15"  style="text-align: end;" *ngIf="this.aptypeid ==3">
                                        Rounding Off:</th> -->
                                        <!-- <th class="totaldisplay" colspan="6"  style="text-align: end;" *ngIf=" this.aptypeid == 8">
                                    Other Adjustment:</th> -->
                                        <td class="totaldisplay" colspan="4" style="text-align: end;"
                                            *ngIf="this.aptypeid ==13 || this.aptypeid == 3">
                                            Other Adjustment:</td>
                                        <td id="matInput-size">
                                            <mat-form-field appearance="outline">
                                                <input matInput placeholder="Other Adjustment"
                                                    formControlName="otheramount" #otheramount
                                                    (ngModelChange)="INVdatasums()" appCleardirective
                                                    (change)="invdtlamtDecimalChg(otheramount ,'otheramount', 0)"
                                                    (keypress)="numberOnlyandDotminus($event, InvoiceDetailForm.value.otheramount)"
                                                    autocomplete="off" style="text-align: end;" [readonly]="invdtlsaved"
                                                    id="invoice-detail-0099">
                                            </mat-form-field>
                                        </td>
                                        <td *ngIf="movedata != 'apapproverview'" colspan="3"></td>
                                        <td *ngIf="movedata == 'apapproverview'" colspan="2"></td>
                                    </tr>
                                    <tr>

                                        <td class="totaldisplay" colspan="15" style="text-align: end;"
                                            *ngIf="this.aptypeid ==1">
                                            Rounding Off:</td>
                                        <td class="totaldisplay" colspan="14" style="text-align: end;"
                                            *ngIf="this.aptypeid !=1 && this.aptypeid !=4 && this.aptypeid != 8 && this.aptypeid !=13 && this.aptypeid !=3">
                                            Rounding Off:</td>
                                        <!-- <th class="totaldisplay" colspan="15"  style="text-align: end;" *ngIf="this.aptypeid ==3">
                                        Rounding Off:</th> -->
                                        <td class="totaldisplay" colspan="7" style="text-align: end;"
                                            *ngIf=" this.aptypeid == 8">
                                            Rounding Off:</td>
                                        <td class="totaldisplay" colspan="15" style="text-align: end;"
                                            *ngIf=" this.aptypeid ==13 || this.aptypeid ==3">
                                            Rounding Off:</td>
                                        <td id="matInput-size">
                                            <mat-form-field appearance="outline">
                                                <input matInput placeholder="Rounding Off" [min]="min" [max]="max"
                                                    style="text-align: end;" #roundoffamt
                                                    (ngModelChange)="RoundingOFF($event)" appCleardirective
                                                    (change)="invdtlamtDecimalChg(roundoffamt ,'roundoffamt', 0)"
                                                    formControlName="roundoffamt" autocomplete="off"
                                                    (keypress)="numberOnlyandDotminus($event, InvoiceDetailForm.value.roundoffamt)" [readonly]="invdtlsaved"
                                                    id="invoice-detail-0100">
                                            </mat-form-field>
                                        </td>
                                        <td *ngIf="movedata != 'apapproverview'" colspan="3"></td>
                                        <td *ngIf="movedata == 'apapproverview'" colspan="2"></td>

                                    </tr>
                                    <tr>
                                        <td class="totaldisplay" colspan="15" *ngIf="this.aptypeid ==1"
                                            style="text-align: right">
                                            Net Amount:</td>
                                        <td class="totaldisplay" colspan="14"
                                            *ngIf="this.aptypeid !=1 && this.aptypeid !=4 && this.aptypeid != 8 && this.aptypeid != 13 && this.aptypeid !=3"
                                            style="text-align: right">
                                            Net Amount:</td>
                                        <!-- <th class="totaldisplay" colspan="15" *ngIf="this.aptypeid ==3"
                                    style="text-align: right">
                                    Net Amount:</th> -->
                                        <td class="totaldisplay" colspan="7" *ngIf="this.aptypeid == 8"
                                            style="text-align: right">
                                            Net Amount:</td>
                                        <td class="totaldisplay" colspan="15"
                                            *ngIf="this.aptypeid == 13 || this.aptypeid ==3" style="text-align: right">
                                            Net Amount:</td>
                                        <td style="text-align: end;width: 100px;">{{INVsum | currency:'INR'}}</td>
                                        <td *ngIf="movedata != 'apapproverview'" colspan="3"></td>
                                        <td *ngIf="movedata == 'apapproverview'" colspan="2"></td>
                                    </tr>
                                    <tr *ngIf="movedata != 'apapproverview'">
                                        <td colspan="19">
                                            <button type="button" style="border-radius:40px;float: right;"
                                                class="btn btn-outline-success" (click)="submitinvoicedtl()"
                                                [disabled]="invdtlsaved||!isFormChanged" id="invoice-detail-0101">


                                                Save
                                            </button>
                                            <!-- [disabled]="invdtlsave" -->
                                        </td>
                                    </tr>
                                </table>

                            </div>
                        </div>


                        <!-- ----------credit detail --------- -->
                        <br>

                        <!-- <form [formGroup]="creditdetForm">    
            <div style=" display: flex;
            align-items: flex-start;
            justify-content: flex-start;
            gap: 10px;">
            <div style="margin-top:5px">
                <h3>Credit Details</h3>
            </div>  -->
                        <!-- <td>
                <mat-form-field style="width: 200px;margin-left: 20px;">
                    <input type="text" matInput formControlName="payment_instruction" autocomplete="off"
                        placeholder="Payment Instructions" id="invoice-detail-0102">
                </mat-form-field> 
            </td>
            <td>
                <section class="example-section ecfapcheck" style="margin-left:30px">
                    <mat-checkbox class="example-margin" formControlName="is_tds_applicable"  (change)="tdsAppl($event)">Is TDS Applicable
                    
                    </mat-checkbox>
                </section>
            </td> -->
                        <!-- <div *ngIf="movedata != 'apapproverview' && aptypeid != 13">
                <button mat-icon-button matTooltip=" Edit" matTooltipClass="custom-tooltipnew" class="iconbutton" color="primary"
                style ="margin-bottom: 15px;border-radius: 50%;" (click)="showcreditedit()"  id="invoice-detail-0104">
                <mat-icon [ngClass]="creditsaved ? 'edit_disabled' : 'edit_enabled'"  aria-label="Edit">edit</mat-icon>
                </button>
            </div>
            <div *ngIf="aptypeid == 13 && movedata != 'apapproverview'">
                <button mat-icon-button matTooltip=" Edit" matTooltipClass="custom-tooltipnew" class="iconbutton" color="primary" 
                style ="margin-bottom: 15px;border-radius: 50%;" (click)="showcreditedit()" id="invoice-detail-0105">
                <mat-icon  [ngClass]="creditsaved ? 'edit_disabled' : 'edit_enabled'" aria-label="Edit">edit</mat-icon>
                </button>
            </div>
            <div *ngIf="movedata != 'apapproverview'">
                <button *ngIf="aptypeid != 13" type="button" class="btn btn-outline-success" matTooltip="Add credit details" matTooltipClass="custom-tooltipnew"
                    style="margin-bottom: 15px;border-radius:40px;" (click)="addcreditSection(0, '', true)" [class.disabled]="creditsaved"
                     id="invoice-detail-0103"> -->
                        <!-- data-toggle="modal" data-target="#invoice-detail-0003" -->
                        <!-- <i class="fa fa-plus"> &nbsp;&nbsp;Credit Details</i>
                </button>
            </div>
            </div>
            <div style=" display: flex;
            align-items: flex-start;
            justify-content: flex-start;
            gap: 10px;margin-top:5px">
                <div *ngIf="this.aptypeid != 14"> -->

                        <!-- <lib-vs-dynamicform-cmp
                      id="matInput-size"
                    [InputFields]="tdsapplicable1"
                    (dataEvent)="tdsdata1($event)"
                    [formGroup]="creditdetForm"
                    [ResetForm]="resettds1"
                  ></lib-vs-dynamicform-cmp> -->


                        <!-- <mat-form-field style="width: 200px;margin-left: 0px;">
                    
                            <mat-label>Is TDS Applicable <label style="color:red">*</label></mat-label>
                            <mat-select placeholder="Is TDS Applicable" formControlName="is_tds_applicable" 
                            [class.disabled]="creditsaved||aptypeid == 13 || aptypeid == 3 || (aptypeid ==4 && ppxid =='E')" 
                            [disabled]="creditsaved || aptypeid == 13 || aptypeid == 3 || (aptypeid ==4 && ppxid =='E')" id="invoice-detail-0106">
                            <mat-option *ngFor="let tds of tdslist" [value]="tds.id" (click)="gettdschoosen(tds)"
                                >
                                {{tds.text}}
                            </mat-option>
                        </mat-select>
                    </mat-form-field> 
                </div>
                <div *ngIf="this.aptypeid == 14"> -->
                        <!-- 
                    <lib-vs-dynamicform-cmp
                      id="matInput-size"
                    [InputFields]="tdsapplicable1"
                    (dataEvent)="tdsdata1($event)"
                    [formGroup]="creditdetForm"
                    [ResetForm]="resettds1"
                  ></lib-vs-dynamicform-cmp> -->


                        <!-- <mat-form-field style="width: 200px;margin-left: 0px;">
                    
                            <mat-label>Is TDS Applicable <label style="color:red">*</label></mat-label>
                            <mat-select placeholder="Is TDS Applicable" formControlName="is_tds_applicable"  [disabled]="true" id="invoice-detail-0107">
                            <mat-option *ngFor="let tds of tdslist" [value]="tds.id" (click)="gettdschoosen(tds)"
                                >
                                {{tds.text}}
                            </mat-option>
                        </mat-select>
                    </mat-form-field> 
                </div> -->
                        <!-- <td *ngIf="movedata == 'AP'">TDS Applicability : {{this.invHdrRes?.is_tds_applicable?.text}} </td> -->
                        <!-- <div   id="matInput-size">
                    <mat-form-field appearance="outline">
                        <mat-label>Payment Instructions</mat-label>
                        <input type="text" matInput formControlName="payment_instruction" autocomplete="off" [readonly]="creditsaved"
                            placeholder="Payment Instructions" maxlength="60" [matTooltip]="creditdetForm.value.payment_instruction" matTooltipClass="custom-tooltipnew" id="invoice-detail-0108">
                    </mat-form-field>
                </div>
                <div *ngIf ="aptypeid ==2 || aptypeid == 3">
                    <button type="button" class="btn btn-light"  [disabled]="this.creditsaved" style="border-radius:40px;
                    border-color: crimson; color:crimson; margin-bottom: 20px;
                    background-color: white;" (click)="addPPXline()" id="invoice-detail-0109"> -->
                        <!-- data-toggle="modal" data-target="#invoice-detail-0003" -->
                        <!-- Check For Advance</button> -->
                        <!-- <input type="text"  value="Check For Advance" class="textboxStyle" (click)="addPPXline()" data-toggle="modal"  data-target="#createmodalforpopup" id="invoice-detail-0110"> -->

                        <!-- </div>   
                <div *ngIf="showcrnnotify == true && checkAdvance == false">
                    <input type="text"  value="Check For Credit Note" class="textboxStyle" id="invoice-detail-0111">
                
                </div>
                <div *ngIf="showcrnnotify == true && checkAdvance == true">
                    <input type="text"  value="Check For Advance / Credit Note" class="textboxStyle" id="invoice-detail-0112">
                
                </div>
            </div> -->
                        <!-- <form [formGroup]="creditdetForm">             -->
                        <!-- <table *ngIf="showthreshold && paytoid=='S'">
                    <div>
                    <tr>
                        <td>
                            <mat-form-field style="width:200px">
                                <input type="text" formControlName="supName" matInput readonly placeholder="Supplier Name" id="invoice-detail-0113">
                                <mat-label>Supplier Name</mat-label>
                            </mat-form-field>
                        </td>
                        <td>
                            <mat-form-field style="width:200px;margin-left: 50px;">
                                <input type="text" formControlName="isexcempted" matInput readonly placeholder="Is Exempted" id="invoice-detail-0114">
                                <mat-label>Is Exempted</mat-label>
                            </mat-form-field>
                        </td>
                        <td>
                            <mat-form-field style="width:200px;margin-left: 50px">
                                <input type="text" formControlName="TDSSection" matInput readonly placeholder="TDS Section" id="invoice-detail-0115">
                                <mat-label>TDS Section</mat-label>
                            </mat-form-field>
                        </td>
                        <td>
                            <mat-form-field style="width:200px;margin-left: 50px">
                                <input type="text" formControlName="TDSRate" matInput readonly placeholder="TDS Rate" id="invoice-detail-0116">
                                <mat-label>TDS Rate</mat-label>
                            </mat-form-field>
                        </td>
                        <td>
                            <mat-form-field style="width:200px;;margin-left: 50px">
                                <input type="text" formControlName="thresholdValue" matInput readonly placeholder="Threshold Value" id="invoice-detail-0117">
                                <mat-label>Threshold Value</mat-label>
                            </mat-form-field>
                        </td>
                    </tr>    
                    <tr>
                        <td>
                            <mat-form-field style="width:200px;">
                                <input type="text" matInput formControlName="amountPaid" readonly placeholder="Amount Paid" id="invoice-detail-0118">
                                <mat-label>Amount Paid</mat-label>
                            </mat-form-field>
                        </td>
                        <td>
                            <mat-form-field style="width:200px;margin-left: 50px">
                                <input type="text" matInput formControlName="balThroAmt" readonly placeholder="Balance Threshold Amount" id="invoice-detail-0119">
                                <mat-label>Balance Threshold Amount</mat-label>
                            </mat-form-field>
                        </td>
                        <td>
                            <mat-form-field style="width:200px;margin-left: 50px">
                                <input type="text" matInput formControlName="normaltdsRate" readonly placeholder="Normal TDS Rate" id="invoice-detail-0120">
                                <mat-label>Normal TDS Rate</mat-label>
                            </mat-form-field>
                        </td>
                        <td>
                            <mat-form-field style="width:200px;margin-left: 50px">
                                <input type="text" matInput formControlName="startdate" readonly placeholder="Start Date" id="invoice-detail-0121">
                                <mat-label>Start Date</mat-label>
                            </mat-form-field>
                        </td>
                        <td>
                            <mat-form-field style="width:200px;margin-left: 50px">
                                <input type="text" matInput formControlName="enddate" readonly placeholder="End Date" id="invoice-detail-0122">
                                <mat-label>End Date</mat-label>
                            </mat-form-field>
                        </td>
                    </tr>     -->
                        <!-- <tr > -->
                        <!-- <td>  
                            <mat-form-field style="width:300px">
                                <mat-label>Debit Bank</mat-label>
                                                <input #debbankInput placeholder="Debit Bank" matInput formControlName="debitbank_id"
                                                    [matAutocomplete]="debbank"  id="invoice-detail-0123">
                                                <mat-autocomplete  [panelWidth]="400" #debbank="matAutocomplete" [displayWith]="displaydebbank">
                                                    <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                    </mat-option>
                                                    <ng-container *ngIf="!isLoading">
                                                        <mat-option *ngFor="let b of debbankList" [value]="b" (click)="getbankdetailsid(b)">
                                                            {{b.bankbranch.bank.name}} - {{b.account_no}} 
                                                        </mat-option>
                                                    </ng-container>
                                                </mat-autocomplete>
                            </mat-form-field>
                        </td>     -->

                        <!-- <td *ngIf="checkAdvance == true && showcrnnotify == false">
                            <input type="text"  value="Check For Advance" class="textboxStyle" id="invoice-detail-0124">
                        
                        </td>
                        <td *ngIf="showcrnnotify == true && checkAdvance == false">
                            <input type="text"  value="Check For Credit Note" class="textboxStyle" id="invoice-detail-0125">
                        
                        </td>
                        <td *ngIf="showcrnnotify == true && checkAdvance == true">
                            <input type="text"  value="Check For Advance / Credit Note" class="textboxStyle" id="invoice-detail-0126">
                        
                        </td> -->
                        <!-- </tr> -->
                        <!-- </div>
                </table>
                </form> -->

                        <form [formGroup]="creditdetForm">
                            <div style=" display: flex;
                    align-items: flex-start;
                    justify-content: flex-start;
                    gap: 10px;">
                                <div style="margin-top:5px">
                                    <h3>Credit Details</h3>
                                </div>
                                <!-- <td>
                        <mat-form-field style="width: 200px;margin-left: 20px;">
                            <input type="text" matInput formControlName="payment_instruction" autocomplete="off"
                                placeholder="Payment Instructions" id="invoice-detail-0102">
                        </mat-form-field> 
                    </td>
                    <td>
                        <section class="example-section ecfapcheck" style="margin-left:30px">
                            <mat-checkbox class="example-margin" formControlName="is_tds_applicable"  (change)="tdsAppl($event)">Is TDS Applicable
                            
                            </mat-checkbox>
                        </section>
                    </td> -->
                                <div *ngIf="movedata != 'apapproverview' && aptypeid != 13">
                                    <button mat-icon-button matTooltip=" Edit" matTooltipClass="custom-tooltipnew"
                                        class="iconbutton" color="primary"
                                        style="margin-bottom: 15px;border-radius: 50%;" (click)="showcreditedit()"
                                        id="invoice-detail-0104">
                                        <mat-icon [ngClass]="creditsaved ? 'edit_disabled' : 'edit_enabled'"
                                            aria-label="Edit">edit</mat-icon>
                                    </button>
                                </div>
                                <div *ngIf="aptypeid == 13 && movedata != 'apapproverview'">
                                    <button mat-icon-button matTooltip=" Edit" matTooltipClass="custom-tooltipnew"
                                        class="iconbutton" color="primary"
                                        style="margin-bottom: 15px;border-radius: 50%;" (click)="showcreditedit()"
                                        id="invoice-detail-0105">
                                        <mat-icon [ngClass]="creditsaved ? 'edit_disabled' : 'edit_enabled'"
                                            aria-label="Edit">edit</mat-icon>
                                    </button>
                                </div>
                                <div *ngIf="movedata != 'apapproverview'">
                                    <button *ngIf="aptypeid != 13" type="button" class="btn btn-outline-success"
                                        matTooltip="Add credit details" matTooltipClass="custom-tooltipnew"
                                        style="margin-bottom: 15px;border-radius:40px;"
                                        (click)="addcreditSection(0, '', true)" [class.disabled]="creditsaved"
                                        id="invoice-detail-0103">
                                        <!-- data-toggle="modal" data-target="#invoice-detail-0003" -->
                                        <i class="fa fa-plus"> &nbsp;&nbsp;Credit Details</i>
                                    </button>
                                </div>
                            </div>
                            <div style=" display: flex;
                    align-items: flex-start;
                    justify-content: flex-start;
                    gap: 10px;margin-top:5px">
                                <!-- <div > -->
                                <!-- <lib-vs-optiondd-cmp
                              id="matInput-size"
                            [InputFields]="tdsapplicable1"
                            (dataEvent)="tdsdata1($event)"
                            [formGroup]="creditdetForm"
                            [ResetForm]="resettds1"
                          ></lib-vs-optiondd-cmp> -->
                                <!-- <div *ngIf="this.aptypeid != 14">
                            <div [ngStyle]="{'pointer-events': creditsaved||aptypeid == 13 || aptypeid == 3 || (aptypeid ==4 && ppxid =='E') ? 'none' : 'auto', 'opacity': creditsaved||aptypeid == 13 || aptypeid == 3 || (aptypeid ==4 && ppxid =='E') ? '0.6' : '1'}">
                                <lib-vs-optiondd-cmp
                                  id="matInput-size"
                                [InputFields]="tdsapplicable1"
                                (dataEvent)="tdsdata1($event)"
                                [formGroup]="creditdetForm"
                                [ResetForm]="resettds1"
                              ></lib-vs-optiondd-cmp>
              
                              </div>
              
                          </div>
                          <div *ngIf="this.aptypeid == 14">
                            <lib-vs-optiondd-cmp
                                  id="matInput-size"
                                [InputFields]="tdsapplicable1"
                                (dataEvent)="tdsdata1($event)"
                                [formGroup]="creditdetForm"
                                [ResetForm]="resettds1"
                              ></lib-vs-optiondd-cmp>
                            
                          </div> -->
                                <td *ngIf="this.aptypeid != 14" id="matInput-size">
                                    <mat-form-field appearance="outline" style="margin-left: 0px;">

                                        <mat-label>Is TDS Applicable <label style="color:red">*</label></mat-label>
                                        <mat-select placeholder="Is TDS Applicable" formControlName="is_tds_applicable"
                                            [class.disabled]="creditsaved||aptypeid == 13 || aptypeid == 3 || (aptypeid ==4 && ppxid =='E')"
                                            [disabled]="creditsaved || aptypeid == 13 || aptypeid == 3 || (aptypeid ==4 && ppxid =='E')"
                                            id="invoice-detail-0106">
                                            <mat-option *ngFor="let tds of tdslist" [value]="tds.id"
                                                (click)="gettdschoosen(tds)">
                                                {{tds.text}}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </td>
                                <td *ngIf="this.aptypeid == 14" id="matInput-size">
                                    <mat-form-field appearance="outline" style="margin-left: 0px;">

                                        <mat-label>Is TDS Applicable <label style="color:red">*</label></mat-label>
                                        <mat-select placeholder="Is TDS Applicable" formControlName="is_tds_applicable"
                                            [disabled]="true" id="invoice-detail-0107">
                                            <mat-option *ngFor="let tds of tdslist" [value]="tds.id"
                                                (click)="gettdschoosen(tds)">
                                                {{tds.text}}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </td>

                                <!-- <mat-form-field style="width: 200px;margin-left: 0px;">
                            
                                    <mat-label>Is TDS Applicable <label style="color:red">*</label></mat-label>
                                    <mat-select placeholder="Is TDS Applicable" formControlName="is_tds_applicable" 
                                    [class.disabled]="creditsaved||aptypeid == 13 || aptypeid == 3 || (aptypeid ==4 && ppxid =='E')" 
                                    [disabled]="creditsaved || aptypeid == 13 || aptypeid == 3 || (aptypeid ==4 && ppxid =='E')" id="invoice-detail-0106">
                                    <mat-option *ngFor="let tds of tdslist" [value]="tds.id" (click)="gettdschoosen(tds)"
                                        >
                                        {{tds.text}}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>  -->
                                <!-- </div> -->

                                <!-- <td *ngIf="movedata == 'AP'">TDS Applicability : {{this.invHdrRes?.is_tds_applicable?.text}} </td> -->
                                <div id="matInput-size">
                                    <mat-form-field appearance="outline">
                                        <mat-label>Payment Instructions</mat-label>
                                        <input type="text" matInput formControlName="payment_instruction"
                                            autocomplete="off" [readonly]="creditsaved"
                                            placeholder="Payment Instructions" maxlength="60"
                                            [matTooltip]="creditdetForm.value.payment_instruction"
                                            matTooltipClass="custom-tooltipnew" id="invoice-detail-0108">
                                    </mat-form-field>
                                </div>
                                <div *ngIf="aptypeid ==2 || aptypeid == 3||aptypeid == 1">
                                    <button *ngIf="checkAdvance == true && movedata != 'apapproverview'" type="button" class="btn btn-light" [disabled]="this.creditsaved" style="border-radius:40px;
                            border-color: crimson; color:crimson; margin-top: 5px;
                            background-color: white;" (click)="addPPXline()" id="invoice-detail-0109">
                                        <!-- data-toggle="modal" data-target="#invoice-detail-0003" -->
                                        Check For Advance</button>
                                    <!-- <input type="text"  value="Check For Advance" class="textboxStyle" (click)="addPPXline()" data-toggle="modal"  data-target="#createmodalforpopup" id="invoice-detail-0110"> -->

                                </div>
                                <div *ngIf="showcrnnotify == true  && movedata != 'apapproverview'">
                                    <button class="btn btn-outline-danger" [disabled]="this.creditsaved" style="border-radius:40px;
                            border-color: crimson; color:crimson; margin-top: 5px;
                            background-color: white;" (click)="addCRNline()" id="invoice-detail-0111">Check For Credit Note</button>

                                </div>
                                <!-- <div *ngIf="showcrnnotify == true && checkAdvance == true">
                                    <button class="btn btn-outline-danger"
                                        id="invoice-detail-0112">Check For Advance / Credit Note</button>

                                </div> -->
                            </div>
                            <!-- <form [formGroup]="creditdetForm">             -->
                            <div *ngIf="showthreshold && paytoid=='S'">
                                <div class="search-auto-fit">

                                    <div id="matInput-size">
                                        <mat-form-field appearance="outline">
                                            <mat-label>Supplier Name</mat-label>
                                            <input type="text" formControlName="supName" matInput readonly
                                                placeholder="Supplier Name" id="invoice-detail-0113">
                                        </mat-form-field>
                                    </div>
                                    <div id="matInput-size">
                                        <mat-form-field appearance="outline">
                                            <mat-label>Is Exempted</mat-label>
                                            <input type="text" formControlName="isexcempted" matInput readonly
                                                placeholder="Is Exempted" id="invoice-detail-0114">
                                        </mat-form-field>
                                    </div>
                                    <div id="matInput-size">
                                        <mat-form-field appearance="outline">
                                            <mat-label>TDS Section</mat-label>
                                            <input type="text" formControlName="TDSSection" matInput readonly
                                                placeholder="TDS Section" id="invoice-detail-0115">
                                        </mat-form-field>
                                    </div>
                                    <div id="matInput-size">
                                        <mat-form-field appearance="outline">
                                            <mat-label>TDS Rate</mat-label>
                                            <input type="text" formControlName="TDSRate" matInput readonly
                                                placeholder="TDS Rate" id="invoice-detail-0116">

                                        </mat-form-field>
                                    </div>
                                    <div id="matInput-size">
                                        <mat-form-field appearance="outline">
                                            <mat-label>Threshold Value</mat-label>
                                            <input type="text" formControlName="thresholdValue" matInput readonly
                                                placeholder="Threshold Value" id="invoice-detail-0117">
                                        </mat-form-field>
                                    </div>


                                    <div id="matInput-size">
                                        <mat-form-field appearance="outline">
                                            <mat-label>Amount Paid</mat-label>
                                            <input type="text" matInput formControlName="amountPaid" readonly
                                                placeholder="Amount Paid" id="invoice-detail-0118">
                                        </mat-form-field>
                                    </div>
                                    <div id="matInput-size">
                                        <mat-form-field appearance="outline">
                                            <mat-label>Balance Threshold Amount</mat-label>
                                            <input type="text" matInput formControlName="balThroAmt" readonly
                                                placeholder="Balance Threshold Amount" id="invoice-detail-0119">
                                        </mat-form-field>
                                    </div>
                                    <div id="matInput-size">
                                        <mat-form-field appearance="outline">
                                            <mat-label>Normal TDS Rate</mat-label>
                                            <input type="text" matInput formControlName="normaltdsRate" readonly
                                                placeholder="Normal TDS Rate" id="invoice-detail-0120">
                                        </mat-form-field>
                                    </div>
                                    <div id="matInput-size">
                                        <mat-form-field appearance="outline">
                                            <mat-label>Start Date</mat-label>
                                            <input type="text" matInput formControlName="startdate" readonly
                                                placeholder="Start Date" id="invoice-detail-0121">
                                        </mat-form-field>
                                    </div>
                                    <div id="matInput-size">
                                        <mat-form-field appearance="outline">
                                            <mat-label>End Date</mat-label>
                                            <input type="text" matInput formControlName="enddate" readonly
                                                placeholder="End Date" id="invoice-detail-0122">
                                        </mat-form-field>
                                    </div>

                                    <!-- <tr > -->
                                    <!-- <td>  
                                    <mat-form-field style="width:300px">
                                        <mat-label>Debit Bank</mat-label>
                                                        <input #debbankInput placeholder="Debit Bank" matInput formControlName="debitbank_id"
                                                            [matAutocomplete]="debbank"  id="invoice-detail-0123">
                                                        <mat-autocomplete  [panelWidth]="400" #debbank="matAutocomplete" [displayWith]="displaydebbank">
                                                            <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                            </mat-option>
                                                            <ng-container *ngIf="!isLoading">
                                                                <mat-option *ngFor="let b of debbankList" [value]="b" (click)="getbankdetailsid(b)">
                                                                    {{b.bankbranch.bank.name}} - {{b.account_no}} 
                                                                </mat-option>
                                                            </ng-container>
                                                        </mat-autocomplete>
                                    </mat-form-field>
                                </td>     -->

                                    <!-- <td *ngIf="checkAdvance == true && showcrnnotify == false">
                                    <input type="text"  value="Check For Advance" class="textboxStyle" id="invoice-detail-0124">
                                
                                </td>
                                <td *ngIf="showcrnnotify == true && checkAdvance == false">
                                    <input type="text"  value="Check For Credit Note" class="textboxStyle" id="invoice-detail-0125">
                                
                                </td>
                                <td *ngIf="showcrnnotify == true && checkAdvance == true">
                                    <input type="text"  value="Check For Advance / Credit Note" class="textboxStyle" id="invoice-detail-0126">
                                
                                </td> -->
                                    <!-- </tr> -->
                                </div>
                            </div>
                        </form>


                        <div class="comp-table t-resposive t-bdr-line t-HoverZoom" id="summary-table">
                            <table class="table" fixed-header>
                                <thead class="table_header">
                                    <tr>
                                        <th>S.No</th>
                                        <th>Paymode<span style="color:red">*</span></th>
                                        <th>Account Detail/GL<span style="color:red">*</span></th>
                                        <!-- <th>Transaction Branch</th> -->
                                        <th>Ref No</th>
                                        <th *ngIf="this.paytoid != 'E' && this.paytoid != 'B'">Bank Name</th>
                                        <th *ngIf="this.paytoid != 'E' && this.paytoid != 'B'">Branch Name</th>
                                        <th *ngIf="this.paytoid != 'E' && this.paytoid != 'B'">IFSC Code</th>
                                        <th>Beneficiary Name</th>
                                        <th>Tax Type</th>
                                        <th>Tax Rate</th>
                                        <th>TDS Exempt</th>
                                        <th>Taxable Amount</th>
                                        <th>GL No</th>
                                        <th>Amount<span style="color:red">*</span></th>
                                        <th>Amount change</th>
                                        <th *ngIf="movedata !='apapproverview'">Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <ng-container formArrayName="creditdtl"
                                        *ngFor="let section of getCreditSections(InvoiceDetailForm); let creditindex = index">
                                        <tr [formGroupName]="creditindex">
                                            <td>
                                                {{creditindex+1}}</td>
                                            <td id="matInput-size">

                                                <!-- <mat-option *ngFor="let pay of PaymodeList" [value]="pay" 
                                        (click)="CreditDessss(pay,creditindex)" data-toggle="modal" 
                                        [disabled]="(payableSelected === true && pay.gl_flag === 'Payable') || (pay.code=='PM006' && checkAdvance == false) || 
                                        (pay.code =='PM007' && fullliq) || (pay.code=='PM010' && showcrnnotify == false)"
                                        data-target="#createmodalforpopup" >
                                            
                                            {{pay.name}}
                                        </mat-option> -->
                                                <mat-form-field
                                                    *ngIf="creditindex == 0 && (aptypeid != 1 && aptypeid != 2 && !(aptypeid == 4 && paytoid=='S'))"
                                                    (click)="getPaymode(creditindex)" appearance="outline">

                                                    <mat-label>Paymode</mat-label>
                                                    <input #paymodeInput placeholder="Paymode" matInput
                                                        formControlName="paymode_id" [matAutocomplete]="paymode"
                                                        [readonly]="creditsaved" id="invoice-detail-0127">
                                                    <!-- *ngIf="this.paymodecode[creditindex] != 'PM002' && this.paymodecode[creditindex] != 'PM006'
                                                && this.paymodecode[creditindex] != 'PM007'"
                                            <input #paymodeInput  placeholder="Paymode" matInput formControlName="paymode_id" [matAutocomplete]="paymode" readonly
                                            *ngIf="this.paymodecode[creditindex] == 'PM002' || this.paymodecode[creditindex] == 'PM006'|| this.paymodecode[creditindex] == 'PM007'" 
                                            data-target="#createmodalforpopup" id="invoice-detail-0128"> -->
                                                    <mat-autocomplete [panelWidth]="200" #paymode="matAutocomplete"
                                                        [displayWith]="displayPaymode">
                                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                        </mat-option>
                                                        <ng-container *ngIf="!isLoading">
                                                            <mat-option *ngFor="let pay of PaymodeList" [value]="pay"
                                                                (click)="CreditDessss(pay,creditindex)">
                                                                <!-- data-toggle="modal" data-target="#invoice-detail-0003"  -->

                                                                {{pay.name}}
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>
                                                </mat-form-field>
                                                <mat-form-field
                                                    *ngIf="creditindex == 0 && (aptypeid == 1 ||aptypeid == 2  || (aptypeid == 4 && paytoid=='S'))"
                                                    (click)="getPaymode(creditindex, true)" appearance="outline">

                                                    <mat-label>Paymode</mat-label>
                                                    <input #paymodeInput placeholder="Paymode" matInput
                                                        formControlName="paymode_id" [matAutocomplete]="paymode"
                                                        [readonly]="creditsaved" id="invoice-detail-0129">
                                                    <!-- *ngIf="this.paymodecode[creditindex] != 'PM002' && this.paymodecode[creditindex] != 'PM006'
                                            && this.paymodecode[creditindex] != 'PM007'">
                                        <input #paymodeInput placeholder="Paymode" matInput formControlName="paymode_id" readonly
                                        *ngIf="this.paymodecode[creditindex] == 'PM002' || this.paymodecode[creditindex] == 'PM006'
                                        || this.paymodecode[creditindex] == 'PM007'" [matAutocomplete]="paymode" data-target="#createmodalforpopup" id="invoice-detail-0130"> -->
                                                    <mat-autocomplete [panelWidth]="200" #paymode="matAutocomplete"
                                                        [displayWith]="displayPaymode">
                                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                        </mat-option>
                                                        <ng-container *ngIf="!isLoading">
                                                            <mat-option *ngFor="let pay of supplierPaymodes"
                                                                [value]="pay" (click)="CreditDessss(pay,creditindex)">
                                                                <!-- data-toggle="modal" data-target="#invoice-detail-0003" -->

                                                                {{pay.name}}
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>
                                                </mat-form-field>
                                                <mat-form-field *ngIf="creditindex != 0" (click)="getAdjPaymodes()"
                                                    appearance="outline">

                                                    <mat-label>Paymode</mat-label>
                                                    <input #paymodeInput placeholder="Paymode" matInput
                                                        formControlName="paymode_id" [matAutocomplete]="paymode"
                                                        [readonly]="creditsaved" id="invoice-detail-0131">
                                                    <mat-autocomplete [panelWidth]="200" #paymode="matAutocomplete"
                                                        [displayWith]="displayPaymode">
                                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                        </mat-option>
                                                        <ng-container *ngIf="!isLoading">
                                                            <mat-option *ngFor="let pay of adjPaymodes" [value]="pay"
                                                                (click)="CreditDessss(pay,creditindex)"
                                                                [disabled]="pay.code =='PM007' && fullliq">
                                                                <!-- data-toggle="modal" data-target="#invoice-detail-0003" -->

                                                                {{pay.name}}
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>
                                                </mat-form-field>
                                                <!-- <mat-form-field (click)="getPaymode(creditindex)" style="width:100px">
                                        <mat-label>Paymode</mat-label>
                                        <mat-select formControlName="paymode_id" [class.disabled]="creditsaved" [disabled]="creditsaved" id="invoice-detail-0132">
                                            <mat-option *ngFor="let pay of PaymodeList[creditindex]" [value]="pay" 
                                                (click)="CreditDessss(pay,creditindex)" data-toggle="modal" 
                                                [disabled]="(payableSelected === true && pay.gl_flag === 'Payable') || (pay.code=='PM006' && checkAdvance == false) || 
                                                            (pay.code =='PM007' && fullliq) || (pay.code=='PM010' && showcrnnotify == false)"
                                                data-target="#createmodalforpopup" >
                                                {{pay.name}}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field> -->
                                            </td>
                                            <td id="matInput-size">
                                                <div *ngIf="showaccno[creditindex]==true && (this.paymodecode[creditindex] == 'PM005' || this.paymodecode[creditindex] == 'PM008'
                                        || this.paymodecode[creditindex] == 'PM003')">
                                                    <mat-form-field appearance="outline">
                                                        <mat-label>Acc no</mat-label>
                                                        <mat-select formControlName="accno"
                                                            [class.disabled]="creditsaved"
                                                            id="invoice-detail-0133">
                                                            <mat-option *ngFor="let acc of accList" [value]="acc.id"
                                                                (click)="getacc(acc,creditindex)">
                                                                {{acc.account_no}}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </div>

                                                <div
                                                    *ngIf="showaccno[creditindex]==true && this.paymodecode[creditindex] == 'PM004'">
                                                    <mat-form-field appearance="outline">
                                                        <mat-label>Acc no</mat-label>
                                                        <mat-select formControlName="accno" [disabled]="creditsaved"
                                                            id="invoice-detail-0134">
                                                            <mat-option *ngFor="let acc of ERAList" [value]="acc.id"
                                                                (click)="getEraAccDet(acc, creditindex)">
                                                                {{acc.acno}}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </div>

                                                <div
                                                    *ngIf="showaccno[creditindex]==true && this.paymodecode[creditindex] == 'PM001'">
                                                    <mat-form-field appearance="outline">
                                                        <mat-label>Acc no</mat-label>
                                                        <mat-select formControlName="accno" [disabled]="creditsaved"
                                                            id="invoice-detail-0135">
                                                            <mat-option *ngFor="let acc of BRAList" [value]="acc.acno"
                                                                (click)="getBraAccDet(acc, creditindex)">
                                                                {{acc.acno}}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </div>
                                                <div *ngIf="this.paymodecode[creditindex] == 'PM002' ||
                                        (showaccno[creditindex]==false && this.paymodecode[creditindex] == 'PM008'|| this.paymodecode[creditindex] == 'PM010') ">
                                                    <mat-form-field appearance="outline">
                                                        <mat-label>Acc no</mat-label>
                                                        <input matInput placeholder="Ref No" formControlName="accno"
                                                            autocomplete="off" readonly id="invoice-detail-0136">
                                                    </mat-form-field>
                                                </div>
                                                <div *ngIf="this.paymodecode[creditindex] != 'PM002' && aptypeid != 7 && showaccno[creditindex]==false && this.paymodecode[creditindex] != 'PM008'"
                                                    style="text-align: center;">-</div>
                                            </td>

                                            <!-- <td *ngIf="showtranspay[creditindex]==true">
                                        <mat-form-field>
                                            <mat-label>Payable Branch</mat-label>
                                            <mat-select  id="invoice-detail-0137">
                                                <mat-option *ngFor="let data of creditbrnchList" [value]="data.id" [disabled]="creditsaved">
                                                    {{data.text}}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
            
                                        <mat-form-field>
                                            <mat-label>Transaction Branch</mat-label>
                                            <mat-select  id="invoice-detail-0138">
                                                <mat-option *ngFor="let tran of credittranList" [value]="tran.id" [disabled]="creditsaved">
                                                    {{tran.text}}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </td>
                                    <td *ngIf="showtranspay[creditindex]===false">
                                        <mat-form-field style="width:150px"> 

                                        <input matInput placeholder="Transaction Branch" formControlName="ddtranbranch"  autocomplete="off" readonly 
                                        [matTooltip]="InvoiceDetailForm.value.creditdtl[creditindex].ddtranbranch" matTooltipClass="custom-tooltipnew" id="invoice-detail-0139">
                                        </mat-form-field>
                                    </td>  -->

                                            <td id="matInput-size">
                                                <mat-form-field appearance="outline">

                                                    <input matInput placeholder="Ref No" formControlName="refno"
                                                        autocomplete="off" readonly id="invoice-detail-0140">
                                                </mat-form-field>
                                            </td>



                                            <td id="matInput-size" *ngIf="this.paytoid != 'E' && this.paytoid != 'B'">
                                                <mat-form-field appearance="outline">

                                                    <input matInput placeholder="Bank Name" formControlName="bank"
                                                        autocomplete="off" readonly id="invoice-detail-0141">
                                                </mat-form-field>

                                            </td>

                                            <td id="matInput-size" *ngIf="this.paytoid != 'E' && this.paytoid != 'B'">
                                                <mat-form-field appearance="outline">

                                                    <input matInput placeholder="Branch Name" formControlName="branch"
                                                        autocomplete="off" readonly id="invoice-detail-0142">
                                                </mat-form-field>
                                            </td>

                                            <td id="matInput-size" *ngIf="this.paytoid != 'E' && this.paytoid != 'B'">
                                                <mat-form-field appearance="outline">

                                                    <input matInput placeholder="IFSC code" formControlName="ifsccode"
                                                        autocomplete="off" readonly id="invoice-detail-0143">
                                                </mat-form-field>
                                            </td>


                                            <td id="matInput-size">
                                                <mat-form-field appearance="outline">

                                                    <input matInput placeholder="Beneficiary"
                                                        formControlName="benificiary" autocomplete="off" readonly
                                                        id="invoice-detail-0144">
                                                </mat-form-field>
                                            </td>
                                            <td id="matInput-size" *ngIf="showtaxtype[creditindex]===true">
                                                <mat-form-field appearance="outline">
                                                    <input #taxtypeInput placeholder="Tax type" matInput
                                                        formControlName="suppliertaxtype" [matAutocomplete]="taxtype"
                                                        [readonly]="creditsaved" id="invoice-detail-0145">
                                                    <mat-autocomplete [panelWidth]="250" #taxtype="matAutocomplete"
                                                        [displayWith]="displayFnFilter" (opened)="gettaxtypeScroll()">
                                                        <mat-option *ngIf="isLoading"
                                                            class="is-loading">Loading...</mat-option>
                                                        <ng-container *ngIf="!isLoading">
                                                            <mat-option *ngFor="let tax of taxlist" [value]="tax"
                                                                (click)="gettaxrates(tax,creditindex)">
                                                                {{tax.subtax.name}}
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>
                                                </mat-form-field>
                                            </td>
                                            <td id="matInput-size" *ngIf="showtaxrate[creditindex]===true">
                                                <mat-form-field appearance="outline">
                                                    <input matInput placeholder="Tax Rate"
                                                        formControlName="suppliertaxrate" readonly autocomplete="off"
                                                        id="invoice-detail-0146">
                                                </mat-form-field>
                                            </td>
                                            <td id="matInput-size" *ngIf="showtaxtypes[creditindex] === true">
                                                <mat-form-field appearance="outline">
                                                    <input matInput placeholder="Tax type"
                                                        formControlName="suppliertaxtype" autocomplete="off" readonly
                                                        id="invoice-detail-0147">
                                                </mat-form-field>
                                            </td>
                                            <td id="matInput-size" *ngIf="showtaxrates[creditindex] === true">
                                                <mat-form-field appearance="outline">
                                                    <input matInput placeholder="Tax Rate"
                                                        formControlName="suppliertaxrate" autocomplete="off" readonly
                                                        id="invoice-detail-0148">
                                                </mat-form-field>
                                            </td>
                                            <td id="matInput-size">
                                                <mat-form-field appearance="outline">
                                                    <input matInput formControlName="taxexcempted" autocomplete="off"
                                                        readonly id="invoice-detail-0149">
                                                </mat-form-field>
                                            </td>
                                            <td id="matInput-size">
                                                <mat-form-field appearance="outline">

                                                    <input matInput placeholder="Taxable amount"
                                                        formControlName="taxableamount" #taxableamount 
                                                        style="text-align: right;" [readonly]="creditsaved"
                                                        (keypress)="getCharCode($event);numberOnlyandDot($event,InvoiceDetailForm.value.creditdtl[creditindex].taxableamount)"
                                                        (input)="creditChangeToCurrency('taxableamount', creditindex)" appCleardirective
                                                        (change)="gettaxcalc(creditindex);creditamtDecimalChg(taxableamount ,'taxableamount', creditindex)"
                                                        autocomplete="off" id="invoice-detail-0150">
                                                </mat-form-field>
                                            </td>
                                            <td id="matInput-size">
                                                <mat-form-field appearance="outline">

                                                    <input matInput placeholder="Credit GL" formControlName="glno"
                                                        autocomplete="off" readonly id="invoice-detail-0151">
                                                        <mat-icon matSuffix *ngIf="(creditsaved && movedata=='ECF' || ((movedata=='AP'|| movedata=='apapproverview')) )&& this.paymodecode[creditindex] == 'PM009'&& this.aptypeid == 7" 
                                                        class="invoicedetail-style-536" (click)="crnglpopupopen()">info</mat-icon>

                                                </mat-form-field>
                                                <!-- <h4 *ngIf="this.aptypeid == 7 && section?.value?.glno != 0 && this.paymodecode[creditindex] == 'PM011'"
                                                style="cursor: pointer;color:blue;font-family: 'Montserrat';"
                                                class="btn btn-link" matTooltip="View catsubcat" data-toggle="modal"
                                                data-target="#showglviewpopup" (click)="getgldata(section)">View
                                            </h4> -->

                                            </td>
                                            <td id="matInput-size">
                                                <mat-form-field appearance="outline">

                                                    <input matInput placeholder="Amount" formControlName="amount"
                                                        readonly style="text-align: right;" id="invoice-detail-0152">
                                                </mat-form-field>
                                            </td>
                                            <td id="matInput-size" *ngIf="this.amtChangeFlag[creditindex]==false">
                                                <mat-form-field appearance="outline">

                                                    <input matInput placeholder="Amount" formControlName="amountchange"
                                                        readonly style="text-align: right;" id="invoice-detail-0153">
                                                </mat-form-field>
                                            </td>
                                            <td id="matInput-size" *ngIf="this.amtChangeFlag[creditindex]==true">
                                                <mat-form-field appearance="outline">
                                                    <input matInput placeholder="Amount" [readonly]="creditsaved "
                                                        formControlName="amountchange" #amountchange autocomplete="off"
                                                        (keypress)="getCharCode($event);numberOnlyandDot($event, InvoiceDetailForm.value.creditdtl[creditindex].amountchange)"
                                                        (input)="creditChangeToCurrency('amountchange', creditindex)"
                                                        (ngModelChange)="addoncreditindex(creditindex,$event)"
                                                        style="text-align: right;"
                                                        (change)="amountReduction(); creditamtDecimalChg(amountchange ,'amountchange', creditindex)"
                                                        id="invoice-detail-0154">
                                                </mat-form-field>
                                            </td>
                                            <td
                                                *ngIf="movedata !='apapproverview' && !creditsaved && !(this.paymodecode[creditindex] == 'PM004' 
                                    || this.paymodecode[creditindex] == 'PM001' || this.paymodecode[creditindex] == 'PM005'
                                    || this.paymodecode[creditindex] == 'PM008' || this.paymodecode[creditindex] == 'PM007')">
                                                <button mat-icon-button type="button" id="invoice-detail-0155">
                                                    <mat-icon style="color: black;" aria-label="Edit"
                                                        matTooltip="delete" matTooltipClass="custom-tooltipnew"
                                                        (click)="deletecreditdetail(section,creditindex)">
                                                        delete</mat-icon>
                                                </button>
                                            </td>
                                            <td
                                                *ngIf="movedata !='apapproverview' && !creditsaved && (this.paymodecode[creditindex] == 'PM004' 
                                    || this.paymodecode[creditindex] == 'PM001' || this.paymodecode[creditindex] == 'PM005'
                                    || this.paymodecode[creditindex] == 'PM008' || this.paymodecode[creditindex] == 'PM007')">
                                            </td>
                                            <td
                                                *ngIf="movedata !='apapproverview' && creditsaved && !(this.paymodecode[creditindex] == 'PM004' 
                                    || this.paymodecode[creditindex] == 'PM001' || this.paymodecode[creditindex] == 'PM005'
                                    || this.paymodecode[creditindex] == 'PM008'|| this.paymodecode[creditindex] == 'PM007' )">
                                                <button mat-icon-button type="button" *ngIf="movedata !='apapproverview' && creditsaved && (this.paymodecode[creditindex] == 'PM004' 
                                        || this.paymodecode[creditindex] == 'PM001' || this.paymodecode[creditindex] == 'PM005'
                                        || this.paymodecode[creditindex] == 'PM008')" id="invoice-detail-0155">
                                                    <mat-icon style="color: grey;">
                                                        delete</mat-icon>
                                                </button>
                                            </td>
                                            <td
                                                *ngIf="movedata !='apapproverview' && creditsaved && (this.paymodecode[creditindex] == 'PM004' 
                                    || this.paymodecode[creditindex] == 'PM001' || this.paymodecode[creditindex] == 'PM005'
                                    || this.paymodecode[creditindex] == 'PM008'|| this.paymodecode[creditindex] == 'PM007' )">

                                            </td>


                                        </tr>
                                    </ng-container>
                                </tbody>

                                <tr *ngIf="this.paytoid != 'E' && this.paytoid != 'B'">
                                    <td colspan="12"></td>
                                    <td class="totaldisplay" colspan="1">
                                        Net Amount:</td>
                                    <td style="text-align: end;">{{cdtsum | currency:'INR'}}</td>
                                </tr>
                                <tr *ngIf="this.paytoid == 'B'">
                                    <td class="totaldisplay" colspan="10" style="text-align: right">
                                        Net Amount:</td>
                                    <td style="text-align: end;">{{cdtsum | currency:'INR'}}</td>
                                </tr>
                                <tr *ngIf="this.paytoid == 'E'">
                                    <td colspan="9"></td>
                                    <td class="totaldisplay" colspan="1">
                                        Net Amount:</td>
                                    <td style="text-align: end;">{{cdtsum | currency:'INR'}}</td>
                                </tr>
                                <tr *ngIf="movedata != 'apapproverview' && this.paytoid == 'S'">
                                    <td colspan="17">
                                        <button type="button" style="border-radius:40px;;margin-left:3900px;"
                                            class="btn btn-outline-success" (click)="ValidateCredit()"
                                            [disabled]="creditsaved" id="invoice-detail-0156">
                                            <!-- data-target="#invoice-detail-0003" data-toggle="modal" -->
                                            Save</button>
                                    </td>
                                </tr>
                                <tr *ngIf="movedata != 'apapproverview' && this.paytoid != 'S'">
                                    <td colspan="14">
                                        <button type="button" style="border-radius:40px;;margin-left: 3900px;"
                                            class="btn btn-outline-success" (click)="ValidateCredit()"
                                            [disabled]="creditsaved" id="invoice-detail-0157">
                                            <!-- data-target="#invoice-detail-0003" data-toggle="modal" -->
                                            Save</button>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </form>
                </div>
                <div *ngIf="showPOdiv">
                    <div style="margin-top: 10px;">

                        <tr>
                            <td>
                                <h3>PO NO. : ({{this.po_no}}) </h3>
                            </td>
                        </tr>


                        <form [formGroup]="POInvoiceForm" autocomplete="off">
                            <div class="comp-table t-resposive t-bdr-line t-HoverZoom">
                                <table >
                                    <thead >
                                        <tr>
                                            <th>S.No</th>
                                            <th>GRN Code</th>
                                            <th>Product Code</th>
                                            <th>Product Name</th>
                                            <th>HSN Code</th>
                                            <th>HSN Percentage</th>
                                            <th>UOM</th>
                                            <th>Unit Price</th>
                                            <th>Qty Ordered</th>
                                            <th>Qty Read & Paid</th>
                                            <th>Balance Qty</th>
                                            <th>Current Invoice Qty Read</th>
                                            <th>Amount</th>
                                            <th>Attachments</th>
                                            <th>Select</th>
                                        </tr>

                                    </thead>
                                    <ng-container formArrayName="poheader"
                                        *ngFor="let lists of getpoSections(POInvoiceForm); let i = index">

                                        <tr [formGroupName]="i">
                                            <td>{{i+1}}</td>
                                            <td>{{lists?.value?.grn_code}}</td>
                                            <td>{{lists?.value?.productcode}}</td>
                                            <td>{{lists?.value?.productname}}</td>
                                            <td>{{lists?.value?.hsn?.code}}</td>
                                            <td>{{lists?.value?.hsn_percentage}}</td>
                                            <td>{{lists?.value?.uom}}</td>
                                            <td>{{lists?.value?.unitprice}}</td>
                                            <td>{{lists?.value?.qty}}</td>
                                            <td>{{lists?.value?.qty_read}}</td>
                                            <td>{{lists?.value?.balance}}</td>
                                            <td id="matInput-size">
                                                <mat-form-field appearance="outline">
                                                    <input matInput type="number" placeholder="Current Invoice Qty Read"
                                                        [min]="1" formControlName="quantity" autocomplete="off"
                                                        (input)="calctot($event,lists,i)" id="invoice-detail-0158">
                                                </mat-form-field>
                                            </td>
                                            <td id="matInput-size">
                                                <mat-form-field appearance="outline">
                                                    <input matInput placeholder="Amount" formControlName="amount"
                                                        readonly autocomplete="off" id="invoice-detail-0159">
                                                </mat-form-field>
                                            </td>
                                            <td>
                                                <span *ngIf="!lists?.value?.file || lists.value.file.length === 0">-</span>
                                                <button *ngIf="lists?.value?.file && lists.value.file.length > 0"
                                                        type="button" 
                                                        class="btn btn-outline-primary"
                                                        matTooltip="View File" 
                                                        matTooltipClass="custom-tooltipnew"
                                                        (click)="viewpofile()"
                                                        style="margin-left: 40px;margin-top: -5px;border-radius:40px">
                                                        <!-- style="text-align: center; vertical-align: middle; transform: translateY(8px); border-radius:40px" -->
                                                    <i class="fa fa-eye create"></i>
                                                </button>
                                            </td>
                                            <td>
                                                <section class="example-section">
                                                    <mat-checkbox
                                                        matTooltip="Select"
                                                        matTooltipClass="custom-tooltipnew"
                                                        style="margin-left: 15px;margin-right: 5px;margin-bottom: 15px"
                                                        (change)="onselectionchangePO($event, lists, i)"
                                                        formControlName="select">
                                                    </mat-checkbox>
                                                </section>
                                            </td>
                                        </tr>
                                    </ng-container>
                                    <tr>
                                        <td class="totaldisplay" colspan="12" style="text-align: end;">Total Amount:
                                        </td>
                                        <td style="text-align: right;">{{this.INVsum}}</td>


                                    </tr>
                                </table>
                            </div>
                            <div class="form-container" style="margin-top: 10px;">
                                <tr>
                                    <td>
                                        <h3>PO Invoice Creation</h3>
                                    </td>
                                </tr>
                            </div>

                            <div class="comp-table t-resposive t-bdr-line t-HoverZoom">
                                <table >
                                    <thead >
                                        <tr>
                                            <th>S.No</th>
                                            <th>PO No</th>
                                            <th>Product Code</th>
                                            <th>Product Name</th>
                                            <th>HSN Code</th>
                                            <th>HSN Percentage</th>
                                            <th>UOM</th>
                                            <th>Unit Price</th>
                                            <th>Qty Ordered</th>
                                            <th>Amount</th>
                                            <th>Delete</th>
                                        </tr>

                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let datas of selectionArray;index as i">
                                            <td>{{i+1}}</td>
                                            <td>{{datas?.po_num}}</td>
                                            <td>{{datas?.productcode}}</td>
                                            <td>{{datas?.productname}}</td>
                                            <td>{{datas?.hsn?.code}}</td>
                                            <td>{{datas?.hsn_percentage}}</td>
                                            <td>{{datas?.uom}}</td>
                                            <td >{{datas?.unitprice}}</td>
                                            <td >{{datas?.quantity}}</td>
                                            <td >{{datas?.amount}}</td>
                                            <td>
                                                <button mat-icon-button type="button" matTooltip="Delete"
                                                    [disabled]="movedata == 'apapproverview'"
                                                    matTooltipClass="custom-tooltipnew" (click)="deletePOInv( i)"
                                                    id="invoice-detail-0160">
                                                    <mat-icon style="color: #0d6efd;" aria-label="Edit">
                                                        delete</mat-icon>
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>

                                    <tr>
                                        <td class="totaldisplay" colspan="9" style="text-align: end;">Total Amount:</td>
                                        <td >{{this.INVsum}}</td>


                                    </tr>

                                </table>
                                <div *ngIf="selectionArray?.length==0" style="text-align:center;">No Records Found...
                                </div>
                            </div>

                            <div style="margin-bottom: 2%;" *ngIf="selectionArray?.length>0">
                                <div class="row">
                                    <div class="col-10">

                                    </div>
                                    <div class="col-2">
                                        <button class="btn btn-outline-success" type="button"
                                            style="border-radius:40px;margin-top:20px" (click)="submitPoInvDtl()" title="Save"
                                            id="invoice-detail-0161">Submit</button>

                                    </div>

                                </div>

                            </div>
                        </form>
                    </div>
                    <tr>
                        <td>
                            <button type="button" style="border-radius:40px;margin-bottom: 10px;margin-left: 550px;"
                                class="btn btn-outline-primary" (click)="overallback()" id="invoice-detail-0162">
                                Back</button>
                        </td>
                    </tr>
                </div>

                <div style="margin-top: 20px;" *ngIf="movedata == 'ECF' && !showPOdiv">
                    <form [formGroup]="OverallForm">
                        <table>
                            <tr>
                                <!-- <td>
                        <mat-form-field style="width: 200px;">
                            <input type="text" matInput formControlName="payment_instruction" autocomplete="off"
                                placeholder="Payment Instructions" id="invoice-detail-0163">
                        </mat-form-field> 
                    </td>
                    <td>
                        <section class="example-section ecfapcheck" style="margin-left:50px">
                            <mat-checkbox class="example-margin" formControlName="is_tds_applicable">Is TDS Applicable
                               
                            </mat-checkbox>
                        </section>
                    </td> -->
                                <!-- <td>
                    <mat-label style="margin-left: 50px;" >Batch wise <label style="color:red">*</label></mat-label>

                    <mat-radio-group formControlName="batch_wise">
                        <mat-radio-button *ngFor="let n of yesorno" [value]="n.value" style="margin-left: 10px;margin-top: 10px;"
                            (click)="batchwiseSelect(n.value)">

                            {{n.display}}
                        </mat-radio-button>
                    </mat-radio-group>
                </td>
                <td *ngIf="showApprover">

                    <mat-form-field style="width: 200px;margin-left: 20px;" (click)="getBranches()">
                        <mat-label>Approver Branch</mat-label>
                        <input #brInput placeholder="Approver Branch" matInput formControlName="branch_id"
                            [matAutocomplete]="branchmatAuto" id="invoice-detail-0164">
                        <mat-autocomplete [panelWidth]="400" #branchmatAuto="matAutocomplete" (opened)="branchScroll()"
                            [displayWith]="displayFnBranch">
                            <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                            <ng-container *ngIf="!isLoading">
                                <mat-option *ngFor="let br of brList" matTooltip="{{br.code}}-{{br.name}}" [value]="br">
                                    {{br.code}}-{{br.name}}
                                </mat-option>
                            </ng-container>
                        </mat-autocomplete>
                    </mat-form-field>
                    <mat-form-field style="width: 250px;margin-left: 20px;font-family: 'Times New Roman', Times, serif;" (click)="approvername()">
                        <mat-label>Approver Name</mat-label>
                        <input #appInput  placeholder="Choose Approver" matInput
                        formControlName="approvedby" [matAutocomplete]="approver" required id="invoice-detail-0165">
                        <mat-autocomplete [panelWidth]="400" #approver="matAutocomplete" (opened)="autocompleteapproverScroll()"
                        [displayWith]="displayFnApprover">
                            <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                            <ng-container *ngIf="!isLoading">
                            <mat-option *ngFor="let app of approverList"
                                [value]="app?.employee_id" matTooltip="{{app?.employee_id?.name}}">{{app?.employee_id?.name}}
                            </mat-option>
                            </ng-container>
                        </mat-autocomplete>
                    </mat-form-field>
                </td> -->
                                <!-- <td>                
                    <button type="button" style="border-radius:40px;margin-left: 550px;"
                                    class="btn btn-outline-primary" (click)="InvoiceFormSubmit()" [disabled]="submitoverallbtn" id="invoice-detail-0166">
            
                                    Submit
                                </button>
                    <button type="button" style="border-radius:40px;margin-left: 10px;"
                    class="btn btn-outline-primary" (click)="overallback()" id="invoice-detail-0167">
                    Back</button>
                </td> -->
                            </tr>
                        </table>
                    </form>
                </div>
                <div style="margin-top: 20px;" *ngIf="movedata == 'AP' && !showPOdiv">
                    <form [formGroup]="OverallAPForm">
                        <table>
                            <tr>
                                <!-- <td>
                        <mat-form-field style="width: 200px;margin-left:450px">
                            <input type="text" matInput formControlName="remarks" autocomplete="off"
                                placeholder="Remarks" required id="invoice-detail-0168">
                        </mat-form-field> 
                    </td> -->
                                <!-- <td>                
                        <button type="button" style="border-radius:40px;margin-left: 460px;margin-bottom: 25px;"
                                        class="btn btn-outline-success" (click)="OverallAPFormSubmit()" id="invoice-detail-0169">
                
                                        Submit
                                    </button>
                        <button type="button" style="border-radius:40px;margin-left: 10px;margin-bottom: 25px;" *ngIf="movedata != 'apapproverview'"
                        class="btn btn-outline-danger" (click)="overallback()" id="invoice-detail-0170">
                        Back</button>
                    </td> -->
                            </tr>
                        </table>
                    </form>
                </div>
                <!-- <div style="margin-top: 20px;" *ngIf="movedata == 'apapproverview'">
                    <form [formGroup]="APapprovesubmitform">
                        <table>
                            <tr>
                                <td>
                                    <mat-form-field
                                        style="width: 250px;font-family: 'Times New Roman', Times, serif;margin-left: 350px;">
                                        <input matInput placeholder="Remarks" formControlName="remarks"
                                            autocomplete="off" required id="invoice-detail-0171">
                                    </mat-form-field>
                                </td>
                                <td style="border:0px">
                                    <input #fileInput id="invoice-detail-0002" type="file" multiple style="width: 108px;" hidden (change)="getFileDetails(0,$event)">

                                <i (click)="fileInput.click()"  class="fa fa-cloud-upload" matTooltip="Upload file" aria-hidden="true" style="font-size: 25px;color: blue;"></i> -->

                <!-- <i (click)="UploadPopupOpen()" class="fa fa-cloud-upload" matTooltip="Upload file"
                                        matTooltipClass="custom-tooltipnew" aria-hidden="true"
                                        style="font-size: 25px;color: blue;"> -->
                <!-- data-target="#create-ecf-0139" data-toggle="modal" -->
                <!-- </i>

                                </td>
                                <td *ngIf="valid_arr?.length != 0">
                                    <i matTooltip="view" class=" fa fa-eye create btn-cust-outline-blue"
                                        (click)="ecfap_view()" style="cursor: pointer;margin-left: 5px;"> -->
                <!-- data-target="#create-ecf-0004" data-toggle="modal" -->
                <!-- </i>
                                </td>
                                <button type="button" style="border-radius:40px;margin-left: 25px;margin-bottom: 25px;"
                                    class="btn btn-outline-success" (click)="approveap('Y')" id="invoice-detail-0172">
                                    Approve & Pay</button>
                                <button type="button" style="border-radius:40px;margin-left: 25px;margin-bottom: 25px;"
                                    class="btn btn-outline-success" (click)="modify()" id="invoice-detail-0172">
                                    Modify</button>
                                <button type="button" style="border-radius:40px;margin-left: 25px;margin-bottom: 25px;"
                                    class="btn btn-outline-danger" (click)="reauditap()" id="invoice-detail-0173">
                                    Re-Audit</button>
                                <button type="button" style="border-radius:40px;margin-left: 25px;margin-bottom: 25px;"
                                    class="btn btn-outline-primary" (click)="overallback()" id="invoice-detail-0174">
                                    Back</button>
                            </tr>
                        </table>
                    </form>
                </div> -->
            </div>
            <!-- Debit Div starts---- -->
            <div *ngIf="showdebitdiv">

                <header class="header-adjust">
                    <div class="headingalign">
                        <h3>
                            <i class="fa fa-arrow-left" aria-hidden="true" (click)="debitbacks()"></i>&nbsp;Debit Details (Total Amount :
                            {{invtotamount | currency:'INR'}})
                        </h3>

                        <button mat-icon-button *ngIf="movedata != 'apapproverview'" matTooltip=" Edit"
                            matTooltipClass="custom-tooltipnew" class="iconbutton" color="primary"
                            (click)="showdebitedit()" id="invoice-detail-0176">
                            <mat-icon [ngClass]="debitsaved ? 'edit_disabled' : 'edit_enabled'"
                                aria-label="Edit">edit</mat-icon>
                        </button>
                    </div>
                    <!-- <div class="button-div">
                        <button type="button" #debitclosebtn
                        style="border-radius:40px;"
                        class="btn btn-outline-primary" (click)="debitbacks()" id="invoice-detail-0191">
                        Back</button>
                    </div> -->
                </header>


                <!-- <h3>Debit Details (Total Amount :
                    {{invtotamount | currency:'INR'}}) -->

                <!-- &nbsp;&nbsp;&nbsp;&nbsp; -->

                <!-- <button type="button" class="btn btn-outline-success" matTooltip="Add debit details" matTooltipClass="custom-tooltipnew" *ngIf="movedata != 'apapproverview'"
                    style="border-radius:50px;margin: left 30px;" (click)="adddebitSection()" [class.disabled]="debitsaved" id="invoice-detail-0175">
                    <span class="fa fa-plus">&nbsp;&nbsp;Debit Details</span>
                </button> -->

                <!-- <button mat-icon-button matTooltip=" Edit" matTooltipClass="custom-tooltipnew" class="iconbutton" color="primary" style ="margin-left:10px;margin-top: 10px;border-radius: 50%;"
                    (click)="showdebitedit()"  id="invoice-detail-0176">
                    <mat-icon  [ngClass]="debitsaved ? 'edit_disabled' : 'edit_enabled'" aria-label="Edit">edit</mat-icon>
                    </button> -->

                <!-- </h3> -->

                <div class="content-adjust">
                    <form [formGroup]="DebitDetailForm">
                        <div class="comp-table t-resposive t-bdr-line t-HoverZoom" id="summary-table">
                            <table class="table" fixed-header>
                                <thead class="table_header">
                                    <tr>
                                        <th>S.No</th>
                                        <th>Category<span style="color:red">*</span></th>
                                        <th>Sub Category<span style="color:red">*</span></th>
                                        <th>GL No</th>
                                        <!-- <th>Business Product Code</th> -->
                                        <th *ngIf="movedata != 'apapproverview'">Split</th>
                                        <th>BS<span style="color:red">*</span> </th>
                                        <th>CC<span style="color:red">*</span></th>
                                        <th>CCBS %<span style="color:red">*</span></th>
                                        <th>Amount<span style="color:red">*</span></th>
                                        <th>Adjust Amount</th>
                                        <th>Debit Amount</th>
                                        <!-- <th>Remove</th> -->
                                        <th *ngIf="movedata != 'apapproverview'">Action</th>

                                    </tr>
                                </thead>
                                <ng-container formArrayName="debitdtl"
                                    *ngFor="let section of getDebitSections(DebitDetailForm); let i = index">
                                    <tr [formGroupName]="i">
                                        <!-- <td *ngIf="showaltslno == false">{{creditslno}}</td>
                                    <td *ngIf="showaltslno == true">{{creditslnos}}</td> -->
                                        <td>
                                            {{i+1}}</td>
                                        <td id="matInput-size">
                                            <mat-form-field appearance="outline" (click)="getcat('')">
                                                <mat-label>Category</mat-label>
                                                <input #categoryInput placeholder="Category" matInput  [readonly]="this.readonlydebit[i] || debitsaved || movedata == 'apapproverview'|| isCapitalizedArr ==1"
                                                    formControlName="category_code" [matAutocomplete]="cattype"
                                                    id="invoice-detail-0177">
                                                <mat-autocomplete [panelWidth]="250" #cattype="matAutocomplete"
                                                    [displayWith]="displaycatFn" (opened)="categoryScroll(i, cattype)">
                                                    <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                    </mat-option>
                                                    <ng-container *ngIf="!isLoading">
                                                        <mat-option *ngFor="let categoryname of categoryNameData"
                                                            (onSelectionChange)="cid(categoryname, '',i)"
                                                            [value]="categoryname">
                                                            {{categoryname.code}}
                                                        </mat-option>
                                                    </ng-container>
                                                </mat-autocomplete>

                                            <mat-icon matSuffix *ngIf="!debitsaved && movedata != 'apapproverview' && ! this.readonlydebit[i] && isCapitalizedArr==0" style="color: red !important;" 
                                            matTooltip="Clear" matTooltipClass="custom-tooltipnew" (click)="categoryClear(i);">clear</mat-icon> 
                                            </mat-form-field>
                                            <!-- <mat-form-field style="width: 200px;" *ngIf="i==0"
                                            (click)="getcat('')">
                                            <mat-label>Category</mat-label>
                                            <input #categoryInput placeholder="Category" matInput 
                                            [readonly]="this.readonlydebit[i] || DebitDetailForm?.value?.debitdtl[i]?.category_code?.code == 'GST Tax' 
                                            || debitsaved || movedata == 'apapproverview'"
                                                formControlName="category_code" [matAutocomplete]="cattype" style="width: 160px;" id="invoice-detail-0178">
                                            <mat-autocomplete  [panelWidth]="250" #cattype="matAutocomplete"
                                                [displayWith]="displaycatFn" (opened)="categoryScroll(i)">
                                                <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                </mat-option>
                                                <ng-container *ngIf="!isLoading">
                                                    <mat-option *ngFor="let categoryname of categoryNameData" (onSelectionChange)="cid(categoryname, '',i)"
                                                        [value]="categoryname">
                                                        {{categoryname.code}}
                                                    </mat-option>
                                                </ng-container>
                                            </mat-autocomplete>&nbsp; &nbsp;
                                            <mat-icon *ngIf="DebitDetailForm?.value?.debitdtl[i]?.category_code?.code != 'GST Tax' && !debitsaved 
                                            && movedata != 'apapproverview'" style="color: red;" 
                                            matTooltip="Clear" matTooltipClass="custom-tooltipnew" (click)="categoryClear(i);">clear</mat-icon> 
                                        </mat-form-field>
                                        <mat-form-field style="width: 200px;" *ngIf="i!=0"
                                            (click)="getcat('')">
                                            <mat-label>Category</mat-label>
                                            <input #categoryInput1 placeholder="Category" matInput 
                                            [readonly]="this.readonlydebit[i] || DebitDetailForm?.value?.debitdtl[i]?.category_code?.code == 'GST Tax' 
                                            || debitsaved || movedata == 'apapproverview'"
                                                formControlName="category_code" [matAutocomplete]="cattype1" style="width: 160px;" id="invoice-detail-0179">
                                            <mat-autocomplete  [panelWidth]="250" #cattype1="matAutocomplete"
                                                [displayWith]="displaycatFn" (opened)="categoryScroll(i)">
                                                <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                </mat-option>
                                                <ng-container *ngIf="!isLoading">
                                                    <mat-option *ngFor="let categoryname of categoryNameData" (onSelectionChange)="cid(categoryname, '',i)"
                                                        [value]="categoryname">
                                                        {{categoryname.code}}
                                                    </mat-option>
                                                </ng-container>
                                            </mat-autocomplete>&nbsp; &nbsp;
                                            <mat-icon *ngIf="DebitDetailForm?.value?.debitdtl[i]?.category_code?.code != 'GST Tax' && !debitsaved 
                                            && movedata != 'apapproverview'" style="color: red;" 
                                            matTooltip="Clear" matTooltipClass="custom-tooltipnew" (click)="categoryClear(i);">clear</mat-icon> 
                                        </mat-form-field> -->
                                            <p *ngIf="DebitDetailForm?.value?.debitdtl[i].category_code !='' && DebitDetailForm?.value?.debitdtl[i].category_code != 0 && DebitDetailForm?.value?.debitdtl[i].category_code != null && DebitDetailForm?.value?.debitdtl[i].category_code !=undefined"
                                                style="color: blue;font: size 11px;">
                                                {{section?.value?.category_code?.name}}</p>
                                        </td>
                                        <td id="matInput-size">
                                            <mat-form-field appearance="outline" (click)="getsubcat(this.catid,'')">
                                                <mat-label>Sub Category</mat-label>
                                                <input #subcategoryInput placeholder="Sub Category" matInput
                                                [readonly]="this.readonlydebit[i] ||debitsaved || movedata == 'apapproverview'|| isCapitalizedArr ==1"
                                                    formControlName="subcategory_code" (click)="getsubcatDebit(i,'')"
                                                    [matAutocomplete]="subcategorytype"  style="width: 160px;" id="invoice-detail-0059">
                                                <mat-autocomplete [panelWidth]="250" #subcategorytype="matAutocomplete"
                                                    [displayWith]="displaysubcatFn"
                                                    (opened)="subcategoryScroll(i, subcategorytype)">
                                                    <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                    </mat-option>
                                                    <ng-container *ngIf="!isLoading">
                                                        <mat-option *ngFor="let subcategoryname of subcategoryNameData"
                                                            [value]="subcategoryname"
                                                            (onSelectionChange)="getGLNumber(subcategoryname,i)">
                                                            {{subcategoryname.code}}
                                                        </mat-option>
                                                    </ng-container>
                                                </mat-autocomplete>
                                               
                                        <mat-icon matSuffix *ngIf="DebitDetailForm?.value?.debitdtl[i]?.category_code?.code != 'GST Tax' && !debitsaved
                                        && movedata != 'apapproverview' && isCapitalizedArr==0" style="color: red !important;" 
                                        matTooltip="Clear" matTooltipClass="custom-tooltipnew" (click)="subcatClear(i);">clear</mat-icon>
                                            </mat-form-field>
                                            <p *ngIf="DebitDetailForm?.value?.debitdtl[i].subcategory_code !='' && DebitDetailForm?.value?.debitdtl[i].subcategory_code != 0 && DebitDetailForm?.value?.debitdtl[i].subcategory_code != null && DebitDetailForm?.value?.debitdtl[i].subcategory_code !=undefined"
                                                style="color: blue;font: size 11px;">
                                                {{section?.value?.subcategory_code?.name}}</p>
                                        </td>
                                        <td id="matInput-size">
                                            <mat-form-field appearance="outline">

                                                <input matInput placeholder="GL Number" type="text"
                                                    formControlName="glno" autocomplete="off"
                                                    (keypress)="only_numalpha($event)" [readonly]="true"
                                                    id="invoice-detail-0181">
                                            </mat-form-field>

                                            <p *ngIf="DebitDetailForm?.value?.debitdtl[i].glno !='' && DebitDetailForm?.value?.debitdtl[i].glno != 0 && DebitDetailForm?.value?.debitdtl[i].glno != null && DebitDetailForm?.value?.debitdtl[i].glno !=undefined"
                                                style="color: blue;font: size 11px;">{{section?.value?.gldesc}}</p>
                                        </td>
                                        <!-- <td>
                                        <mat-form-field style="font-size:15px" (click)="getbpdropdown()">
                                            <mat-label>Business Product Code</mat-label>
        
        
                                            <input #bsproductInput matInput formControlName="bsproduct_code"
                                                [matAutocomplete]="producttype"  id="invoice-detail-0182">
                                            <mat-icon matSuffix class="maticonsize">unfold_more</mat-icon>
                                            <mat-autocomplete  [panelWidth]="400" #producttype="matAutocomplete" [displayWith]="displayFnbp"
                                                (opened)="bpScroll()">
                                                <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                </mat-option>
                                                <ng-container *ngIf="!isLoading">
                                                    <mat-option *ngFor="let data of businesslist"  [value]="data">
                                                        {{data.bsproduct_name}}
                                                    </mat-option>
                                                </ng-container>
                                            </mat-autocomplete>
                                        </mat-form-field>
                                    </td> -->
                                    <td *ngIf="movedata != 'apapproverview' && this.readonlydebit[i]==false  && !debitsaved">
                                            <i (click)="adddsplit(section, i)" class="fa fa-code-fork"
                                                style="font-size: 30px;margin-top: 15px;margin-left: 7px;"></i>
                                            <!-- <mat-icon (click)="adddsplit(section, i)">fork_right</mat-icon> -->
                                        </td>
                                        <td *ngIf="movedata != 'apapproverview' && (this.readonlydebit[i]==true || debitsaved)">
                                        </td>
                                        <td id="matInput-size">
                                            <mat-form-field appearance="outline" (click)="getbsdropdown()">


                                                <mat-label>BS</mat-label>

                                                <input #bsInput placeholder="BS" matInput formControlName="bs_code" 
                                                [readonly]="this.readonlydebit[i] || debitsaved || movedata =='apapproverview'"
                                                    [matAutocomplete]="bstype"  style="width: 160px;" id="invoice-detail-0183">
                                                <mat-autocomplete [panelWidth]="250" #bstype="matAutocomplete"
                                                    [displayWith]="displaybsFn" (opened)="bsScroll(i, bstype)">
                                                    <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                    </mat-option>
                                                    <ng-container *ngIf="!isLoading">
                                                        <mat-option *ngFor="let bsname of bsNameData" [value]="bsname"
                                                            (onSelectionChange)="bsid(bsname,bsname.code,i)">
                                                            {{bsname.name}}
                                                        </mat-option>
                                                    </ng-container>
                                                </mat-autocomplete>
                                               
                                            <mat-icon  matSuffix *ngIf="movedata != 'apapproverview' && !debitsaved && ! readonlydebit[i]" style="color: red !important;" 
                                            matTooltip="Clear" matTooltipClass="custom-tooltipnew" (click)="bsClear(i);">clear</mat-icon>


                                            </mat-form-field>
                                        </td>
                                        <td id="matInput-size">
                                            <mat-form-field appearance="outline" (click)="getccDebit('',i)">
                                                <mat-label>CC</mat-label>
                                                <input #ccinput placeholder="CC" matInput formControlName="cc_code" 
                                                [readonly]="this.readonlydebit[i]|| debitsaved || movedata == 'apapproverview'" 
                                                    [matAutocomplete]="cctype"  style="width: 160px;" id="invoice-detail-0184">
                                                <mat-autocomplete [panelWidth]="250" #cctype="matAutocomplete"
                                                    [displayWith]="displayccFn" (opened)="ccScroll(i, cctype)">
                                                    <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                    </mat-option>
                                                    <ng-container *ngIf="!isLoading">
                                                        <mat-option *ngFor="let ccname of ccNameData" [value]="ccname"
                                                            (onSelectionChange)="getccdata(ccname.code,ccname.id)">
                                                            {{ccname.name}}
                                                        </mat-option>
                                                    </ng-container>
                                                </mat-autocomplete>
                                                
                                            <mat-icon matSuffix *ngIf="!debitsaved && ! readonlydebit[i] && movedata != 'apapproverview'" style="color: red !important;" 
                                            matTooltip="Clear" matTooltipClass="custom-tooltipnew" (click)="CCclear(i);">clear</mat-icon>

                                            </mat-form-field>
                                        </td>
                                        <td id="matInput-size">
                                            <mat-form-field appearance="outline">

                                                <input matInput placeholder="%" formControlName="ccbspercentage" appCleardirective
                                                [readonly]="this.readonlydebit[i] ||debitsaved || movedata == 'apapproverview'"
                                                autocomplete="off" (keypress)="numberOnlyandDot($event,DebitDetailForm.value.debitdtl[i].ccbspercentage)"
                                                style="text-align: right;"
                                               (change)="valPercent( i)" (input)="calcCCBSAmt(i)"
                                                   (click)="addondebindex(i)" id="invoice-detail-0185">
                                            </mat-form-field>
                                        </td>
                                        <td id="matInput-size">

                                            <mat-form-field appearance="outline">
                                                <input matInput placeholder="Amount" type="text" autocomplete="off"
                                                [readonly]="this.readonlydebit[i] || debitsaved || movedata =='apapproverview'"  formControlName="amt"
                                                    #amt style="text-align: right;"
                                                    (change)="debitamtDecimalChg(amt ,'amt',i)"
                                                    (keypress)="getCharCode($event);numberOnlyandDot($event,DebitDetailForm.value.debitdtl[i].amt)" 
                                                    (input)="debitChangeToCurrency(i);calcCCBSPerc(i)" (change)="debitamt(i)" id="invoice-detail-0186">
                                            </mat-form-field>
                                        </td>
                                        <td id="matInput-size">
                                            <mat-form-field appearance="outline">

                                                <input matInput placeholder="Adjust" type="text" 
                                                [readonly]="this.readonlydebit[i] || debitsaved || movedata =='apapproverview'" [min]="min"
                                                    [max]="max" style="text-align: right;" #deductionamount
                                                    formControlName="deductionamount" autocomplete="off" [value]="0"
                                                    (change)="debitamtDecimalChg(deductionamount ,'deductionamount',i)"
                                                    (keypress)="getCharCode($event);numberOnlyandDot($event,DebitDetailForm.value.debitdtl[i].amt)" 
                                                    (input)="debitChangeToCurrency(i);calcCCBSPerc(i)" (change)="debitamt(i)" id="invoice-detail-0186">
                                            </mat-form-field>

                                        </td>
                                        <td id="matInput-size">
                                            <mat-form-field appearance="outline">
                                                <input matInput placeholder="Debit" type="text" formControlName="amount"
                                                    readonly style="text-align: right;" id="invoice-detail-0188">
                                            </mat-form-field>
                                        </td>
                                        <td *ngIf="movedata != 'apapproverview' && this.readonlydebit[i]==false && !debitsaved">
                                            <button mat-icon-button type="button" id="invoice-detail-0189">
                                                <mat-icon style="color: black;" aria-label="Edit" matTooltip="delete"
                                                    matTooltipClass="custom-tooltipnew"
                                                    (click)="deletedebitdetail(section,i)">
                                                    delete</mat-icon>
                                            </button>
                                        </td>
                                        <td *ngIf="movedata != 'apapproverview' && (this.readonlydebit[i] || debitsaved)">
                                            <button mat-icon-button type="button" id="invoice-detail-0189">
                                                <mat-icon style="color: grey;">
                                                    delete</mat-icon>
                                            </button>
                                        </td>
                                        <!-- <td *ngIf="this.readonlydebit[i]==true || DebitDetailForm?.value?.debitdtl[i]?.category_code?.code == 'GST Tax' || debitsaved">
                                    </td> -->

                                    </tr>
                                </ng-container>
                                <tr>
                                    <td *ngIf="movedata != 'apapproverview'" class="totaldisplay" colspan="10"
                                        style="text-align: right">Net Amount:
                                    </td>
                                    <td *ngIf="movedata == 'apapproverview'" class="totaldisplay" colspan="9"
                                        style="text-align: right">Net Amount:
                                    </td>
                                    <td style="text-align: end;">{{debitsum | currency:'INR'}}</td>
                                    <td *ngIf="movedata != 'apapproverview'"></td>
                                </tr>
                                <tr *ngIf="movedata != 'apapproverview'">
                                    <td colspan="12">
                                        <div style="display: flex; justify-content: flex-end; align-items: center;gap: 10px;">
                                            <button type="button" style="border-radius:40px;"
                                                class="btn btn-outline-success" (click)="debitform()"
                                                [disabled]="debitsaved" id="invoice-detail-0190">
                                                <!-- [disabled]="submitdebitdtlbtn" -->
    
                                                Save
                                            </button>
                                            <button type="button" #debitclosebtn
                                            style="border-radius:40px;"
                                            class="btn btn-outline-primary" (click)="debitbacks()" id="invoice-detail-0191">
                                            Back</button>
                                        </div>
                                    </td>
                                </tr>
                                <!-- <tr *ngIf="movedata == 'apapproverview'">
                                <td colspan="10">
                                    <button type="button" #debitclosebtn
                                        style="border-radius:40px;margin-left:15px;font-family: 'Times New Roman', Times, serif;margin-left: 1350px"
                                        class="btn btn-outline-primary" (click)="debitbacks()" id="invoice-detail-0191">
                                        Back</button>
                                </td>
                            </tr> -->
                            </table>
                        </div>
                    </form>
                </div>
            </div>


            <!-- Debit div ends -->
        </div>

    </div>


    <!-- <-----KVBAC POPUP----->
    <!-- <div *ngIf="showkvbacpopup"> -->

    <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabels" aria-hidden="true"
        id="invoice-detail-accpopup">
        <div class="modal-dialog modal-md">

            <div class="modal-content" style="width:550px">
                <div class="modal-header">
                    <h3 class="modal-title mb-0">Account Details</h3>
                    <button type="button" #closekvbbutton class="close" data-dismiss="modal" aria-label="Close"
                        id="invoice-detail-0192">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">


                    <form [formGroup]="kvbaccForm" autocomplete="off">
                        <div class="searchs-expand">

                            <div id="matInput-size">
                                <mat-form-field appearance="outline">
                                    <mat-label>Account Number</mat-label>

                                    <input matInput placeholder="Account Number" formControlName="accno" maxlength="16"
                                        appDisableCopyPaste autocomplete="off" (keypress)="numberOnly($event)"
                                        type="password" id="invoice-detail-0193">

                                </mat-form-field>
                            </div>&nbsp;&nbsp;
                            <div id="matInput-size">
                                <mat-form-field appearance="outline">
                                    <mat-label>Confirm Account Number</mat-label>
                                    <input matInput placeholder="Confirm Account Number" formControlName="confirmaccno"
                                        autocomplete="off" maxlength="16" (keypress)="numberOnly($event)"
                                        appDisableCopyPaste id="invoice-detail-0194">
                                </mat-form-field>
                            </div>


                        </div>

                    </form>


                </div>
                <div class="modal-footer">


                    <button type="submit" style="border-radius:40px;" class="btn btn-outline-success"
                        (click)="kvbsubmitForm()" id="invoice-detail-0195">
                        Save</button>




                    <button type="button" style="border-radius:40px;" class="btn btn-outline-primary"
                        (click)="kvbbackForm()" id="invoice-detail-0196">
                        Back</button>

                </div>

            </div>
        </div>
    </div>


    <!-- </div> -->

    <!-- <div *ngIf="showglpopup"> -->

    <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabels" aria-hidden="true"
        id="invoice-detail-glpopup">
        <div class="modal-dialog modal-md">

            <div class="modal-content" style="width:550px">
                <div class="modal-header ">
                    <h3 class="modal-title mb-0">Credit GL</h3>
                    <button type="button" #closebuttons (click)="closeCreditGL()" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">


                    <form [formGroup]="creditglForm">
                        <div class="searchs-expand">


                            <div id="matInput-size">
                                <mat-form-field appearance="outline">
                                    <mat-label>Paymode Name</mat-label>
                                    <input matInput placeholder="Paymode Name" formControlName="name" autocomplete="off"
                                        readonly id="invoice-detail-0198">
                                </mat-form-field>
                            </div>

                            <!-- <lib-vs-dynamicform-cmp id="matInput-size" [InputFields]="credit_GL"
                                (dataEvent)="getgl($event)" [formGroup]="creditglForm">
                                ></lib-vs-dynamicform-cmp> -->


                            <div   id="matInput-size">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Credit Gl</mat-label>
                                                <mat-select formControlName="glnum" id="invoice-detail-0199">
                                                    <mat-option *ngFor="let gl of glList" [value]="gl.id"
                                                        (click)="getgl(gl)">
                                                        {{gl.glno}}
                                                    </mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                        </div>



                        </div>
                        <!-- <br>
                            <tr>
                                <div style="margin-bottom: 5%;">
                                    <td>
                                      
                                        <button type="submit" style="border-radius:10px;margin-left: 80px;
                            border-color: #f5c68b;
                            background-color: #f5c68b;" (click)="glsubmitForm()" class="btn btn-light" id="invoice-detail-0200">Save</button> -->

                        <!-- <button type="submit"
                                            style="border-radius:40px;margin-left: 80px;font-family: 'Times New Roman', Times, serif;"
                                            class="btn btn-outline-primary" (click)="glsubmitForm()" id="invoice-detail-0201">
                                            Save</button>
    
                                    </td>
    
                                    <td> -->
                        <!-- 
                                        <button type="button" class="btn btn-light" style="border-radius:7px;margin-left:10px;
                              border-color: black; 
                              background-color: white;" (click)="glsubmitForm()" id="invoice-detail-0202">Back</button> -->

                        <!-- <button type="button"
                                            style="border-radius:40px;margin-left:10px;font-family: 'Times New Roman', Times, serif;"
                                            class="btn btn-outline-primary" (click)="glsubmitForm()" id="invoice-detail-0203">
                                            Back</button>
    
                                    </td>
                                </div>
                            </tr> -->
                    </form>


                </div>

                <div class="modal-footer">
                    <button type="submit" style="border-radius:40px;" class="btn btn-outline-success"
                        (click)="glsubmitForm()" id="invoice-detail-0201">
                        Save</button>

                    <button type="button" style="border-radius:40px;" class="btn btn-outline-primary"
                        (click)="closeCreditGL()" id="invoice-detail-0203">
                        Back</button>
                </div>
            </div>
        </div>
    </div>


    <!-- </div> -->


    <!-- <div *ngIf="showglpopup2"> -->

    <!-- <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabels" aria-hidden="true"
        data-keyboard="false" data-backdrop="static" id="invoice-detail-0003">
        <div class="modal-dialog modal-xl">

            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Credit GL</h3>
                    <button type="button" #closebuttons class="close" data-dismiss="modal" aria-label="Close"
                        id="invoice-detail-0197" (click)="closeCreditGL()">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">


                    <form [formGroup]="creditglForm">
                        <table>
                            <div>
                                <tr>
                                    <td id="matInput-size">
                                        <mat-form-field appearance="outline" (click)="getcatdropdowns()">
                                            <mat-label>Category</mat-label>
                                            <input #categoryInput placeholder="Category" matInput
                                                formControlName="category_code" [matAutocomplete]="cattype"
                                                id="invoice-detail-0205">

                                            <mat-autocomplete [panelWidth]="250" #cattype="matAutocomplete"
                                                [displayWith]="displaycrncatFn" (opened)="categoryScroll(0, cattype)">
                                                <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                </mat-option>
                                                <ng-container *ngIf="!isLoading">
                                                    <mat-option *ngFor="let categoryname of categoryData"
                                                        (onSelectionChange)="crncid(categoryname, '')"
                                                        [value]="categoryname" matTooltip="{{categoryname.code}}"
                                                        matTooltipClass="custom-tooltipnew">
                                                        {{categoryname.code}}
                                                    </mat-option>
                                                </ng-container>
                                            </mat-autocomplete>
                                        </mat-form-field>
                                    </td>
                                    <td id="matInput-size">
                                        <mat-form-field appearance="outline" (click)="getsubcatdropdowns()">

                                            <mat-label>Sub Category</mat-label>
                                            <input #subcategoryInput placeholder="Sub Category" matInput
                                                formControlName="subcategory_code" [matAutocomplete]="subcategorytype"
                                                id="invoice-detail-0206">

                                            <mat-autocomplete [panelWidth]="250" #subcategorytype="matAutocomplete"
                                                [displayWith]="displaycrnsubcatFn"
                                                (opened)="subcategoryScroll(0, subcategorytype)">
                                                <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                </mat-option>
                                                <ng-container *ngIf="!isLoading">
                                                    <mat-option *ngFor="let subcategoryname of subcategoryNameData"
                                                        [value]="subcategoryname"
                                                        (focusout)="getcrnGLNumber(subcategoryname)"
                                                        matTooltip="{{subcategoryname.code}}"
                                                        matTooltipClass="custom-tooltipnew">
                                                        {{subcategoryname.code}}
                                                    </mat-option>
                                                </ng-container>
                                            </mat-autocomplete>
                                        </mat-form-field>
                                    </td>
                                    <td id="matInput-size">
                                        <mat-form-field appearance="outline">

                                            <input matInput placeholder="GL Number" type="text" formControlName="glnum"
                                                autocomplete="off" readonly id="invoice-detail-0207">
                                        </mat-form-field>
                                    </td>
                                    <td id="matInput-size">
                                        <mat-form-field appearance="outline" (click)="getbsdropdown()">


                                            <mat-label>BS</mat-label>

                                            <input #bsInput placeholder="BS" matInput formControlName="bs_code"
                                                [matAutocomplete]="bstype" style="width: 160px;"
                                                id="invoice-detail-0208">
                                            <mat-autocomplete [panelWidth]="250" #bstype="matAutocomplete"
                                                [displayWith]="displaybsFn" (opened)="bsScroll(0, bstype)">
                                                <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                </mat-option>
                                                <ng-container *ngIf="!isLoading">
                                                    <mat-option *ngFor="let bsname of bsNameData" [value]="bsname"
                                                        (onSelectionChange)="crnbsid(bsname,bsname.code)">
                                                        {{bsname.name}}
                                                    </mat-option>
                                                </ng-container>
                                            </mat-autocomplete>
                                        </mat-form-field>
                                    </td>
                                    <td id="matInput-size">
                                        <mat-form-field appearance="outline">
                                            <mat-label>CC</mat-label>
                                            <input #ccinput placeholder="CC" matInput formControlName="cc_code"
                                                [matAutocomplete]="cctype" style="width: 160px;"
                                                id="invoice-detail-0209">
                                            <mat-autocomplete [panelWidth]="250" #cctype="matAutocomplete"
                                                [displayWith]="displayccFn" (opened)="ccScroll(0, cctype)">
                                                <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                </mat-option>
                                                <ng-container *ngIf="!isLoading">
                                                    <mat-option *ngFor="let ccname of ccNameData" [value]="ccname"
                                                        (onSelectionChange)="getccdata(ccname.code,ccname.id)">
                                                        {{ccname.name}}
                                                    </mat-option>
                                                </ng-container>
                                            </mat-autocomplete>

                                        </mat-form-field>
                                    </td>
                                </tr>

                            </div>
                        </table>
                        <br>
                        <tr>
                            <div class="modal-footer">
                                <td>
                                    <!-- 
                                        <button type="submit" style="border-radius:10px;margin-left: 80px;
                            border-color: #f5c68b;
                            background-color: #f5c68b;" (click)="glsubmitForm()" class="btn btn-light" id="invoice-detail-0210">Save</button> -->

    <!-- <button type="submit" style="border-radius:40px;" class="btn btn-outline-success"
                                        (click)="glsubmitForm()" id="invoice-detail-0211">
                                        Save</button>

                                </td>

                                <td> -->
    <!-- 
                                        <button type="button" class="btn btn-light" style="border-radius:7px;margin-left:10px;
                              border-color: black; 
                              background-color: white;" (click)="glsubmitForm()" id="invoice-detail-0212">Back</button> -->

    <!-- <button type="button" style="border-radius:40px;" class="btn btn-outline-primary"
                                        (click)="glsubmitForm()" id="invoice-detail-0213">
                                        Back</button>

                                </td>
                            </div>
                        </tr>

                    </form>


                </div>

            </div>
        </div>
    </div> -->

    <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabels" aria-hidden="true"
        id="invoice-detail-0003">
        <div class="modal-dialog modal-lg">

            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Credit GL</h3>
                    <button type="button" #closebuttons class="close" data-dismiss="modal" aria-label="Close"
                        id="invoice-detail-0197" (click)="closeCreditGL()">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">


                    <form [formGroup]="creditglForm">
                        <div class="searchs-expand">
                            <!-- <tr> -->
                            <div id="matInput-size">
                                <mat-form-field appearance="outline" (click)="getcatdropdowns()">
                                    <mat-label>Category</mat-label>
                                    <input #categoryInput placeholder="Category" matInput
                                        formControlName="category_code" [matAutocomplete]="cattype"
                                        id="invoice-detail-0205">

                                    <mat-autocomplete [panelWidth]="250" #cattype="matAutocomplete"
                                        [displayWith]="displaycrncatFn" (opened)="categoryScroll(0, cattype)">
                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                        </mat-option>
                                        <ng-container *ngIf="!isLoading">
                                            <mat-option *ngFor="let categoryname of categoryData"
                                                (onSelectionChange)="crncid(categoryname, '')" [value]="categoryname"
                                                matTooltip="{{categoryname.code}}" matTooltipClass="custom-tooltipnew">
                                                {{categoryname.code}}
                                            </mat-option>
                                        </ng-container>
                                    </mat-autocomplete>
                                </mat-form-field>
                            </div>
                            <div id="matInput-size">
                                <mat-form-field appearance="outline" (click)="getsubcatdropdowns()">

                                    <mat-label>Sub Category</mat-label>
                                    <input #subcategoryInput placeholder="Sub Category" matInput
                                        formControlName="subcategory_code" [matAutocomplete]="subcategorytype"
                                        id="invoice-detail-0206">

                                    <mat-autocomplete [panelWidth]="250" #subcategorytype="matAutocomplete"
                                        [displayWith]="displaycrnsubcatFn"
                                        (opened)="subcategoryScroll(0, subcategorytype)">
                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                        </mat-option>
                                        <ng-container *ngIf="!isLoading">
                                            <mat-option *ngFor="let subcategoryname of subcategoryNameData"
                                                [value]="subcategoryname" (focusout)="getcrnGLNumber(subcategoryname)"
                                                matTooltip="{{subcategoryname.code}}"
                                                matTooltipClass="custom-tooltipnew">
                                                {{subcategoryname.code}}
                                            </mat-option>
                                        </ng-container>
                                    </mat-autocomplete>
                                </mat-form-field>
                            </div>
                            <div id="matInput-size">
                                <mat-form-field appearance="outline">

                                    <input matInput placeholder="GL Number" type="text" formControlName="glnum"
                                        autocomplete="off" readonly id="invoice-detail-0207">
                                </mat-form-field>
                            </div>
                        </div>
                        <div class="searchs-expand">
                            <div id="matInput-size">
                                <mat-form-field appearance="outline" (click)="getbsdropdown()">


                                    <mat-label>BS</mat-label>

                                    <input #bsInput placeholder="BS" matInput formControlName="bs_code"
                                        [matAutocomplete]="bstype" style="width: 160px;" id="invoice-detail-0208">
                                    <mat-autocomplete [panelWidth]="250" #bstype="matAutocomplete"
                                        [displayWith]="displaybsFn" (opened)="bsScroll(0, bstype)">
                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                        </mat-option>
                                        <ng-container *ngIf="!isLoading">
                                            <mat-option *ngFor="let bsname of bsNameData" [value]="bsname"
                                                (onSelectionChange)="crnbsid(bsname,bsname.code)">
                                                {{bsname.name}}
                                            </mat-option>
                                        </ng-container>
                                    </mat-autocomplete>
                                </mat-form-field>
                            </div>
                            <div id="matInput-size">
                                <mat-form-field appearance="outline">
                                    <mat-label>CC</mat-label>
                                    <input #ccinput placeholder="CC" matInput formControlName="cc_code"
                                        [matAutocomplete]="cctype" style="width: 160px;" id="invoice-detail-0209">
                                    <mat-autocomplete [panelWidth]="250" #cctype="matAutocomplete"
                                        [displayWith]="displayccFn" (opened)="ccScroll(0, cctype)">
                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                        </mat-option>
                                        <ng-container *ngIf="!isLoading">
                                            <mat-option *ngFor="let ccname of ccNameData" [value]="ccname"
                                                (onSelectionChange)="getccdata(ccname.code,ccname.id)">
                                                {{ccname.name}}
                                            </mat-option>
                                        </ng-container>
                                    </mat-autocomplete>

                                </mat-form-field>
                            </div>
                            <!-- </tr> -->

                        </div>
                    </form>


                </div>
                <div class="modal-footer">
                    <!-- 
                                        <button type="submit" style="border-radius:10px;margin-left: 80px;
                            border-color: #f5c68b;
                            background-color: #f5c68b;" (click)="glsubmitForm()" class="btn btn-light" id="invoice-detail-0210">Save</button> -->

                    <button type="submit" style="border-radius:40px;" class="btn btn-outline-success"
                        (click)="glsubmitForm()" id="invoice-detail-0211">
                        Save</button>


                    <!-- 
                                        <button type="button" class="btn btn-light" style="border-radius:7px;margin-left:10px;
                              border-color: black; 
                              background-color: white;" (click)="glsubmitForm()" id="invoice-detail-0212">Back</button> -->

                    <button type="button" style="border-radius:40px;" class="btn btn-outline-primary"
                        (click)="glsubmitForm()" id="invoice-detail-0213">
                        Back</button>

                </div>

            </div>
        </div>
    </div>


    <!-- </div> -->

    <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabels" aria-hidden="true"
        data-backdrop="static" data-keyboard="false" id="invoice-detail-0006">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title mb-0">Supplier Details</h3>
                    <button type="button" #supclosebuttons class="close" data-dismiss="modal" aria-label="Close"
                        id="invoice-detail-0214">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div>


                        <form [formGroup]="SupplierDetailForm">
                            <div class="search-auto-fit">


                                <div id="matInput-size">
                                    <mat-form-field appearance="outline" id="matInput-size">
                                        <mat-label>Supplier Gst-No</mat-label>
                                        <input matInput placeholder="Supplier Gst-No" formControlName="suppliergst"
                                            maxlength="15" [ngModel]="inputGstValue"
                                            [readonly]="invdtlsaved || this.getgstapplicable== 'N'"
                                            (change)="GSTtext=''" (ngModelChange)="inputGstValue = $event.toUpperCase()"
                                            (keydown.space)="$event.preventDefault();" autocomplete="off"
                                            id="invoice-detail-0215">

                                    </mat-form-field>
                                    <h3 style="color:red">{{GSTtext}}</h3>
                                    <!-- (input)="validationGstNo($event)" -->
                                </div>

                                <div *ngIf="invdtlsaved || this.getgstapplicable== 'N'"></div>
                                <div *ngIf="!invdtlsaved && this.getgstapplicable== 'Y'">
                                    <i class="fa fa-check-circle"
                                        style="font-size:36px;color:darkblue;margin-left:10px;cursor: pointer;"
                                        matTooltip="validate" matTooltipClass="custom-tooltipnew"
                                        (click)="validationGstNo(SupplierDetailForm?.value?.suppliergst)"></i>
                                </div>

                                <div id="matInput-size">
                                    <mat-form-field appearance="outline">
                                        <mat-label>Supplier Name</mat-label>
                                        <input matInput placeholder="Supplier Name" formControlName="supplier_name"
                                            [readonly]="invdtlsaved|| this.getgstapplicable== 'Y'" autocomplete="off"
                                            required id="invoice-detail-0216">
                                    </mat-form-field>
                                </div>
                                <!-- <td *ngIf="!supdetDisable">
                                <mat-form-field
                                    style="width:200px;margin-left:-400px;font-family: 'Times New Roman', Times, serif;">
                                    <input matInput placeholder="Supplier Name" formControlName="supplier_name"
                                    autocomplete="off" readonly id="invoice-detail-0217">
                                </mat-form-field>
                            </td> -->
                                <div id="matInput-size">
                                    <mat-form-field appearance="outline">
                                        <mat-label>Supplier Pin-Code</mat-label>
                                        <input matInput placeholder="Supplier Pin-Code" formControlName="pincode"
                                            maxlength="6" [readonly]="invdtlsaved|| this.getgstapplicable== 'Y'"
                                            autocomplete="off" (keypress)="numberOnly($event)" required
                                            id="invoice-detail-0218">
                                    </mat-form-field>
                                </div>
                                <!-- <td >
                                <mat-form-field
                                    style="width:200px;margin-left:-150px;font-family: 'Times New Roman', Times, serif;">
                                    <input matInput placeholder="Supplier Pin-Code" formControlName="pincode" maxlength="6"
                                    autocomplete="off" (keypress)="numberOnly($event)" readonly id="invoice-detail-0219">
                                </mat-form-field>
                            </td> -->
                                <div id="matInput-size">
                                    <mat-form-field appearance="outline">
                                        <mat-label>Invoice No</mat-label>
                                        <input matInput placeholder="Invoice No" formControlName="invoiceno"
                                            [readonly]="invdtlsaved" autocomplete="off" required
                                            maxlength="16" id="invoice-detail-0220" (keypress)="invNoFilter($event);">
                                    </mat-form-field>
                                </div>
                                <div id="matInput-size">
                                    <mat-form-field appearance="outline">
                                        <mat-label>Date</mat-label>
                                        <input matInput [matDatepicker]="picker1" placeholder="Date"
                                            (dateChange)="onDateChange($event)" formControlName="invoicedate"
                                            [max]="tomorrow" required readonly id="invoice-detail-0221">
                                        <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                                        <mat-datepicker #picker1 [disabled]="invdtlsaved"></mat-datepicker>
                                    </mat-form-field>
                                </div>
                                <div id="matInput-size">
                                    <mat-form-field appearance="outline" id="matInput-size">
                                        <mat-label>Supplier Address</mat-label>
                                        <input matInput placeholder="Supplier Address" formControlName="address"
                                            [readonly]="invdtlsaved || this.getgstapplicable== 'Y'" autocomplete="off"
                                             id="invoice-detail-0222">
                                    </mat-form-field>
                                </div>
                                <!-- <td *ngIf="!supdetDisable">
                                <mat-form-field
                                    style="width:400px;margin-left:70px;font-family: 'Times New Roman', Times, serif;">
                                    <input matInput placeholder="Supplier Address" formControlName="address" 
                                        autocomplete="off"  id="invoice-detail-0223">
                                </mat-form-field>
                            </td> -->
                            </div>
                        </form>
                    </div>
                </div>

                <!-- <div>
                    <div *ngIf="!invdtlsaved" style="margin-bottom: 5%;">
                        <td>
                            <button type="submit" style="border-radius:40px;margin-left: 410px;
                             background-color: white;" (click)="suppliersubmitForm()" class="btn btn-outline-primary" id="invoice-detail-0224">Save</button>
                        </td>
                        <td>
                            <button type="button" class="btn btn-outline-primary" style="border-radius:40px;margin-left:10px;
                             background-color: white;" (click)="supplierResetform()" id="invoice-detail-0225">Reset</button>
                        </td>
                    </div>
                    <div *ngIf="invdtlsaved" style="margin-bottom: 5%;">
                        <td>
                            <button type="button" class="btn btn-outline-primary" style="border-radius:40px;margin-left:410px;
                             background-color: white;" (click)="supplierbackform()" id="invoice-detail-0226">Back</button>
                        </td>
                    </div>
                </div> -->

                <div class="modal-footer">
                    <div *ngIf="!invdtlsaved">
                        <button type="submit" style="border-radius: 40px;margin-right: 10px;"
                            class="btn btn-outline-success" id="invoice-detail-0224" (click)="suppliersubmitForm()">
                            Save
                        </button>
                        <button type="button" class="btn btn-outline-secondary" (click)="supplierResetform()"
                            style="border-radius: 40px" id="invoice-detail-0225">
                            Reset
                        </button>
                    </div>
                    <div *ngIf="invdtlsaved">
                        <button type="button" class="btn btn-outline-primary" (click)="supplierbackform()"
                            data-dismiss="modal" style="border-radius: 40px" id="invoice-detail-0226">
                            Back
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ---------- -->
    <!-- -------ppx popup------ -->


    <div class="modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true"
        id="liqdetailspop" style="overflow:auto">
        <div class="modal-dialog modal-lg " style="width: 100%;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">LIQ Details</h3>
                    <button type="button" class="close" #closeppxbutton data-dismiss="modal" aria-label="Close"
                        id="invoice-detail-0227" (click)="closeppx()">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <h3>CR No : {{this.crno}},
                        Invoice Amount: {{this.totalamount | currency:'INR'}}</h3>

                    <form [formGroup]="ppxForm">
                        <div class="container">
                            <div class="row">
                                <div class="table-responsive">
                                    <table class="table" fixed-header>
                                        <thead class="table_header">
                                            <tr>
                                                <th>S.No</th>
                                                <th>Advance No</th>                                                
                                                <th  *ngIf="ppxid != 'E'&& aptypeid !=3">Supplier Name</th>
                                                <th>Raiser Branch</th>
                                                <th>Date</th>
                                                <th>Advance Amount</th>
                                                <th>Balance Amount</th>
                                                <th *ngIf="modificationFlag == 'modification'">Amount liquidated in ECF
                                                </th>
                                                <th>Amount to be Liquidated </th>
                                                <th>Select</th>
                                            </tr>
                                        </thead>

                                        <ng-container formArrayName="ppxdtl">
                                            <tr  *ngFor="let section of getPpxSections(ppxForm); let i = index" [formGroupName]="i">
                                                <td>{{ (ppxCurrentPage - 1) * pageSize_ppx + i + 1 }}</td>
                                                <td id="matInput-size">
                                                    <mat-form-field appearance="outline">
                                                        <input matInput type="text" readonly formControlName="crno"
                                                            id="invoice-detail-0228">
                                                    </mat-form-field>
                                                </td>
                                                <td *ngIf="ppxid != 'E'&& aptypeid !=3" id="matInput-size">
                                                    <mat-form-field appearance="outline">
                                                        <input matInput type="text" readonly formControlName="name"
                                                            matTooltip="{{ppxForm.value.ppxdtl[i].name}}"
                                                            matTooltipClass="custom-tooltipnew"
                                                            id="invoice-detail-0229">
                                                    </mat-form-field>
                                                </td>
                                                <td id="matInput-size">
                                                    <mat-form-field appearance="outline">
                                                        <input matInput type="text" readonly
                                                            formControlName="raiserbranch"
                                                            matTooltip="{{ppxForm.value.ppxdtl[i].raiserbranch}}"
                                                            matTooltipClass="custom-tooltipnew"
                                                            id="invoice-detail-0230">
                                                    </mat-form-field>
                                                </td>
                                                <td id="matInput-size">
                                                    <mat-form-field appearance="outline">
                                                        <input matInput type="text" readonly
                                                            formControlName="ppxheader_date" id="invoice-detail-0231">
                                                    </mat-form-field>
                                                </td>
                                                <td id="matInput-size">
                                                    <mat-form-field appearance="outline">
                                                        <input matInput type="text" readonly
                                                            formControlName="ppxheader_amount" id="invoice-detail-0232">
                                                    </mat-form-field>
                                                </td>
                                                <td id="matInput-size">
                                                    <mat-form-field appearance="outline">
                                                        <input matInput type="text" readonly
                                                            formControlName="ppxheader_balance"
                                                            id="invoice-detail-0233">
                                                    </mat-form-field>
                                                </td>
                                                <td id="matInput-size" *ngIf="modificationFlag == 'modification'">
                                                    <mat-form-field appearance="outline">
                                                        <input matInput type="text" readonly
                                                            formControlName="ecf_amount" id="invoice-detail-0234">
                                                    </mat-form-field>
                                                </td>
                                                <td id="matInput-size">
                                                    <mat-form-field appearance="outline">
                                                        <input matInput type="text" formControlName="liquidate_amt"
                                                            #liquidate_amt (keypress)="getCharCode($event);"
                                                            (input)="ppxamt($event,i);getPPXsum()"
                                                            (change)="ppxamtDecimalChg(liquidate_amt, 'liquidate_amt', i)"  [readonly]="ppxdisable[i]"
                                                            id="invoice-detail-0235">
                                                    </mat-form-field>
                                                </td>
                                                 <!-- <td id="matInput-size">
                                                    <mat-form-field *ngIf="showcrnnotify == true && iscrn == true"  appearance="outline">
                                                        <input matInput type="text" formControlName="liquidate_amt"
                                                            #liquidate_amt (keypress)="getCharCode($event);"
                                                            (input)="ppxamt($event,i);getCRNsum()"
                                                            (change)="ppxamtDecimalChg(liquidate_amt, 'liquidate_amt', i)" [readonly]="crnliqdisable[i]"
                                                            id="invoice-detail-0235">
                                                    </mat-form-field>
                                                </td> -->
                                                <td>
                                                    <!-- style="text-align: center; vertical-align: middle; transform: translateY(-7px);" -->
                                                    <section class="example-section">
                                                        <mat-checkbox class="example-margin" formControlName="select" (change)="ppxselect($event,i)"
                                                        [disabled]="ppxDisable[(ppxCurrentPage - 1) * pageSize_ppx + i]" ></mat-checkbox>
                                                    </section>
                                                     <!-- <section *ngIf="showcrnnotify == true && iscrn == true"  class="example-section">
                                                    <mat-checkbox class="example-margin" formControlName="select"
                                                        (change)="crnliqselect($event,i)"
                                                        [disabled]="this.crnDisable[i]"></mat-checkbox>
                                                </section> -->
                                                </td>
                                            </tr>
                                        </ng-container>
                                         
                                        <tr>
                                            <td class="totaldisplay" colspan="7"
                                                style="text-align: end;font-size: 15px;">Total Amount:
                                            </td>
                                            <td>{{ppxsum | currency:'INR'}}</td>
                                            <td></td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </form>

                    <div class="row" *ngIf="ppxdata?.length > 0 && checkAdvance == true">
                        <div class="col-sm-6" style="margin-bottom: 0%;font-size: small;text-align: right;margin-top: 18px;font-weight:bold">
                        Page: {{ppxCurrentPage}}
                        </div>
                        <div  class="col-sm-6" style="margin-bottom: 0%;font-size: small;text-align:right;">
                        <mat-paginator
                        (page)="handlepageEvent($event)"
                        [length]="length_ppx"
                        [pageSize]="pageSize_ppx"
                        [showFirstLastButtons]="true"
                        [pageIndex]="pageIndexppx"
                        [hidePageSize]="true"
                        aria-label="Select page">
                        </mat-paginator>

                        </div>
                    </div>
                 
                </div>

                <div class="modal-footer">
                    <button  type="submit" style="border-radius:40px;" class="btn btn-outline-success"
                        (click)="submitppx()" id="invoice-detail-0236">
                        Submit</button>
                           


                    <button type="button" style="border-radius:40px;" class="btn btn-outline-primary"
                        (click)="closeppx()" id="invoice-detail-0237">
                        Back</button>
                </div>






            </div>
        </div>
    </div>
        <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true"
        id="crndetailspop" style="overflow:auto">
        <div class="modal-dialog modal-lg " style="width: 100%;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">CRN Details</h3>
                    <button type="button" class="close" #closeppxbuttoncrn data-dismiss="modal" aria-label="Close"
                        id="invoice-detail-0227" (click)="closecrnliq()">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <h3>CR No : {{this.crno}},
                        Invoice Amount: {{this.totalamount | currency:'INR'}}</h3>

                    <form [formGroup]="ppxForm">
                        <div class="container">
                            <div class="row">
                                <div class="table-responsive">
                                    <table class="table" fixed-header>
                                        <thead class="table_header">
                                            <tr>
                                                <th>S.No</th>
                                                <th>CreditNote No</th>
                                                <th>Supplier Name</th>
                                                <th>Raiser Branch</th>
                                                <th>Date</th>
                                                <th>CreditNote Amount</th>
                                                <th>Balance Amount</th>
                                                <th *ngIf="modificationFlag == 'modification'">Amount liquidated in ECF
                                                </th>
                                                <th>Amount to be Liquidated </th>
                                                <th>Select</th>
                                            </tr>
                                        </thead>

                                        
                                         <ng-container formArrayName="crndtl">
                                            <tr  *ngFor="let section of getCrndetSections(ppxForm); let i = index" [formGroupName]="i">
                                                <td>{{ (currentPagecrn - 1) * pageSize_crn + i + 1 }}</td>
                                                <td id="matInput-size">
                                                    <mat-form-field appearance="outline">
                                                        <input matInput type="text" readonly formControlName="crno"
                                                            id="invoice-detail-0228">
                                                    </mat-form-field>
                                                </td>
                                                <td id="matInput-size">
                                                    <mat-form-field appearance="outline">
                                                        <input matInput type="text" readonly formControlName="name"
                                                            matTooltip="{{ppxForm.value.crndtl[i].name}}"
                                                            matTooltipClass="custom-tooltipnew"
                                                            id="invoice-detail-0229">
                                                    </mat-form-field>
                                                </td>
                                                <td id="matInput-size">
                                                    <mat-form-field appearance="outline">
                                                        <input matInput type="text" readonly
                                                            formControlName="raiserbranch"
                                                            matTooltip="{{ppxForm.value.crndtl[i].raiserbranch}}"
                                                            matTooltipClass="custom-tooltipnew"
                                                            id="invoice-detail-0230">
                                                    </mat-form-field>
                                                </td>
                                                <td id="matInput-size">
                                                    <mat-form-field appearance="outline">
                                                        <input matInput type="text" readonly
                                                            formControlName="ppxheader_date" id="invoice-detail-0231">
                                                    </mat-form-field>
                                                </td>
                                                <td id="matInput-size">
                                                    <mat-form-field appearance="outline">
                                                        <input matInput type="text" readonly
                                                            formControlName="ppxheader_amount" id="invoice-detail-0232">
                                                    </mat-form-field>
                                                </td>
                                                <td id="matInput-size">
                                                    <mat-form-field appearance="outline">
                                                        <input matInput type="text" readonly
                                                            formControlName="ppxheader_balance"
                                                            id="invoice-detail-0233">
                                                    </mat-form-field>
                                                </td>
                                                <td id="matInput-size" *ngIf="modificationFlag == 'modification'">
                                                    <mat-form-field appearance="outline">
                                                        <input matInput type="text" readonly
                                                            formControlName="ecf_amount" id="invoice-detail-0234">
                                                    </mat-form-field>
                                                </td>
                                               
                                                 <td id="matInput-size">
                                                    <mat-form-field appearance="outline">
                                                        <input matInput type="text" formControlName="liquidate_amt"
                                                            #liquidate_amt (keypress)="getCharCode($event);"
                                                            (input)="crnamt($event,i);getCRNsum()"
                                                            (change)="crnamtDecimalChg(liquidate_amt, 'liquidate_amt', i)" [readonly]="crnliqdisable[i]"
                                                            id="invoice-detail-0235">
                                                    </mat-form-field>
                                                </td>
                                                <td>
                                                    <!-- style="text-align: center; vertical-align: middle; transform: translateY(-7px);" -->
                                                     <section  class="example-section">
                                                    <mat-checkbox class="example-margin" formControlName="select"
                                                        (change)="crnliqselect($event,i)"
                                                        [disabled]="this.crnDisable[(currentPagecrn - 1) * pageSize_crn + i]"></mat-checkbox>
                                                </section>
                                                </td>
                                            </tr>
                                        </ng-container>
                                        <tr>
                                            <td class="totaldisplay" colspan="7"
                                                style="text-align: end;font-size: 15px;">Total Amount:
                                            </td>
                                            <td>{{crnsum | currency:'INR'}}</td>
                                            <td></td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </form>

                     <div class="row" *ngIf="crndata?.length > 0">
                        <div class="col-sm-6" style="margin-bottom: 0%;font-size: small;text-align: right;margin-top: 18px;font-weight:bold">
                        Page: {{currentPagecrn}}
                        </div>
                        <div  class="col-sm-6" style="margin-bottom: 0%;font-size: small;text-align:right;">
                        
                        <mat-paginator
                        (page)="handlepageCrnEvent($event)"
                        [length]="length_crn"
                        [pageSize]="pageSize_crn"
                        [showFirstLastButtons]="true"
                        [pageIndex]="pageIndexcrn"
                        [hidePageSize]="true"
                        aria-label="Select page">
                        </mat-paginator>

                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    
                           <button type="submit" 
                            style="border-radius:40px;" class="btn btn-outline-success" [disabled]="crnselected"
                            (click)="submitcrnliq1()" id="invdetail-0225">
                            Submit</button>


                    <button type="button" style="border-radius:40px;" class="btn btn-outline-primary"
                        (click)="closecrnliq()" id="invoice-detail-0237">
                        Back</button>
                </div>






            </div>
        </div>
    </div>


    <!-- <div *ngIf="showppxmodal">
   
</div> -->
    <!-- View Trancation -->
    <!-- View Trancation -->
<div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabels" aria-hidden="true"
    data-keyboard="false" data-backdrop="static" id="invoice-detail-0008">
    <div class="modal-dialog modal-xl" style="width: 70%">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">View Transaction</h3>
                <!-- <button class="close" type="button" data-dismiss="modal" id="invoice-detail-0238">
                    x
                </button> -->
                <button class="close" type="button" data-dismiss="modal" id="invoice-detail-0238">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="container">
                    <div class="row">
                        <div class="table-responsive" style="width: 100%; margin-top: 1%">
                            <div class="table-responsive">
                                <lib-vs-cbox-summary [SummaryDetails]="SummaryviewData"
                                    [SummaryApiObj]="SummaryApiviewObjNew"  [FirstLastbtn]="true"></lib-vs-cbox-summary>
                            </div>
                            <br />
                            <table style="width: 100%; text-align: center">
                                <tr>
                                    <td>Employee Name: &nbsp;{{ this.name }}</td>
                                    <td>Designation: &nbsp;{{ this.designation }}</td>
                                    <td>Branch Name : &nbsp;{{ this.branch }}</td>
                                </tr>
                            </table>
                            <!-- <table
      class="table table-bordered"
      style="width: 100%; text-align: center"
    >
      <thead class="table_header">
        <tr>
          <th>S.NO</th>
          <th>Type</th>
          <th>Status</th>
          <th>From Date</th>
          <th>Remarks</th>
          <th>Employee Name</th>
          <th>Approver Name</th>
        </tr>
      </thead>
      <tr *ngFor="let dt of viewtrnlist; let i = index">
        <td>{{ i + 1 }}</td>
        <td>{{ dt.Type }}</td>
        <td>{{ dt.comments }}</td>
        <td>{{ dt.created_date }}</td>
        <td>{{ dt.remarks }}</td>
        <td>
          {{ dt.from_user.name }}
          <br />
          <div *ngIf="dt.from_user_id == -1; else deta"></div>
          <ng-template #deta>
            <a style="color: green; cursor: pointer" (click)="view(dt)"
              >View Details</a
            >
          </ng-template>
        </td>
        <td>
          {{ dt?.to_user?.name }}
          <br />
          <div *ngIf="dt.to_user_id == -1; else deta1"></div>
          <ng-template #deta1>
            <a style="color: green; cursor: pointer" (click)="viewto(dt)"
              >View Details</a
            >
          </ng-template>
        </td>
      </tr>
        <div class="row" *ngIf="viewtrnlist?.length > 0">
            <div class="col-sm-8" style="margin-bottom: 0%;font-size: small;text-align: right;margin-top: 18px;font-weight:bold">
            Page: {{viewtrnCurrentPage}}
            </div>
            <div  class="col-sm-4" style="margin-bottom: 0%;font-size: small;text-align:right;">
                <mat-paginator  style="margin-top: 0%;width: 350px;"
                            (page)="handleViewtrn($event)"
                            [length]="length_viewtrn"
                            [pageSize]="pageSize_Viewtrn"
                            [showFirstLastButtons]="showFirstLastButtons"
                            [pageSizeOptions]="pageSizeOptions"
                            [pageIndex]="pageIndexViewtrn"
                            [hidePageSize]="true"
                            aria-label="Select page">                            
                </mat-paginator>
            </div>
        </div>
    </table> -->
                        </div>
                            <!-- <table style="width: 100%; text-align: center">
      <tr>
        <td>Employee Name: &nbsp;{{ this.name }}</td>
        <td>Designation: &nbsp;{{ this.designation }}</td>
        <td>Branch Name : &nbsp;{{ this.branch }}</td>
      </tr>
      <tr>
        <td colspan="3">
          <button
            type="button"
            class="btn btn-outline-primary"
            style="border-radius: 40px; height: 44px; margin-top: 12px"
            data-dismiss="modal"
            id="invoice-detail-0239"
          >
            Back
          </button>
        </td>
      </tr>
    </table> -->
                          
                    </div>
                </div>
            </div>
            <div class="modal-footer" >
            <button type="button" class="btn btn-outline-primary" style="border-radius: 40px"
            data-dismiss="modal" id="invoice-detail-0239">
            Back
        </button>
    </div>
        </div>
    </div>
</div>


    <!-- -----CRNGL popup----- -->

    <div *ngIf="showgrnpopup">

        <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabels" aria-hidden="true"
            data-keyboard="false" data-backdrop="static" id="invoice-detail-0003">
            <div class="modal-dialog modal-xl">

                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title">CRNGL</h3>
                        <button type="button" #closebuttons class="close" data-dismiss="modal" aria-label="Close"
                            id="invoice-detail-0240">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div style="margin-left: 20px;margin-top: 2%; ">


                        <form [formGroup]="crnglForm">

                            <div class="table-responsive" style="width:100%;margin-top: 1%;">
                                <table class="table table-bordered" fixed-header style="width: 99%;margin-top: 10px;">
                                    <thead class="table_header" style="text-align: left;">

                                        <tr>
                                            <th>S.No</th>
                                            <th>Category<span style="color:red">*</span></th>
                                            <th>Sub Category<span style="color:red">*</span></th>
                                            <th>GL Number</th>
                                            <th>BS<span style="color:red">*</span> </th>
                                            <th>CC<span style="color:red">*</span></th>
                                        </tr>
                                    </thead>

                                    <ng-container formArrayName="crnglArray"
                                        *ngFor="let section of crnglForm.controls.crnglArray['controls']; let i = index">
                                        <tr [formGroupName]="i">
                                            <td>{{i+1}}</td>
                                            <td>
                                                <mat-form-field style="width:200px;font-size:15px"
                                                    (click)="getcatdropdowns()">
                                                    <mat-label>Category</mat-label>
                                                    <input #categoryInput placeholder="Category" matInput
                                                        formControlName="category_code" [matAutocomplete]="cattype"
                                                        id="invoice-detail-0241">

                                                    <mat-autocomplete [panelWidth]="250" #cattype="matAutocomplete"
                                                        [displayWith]="displaycrncatFn"
                                                        (opened)="categoryScroll(0, cattype)">
                                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                        </mat-option>
                                                        <ng-container *ngIf="!isLoading">
                                                            <mat-option *ngFor="let categoryname of categoryData"
                                                                (onSelectionChange)="cid(categoryname, '',i)"
                                                                [value]="categoryname"
                                                                matTooltip="{{categoryname.code}}"
                                                                matTooltipClass="custom-tooltipnew">
                                                                {{categoryname.code}}
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>
                                                </mat-form-field>
                                            </td>
                                            <td>
                                                <mat-form-field style="width: 200px;font-size:15px;"
                                                    (click)="getsubcatdropdowns()">

                                                    <mat-label>Sub Category</mat-label>
                                                    <input #subcategoryInput placeholder="Sub Category" matInput
                                                        formControlName="subcategory_code"
                                                        [matAutocomplete]="subcategorytype" id="invoice-detail-0242">

                                                    <mat-autocomplete [panelWidth]="250"
                                                        #subcategorytype="matAutocomplete"
                                                        [displayWith]="displaycrnsubcatFn"
                                                        (opened)="subcategoryScroll(0, subcategorytype)">
                                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                        </mat-option>
                                                        <ng-container *ngIf="!isLoading">
                                                            <mat-option
                                                                *ngFor="let subcategoryname of subcategoryNameData"
                                                                [value]="subcategoryname"
                                                                (focusout)="getcrnGLNumber(subcategoryname)"
                                                                matTooltip="{{subcategoryname.code}}"
                                                                matTooltipClass="custom-tooltipnew">
                                                                {{subcategoryname.code}}
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>
                                                </mat-form-field>
                                            </td>
                                            <td>
                                                <mat-form-field style="width:90px;font-size:15px;">

                                                    <input matInput placeholder="GL Number" type="text"
                                                        formControlName="creditglno" autocomplete="off"
                                                        (keypress)="only_numalpha($event)" [readonly]="true"
                                                        id="invoice-detail-0243">
                                                </mat-form-field>
                                            </td>
                                            <td>
                                                <mat-form-field style="width: 200px;" (click)="getbsdropdown()">


                                                    <mat-label>BS</mat-label>

                                                    <input #bsInput placeholder="BS" matInput formControlName="bs_code"
                                                        [matAutocomplete]="bstype" style="width: 160px;"
                                                        id="invoice-detail-0244">
                                                    <mat-autocomplete [panelWidth]="250" #bstype="matAutocomplete"
                                                        [displayWith]="displaybsFn" (opened)="bsScroll(0, bstype)">
                                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                        </mat-option>
                                                        <ng-container *ngIf="!isLoading">
                                                            <mat-option *ngFor="let bsname of bsNameData"
                                                                [value]="bsname"
                                                                (onSelectionChange)="bsid(bsname,bsname.code,i)">
                                                                {{bsname.name}}
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>
                                                </mat-form-field>
                                            </td>
                                            <td>
                                                <mat-form-field style="width:200px;">
                                                    <mat-label>CC</mat-label>
                                                    <input #ccinput placeholder="CC" matInput formControlName="cc_code"
                                                        [matAutocomplete]="cctype" style="width: 160px;"
                                                        id="invoice-detail-0245">
                                                    <mat-autocomplete [panelWidth]="250" #cctype="matAutocomplete"
                                                        [displayWith]="displayccFn" (opened)="ccScroll(0, cctype)">
                                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                        </mat-option>
                                                        <ng-container *ngIf="!isLoading">
                                                            <mat-option *ngFor="let ccname of ccNameData"
                                                                [value]="ccname"
                                                                (onSelectionChange)="getccdata(ccname.code,ccname.id)">
                                                                {{ccname.name}}
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>

                                                </mat-form-field>
                                            </td>


                                        </tr>
                                    </ng-container>
                                </table>
                            </div>
                            <br>
                            <tr>
                                <div style="margin-bottom: 5%;">
                                    <td>

                                        <!-- <button type="submit" style="border-radius:10px;margin-left: 300px;
                        border-color: #f5c68b;
                        background-color: #f5c68b;" (click)="crnsubmitForm()" class="btn btn-light" id="invoice-detail-0246">Save</button> -->


                                        <button type="submit"
                                            style="border-radius:40px;margin-left: 300px;font-family: 'Times New Roman', Times, serif;"
                                            class="btn btn-outline-success" (click)="crnsubmitForm()"
                                            id="invoice-detail-0247">
                                            Save</button>

                                    </td>

                                    <td>

                                        <!-- <button type="button" class="btn btn-light" style="border-radius:7px;margin-left:10px;
                          border-color: black; 
                          background-color: white;" (click)="glsubmitForm()" id="invoice-detail-0248">Back</button> -->

                                        <button type="button"
                                            style="border-radius:40px;margin-left:10px;font-family: 'Times New Roman', Times, serif;"
                                            class="btn btn-outline-primary" (click)="glsubmitForm()"
                                            id="invoice-detail-0249">
                                            Back</button>

                                    </td>
                                </div>
                            </tr>

                        </form>
























                        <!-- <table>
                            <div>

                                <tr>
                                    <td>
                                        <mat-form-field style="width:200px;font-size:15px"
                                            (click)="getcatdropdowns()">
                                            <mat-label>Category</mat-label>
                                            <input #categoryInput placeholder="Category" matInput
                                                formControlName="category_code" [matAutocomplete]="cattype"
                                                id="invoice-detail-0250">
                                              
                                            <mat-autocomplete [panelWidth]="400" #cattype="matAutocomplete"
                                                [displayWith]="displaycrncatFn" (opened)="categoryScroll()">
                                                <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                </mat-option>
                                                <ng-container *ngIf="!isLoading">
                                                    <mat-option *ngFor="let categoryname of categoryNameData"
                                                        (click)="cid(categoryname)" [value]="categoryname" matTooltip="{{categoryname.code}}">
                                                        {{categoryname.code}}
                                                    </mat-option>
                                                </ng-container>
                                            </mat-autocomplete>
                                        </mat-form-field>
                                    </td>
                                    <td>
                                        <mat-form-field style="width: 200px;font-size:15px;margin-left:50px;" (click)="getsubcatdropdowns()">

                                            <mat-label>Sub Category</mat-label>
                                            <input #subcategoryInput placeholder="Sub Category" matInput
                                                formControlName="subcategory_code"
                                                [matAutocomplete]="subcategorytype"
                                                 id="invoice-detail-0251">
                                               
                                            <mat-autocomplete [panelWidth]="400" #subcategorytype="matAutocomplete"
                                                [displayWith]="displaycrnsubcatFn" (opened)="subcategoryScroll()">
                                                <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                </mat-option>
                                                <ng-container *ngIf="!isLoading">
                                                    <mat-option *ngFor="let subcategoryname of subcategoryNameData"
                                                        [value]="subcategoryname"
                                                        (focusout)="getcrnGLNumber(subcategoryname)" matTooltip="{{subcategoryname.code}}">
                                                        {{subcategoryname.code}}
                                                    </mat-option>
                                                </ng-container>
                                            </mat-autocomplete>
                                        </mat-form-field>
                                    </td>
                                    <td>
                                        <mat-form-field style="width:90px;font-size:15px;margin-left: 50px;">

                                            <input matInput placeholder="GL Number" type="text"
                                                formControlName="debitglno" autocomplete="off"
                                                (keypress)="only_numalpha($event)" [readonly]="true" id="invoice-detail-0252">
                                        </mat-form-field>
                                    </td>


                                </tr>

                            </div>
                        </table>
                        <br>
                        <tr>
                            <div style="margin-bottom: 5%;">
                                <td>

                                    <button type="submit" style="border-radius:10px;margin-left: 80px;
                        border-color: #f5c68b;
                        background-color: #f5c68b;" (click)="crnsubmitForm()" class="btn btn-light" id="invoice-detail-0253">Save</button>

                                </td>

                                <td>

                                    <button type="button" class="btn btn-light" style="border-radius:7px;margin-left:10px;
                          border-color: black; 
                          background-color: white;" (click)="glsubmitForm()" id="invoice-detail-0254">Back</button>

                                </td>
                            </div>
                        </tr>

                    </form> -->


                    </div>

                </div>
            </div>
        </div>


    </div>


<div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabels" aria-hidden="true"
            data-keyboard="false" data-backdrop="static" id="crnglpopup">
            <div class="modal-dialog modal-xl">

                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title">CRNGL</h3>
                        <button type="button" #closebuttonsgl class="close" data-dismiss="modal" aria-label="Close"
                            id="invoice-detail-0240">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">


                        <form [formGroup]="crnglForm">

                            <div class="comp-table t-resposive t-bdr-line t-HoverZoom" id="summary-table">
                                <table>
                                    <thead>

                                        <tr>
                                            <th>S.No</th>
                                            <th>Category<span style="color:red">*</span></th>
                                            <th>Sub Category<span style="color:red">*</span></th>
                                            <th>GL Number</th>
                                            <!-- <th>BS<span style="color:red">*</span> </th>
                                            <th>CC<span style="color:red">*</span></th> -->
                                        </tr>
                                    </thead>

                                    <ng-container formArrayName="crnglArray"
                                        *ngFor="let section of crnglArray.controls; let i = index">
                                        <tr [formGroupName]="i">
                                            <td>{{i+1}}</td>
                                            <!-- (click)="getcatdropdowns()" -->
                                            <td  id="matInput-size">
                                                <mat-form-field appearance="outline"
                                                     (click)="getcrncat('')">
                                                    <mat-label>Category</mat-label>
                                                    <input #categoryInput placeholder="Category" matInput
                                                        formControlName="category_code" [matAutocomplete]="cattype"
                                                        id="invoice-detail-0241" [disabled]="creditsaved">

                                                    <mat-autocomplete [panelWidth]="250" #cattype="matAutocomplete"
                                                        [displayWith]="displaycrncatFn"
                                                        (opened)="categoryScroll(0, cattype)">
                                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                        </mat-option>
                                                        <ng-container *ngIf="!isLoading">
                                                            <mat-option *ngFor="let categoryname of categoryNameData"
                                                                (onSelectionChange)="crnselcid(categoryname, '',i)"
                                                                [value]="categoryname"
                                                                matTooltip="{{categoryname.code}}"
                                                                matTooltipClass="custom-tooltipnew">
                                                                {{categoryname.code}}
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>
                                                </mat-form-field>
                                            </td>
                                            <td  id="matInput-size">
                                                <mat-form-field appearance="outline"
                                                    (click)="getsubcatdropdowns()">

                                                    <mat-label>Sub Category</mat-label>
                                                    <input #subcategoryInput placeholder="Sub Category" matInput
                                                        formControlName="subcategory_code"
                                                        [matAutocomplete]="subcategorytype" id="invoice-detail-0242" [disabled]="creditsaved">

                                                    <mat-autocomplete [panelWidth]="250"
                                                        #subcategorytype="matAutocomplete"
                                                        [displayWith]="displaycrnsubcatFn"
                                                        (opened)="subcategoryScroll(0, subcategorytype)">
                                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                        </mat-option>
                                                        <ng-container *ngIf="!isLoading">
                                                            <mat-option
                                                                *ngFor="let subcategoryname of subcategoryNameData"
                                                                [value]="subcategoryname"
                                                                (focusout)="getgetcrnGLNumber(subcategoryname)"
                                                                matTooltip="{{subcategoryname.code}}"
                                                                matTooltipClass="custom-tooltipnew">
                                                                {{subcategoryname.code}}
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>
                                                </mat-form-field>
                                            </td>
                                            <td id="matInput-size">
                                                <mat-form-field appearance="outline">

                                                    <input matInput placeholder="GL Number" type="text"
                                                        formControlName="creditglno" autocomplete="off"
                                                        (keypress)="only_numalpha($event)" [readonly]="true"
                                                        id="invoice-detail-0243" [disabled]="creditsaved">
                                                </mat-form-field>
                                            <!-- </td>
                                            <td>
                                                <mat-form-field style="width: 200px;" (click)="getbsdropdown()">


                                                    <mat-label>BS</mat-label>

                                                    <input #bsInput placeholder="BS" matInput formControlName="bs_code"
                                                        [matAutocomplete]="bstype" style="width: 160px;"
                                                        id="invoice-detail-0244">
                                                    <mat-autocomplete [panelWidth]="250" #bstype="matAutocomplete"
                                                        [displayWith]="displaybsFn" (opened)="bsScroll(0, bstype)">
                                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                        </mat-option>
                                                        <ng-container *ngIf="!isLoading">
                                                            <mat-option *ngFor="let bsname of bsNameData"
                                                                [value]="bsname"
                                                                (onSelectionChange)="bsid(bsname,bsname.code,i)">
                                                                {{bsname.name}}
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>
                                                </mat-form-field>
                                            </td>
                                            <td>
                                                <mat-form-field style="width:200px;">
                                                    <mat-label>CC</mat-label>
                                                    <input #ccinput placeholder="CC" matInput formControlName="cc_code"
                                                        [matAutocomplete]="cctype" style="width: 160px;"
                                                        id="invoice-detail-0245">
                                                    <mat-autocomplete [panelWidth]="250" #cctype="matAutocomplete"
                                                        [displayWith]="displayccFn" (opened)="ccScroll(0, cctype)">
                                                        <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                                        </mat-option>
                                                        <ng-container *ngIf="!isLoading">
                                                            <mat-option *ngFor="let ccname of ccNameData"
                                                                [value]="ccname"
                                                                (onSelectionChange)="getccdata(ccname.code,ccname.id)">
                                                                {{ccname.name}}
                                                            </mat-option>
                                                        </ng-container>
                                                    </mat-autocomplete>

                                                </mat-form-field>
                                            </td> -->


                                        </tr>
                                    </ng-container>
                                </table>
                            </div>
                          
                            

                        </form>










                    </div>

                    <div class="modal-footer">
                            <button type="submit"
                                            style="border-radius:40px;margin-left: 300px;font-family: 'Times New Roman', Times, serif;"
                                            class="btn btn-outline-success" (click)="crnsubmitForm()"
                                            id="invoice-detail-0247">
                                            Save</button>
                            <button type="button"
                                            style="border-radius:40px;margin-left:10px;font-family: 'Times New Roman', Times, serif;"
                                            class="btn btn-outline-primary" (click)="crnback()"
                                            id="invoice-detail-0249">
                                            Back</button>
                    </div>
                </div>
            </div>
        </div>

    <div>
        <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true"
            data-keyboard="false" data-backdrop="static" id="invoice-detail-0010">
            <div class="modal-dialog modal-xl " style="width: 40%;">
                <div class="modal-content">
                    <div class="modal-header" style="background: rgba(23, 204, 23, 0.288);">
                        <h2 class="modal-title" style="color:black ;text-align: center;font-weight: bold;">GL
                            Description
                        </h2>
                        <button type="button" class="close" data-dismiss="modal" #closeglbutton aria-label="Close"
                            id="invoice-detail-0255">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>

                    <div style="margin-left: 50px;margin-right: 80%;margin-top: 2%; width: 80%;">
                        <div class="container">
                            <div class="row">
                                <div class="table-responsive" style="width:100%;margin-top: 1%;">
                                    <table class="table table-bordered" fixed-header
                                        style="width: 99%;margin-top: 10px;">
                                        <thead class="table_header" style="text-align: left;">

                                            <tr>

                                                <th style="text-align: center;">Category</th>
                                                <th style="text-align: center;">SubCategory</th>
                                                <th style="text-align: center;">GL Number</th>



                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td style="text-align: center;">{{catviewdata}}</td>
                                                <td style="text-align: center;">{{subcatviewdata}}</td>
                                                <td style="text-align: center;">{{glviewdata}}</td>
                                            </tr>
                                        </tbody>
                                    </table>

                                </div>
                                <tr>
                                    <td>

                                        <button type="button" class="btn btn-outline-primary" style="border-radius:7px;margin-left:180px;
                                    border-color: black; margin-bottom: 20px;
                                    background-color: white;" (click)="glback()" id="invoice-detail-0256">Back</button>

                                    </td>
                                </tr>
                            </div>
                        </div>


                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true"
    id="invoice-detail-0011">
    <div class="modal-dialog modal-xl" style="width:80%;height:200%;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Dedupe</h3>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"
                    id="invoice-detail-0257">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <!-- <br> -->
            <div class="modal-body">
                <h3>EXACT MATCH</h3>
                <lib-vs-cbox-summary [SummaryDetails]="Summary_exactmatch"
                    [SummaryApiObj]="SummaryObj_exactmatch_New"></lib-vs-cbox-summary>
                <!-- <div class="table-responsive" class="tablescroll" style="margin-top: 10px;width: 100%;margin-left: 10px;">
                   <table class="table table scrolltable table-bordered" style="width: 99%; margin-top: 10px;">
                       <thead class="table_header " fixed-header>
                           <tr>
                               <th>S.No</th> 
                               <th>Invoice Number</th>                             
                               <th>Invoice Date</th>                             
                               <th>Invoice Header Amount</th>
                               <th>Status</th>          
                               <th>CR Number</th>                
                               <th>Supplier Name</th>
                               <th>Branch Name</th>             
                               <th>Employee Name</th>                                      
                           </tr>
                       </thead>
                       <tbody>                    
                           <tr *ngFor="let value of exactList; index as i;">
                               <td style="text-align:center;"> {{(presentpageDedExact  - 1)*identificationSize +i+1 }} </td>
                               <td>{{value.invoiceno}}</td>
                               <td>{{value.invoice_date |date :'dd-MMM-yyyy' }}</td>
                               <td style="text-align: right;">{{value.invoiceamount}}</td>     
                               <td>{{value['status'].text}}</td>
                               <td>{{value.crno}}</td>                         
                               <td>{{value['supplier'].name}}</td>
                               <td>{{value['branch'].name}}</td>
                               <td>{{value.raised_empname}}</td>    
                           </tr>
                       </tbody>
                   </table>
                   <div *ngIf="exactList ?.length == 0" style="margin-left: 42%;">
                       <h3 style="font-family: 'Times New Roman', Times, serif;">No Records found!..</h3>
                   </div>
                    <div class="row" *ngIf="exactList?.length > 0">
                         <div class="col-sm-7" style="margin-bottom: 0%;font-size: small;text-align: right;margin-top: 18px;font-weight:bold">
                         Page: {{presentpageDedExact}}
                         </div>
                         <div  class="col-sm-5" style="margin-bottom: 1%;font-size: small;text-align:right;">
                             <mat-paginator  style="margin-top: 0%;margin-left: 25px; width: 350px;"
                                         (page)="handleDedExact($event)"
                                         [length]="length_DedExact"
                                         [pageSize]="pageSize_DedExact"
                                         [showFirstLastButtons]="showFirstLastButtons"
                                         [pageSizeOptions]="pageSizeOptions"
                                         [pageIndex]="pageIndexDedExact"
                                         [hidePageSize]="true"
                                         aria-label="Select page"> 
                                     
                                     </mat-paginator>
                         </div>
                    </div>
               </div> -->
                <br>
                <h3>WITHOUT SUPPLIER</h3>
                <lib-vs-cbox-summary [SummaryDetails]="Summary_without_supp"
                    [SummaryApiObj]="SummaryObj_without_supp_New"></lib-vs-cbox-summary>
                <!-- <div class="table-responsive" class="tablescroll" style="margin-top: 10px;width: 100%;margin-left: 10px;">
                   <table class="table table scrolltable table-bordered" style="width: 99%; margin-top: 10px;">
                       <thead class="table_header " fixed-header>
                           <tr>
                               <th>S.No</th> 
                               <th>Invoice Number</th>                             
                               <th>Invoice Date</th>                             
                               <th>Invoice Header Amount</th>
                               <th>Status</th>          
                               <th>CR Number</th>                
                               <th>Supplier Name</th>
                               <th>Branch Name</th>             
                               <th>Employee Name</th>                                      
                           </tr>
                       </thead>
                       <tbody>                    
                           <tr *ngFor="let value of withoutSuppList; index as i;">
                               <td style="text-align:center;"> {{(presentpageDedWithoutSup  - 1)*identificationSize +i+1 }} </td>
                               <td>{{value.invoiceno}}</td>
                               <td>{{value.invoice_date |date :'dd-MMM-yyyy' }}</td>
                               <td style="text-align: right;">{{value.invoiceamount}}</td>     
                               <td>{{value['status'].text}}</td>
                               <td>{{value.crno}}</td>                         
                               <td>{{value['supplier'].name}}</td>
                               <td>{{value['branch'].name}}</td>
                               <td>{{value.raised_empname}}</td>    
                           </tr>
                       </tbody>
                   </table>
                   <div *ngIf="withoutSuppList ?.length == 0" style="margin-left: 42%;">
                       <h3 style="font-family: 'Times New Roman', Times, serif;">No Records found!..</h3>
                   </div>

                    <div class="row" *ngIf="withoutSuppList?.length > 0">
                         <div class="col-sm-7" style="margin-bottom: 0%;font-size: small;text-align: right;margin-top: 18px;font-weight:bold">
                         Page: {{presentpageDedWithoutSup}}
                         </div>
                         <div  class="col-sm-5" style="margin-bottom: 1%;font-size: small;text-align:right;">
                             <mat-paginator  style="margin-top: 0%;margin-left: 25px; width: 350px;"
                                         (page)="handleDedWithoutSupp($event)"
                                         [length]="length_DedWithoutSupp"
                                         [pageSize]="pageSize_DedWithoutSupp"
                                         [showFirstLastButtons]="showFirstLastButtons"
                                         [pageSizeOptions]="pageSizeOptions"
                                         [pageIndex]="pageIndexDedWithoutSupp"
                                         [hidePageSize]="true"
                                         aria-label="Select page"> 
                                     
                                     </mat-paginator>
                         </div>
                    </div>
               </div> -->
                <br>
                <h3>WITHOUT INVOICE AMOUNT</h3>
                <lib-vs-cbox-summary [SummaryDetails]="Summary_without_inv_amnt"
                    [SummaryApiObj]="SummaryObj_without_inv_amnt_New"></lib-vs-cbox-summary>
                <!-- <div class="table-responsive" class="tablescroll" style="margin-top: 10px;width: 100%;margin-left: 10px;">
                   <table class="table table scrolltable table-bordered" style="width: 99%; margin-top: 10px;">
                       <thead class="table_header " fixed-header>
                           <tr>
                               <th>S.No</th> 
                               <th>Invoice Number</th>                             
                               <th>Invoice Date</th>                             
                               <th>Invoice Header Amount</th>
                               <th>Status</th>          
                               <th>CR Number</th>                
                               <th>Supplier Name</th>
                               <th>Branch Name</th>             
                               <th>Employee Name</th>                                      
                           </tr>
                       </thead>
                       <tbody>                    
                           <tr *ngFor="let value of withoutInvAmtList; index as i;">
                               <td style="text-align:center;"> {{(presentpageDedWithoutInvAmt  - 1)*identificationSize +i+1 }} </td>
                               <td>{{value.invoiceno}}</td>
                               <td>{{value.invoice_date |date :'dd-MMM-yyyy' }}</td>
                               <td style="text-align: right;">{{value.invoiceamount}}</td>     
                               <td>{{value['status'].text}}</td>
                               <td>{{value.crno}}</td>                         
                               <td>{{value['supplier'].name}}</td>
                               <td>{{value['branch'].name}}</td>
                               <td>{{value.raised_empname}}</td>    
                           </tr>
                       </tbody>
                   </table>
                   <div *ngIf="withoutInvAmtList ?.length == 0" style="margin-left: 42%;">
                       <h3 style="font-family: 'Times New Roman', Times, serif;">No Records found!..</h3>
                   </div>

                    <div class="row" *ngIf="withoutInvAmtList?.length > 0">
                         <div class="col-sm-7" style="margin-bottom: 0%;font-size: small;text-align: right;margin-top: 18px;font-weight:bold">
                         Page: {{presentpageDedWithoutInvAmt}}
                         </div>
                         <div  class="col-sm-5" style="margin-bottom: 1%;font-size: small;text-align:right;">
                             <mat-paginator  style="margin-top: 0%;margin-left: 25px; width: 350px;"
                                         (page)="handleDedWithoutInvAmt($event)"
                                         [length]="length_DedWithoutInvAmt"
                                         [pageSize]="pageSize_DedWithoutInvAmt"
                                         [showFirstLastButtons]="showFirstLastButtons"
                                         [pageSizeOptions]="pageSizeOptions"
                                         [pageIndex]="pageIndexDedWithoutInvAmt"
                                         [hidePageSize]="true"
                                         aria-label="Select page"> 
                                     
                                     </mat-paginator>
                         </div>
                    </div>
               </div> -->
                <br>
                <h3>WITHOUT INVOICE NUMBER</h3>
                <lib-vs-cbox-summary [SummaryDetails]="Summary_without_inv_no"
                    [SummaryApiObj]="SummaryObj_without_inv_no_New"></lib-vs-cbox-summary>
                <!-- <div class="table-responsive" class="tablescroll" style="margin-top: 10px;width: 100%;margin-left: 10px;">
                   <table class="table table scrolltable table-bordered" style="width: 99%; margin-top: 10px;">
                       <thead class="table_header " fixed-header>
                           <tr>
                               <th>S.No</th> 
                               <th>Invoice Number</th>                             
                               <th>Invoice Date</th>                             
                               <th>Invoice Header Amount</th>
                               <th>Status</th>          
                               <th>CR Number</th>                
                               <th>Supplier Name</th>
                               <th>Branch Name</th>             
                               <th>Employee Name</th>                                      
                           </tr>
                       </thead>
                       <tbody>                    
                           <tr *ngFor="let value of withoutInvNoList; index as i;">
                               <td style="text-align:center;"> {{(presentpageDedWithoutInvNo  - 1)*identificationSize +i+1 }} </td>
                               <td>{{value.invoiceno}}</td>
                               <td>{{value.invoice_date |date :'dd-MMM-yyyy' }}</td>
                               <td style="text-align: right;">{{value.invoiceamount}}</td>     
                               <td>{{value['status'].text}}</td>
                               <td>{{value.crno}}</td>                         
                               <td>{{value['supplier'].name}}</td>
                               <td>{{value['branch'].name}}</td>
                               <td>{{value.raised_empname}}</td>    
                           </tr>
                       </tbody>
                   </table>
                   <div *ngIf="withoutInvNoList ?.length == 0" style="margin-left: 42%;">
                       <h3 style="font-family: 'Times New Roman', Times, serif;">No Records found!..</h3>
                   </div>

                    <div class="row" *ngIf="withoutInvNoList?.length > 0">
                         <div class="col-sm-7" style="margin-bottom: 0%;font-size: small;text-align: right;margin-top: 18px;font-weight:bold">
                         Page: {{presentpageDedWithoutInvNo}}
                         </div>
                         <div  class="col-sm-5" style="margin-bottom: 1%;font-size: small;text-align:right;">
                             <mat-paginator  style="margin-top: 0%;margin-left: 25px; width: 350px;"
                                         (page)="handleDedWithoutInvNo($event)"
                                         [length]="length_DedWithoutInvNo"
                                         [pageSize]="pageSize_DedWithoutInvNo"
                                         [showFirstLastButtons]="showFirstLastButtons"
                                         [pageSizeOptions]="pageSizeOptions"
                                         [pageIndex]="pageIndexDedWithoutInvNo"
                                         [hidePageSize]="true"
                                         aria-label="Select page"> 
                                     
                                     </mat-paginator>
                         </div>
                    </div>
               </div> -->
                <br>
                <h3>WITHOUT INVOICE DATE</h3>
                <lib-vs-cbox-summary [SummaryDetails]="Summary_without_inv_date"
                    [SummaryApiObj]="SummaryObj_without_inv_date_New"></lib-vs-cbox-summary>
                <!-- <div class="table-responsive" class="tablescroll" style="margin-top: 10px;width: 100%;margin-left: 10px;">
                   <table class="table table scrolltable table-bordered" style="width: 99%; margin-top: 10px;">
                       <thead class="table_header " fixed-header>
                           <tr>
                               <th>S.No</th> 
                               <th>Invoice Number</th>                             
                               <th>Invoice Date</th>                             
                               <th>Invoice Header Amount</th>
                               <th>Status</th>          
                               <th>CR Number</th>                
                               <th>Supplier Name</th>
                               <th>Branch Name</th>             
                               <th>Employee Name</th>                                      
                           </tr>
                       </thead>
                       <tbody>                    
                           <tr *ngFor="let value of withoutInvDtList; index as i;">
                               <td style="text-align:center;"> {{(presentpageDedWithoutDate  - 1)*identificationSize +i+1 }} </td>
                               <td>{{value.invoiceno}}</td>
                               <td>{{value.invoice_date |date :'dd-MMM-yyyy' }}</td>
                               <td style="text-align: right;">{{value.invoiceamount}}</td>     
                               <td>{{value['status'].text}}</td>
                               <td>{{value.crno}}</td>                         
                               <td>{{value['supplier'].name}}</td>
                               <td>{{value['branch'].name}}</td>
                               <td>{{value.raised_empname}}</td>    
                           </tr>
                       </tbody>
                   </table>
                   <div *ngIf="withoutInvDtList ?.length == 0" style="margin-left: 42%;">
                       <h3 style="font-family: 'Times New Roman', Times, serif;">No Records found!..</h3>
                   </div>
                     <div class="row" *ngIf="withoutInvDtList?.length > 0">
                         <div class="col-sm-7" style="margin-bottom: 0%;font-size: small;text-align: right;margin-top: 18px;font-weight:bold">
                         Page: {{presentpageDedWithoutDate}}
                         </div>
                         <div  class="col-sm-5" style="margin-bottom: 1%;font-size: small;text-align:right;">
                             <mat-paginator  style="margin-top: 0%;margin-left: 25px; width: 350px;"
                                         (page)="handleDedWithoutInvDate($event)"
                                         [length]="length_DedWithoutInvDate"
                                         [pageSize]="pageSize_DedWithoutInvDate"
                                         [showFirstLastButtons]="showFirstLastButtons"
                                         [pageSizeOptions]="pageSizeOptions"
                                         [pageIndex]="pageIndexDedWithoutInvDate"
                                         [hidePageSize]="true"
                                         aria-label="Select page"> 
                                     
                                     </mat-paginator>
                        </div>
                     </div>
               </div> -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline-primary" style="border-radius:40px"
                    data-dismiss="modal" id="invoice-detail-0258">
                    Back</button>
                <!-- </tr> -->
            </div>
        </div>
    </div>
    </div>
    <!-- Auditchecklist -->
    <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabels" aria-hidden="true"
        id="invoice-detail-0012">
        <div class="modal-dialog modal-xl " style="width: 85%;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Audit Checklist</h3>
                    <button type="button" class="close" #auditclose data-dismiss="modal" aria-label="Close"
                        id="invoice-detail-0259">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <!-- <table  id="customers" style="text-align: center;">
            <thead > -->
                <div class="comp-table t-resposive t-bdr-line t-HoverZoom" id="summary-table">
                    <table class="table" fixed-header>
                        <thead class="table_header">
                            <tr>
                                <th>S.No</th>
                                <th>Question</th>
                                <th>OK/NOT-OK</th>
                            </tr>
                        </thead>
                        <tr *ngFor="let dt of checklist;let i=index">
                            <td style="height: 28px;">{{i+1}}</td>
                            <td style="height: 28px;">{{dt.question}}</td>
                            <td style="height: 28px;">
                                <div class="btn-group btn-group-toggle" data-toggle="buttons">
                                    <label class="btn btn-outline-success" [ngClass]="(dt.value==1)? 'active': ''"
                                        style="height: 28px;padding:4px;font-size: 13px">
                                        <input type="radio" name="options" id="option1" autocomplete="off"
                                            (change)="ok(i,dt)" style="height: 28px"> OK
                                    </label>
                                    <label class="btn btn-outline-danger " [ngClass]="(dt.value==2)? 'active': ''"
                                        style="height: 28px;padding:4px;font-size: 13px">
                                        <input type="radio" name="options" id="option2" autocomplete="off" checked
                                            (change)="notok(i,dt)" style="height: 28px"> NOT-OK
                                    </label>
                                    <label class="btn btn-outline-secondary" [ngClass]="(dt.value==3)? 'active': ''"
                                        style="height: 28px;padding:4px;font-size: 13px">
                                        <input type="radio" name="options" id="option3" autocomplete="off"
                                            (change)="nap(i,dt)" style="height: 28px;"> N/A
                                    </label>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
                    <div id="matInput-size" class="search-expand" style="margin-top:5px">
                        <mat-form-field appearance="outline">
                            <mat-label>Solution <label style="color:red"> *</label></mat-label>
                            <mat-select placeholder="Solution" [formControl]="rem" id="invoice-detail-0260">
                                <mat-option *ngFor="let sol of Notoklist" [value]="sol.solution"
                                    matTooltip="{{sol.solution}}" matTooltipClass="custom-tooltipnew">
                                    {{sol.solution}}
                                </mat-option>
                            </mat-select>
                            <!-- <input matInput [formControl]="rem" autocomplete="off" required id="invoice-detail-0261"> -->
                        </mat-form-field>
                        <mat-form-field *ngIf="rem.value === 'other'|| rem.value  === 'Other' || rem.value  === 'OTHER'"
                            appearance="outline">
                            <mat-label>Remarks</mat-label>
                            <input matInput [formControl]="purpose" autocomplete="off" required
                                id="invoice-detail-0262">
                        </mat-form-field>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="submit" [disabled]="chklstValid==true" class="btn btn-outline-danger"
                        style="border-radius:40px" (click)="bounce()" id="invoice-detail-0263">Bounce</button>

                    <button class="btn btn-outline-success" style="border-radius:40px" [disabled]="chklstValid == false"
                        (click)="submitted()" id="invoice-detail-0264">
                        Submit</button>
                    <button data-dismiss="modal" class="btn btn-outline-primary" style="border-radius:40px"
                        id="invoice-detail-0265">
                        Back</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabels" aria-hidden="true"
        data-keyboard="false" data-backdrop="static" id="invoice-detail-0017">
        <div class="modal-dialog modal-xl " style="width: 85%;">
            <div class="modal-content">
                <div class="modal-header" style="text-align:center;background:#DDEFDD;">
                    <h2 class="modal-title" style="text-align:center;margin-left:38%">Audit Checklist</h2>
                    <button type="button" class="close" #auditclose data-dismiss="modal" aria-label="Close"
                        id="invoice-detail-0266">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div>
                    <table id="invoice-detail-0018" style="text-align: center;">
                        <thead>
                            <tr>
                                <th style="text-align: center;color: black;">S.No</th>
                                <th style="text-align: center;color: black;">Question</th>
                                <th style="text-align: center;color: black;">OK/NOT-OK</th>
                            </tr>
                        </thead>
                        <tr *ngFor="let dt of checklist;let i=index">
                            <td style="height: 28px;">{{i+1}}</td>
                            <td style="height: 28px;">{{dt.question}}</td>
                            <td style="height: 28px;"
                                [ngClass]="dt.value.text=='OK' ? 'OK': dt.value.text=='NOT_OK' ? 'NOT_OK' : 'NAP'">
                                {{dt.value.text}} </td>
                        </tr>

                    </table>

                    <div *ngIf="checklist?.length==0;" style="margin-left: 450px;margin-top: 10px;">No Records Found...
                    </div>
                </div>
                <div>
                    <button data-dismiss="modal" class="btn btn-outline-primary"
                        style="border-radius:35px;height: 40px;margin-top: 1%;margin-bottom: 2%; margin-left: 500px;"
                        id="invoice-detail-0267">Back</button>
                </div>
            </div>
        </div>
    </div>





    <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true"
        id="invoice-detail-0303">
        <div class="modal-dialog modal-xl" style="width:80%;height:200%;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Supplier GST Validation Details</h3>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"
                        id="invoice-detail-0268">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <!-- <br> -->
                <div class="modal-body">
                    <!-- <mat-card class="card_inside"> -->
                    <div class="container">
                        <div class="row gy-3 label_view">
                            <div class="col-md-4 d-flex" *ngFor="let item of displayData ">
                                <div class="label-col">
                                    <label class="fw-400 label_font">{{ item.label }}</label>
                                </div>
                                <div class="colon-col label_font">:</div>
                                <div class="value-col">
                                    <p>{{ item.value }}</p>
                                </div>
                            </div>
                            <div>
                                <i class="fa fa-check-circle"
                                    style="font-size:25px;color:darkblue;margin-left:10px;cursor: pointer;"
                                    matTooltip="validate" matTooltipClass="custom-tooltipnew"
                                    (click)="suppGstValidChk()"></i>
                            </div>
                            <div class="d-flex" *ngIf="supGstFiling_list == null">
                                <div class="label-col">
                                    <label class="fw-400 label_font">GST Filing List </label>
                                </div>
                                <div class="colon-col label_font">:</div>
                                <div class="value-col">
                                    <p>-</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div *ngIf="supGstFiling_list != null">
                        <lib-vs-cbox-summary [SummaryDetails]="SummarygstvalidData"
                            [SummaryApiObj]="SummaryApigstvalidObjNew"></lib-vs-cbox-summary>
                        <!-- <table class="table table-bordered" fixed-header style="width: 99%;margin-top: 10px;">
                           <thead class="table_header" style="text-align: left;">
                           <tr>
                               <th>S. No</th>
                               <th>GSTR1 FILING DATE</th>
                               <th>GSTR3B FILING DATE</th>
                               <th>Month</th>
                           </tr>
                           </thead>
                           <tbody>
                               <tr *ngFor="let list of supGstFiling_list; index as i">
                                   <td style="text-align: center;">{{i+1}}</td>
                                   <td>{{list.GSTR1FILINGDATE}}</td>
                                   <td>{{list.GSTR3BFILINGDATE}}</td>
                                   <td>{{list.MONTH}}</td>
                               </tr>
                           </tbody>
                       </table> -->
                    </div>
                    <!-- </mat-card> -->
                </div>
                <div class="modal-footer">
                    <tr>
                        <button type="button" data-dismiss="modal" style="border-radius:40px;"
                            class="btn btn-outline-primary">Back</button>
                    </tr>
                    <!-- </tr> -->
                </div>
            </div>
        </div>
    </div>


    <!-- <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true"
        data-keyboard="false" data-backdrop="static" id="create-ecf-0139">
        <div class="modal-dialog modal-lg " style="width: 70%;">
            <div class="modal-content">
                <div class="modal-header" style="background: rgba(23, 204, 23, 0.288);">
                    <h2 class="modal-title" style="color:black ;text-align: center;font-weight: bold;">Upload File
                    </h2>
                    <button type="button" class="close" data-dismiss="modal" #uploadclose aria-label="Close"
                        id="create-ecf-0140">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>

                <div style="margin-left: 50px;margin-right: 80%;margin-top: 2%; width: 80%;">
                    <div class="container">
                        <div class="row">
                            <div class="table-responsive" style="width:100%;margin-top: 1%;">
                                <table class="table table-bordered" fixed-header style="width: 99%;margin-top: 10px;">
                                    <thead class="table_header" style="text-align: left;">
                                        <tr>
                                            <th style="text-align: center;">S.No</th>
                                            <th style="text-align: center;">Document Type</th>
                                            <th style="text-align: center;">Upload</th>
                                            <th style="text-align: center;">Selected Files</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let type of uploadFileTypes; let index = index">
                                            <td style="text-align: center;">{{index+1}}</td>
                                            <td>
                                                {{type}}
                                            </td>
                                            <td style="text-align: center;">
                                                <input #fileInput id="create-ecf-0002" type="file" multiple
                                                    style="width: 108px;" hidden
                                                    (change)="getFileDetails( $event, type)">
                                                <i (click)="fileInput.click()" class="fa fa-cloud-upload"
                                                    matTooltip="Upload file" matTooltipClass="custom-tooltipnew"
                                                    aria-hidden="true" style="font-size: 25px;color: blue;"></i>
                                            </td>
                                            <td>
                                                <div *ngFor="let file of file_process_data2[type]; let j = index"
                                                    style="border: 0cm;">
                                                    <div>{{j+1}}.{{file.name}}</div>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <tr>
                                <td>
                                    <button type="button" class="btn btn-outline-success" style="border-radius:7px;margin-left:40%;
                                    margin-bottom: 20px; " (click)="uploadSubmit()" data-target="#create-ecf-0152"
                                        data-toggle="modal" id="create-ecf-0153">Submit</button>
                                    <button type="button" class="btn btn-outline-primary" style="border-radius:7px;margin-left:10px;
                                    margin-bottom: 20px; " (click)="uploadback()">Back</button>
                                </td>
                            </tr>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div> -->

    <!-- <div *ngIf="uploadPopShow">
        <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true" 
                id="create-ecf-0139">
                <div class="modal-dialog modal-lg " style="width: 70%;">
                    <div class="modal-content">
                        <div class="modal-header" style="background: rgba(23, 204, 23, 0.288);">
                            <h2 class="modal-title" style="color:black ;text-align: center;font-weight: bold;">Upload File
                            </h2>
                            <button type="button" class="close" data-dismiss="modal" #fileuploadBack aria-label="Close" id="create-ecf-0140">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
        
                        <div style="margin-left: 50px;margin-right: 80%;margin-top: 2%; width: 80%;">
                            <div class="container">
                                <div class="row">
                                    <div class="table-responsive" style="width:100%;margin-top: 1%;">
                                        <table class="table table-bordered" fixed-header style="width: 99%;margin-top: 10px;">
                                            <thead class="table_header" style="text-align: left;">
                                            <tr>
                                                <th style="text-align: center;">S.No</th>
                                                <th style="text-align: center;">Document Type</th>
                                                <th style="text-align: center;">Upload</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                                 <tr  *ngFor="let type of uploadFileTypes; let index = index">
                                                    <td>{{index+1}}</td>
                                                    <td>
                                                        {{type}} 
                                                    </td>
                                                    <td style="text-align: center;">
                                                        <input #fileInput id="create-ecf-0002" type="file" multiple style="width: 108px;" hidden (change)="getFileDetails( $event, type)">
                                                        <i  (click)="fileInput.click()"  class="fa fa-cloud-upload" matTooltip="Upload file" matTooltipClass="custom-tooltipnew" aria-hidden="true" style="font-size: 25px;color: blue;"
                                                        ></i>
                                                    </td>                                            
                                                 </tr>
                                                
                                            </tbody>
                                        </table>                               
                                    </div>
                                    <tr>
                                        <td>
                                            <button type="button" class="btn btn-light" style="border-radius:7px;margin-left:220px;
                                             border-color: black; margin-bottom: 20px; background-color: white;"
                                            (click)="fileUploadClose()"  id="create-ecf-0132">Back</button>
                                        </td>
                                    </tr>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
         </div> -->

    <div *ngIf="showimageHeaderPreview" id="invoice-detail-0020" class="modal fade" aria-labelledby="my-modalLabel"
        aria-hidden="true" tabindex="-1" role="dialog" data-keyboard="false" data-backdrop="static">
        <div class="modal-dialog modal-xl" data-dismiss="modal" style="width: 60%;height: 80%;">
            <div class="modal-content">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="invoice-detail-0271">
                    <span aria-hidden="true">&times;</span>
                </button>
                <div class="modal-body">
                    <img src="{{jpgUrls}}" class="img-responsive" style="width: 100%;">

                </div>
            </div>
        </div>
    </div>

    <div *ngIf="showimageHeaderPreviewPDF" id="invoice-detail-0020" class="modal fade" aria-labelledby="my-modalLabel"
        aria-hidden="true" tabindex="-1" role="dialog" data-keyboard="false" data-backdrop="static">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header" style="background: rgba(23, 204, 23, 0.288);">
                    <h2 class="modal-title"> ECF Attachments</h2>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"
                        id="invoice-detail-0272">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <pdf-viewer [src]="pdfurl" [original-size]="false" [render-text]='false' [show-borders]="true"
                    [fit-to-page]="true" [show-all]="true" style="display: block; height: 600px;" [fit-to-page]="true">
                </pdf-viewer>
            </div>
        </div>
    </div>

    <ngx-spinner bdColor="rgba(51, 51, 51, 0.8)" size="default" [fullScreen]="true" type="ball-spin-clockwise">
        <p style="color: white">Please Wait. </p>
    </ngx-spinner>

    <!-- ----supplier popup----- -->
    <!-- <div *ngIf="showsupppopup">
    
</div> -->
    <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true"
        data-keyboard="false" data-backdrop="static" id="invoice-detail-0022">
        <div class="modal-dialog modal-xl" style="width:80%;height:200%;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">
                        Find Supplier</h3>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"
                        id="invoice-detail-0273">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <!-- <br> -->
                <div class="modal-body">
                    <!-- <form [formGroup]="SelectSupplierForm" (ngSubmit)="SelectSuppliersearch()"> -->
                    <form [formGroup]="SelectSupplierForm">
                        <div class="search-auto-fit" style="margin-left:20px">
                            <lib-vs-search-cmp id="matInput-size" [SearchArr]="Apsuppliersearch"
                                [Outputtype]="searchvar" (dataoutput)="SelectSuppliersearch($event)"
                                [SeparateReset]="true" Tooltip="true" (ResetOutput)="dataclear($event)">
                            </lib-vs-search-cmp>
                        </div>
                        <table style="margin-left: 20px;">
                            <div>
                                <!-- <tr>
                            <td>
                                <mat-form-field style="width: 200px;">
                                    <mat-label>Supplier GST Number</mat-label>
                                    <input matInput placeholder="GST No" formControlName="gstno"
                                        autocomplete="off" (keypress)="only_numalpha($event)" maxlength="15"
                                        id="invoice-detail-0274">
                                </mat-form-field>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            </td>

                            <td>
                                <mat-form-field style="width: 200px;">
                                    <mat-label>Supplier Code</mat-label>
                                    <input matInput placeholder="Supplier" formControlName="code"
                                        autocomplete="off" (keypress)="only_numalpha($event)" maxlength="10"
                                        id="invoice-detail-0275">
                                </mat-form-field>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            </td> -->
                                <!-- [disabled]="showsuppliercode"  -->

                                <!-- <td>
                                <mat-form-field style="width: 200px;">
                                    <mat-label>PAN Number</mat-label>
                                    <input matInput placeholder="PAN" formControlName="panno" autocomplete="off"
                                        (keypress)="only_numalpha($event)" id="invoice-detail-0276">
                                </mat-form-field>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            </td> -->
                                <!--  [disabled]="true" -->
                                <!-- <button class="btn btn-outline-primary" type="submit"
                                style="border-radius:40px;margin-left: 15px;" color="primary"
                                id="invoice-detail-0277"><i class="fa fa-search"
                                    aria-hidden="true"></i></button>&nbsp; -->

                                <!-- <button type="button" style="border-radius:10px;margin-left: 15px; border-color: black; 
                            background-color: white;" class="btn btn-light" (click)="dataclear()" id="invoice-detail-0278">
                                Reset</button> -->

                                <!-- <button type="button" style="border-radius:40px;margin-left: 15px;
                                font-family: 'Times New Roman', Times, serif;" class="btn btn-outline-primary"
                                (click)="dataclear()" id="invoice-detail-0279">
                                Reset</button>


                        </tr> -->
                                <tr>
                                    <div *ngIf="default">
                                        <lib-vs-dynamicform-cmp id="matInput-size" [formGroup]="SelectSupplierForm"
                                            (dataEvent)="choosesupplierdata($event)"
                                            [InputFields]="choose_supplier_field">
                                        </lib-vs-dynamicform-cmp>
                                        <!-- <td>
                                    <mat-form-field style="width: 250px;margin-top: 5px;" (click)="getsuppdd()">
                                        <mat-label>Choose Supplier</mat-label>
                                        <input #suppInput placeholder="Choose Supplier" matInput
                                            formControlName="name" [matAutocomplete]="Suppliertype"
                                            id="invoice-detail-0280">
                                        <mat-autocomplete [panelWidth]="400" #Suppliertype="matAutocomplete"
                                            [displayWith]="displayFn" (opened)="supplierScroll()">

                                            <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                            </mat-option>
                                            <ng-container *ngIf="!isLoading"> -->
                                        <!-- ngDefaultControl [(ngModel)]="inputSUPPLIERValue"
                                                    [ngModelOptions]="{standalone: true}"
                                                    (ngModelChange)="inputSUPPLIERValue = $event.toUpperCase()" -->
                                        <!-- <mat-option *ngFor="let suppliername of supplierNameData"
                                                    (onSelectionChange)="getsuppView(suppliername)"
                                                    [value]="suppliername" matTooltip="{{suppliername.name}}"
                                                    matTooltipClass="custom-tooltipnew">
                                                    {{suppliername.name}}
                                                </mat-option>
                                            </ng-container>
                                        </mat-autocomplete>
                                    </mat-form-field>
                                </td> -->
                                    </div>

                                    <div *ngIf="alternate">
                                        <lib-vs-dynamicform-cmp id="matInput-size" [formGroup]="SelectSupplierForm"
                                            (dataEvent)="choosesupplierdata1($event)"
                                            [InputFields]="choose_supplier_field_1">
                                        </lib-vs-dynamicform-cmp>
                                        <!-- <td>
                                    <mat-form-field style="width: 250px;margin-top: 5px;" (click)="getsuppdd()">
                                        <mat-label>Choose Supplier</mat-label>
                                        <input #name placeholder="Choose Supplier" matInput
                                            formControlName="name" [matAutocomplete]="autosupp2"
                                            id="invoice-detail-0281">
                                        <mat-autocomplete [panelWidth]="400" #autosupp2="matAutocomplete"
                                            [displayWith]="displaytest"> -->
                                        <!-- [(ngModel)]="inputSUPPLIERValue" [ngModelOptions]="{standalone: true}" 
                                            
                                                    ngDefaultControl
                                                    (ngModelChange)="inputSUPPLIERValue = $event.toUpperCase()" -->
                                        <!-- <mat-option *ngIf="isLoading" class="is-loading">Loading...
                                            </mat-option>
                                            <ng-container *ngIf="!isLoading">
                                                <mat-option *ngFor="let suppliername of selectsupplierlist"
                                                    (onSelectionChange)="getsuppView(suppliername)"
                                                    [value]="suppliername" matTooltip="{{suppliername.name}}"
                                                    matTooltipClass="custom-tooltipnew">
                                                    {{suppliername.name}}
                                                </mat-option>
                                            </ng-container>
                                        </mat-autocomplete>
                                    </mat-form-field>
                                </td> -->
                                    </div>
                                </tr>
                            </div>
                        </table>

                        <!-- <form [formGroup]="supplierchooseForm"></form> -->
                        <table width="100%" style="margin-top: 2%;margin-bottom: 5%;">
                            <tbody>
                                <tr>
                                    <td valign="top">
                                        <table style="font-size:14px;margin-left: 20px;">
                                            <tbody>
                                                <tr>
                                                    <td
                                                        style="color: #808080;  width: 200px;font-size: medium;height: 50px">
                                                        Supplier Name:
                                                    </td>
                                                    <td style="width: 400px;height: 50px">
                                                        {{SupplierName }}
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td
                                                        style="color: #808080; width: 200px;font-size: medium;height: 50px">
                                                        Supplier Code:
                                                    </td>
                                                    <td style="width: 400px;height: 50px">
                                                        {{SupplierCode }}
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td
                                                        style="color: #808080;  width: 200px;font-size: medium;height: 50px">
                                                        Supplier GST Number:
                                                    </td>
                                                    <td style="width: 400px;height: 50px">
                                                        {{SupplierGSTNumber }}
                                                    </td>
                                                </tr>
                                                <!-- <p style="color: #808080; margin: 0px 0 4px;">
                                                Supplier Name:
                                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span
                                                    style="color: black;margin-left: 2.5em;">{{SupplierName }}
                                                </span>
                                            </p>
                                            <p style="color: #808080; margin: 0px 0 4px;margin-top: 3%;">
                                                Supplier Code:
                                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                                <span style="color: black;margin-left: 3.8em;">{{SupplierCode}}
                                                </span>
                                            </p>
                                            <p style="color: #808080; margin: 0px 0 4px;margin-top: 3%;">
                                                Supplier GST Number:
                                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                                <span
                                                    style="color: black;margin-left: 0.2em;">{{SupplierGSTNumber}}
                                                </span>
                                            </p> -->
                                            </tbody>
                                        </table>
                                    </td>
                                    <td valign="top">
                                        <table style="font-size:14px;margin-left:-120px;">
                                            <tbody>
                                            <tbody>
                                                <tr>
                                                    <td
                                                        style="color: #808080;  width: 120px;font-size: medium;height: 50px">
                                                        PAN Number:
                                                    </td>
                                                    <td style="width: 300px;height: 50px">
                                                        {{SupplierPANNumber }}
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td
                                                        style="color: #808080; width: 120px;font-size: medium;height: 50px">
                                                        Address:
                                                    </td>
                                                    <td style="width: 300px;height: 50px">
                                                        {{line1 }},
                                                        {{line2 }},
                                                        {{line3 }}
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td
                                                        style="color: #808080;  width: 120px;font-size: medium;height: 50px">
                                                        City:
                                                    </td>
                                                    <td style="width: 300px;height: 50px">
                                                        {{City }}
                                                    </td>
                                                </tr><!-- <tr>
                                            <p style="color: #808080; margin: 0px 0 4px;">
                                                PAN Number:
                                                &nbsp;&nbsp;&nbsp;<span
                                                    style="color: black;margin-left: 0em;">{{SupplierPANNumber}}
                                                </span>
                                            </p>
                                            <p style="color: #808080; margin: 0px 0 4px;margin-top: 3%;">
                                                Address:
                                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                                <span style="color: black;margin-left: 0.3em;"> {{line1}},
                                                    {{line2}},
                                                    {{line3}}</span>
                                            </p>
                                            <p style="color: #808080; margin: 0px 0 4px;margin-top: 3%;">
                                                City:
                                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                                <span style="color: black;margin-left: -0.4em;">{{City}} </span>
                                            </p>
                                        </tr> -->
                                            </tbody>
                                        </table>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </form>
                </div>
                <!-- <br><br> -->
                <div class="modal-footer">
                    <!-- <div style="margin-left: 20px; "> -->
                    <!-- <tr> -->
                    <!-- <button type="button" data-dismiss="modal" style="border-radius:10px;margin-left: 500px;border-color: #f5c68b;
                                background-color: #f5c68b;" class="btn btn-light"
                                    (click)="Branchcallingfunction()" id="invoice-detail-0282">
                                    Submit</button> -->

                    <button type="button" data-dismiss="modal" [disabled]="!submitbutton" style="border-radius:40px;"
                        class="btn btn-outline-success" (click)="Branchcallingfunction()" id="invoice-detail-0283">
                        Submit
                    </button>
                    <button type="button" data-dismiss="modal" style="border-radius:40px;"
                        class="btn btn-outline-primary" id="invoice-detail-0284">
                        Back</button>


                    <!-- </tr> -->
                </div>
            </div>
        </div>


    </div>


    <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true"
        id="approval_popup">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">
                        {{remarks_heading}}</h3>
                    <button type="button" #ap_approval_closebtn class="close" data-dismiss="modal" aria-label="Close"
                        id="invoice-detail-0273">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>

                <div class="modal-body">
                    <form [formGroup]="APapprovesubmitform">
                        <div style="display: flex;gap: 10px;align-items: center;">
                            <div id="matInput-size">
                                <mat-form-field appearance="outline">
                                    <mat-label>Remarks</mat-label>
                                    <input matInput placeholder="Remarks" formControlName="remarks" autocomplete="off"
                                        required id="invoice-detail-0171">
                                </mat-form-field>
                            </div>
                            <div style="border:0px">
                                <!-- <input #fileInput id="invoice-detail-0002" type="file" multiple style="width: 108px;" hidden (change)="getFileDetails(0,$event)">

                        <i (click)="fileInput.click()"  class="fa fa-cloud-upload" matTooltip="Upload file" aria-hidden="true" style="font-size: 25px;color: blue;"></i> -->

                                <i (click)="UploadPopupOpen()" class="fa fa-cloud-upload" matTooltip="Upload file"
                                    matTooltipClass="custom-tooltipnew" aria-hidden="true"
                                    style="font-size: 25px;color: blue;margin-bottom:25px">
                                    <!-- data-target="#create-ecf-0139" data-toggle="modal" -->
                                </i>

                            </div>
                            <div *ngIf="valid_arr?.length != 0">
                                <i matTooltip="view" class=" fa fa-eye create " (click)="ecfap_view()"
                                    style="margin-bottom:25px;color: blue;cursor: pointer;">
                                    <!-- data-target="#create-ecf-0004" data-toggle="modal" -->
                                </i>
                            </div>
                        </div>

                    </form>
                </div>

                <div class="modal-footer">
                    <button type="button" *ngIf=" submit_approver == 1" style="border-radius:40px;"
                        class="btn btn-outline-success" (click)="approveap('Y')" id="invoice-detail-0172">
                        Submit</button>
                    <button type="button" *ngIf=" submit_approver == 2" style="border-radius:40px;"
                        class="btn btn-outline-success" (click)="modify()" id="invoice-detail-0172">
                        Submit</button>
                    <button type="button" style="border-radius:40px;" *ngIf=" submit_approver == 3"
                        class="btn btn-outline-success" (click)="reauditap()" id="invoice-detail-0173">
                        Submit</button>
                    <button type="button" style="border-radius:40px;" class="btn btn-outline-primary"
                        data-dismiss="modal" id="invoice-detail-0174">
                        Back</button>
                </div>
            </div>
        </div>


    </div>


    <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true"
        data-keyboard="false" data-backdrop="static" id="create-ecf-0004">
        <div class="modal-dialog modal-lg ">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Attachments
                    </h3>
                    <button type="button" class="close" data-dismiss="modal" #closedbuttons aria-label="Close"
                        id="invoice-detail-0268">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>

                <div class="modal-body">


                    <div class="table-responsive">
                        <h3>Currently Attached Files</h3>

                        <!-- <lib-vs-cbox-summary
                        [SummaryDetails]="SummaryCurrentlyAttechedFiles"
                        [SummaryApiObj]="SummaryApiCurrentlyAttechedFilesObjNew"
                        ></lib-vs-cbox-summary> -->
                        <div class="comp-table t-resposive t-bdr-line t-HoverZoom">
                            <table>
                                <thead >
                                    <tr>
                                        <th >S.No</th>
                                        <th >Document Type</th>
                                        <th >File Name</th>
                                        <th  *ngIf="inveditFlag">Delete</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <ng-container *ngFor="let type of uploadFileTypes; let ind = index">
                                        <tr *ngFor="let files of file_process_data[type]; let index = index">
                                            <td style="text-align: center;">
                                                {{ind+1}}.{{index+1}}
                                            </td>
                                            <td>
                                                {{type}}
                                            </td>
                                            <td style="width: 303px;">
                                                <div  style="width: 300px;overflow: hidden" matTooltip="{{files?.name}}" matTooltipClass="custom-tooltipnew">
                                                    {{files?.name}}
                                                </div>
                                            </td>
                                            <td style="text-align: center;" *ngIf="inveditFlag">
    
                                                <span (click)="deletefileUpload(frmInvHdr.value,index, type)">
                                                    <mat-icon matTooltip="Delete" matTooltipClass="custom-tooltipnew">delete
                                                    </mat-icon>
                                                </span>
                                            </td>
                                        </tr>
                                    </ng-container>
    
                                </tbody>
                            </table>
                        </div>

                        <!-- <div
                        *ngFor="let files of InvoiceHeaderForm?.value?.invoiceheader[this.fileindex]?.filevalue; let index = index">
                        <p (click)="filepreview(files)" data-toggle="modal"
                            data-target="#my-modalpreview"
                            style="color: #0000EE;cursor: pointer;">
                            {{index+1}}.{{files?.name}} </p>
                        <span
                            (click)="deletefileUpload(InvoiceHeaderForm?.value?.invoiceheader[this.fileindex],index)"
                            [class.disabled]="readinvhdrdata != false">
                            <mat-icon matTooltip="Delete">delete
                            </mat-icon>
                        </span>

                    </div> -->

                        <h3>Previously Attached Files</h3>

                        <!-- <lib-vs-cbox-summary [SummaryDetails]="SummarypreviouslyAttechedFiles"
                            [SummaryApiObj]="SummaryApipreviouslyAttechedFilesObjNew"></lib-vs-cbox-summary> -->
                        
                    <div class="comp-table t-resposive t-bdr-line t-HoverZoom">
                        <table >
                           <thead >

                               <tr>
                                   <th >S.No</th>
                                   <th>Document Type</th>
                                   <th >File Name</th>
                                   <!-- <th >Module</th> -->
                                   <th >View</th>
                                   <!-- <th >Download</th> -->
                                   <th >Delete </th>


                               </tr>
                           </thead>
                           <tbody>
                               <tr *ngFor="let attach of fullfile; index as i">
                                   <td >{{i+1}}</td>
                                   <td>{{attach?.document_type}}</td>
                                   <td>{{attach.file_name}}</td>
                                   <!-- <td >{{attach?.file_module}}</td> -->
                                   <td  >
                                       <i class="fa fa-external-link" aria-hidden="true" style="color:blue;font-size: 24px;" (click)="data1(attach)"></i>
                                       </td>
                                  

                                   <td style="text-align:center">
                                       <mat-icon style="color: black;cursor: pointer;"
                                           (click)="fileDeletes(attach.file_id,i,attach)">delete</mat-icon>
                                   </td>
                               </tr>
                           </tbody>
                       </table> 
                    </div>
                            <!-- <table class="table table-bordered" fixed-header style="width: 99%;margin-top: 10px;">
                            <thead class="table_header" style="text-align: left;">

                                <tr>
                                    <th style="text-align: center;">S.No</th>
                                    <th style="text-align: center;">File Name</th>
                                    <th style="text-align: center;">Module</th>
                                    <th style="text-align: center;">View</th>
                                    <th style="text-align: center;">Download</th>
                                    <th style="text-align: center;">Delete </th>


                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let attach of attachedFile.value; index as i">
                                    <td style="text-align: center;">{{i+1}}</td>
                                    <td>{{attach.file_name}}</td>
                                    <td style="text-align: center;">{{attach?.file_module}}</td>
                                    <td style="text-align: center;" >
                                        <i class="fa fa-external-link" aria-hidden="true" style="color:blue;font-size: 24px;margin-left: 20px;" (click)="data1(attach)"></i>
                                        </td>
                                        <td style="text-align: center;color:blue;">
                    <div matTooltip="View" class="fa fa-arrow-up" aria-hidden="true" 
                    data-toggle="modal"
                    (click)="data(attach.file_id)" >

                    
                    </div>
                </td> -->
                        <!-- <td style="text-align: center;">
                                        <button class="btn btn-outline-primary" type="submit"
                                            (click)="getfiles(attach)"
                                            style="border-radius:40px;margin-left: 15px;" color="primary" id="invoice-detail-0269">
                                            <i matTooltip="Download" matTooltipClass="custom-tooltipnew" class="fa fa-download"
                                                aria-hidden="true"></i>
                                        </button>
                                    </td>
                                    <td style="text-align:center">
                                        <mat-icon style="color: black;cursor: pointer;"
                                            (click)="fileDeletes(attach.file_id,i,attach)">delete</mat-icon>
                                    </td>
                                </tr>
                            </tbody>
                        </table>  -->

                    </div>
                    <!-- <tr>
                        <td>

                            <button type="button" class="btn btn-light" style="border-radius:7px;margin-left:220px;
                                                    border-color: black; margin-bottom: 20px;
                                                    background-color: white;" (click)="fileback()" id="invoice-detail-0270">Back</button>

                        </td>
                    </tr> -->



                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-primary" style="border-radius:40px;"
                        (click)="fileback()" id="create-ecf-0132">Back</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true"
        data-keyboard="false" data-backdrop="static" id="pofilepop">
        <div class="modal-dialog modal-lg ">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Po File Attachments
                    </h3>
                    <button type="button" class="close" data-dismiss="modal" #closedPobuttons aria-label="Close"
                        id="invoice-detail-0268">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>

                <div class="modal-body">


                    <div class="table-responsive">

                        <div class="comp-table t-resposive t-bdr-line t-HoverZoom">
                            <table>
                                <thead >
                                    <tr>
                                        <th>S.No</th>
                                        <th>File Name</th>
                                        <th>View</th>
                                        <th>Download</th>
                                    </tr>
                                </thead>
                        
                                    <tbody>
  <ng-container *ngFor="let files of pofiledetails; let i = index">
    <ng-container *ngIf="files && files.length > 0">
      <tr *ngFor="let file of files; let fIndex = index">
        <td>{{fIndex + 1}}</td>
        <td>
          <div style="width: 300px; overflow: hidden;" 
               matTooltip="{{file?.file_name}}" 
               matTooltipClass="custom-tooltipnew">
            {{file?.file_name}}
          </div>
        </td>
        <td>
          <i class="fa fa-external-link" style="color:blue; cursor:pointer;" 
             (click)="Podata1(file)"></i>
        </td>
        <td>
          <i class="fa fa-download" style="color:green;" 
             (click)="Pogetfiles(file)"></i>
        </td>
      </tr>
    </ng-container>
    <tr *ngIf="!files || files.length === 0">
      <td colspan="4" style="text-align:center; color: gray;">No files available</td>
    </tr>
  </ng-container>
</tbody>

                                 
                            </table>
                        </div>                     
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-primary" style="border-radius:40px;"
                        (click)="filePOback()" id="create-ecf-0132">Back</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true"
        id="fileUploaddpopup">
        <div class="modal-dialog modal-lg ">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Upload File
                    </h3>
                    <button type="button" class="close" data-dismiss="modal" #fileclosedbuttons aria-label="Close"
                        id="create-ecf-0140">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>


                <div class="modal-body">
                    <div class="comp-table t-resposive t-bdr-line t-HoverZoom">
                        <table>
                            <thead>
                                <tr>
                                    <th>S.No</th>
                                    <th>Document Type</th>
                                    <th>Upload</th>
                                    <th>Selected Files</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let type of uploadFileTypes; let index = index">
                                    <td>{{index+1}}</td>
                                    <td>
                                        {{type}}
                                    </td>
                                    <td>
                                            <input #fileInput id="create-ecf-0002" type="file" multiple style="width: 108px;" hidden (change)="getFileDetails( $event, type); fileInput.value=''">
                                            <i  (click)="fileInput.click()"  class="fa fa-cloud-upload" matTooltip="Upload file" matTooltipClass="custom-tooltipnew" aria-hidden="true" style="font-size: 25px;color: blue;"
                                            ></i>
                                        </td>
                                    <td>
                                        <div *ngFor="let file of file_process_data2[type]; let j = index" style="border: 0cm;width: 300px;overflow: hidden" matTooltip="{{file.name}}"
                                        matTooltipClass="custom-tooltipnew">
                                            <div>{{j+1}}.{{file.name}}</div>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-success" style="border-radius:40px;"
                        (click)="fileuploadSubmit()" data-target="#create-ecf-0152" data-toggle="modal"
                        id="create-ecf-0153">Submit</button>
                    <button type="button" class="btn btn-outline-primary" style="border-radius:40px;"
                        (click)="fileuploadback()">Back</button>
                </div>


            </div>
        </div>
    </div>

    <div>
        <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true"
            id="create-ecf-0004">
            <div class="modal-dialog modal-lg ">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title">Attachments
                        </h3>
                        <button type="button" class="close" data-dismiss="modal" #closedbuttons aria-label="Close"
                            id="invoice-detail-0268">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>

                    <div class="modal-body">


                        <div class="table-responsive">
                            <h3>Currently Attached Files</h3>

                            <!-- <lib-vs-cbox-summary
                        [SummaryDetails]="SummaryCurrentlyAttechedFiles"
                        [SummaryApiObj]="SummaryApiCurrentlyAttechedFilesObjNew"
                    ></lib-vs-cbox-summary> -->
                            <div class="comp-table t-resposive t-bdr-line t-HoverZoom">

                                <table>
                                    <thead >
                                        <tr>
                                            <th >S.No</th>
                                            <th>Document Type</th>
                                            <th>File Name</th>
                                            <th *ngIf="inveditFlag">Delete</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <ng-container *ngFor="let type of uploadFileTypes; let ind = index">
                                            <tr *ngFor="let files of file_process_data[type]; let index = index">
                                                <td >
                                                    {{ind+1}}.{{index+1}}
                                                </td>
                                                <td>
                                                    {{type}}
                                                </td>
                                                <td>
                                                    {{files?.name}}
                                                </td>
                                                <td  *ngIf="inveditFlag">
    
                                                    <span (click)="deletefileUpload(frmInvHdr.value,index, type)">
                                                        <mat-icon matTooltip="Delete"
                                                            matTooltipClass="custom-tooltipnew">delete
                                                        </mat-icon>
                                                    </span>
                                                </td>
    
                                            </tr>
                                        </ng-container>
    
                                    </tbody>
                                </table>
                            </div>

                            <!-- <div
                        *ngFor="let files of InvoiceHeaderForm?.value?.invoiceheader[this.fileindex]?.filevalue; let index = index">
                        <p (click)="filepreview(files)" data-toggle="modal"
                            data-target="#my-modalpreview"
                            style="color: #0000EE;cursor: pointer;">
                            {{index+1}}.{{files?.name}} </p>
                        <span
                            (click)="deletefileUpload(InvoiceHeaderForm?.value?.invoiceheader[this.fileindex],index)"
                            [class.disabled]="readinvhdrdata != false">
                            <mat-icon matTooltip="Delete">delete
                            </mat-icon>
                        </span>

                    </div> -->

                            <h3>Previously Attached Files</h3>

                            <lib-vs-cbox-summary [SummaryDetails]="SummarypreviouslyAttechedFiles"
                                [SummaryApiObj]="SummaryApipreviouslyAttechedFilesObjNew"></lib-vs-cbox-summary>
                            <!-- <table class="table table-bordered" fixed-header style="width: 99%;margin-top: 10px;">
                            <thead class="table_header" style="text-align: left;">

                                <tr>
                                    <th style="text-align: center;">S.No</th>
                                    <th style="text-align: center;">File Name</th>
                                    <th style="text-align: center;">Module</th>
                                    <th style="text-align: center;">View</th>
                                    <th style="text-align: center;">Download</th>
                                    <th style="text-align: center;">Delete </th>


                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let attach of attachedFile.value; index as i">
                                    <td style="text-align: center;">{{i+1}}</td>
                                    <td>{{attach.file_name}}</td>
                                    <td style="text-align: center;">{{attach?.file_module}}</td>
                                    <td style="text-align: center;" >
                                        <i class="fa fa-external-link" aria-hidden="true" style="color:blue;font-size: 24px;margin-left: 20px;" (click)="data1(attach)"></i>
                                        </td>
                                    <td style="text-align: center;color:blue;">
                <div matTooltip="View" class="fa fa-arrow-up" aria-hidden="true" 
                    data-toggle="modal"
                    (click)="data(attach.file_id)" >

                
                </div>
                </td> -->
                            <!-- <td style="text-align: center;">
                                        <button class="btn btn-outline-primary" type="submit"
                                            (click)="getfiles(attach)"
                                            style="border-radius:40px;margin-left: 15px;" color="primary" id="invoice-detail-0269">
                                            <i matTooltip="Download" matTooltipClass="custom-tooltipnew" class="fa fa-download"
                                                aria-hidden="true"></i>
                                        </button>
                                    </td>
                                    <td style="text-align:center">
                                        <mat-icon style="color: black;cursor: pointer;"
                                            (click)="fileDeletes(attach.file_id,i,attach)">delete</mat-icon>
                                    </td>
                                </tr>
                            </tbody>
                        </table>  -->


                       
                        </div>
                        <!-- <tr>
                        <td>

                            <button type="button" class="btn btn-light" style="border-radius:7px;margin-left:220px;
                                                    border-color: black; margin-bottom: 20px;
                                                    background-color: white;" (click)="fileback()" id="invoice-detail-0270">Back</button>

                        </td>
                    </tr> -->



                    </div>

                    <div class="modal-footer">
                        <button type="button" data-dismiss="modal" class="btn btn-outline-primary"
                            style="border-radius:40px;" (click)="fileback()" id="create-ecf-0132">
                            Back
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
<div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true"
        id="addpocomponent">
        <div class="modal-dialog modal-xl" style="width:80%;height:200%;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Add Component</h3>
                    <button type="button" class="close" data-dismiss="modal" #addcomponentbuttons aria-label="Close"
                        id="invoice-detail-0268">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="comp-table t-resposive t-bdr-line t-HoverZoom" id="summary-table">
                        <div class="d-flex">
                        <h2> Total Amount : {{pounitprice}}</h2>
                         <button *ngIf="movedata!='apapproverview'" type="button" class="btn btn-outline-success"
                          style="margin-bottom: 15px;border-radius:40px;" (click)="addinvpodetails()" [disabled]="invdtlsaved"><i class="fa fa-plus"
                            ></i></button>

                        </div>
                       <form [formGroup]="POInvoiceDetailForm">
                        <table>
                            <thead>
                                <tr>
                                    <th>S.No</th>
                                    <th>Product Name<span style="color:red">*</span></th>
                                            <!-- <th style="width: 50px;">Is RCM</th> -->
                                            <th *ngIf="this.aptypeid == 13 || this.aptypeid == 3">Supplier<span
                                                    style="color:red">*</span></th>
                                            <!-- <th style="width: 70px;">UOM</th>    -->
                                            <th *ngIf=" this.aptypeid !== 4 && this.aptypeid !== 8" style="width:80px">
                                                HSN Code<span style="color:red">*</span></th>
                                            <th *ngIf=" this.aptypeid !== 4 && this.aptypeid !== 8" style="width:30px">
                                                HSN %<span style="color:red">*</span></th>
                                            <th style="width:100px">Unit Price<span style="color:red">*</span></th>
                                            <th style="width:50px">Quantity<span style="color:red">*</span></th>
                                            <th style="width:100px">Amount</th>
                                            <!-- <th style="width:100px" *ngIf="this.aptypeid !== 4 && this.aptypeid !== 8">
                                                Discount</th> -->
                                            <th style="width:100px">Taxable Amount</th>
                                            <th style="width:100px" *ngIf="this.aptypeid !== 4 && this.aptypeid !== 8">
                                                CGST</th>
                                            <th style="width:100px" *ngIf="this.aptypeid !== 4 && this.aptypeid !== 8">
                                                SGST</th>
                                            <th style="width:100px" *ngIf="this.aptypeid !== 4 && this.aptypeid !== 8">
                                                IGST</th>
                                            <th style="width:100px" *ngIf="this.aptypeid !== 4 && this.aptypeid !== 8">
                                                Tax Amount</th>
                                            <th style="width:100px">Total Amount</th>
                                            <!-- <th *ngIf="movedata != 'ECF' && aptypeid != 13">Is Capitalized</th>-->
                                            <th *ngIf="movedata != 'apapproverview'">Action</th> 
                                </tr>
                            </thead>
                            <tbody>
<ng-container formArrayName="podetls"
  *ngFor="let section of poinvdetails.controls; let invdtlindex = index">
<tr [formGroupName]="invdtlindex">
    <td>{{invdtlindex+1}}</td>
    <td id="matInput-size">
      <mat-form-field appearance="outline" style="margin-bottom :-25px;">
        <mat-label>Product</mat-label>
        <input #productPoInput placeholder="Product" matInput
               formControlName="productname"   [readonly]=" movedata=='apapproverview'"
               [matAutocomplete]="PoprodAutocom" (click)="getpoindex(invdtlindex)"
               id="invoice-detail-0079">
        <mat-autocomplete [panelWidth]="150" #PoprodAutocom="matAutocomplete"
                          [displayWith]="displayFnProduct" (opened)="PoProductScroll()">
          <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
          <ng-container *ngIf="!isLoading">
            <mat-option *ngFor="let prod of poprodList" [value]="prod"
                        (onSelectionChange)="poproductChange(prod,invdtlindex)"
                        matTooltip="{{prod.name}}"
                        matTooltipClass="custom-tooltipnew">
              {{prod.name}}
            </mat-option>
          </ng-container>
        </mat-autocomplete>
      </mat-form-field>

      <h3 *ngIf="showrcm[invdtlindex] == true">
        Is RCM :
        <span [ngStyle]="this.prodRcm[invdtlindex] == 'Yes'
                        ? {'color':'green','font-weight':'bold'}
                        : {'color':'red','font-weight':'bold'}">
          {{prodRcm[invdtlindex]}}
        </span>
        &nbsp;&nbsp;Is Blocked:
        <span [ngStyle]="this.prodBlock[invdtlindex] == 'Yes'
                        ? {'color':'green','font-weight':'bold'}
                        : {'color':'red','font-weight':'bold'}">
          {{this.prodBlock[invdtlindex]}}
        </span>
      </h3>
    </td>

    <td *ngIf="this.aptypeid !== 4 && this.aptypeid !== 8" id="matInput-size">
      <mat-form-field (click)="gethsn('')" appearance="outline">
        <mat-label>HSN Code</mat-label>
        <input #hsnInput placeholder="HSN" matInput formControlName="hsn"
                [matAutocomplete]="hsntype"   [readonly]=" movedata=='apapproverview'"
               (click)="getpoindex(invdtlindex)" id="invoice-detail-0082">
        <mat-autocomplete [panelWidth]="200" #hsntype="matAutocomplete"
                          [displayWith]="displayFnhsn" (opened)="hsnScroll()"
                          (optionSelected)="pogetgst(invdtlindex);">
          <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
          <ng-container *ngIf="!isLoading">
            <mat-option *ngFor="let hsn of hsnList" [value]="hsn"
                        (click)="getpohsncode(hsn,invdtlindex)">
              {{hsn.code}}
            </mat-option>
          </ng-container>
        </mat-autocomplete>
      </mat-form-field>
    </td>

    <td *ngIf="this.aptypeid !== 4 && this.aptypeid !== 8" id="matInput-size">
      <mat-form-field appearance="outline">
        <input matInput formControlName="hsn_percentage" placeholder="HSN %"
               readonly autocomplete="off" id="invoice-detail-0083">
      </mat-form-field>
    </td>

    <td id="matInput-size">
      <mat-form-field appearance="outline">
        <input matInput placeholder="Unit Price" formControlName="unitprice"
               #unitprice style="text-align: right;"  [readonly]="movedata=='apapproverview'"
               (keypress)="getCharCode($event);numberOnlyandDot($event, POInvoiceDetailForm.value.podetls[invdtlindex].unitprice)"
               (input)="poinvDtlChangeToCurrency('unitprice', invdtlindex)"
               (change)="poinvdtlamtDecimalChg(unitprice,'unitprice',invdtlindex)"
               autocomplete="off" (change)="pogetgst(invdtlindex)"
               id="invoice-detail-0084">
      </mat-form-field>
    </td>

    <td id="matInput-size">
      <mat-form-field appearance="outline">
        <input matInput placeholder="Quantity" formControlName="quantity" [readonly]="movedata=='apapproverview'"
               (keypress)="getCharCode($event);numberOnlyandDot($event,POInvoiceDetailForm.value.podetls[invdtlindex].quantity)"
               (input)="poinvDtlChangeToCurrency('quantity', invdtlindex)"
               #quantity autocomplete="off" 
               (change)="pogetgst(invdtlindex)" id="invoice-detail-0085">
      </mat-form-field>
    </td>

    <td id="matInput-size">
      <mat-form-field appearance="outline">
        <input matInput placeholder="Amount" formControlName="amount"
               autocomplete="off" readonly style="text-align: right;"
               id="invoice-detail-0086">
      </mat-form-field>
    </td>

    <!-- <td *ngIf="this.aptypeid !== 4 && this.aptypeid !== 8" id="matInput-size">
      <mat-form-field appearance="outline">
        <input matInput placeholder="Discount" #discount formControlName="discount"
               (change)="pogetgst(invdtlindex);poinvdtlamtDecimalChg(discount,'discount',invdtlindex)"
               (keypress)="getCharCode($event);numberOnlyandDot($event,POInvoiceDetailForm.value.podetls[invdtlindex].discount)"
               (input)="poinvDtlChangeToCurrency('discount', invdtlindex)"
               autocomplete="off" style="text-align: right;"
               [readonly]="invdtlsaved" id="invoice-detail-0094">
      </mat-form-field>
    </td> -->

    <td id="matInput-size">
      <mat-form-field appearance="outline">
        <input matInput placeholder="Taxable Amount"
               formControlName="taxable_amount" autocomplete="off" readonly
               style="text-align: right;" id="invoice-detail-0286">
      </mat-form-field>
    </td>

    <td *ngIf="this.aptypeid !== 4 && this.aptypeid !== 8" id="matInput-size">
      <mat-form-field appearance="outline">
        <input matInput placeholder="CGST" formControlName="cgst" readonly
               style="text-align: right;" id="invoice-detail-0087">
      </mat-form-field>
    </td>

    <td *ngIf="this.aptypeid !== 4 && this.aptypeid !== 8" id="matInput-size">
      <mat-form-field appearance="outline">
        <input matInput placeholder="SGST" formControlName="sgst" readonly
               style="text-align: right;" id="invoice-detail-0089">
      </mat-form-field>
    </td>

    <td *ngIf="this.aptypeid !== 4 && this.aptypeid !== 8" id="matInput-size">
      <mat-form-field appearance="outline">
        <input matInput placeholder="IGST" formControlName="igst" readonly
               id="invoice-detail-0091" style="text-align: right;">
      </mat-form-field>
    </td>

    <td *ngIf="this.aptypeid !== 4 && this.aptypeid !== 8" id="matInput-size">
      <mat-form-field appearance="outline">
        <input matInput placeholder="Tax" formControlName="taxamount"
               readonly style="text-align: right;" id="invoice-detail-0093">
      </mat-form-field>
    </td>

    <td id="matInput-size">
      <mat-form-field appearance="outline">
        <input matInput placeholder="Total" formControlName="totalamount"
               autocomplete="off" readonly
               (keypress)="getCharCode($event);numberOnlyandDot($event,POInvoiceDetailForm.value.podetls[invdtlindex].totalamount)"
               (input)="poinvDtlChangeToCurrency('totalamount', invdtlindex)"
               (click)="POINVdatasums()" style="text-align: right;"
               id="invoice-detail-0095">
      </mat-form-field>
    </td>
      <td *ngIf="movedata != 'apapproverview'">
                                                <button mat-icon-button type="button" *ngIf="!invdtlsaved"
                                                    id="invoice-detail-0096">
                                                    <mat-icon 
                                                    style="text-align: center; vertical-align: middle; transform: translateY(4px);color: green" aria-label="Edit"
                                                        (click)="deletepoinvdetail(section,invdtlindex)"
                                                        matTooltip="delete" matTooltipClass="custom-tooltipnew">
                                                        delete</mat-icon>
                                                </button>
                                                <button mat-icon-button type="button" *ngIf="invdtlsaved">
                                                    <mat-icon style="text-align: center; vertical-align: middle; transform: translateY(4px);color: black" >

                                                        delete</mat-icon>
                                                </button>
                                            </td>
  </tr>


  </ng-container>
</tbody>
 <tr style="font-weight: bold;">
  <td colspan="6" class="rghtaln">Total</td>
  <td class="rghtaln">{{ podetlsTotals.taxable_amount | number:'1.2-2' }}</td>
  <td class="rghtaln">{{ podetlsTotals.taxable_amount | number:'1.2-2' }}</td>
  <td class="rghtaln">
    {{ podetlsTotals.cgst | number:'1.2-2' }}
  </td>
  <td class="rghtaln">
    {{ podetlsTotals.sgst | number:'1.2-2' }}
  </td>
  <td class="rghtaln">
    {{ podetlsTotals.igst | number:'1.2-2' }}
  </td>
  <td class="rghtaln">
    {{ podetlsTotals.taxamount | number:'1.2-2' }}
  </td>
  <td class="rghtaln">{{ podetlsTotals.totalamount | number:'1.2-2' }}</td>
</tr>

                        </table>
                        </form>
                         
                    </div>
                   
                </div>
                <div class="modal-footer">
                    <tr>
                         <button *ngIf="movedata!='apapproverview'" type="button" style="border-radius:40px;"
                            class="btn btn-outline-primary" (click)="poaddcompsubmit()"  [disabled]="invdtlsaved">Submit</button>
                        <button type="button" (click)="closepoaddcom()" style="border-radius:40px;margin-left:10px"
                            class="btn btn-outline-primary">Back</button>
                    </tr>
                </div>
            </div>
        </div>
    </div>


    <!-- <div *ngIf="LiqConfirmPopup"> -->
    <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabels" aria-hidden="true"
        data-keyboard="false" data-backdrop="static" id="SaveYesOrNo">
        <div class="modal-dialog modal-xl " style="width: 30%;">

            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Credit Save</h3>
                    <button type="button" class="close" data-dismiss="modal" #LiqConfirmClose aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div>
                    <div style="margin-top: 20px;">
                        <h3 style="margin-left:28% ;font-size:large;">Do you want to Liquidate?</h3>
                    </div>
                    <br>
                    <div style="margin-bottom: 15px;">
                        <button type="submit" class="btn btn-outline-success " data-toggle="modal"
                            style="border-radius: 40px;margin-left: 37%;" id="invdetail-0285" (click)="addPPX()">
                            Yes</button>
                        <button type="button" data-dismiss="modal" class="btn btn-outline-danger "
                            style="margin-left: 10px;border-radius: 40px;" (click)="closeliqConfirm()"
                            id="invdetail-0286">
                            No</button>
                    </div>

                </div>

            </div>
        </div>
    </div>
    <!-- </div> -->
</section>