<div class="head_div">
    <h2 class="headergeneral">FA General Query</h2>
    <form [formGroup]="genearqueryform">
        <div class="row col-md-12">
            <div class="col-md-3">
                <mat-form-field class="example-full-width">
                    <mat-label>Asset ID</mat-label>
                    <input formControlName="assetid" matInput autocomplete="off" placeholder="Enter the AssetId">
                </mat-form-field>
            </div>
            <div class="col-md-3"> 
                <mat-form-field class="example-full-width">
                    <mat-label>CR No</mat-label>
                    <input formControlName="crno" matInput autocomplete="off" placeholder="Enter the crno">
                </mat-form-field>
            </div>
            <div class="col-md-3"> 
                <mat-form-field class="example-full-width">
                    <mat-label>PO No</mat-label>
                    <input formControlName="ponumber" matInput autocomplete="off" placeholder="Enter the Ponumber">
                </mat-form-field>
            </div>
            <div class="col-md-3"> 
                <mat-form-field class="example-full-width">
                    <mat-label>Invoice Number</mat-label>
                    <input formControlName="invoicenno" matInput autocomplete="off" placeholder="Enter the Invoice Number">
                </mat-form-field>
            </div>
            <div class="col-md-3">
                <mat-form-field class="example-full-width">
                    <mat-label>Invoice date</mat-label>
                    <!-- <input formControlName="invoicedate" matInput autocomplete="off"  placeholder="Choose the Invoice Date">
                    <mat-datepicker-toggle matSuffix [for]="picker">
                        <mat-icon matDatepickerToggleIcon>keyboard_arrow_down</mat-icon>
                        <mat-datepicker #picker></mat-datepicker>
                    </mat-datepicker-toggle> -->
                    
                        <input readonly matInput [matDatepicker]="picker1" formControlName="invoicedate"
                             class="matformfieldinputstyle">
                        <mat-datepicker-toggle matSuffix class="maticonsize" [for]="picker1">
                        </mat-datepicker-toggle>
                        <mat-datepicker #picker1></mat-datepicker>
                </mat-form-field>
            </div>
            <div class="col-md-3" *ngIf="is_admin">
                <mat-form-field class="example-full-width">
                    <mat-label>Branch</mat-label>
                    <input type="text" placeholder="Select the Branch" matInput
                        formControlName='branch' [matAutocomplete]="auto1" #branchInput>
                    <mat-autocomplete #branchinfo #auto1="matAutocomplete" [displayWith]="displayFnbranchfrom" (opened)="autocompleteScrollbranch()">
                        <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                        <ng-container *ngIf="!isLoading">
            
                            <mat-option *ngFor="let branch of branchlist " [value]="branch">
                                {{branch.name_code}}
                            </mat-option>
                        </ng-container>
                    </mat-autocomplete>
                </mat-form-field>
            </div>
            <div class="col-md-3">
                <mat-form-field class="example-full-width">
                    <mat-label>Product</mat-label>
                    <input type="text" placeholder="Select the Product"  matInput 
                        formControlName='product' [matAutocomplete]="product" #productInput>
                    <mat-autocomplete #productinfo #product="matAutocomplete" [displayWith]="displayFnproduct" (opened)="autocompleteScrollProduct()">
                        <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                        <ng-container *ngIf="!isLoading">
            
                            <mat-option *ngFor="let product of productlist " [value]="product">
                                {{product.name}}
                            </mat-option>
                        </ng-container>
                    </mat-autocomplete>
                </mat-form-field>
            </div>
            <div class="col-md-3">
                <mat-form-field class="example-full-width">
                    <mat-label>Vendor</mat-label>
                    <input type="text" placeholder="Select the Vendor" matInput
                        formControlName='vendorname' [matAutocomplete]= "vendor" #vendorInput>
                    <mat-autocomplete #vendorinfo #vendor="matAutocomplete" [displayWith]="displayFnvendor" (opened)="autocompleteScrollVendor()">
                        <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                        <ng-container *ngIf="!isLoading">
            
                            <mat-option *ngFor="let vendor of vendorlist " [value]="vendor">
                                {{vendor.name}}
                            </mat-option>
                        </ng-container>
                    </mat-autocomplete>
                </mat-form-field>
            </div>
            <div class="col-md-3"> 
                <mat-form-field class="example-full-width">
                    <mat-label>Asset Make</mat-label>
                    <input formControlName="assetmake" matInput autocomplete="off" placeholder="Enter the Asset Make">
                </mat-form-field>
            </div>
                <div class="col-md-3"> 
                    <mat-form-field class="example-full-width">
                        <mat-label>Asset Model </mat-label>
                        <input formControlName="assetmodel" matInput autocomplete="off" placeholder="Enter the Asset Model">
                    </mat-form-field>
                </div>
                <div class="col-md-3"> 
                    <mat-form-field class="example-full-width">
                        <mat-label>Asset Serial No</mat-label>
                        <input formControlName="serialno" matInput autocomplete="off" placeholder="Enter the Serial No">
                    </mat-form-field>
                </div>
                <div class="col-md-3"> 
                    <mat-form-field class="example-full-width">
                        <mat-label>Asset Specification</mat-label>
                        <input formControlName="specification" matInput autocomplete="off" placeholder="Enter the Specification">
                    </mat-form-field>
                </div>
                <div class="col-md-3">
                    <mat-form-field  class="example-full-width" (click)="Criticality_dropdown()">
                         <mat-label>Criticality</mat-label>
                        <input type="text" placeholder="Criticality" #cricinput  matInput formControlName="crictical" [matAutocomplete]="is_cricauto">
                    <mat-autocomplete #is_cricauto="matAutocomplete"[displayWith]="displayfnCriticality">
                        <mat-option *ngFor="let list of criticality_list" [value]="list">{{list.name}}</mat-option>
                    </mat-autocomplete>
                     </mat-form-field>
                </div>
                <div class="col-md-3">
                    <mat-form-field class="example-full-width" (click)="itod_dropdown()">
                        <mat-label>IT/OD</mat-label>
                        <input type="text" #itodinput placeholder="IT/OD" matInput formControlName="itod" [matAutocomplete]="is_itodauto">
                        <mat-autocomplete #is_itodauto="matAutocomplete"[displayWith]="display_idod">
                            <mat-option *ngFor="let list of itod_list" [value]="list">{{list.name}}</mat-option>
                        </mat-autocomplete>
                    </mat-form-field>
                </div>
                <div class="col-md-12">
                    <button mat-raised-button type="button" class="btn btn-primary prepareexcel" color="primary" (click)="Download_prepare()"
                        >
                        Prepare Excel For Download
                        <mat-icon *ngIf="first"><mat-spinner color="accent" diameter="20">
                            </mat-spinner></mat-icon>
                        <mat-icon *ngIf="!first" inline=true style="color:black">download</mat-icon>
                    </button>
                <!-- </div>
                <div class="col-md-1"> -->
                    <button mat-raised-button type="button" class="btn btn-primary prepareexcel" style="margin-left:10px" color="primary" (click)="download_file()"
                        >
                        Download
                    </button>
                <!-- </div> -->
                <!-- <div  class="col-md-3 radiogroupstyle">
                    <mat-radio-group formControlName="active_inactive">
                        <mat-radio-button *ngFor="let a of Type"  [value]="a.id" (click)="selecttype(a.id)"
                            style="margin-left: 10px">
                            {{ a.name }}
                        </mat-radio-button>
                    </mat-radio-group>
                </div> -->
            <!-- <div class="col-md-2"> -->
                <button class="btn btn-outline-primary querysearch" type="submit" matTooltip="search" (click)="getgen_summary()"
                    color="primary"><i class="fa fa-search"
                        aria-hidden="true"></i></button>
                <button class="btn btn-outline-primary querysearch" (click)="reset()" type="button" matTooltip="clear"
                     color="primary">Reset</button>
            
            <!-- </div>
            <div class="col-md-2"> -->
               
                    <button type="button" routerLink="/fa/fa" class="btn btn-outline-success" style="border-radius:30px;height:40px;margin-left:10px"><span
                        class="fa fa-arrow-left">Go Back</span></button>  
            </div>
            
        </div>
    </form>

<div class="table-responsive table-bordered">
    <table class="table">
        <thead class="table_header">
            <tr>
                <th  style="position: sticky;">S.No</th>
                <th>Asset Id/Barcode</th>
                <th>Cr no</th>
                <!-- <th>Status</th> -->
                <th>Criticality</th>
                <th>Product Name</th>
                <th>Capitalisation Date</th>
                <!-- <th>Asset Value</th> -->
                <th>Po Number</th>
                <th>Invoice Number</th>
                <th>Invoice Date</th>
                <th>Vendor Name</th>
                <th>Branch Name</th>
                <th>Asset End Date</th>
                <th>Asset Purchase cost</th>
                <th>Asset Value Before Dep</th>
                <th>Asset Make</th>
                <th>Asset Model</th>
                <th>Asset Specification</th>
                <th>Asset Serial No</th>
             </tr>
        </thead>
        <tbody>
          <tr *ngFor="let data of Querylist;let i =index">
            <td>{{(presentpage-1) * pagesize+i+1}}</td>
            <td>{{data?.barcode}}</td>
            <td>{{data?.crnum}}</td>
            <!-- <td>{{data?.assetdetails_status}}</td> -->
            <td>{{data.criticality}}</td>
            <td class="text-wrap">{{"("+data?.product_id?.code+")"}}-{{data?.product_id?.name}}</td> 
            <td class="text-wrap">{{data?.capdate | date:'dd-MMM-yyyy'}}</td>
            <!-- <td class="text-wrap">{{data?.assetdetails_value}}</td> -->
            <td class="text-wrap">{{data?.ponum}}</td>
            <td class="text-wrap">{{data?.invoice_id?.invoiceno}}</td>
            <td class="text-wrap">{{data?.invoice_id?.invoicedate |  date:'dd-MMM-yyyy' }}</td>
            <td class="text-wrap">{{data?.vendorname}}</td>
            <td class="text-wrap">{{"("+data?.branch_id?.code+")"}}-{{data?.branch_id?.name}}</td>
            <td class="text-wrap">{{data?.enddate |  date:'dd-MMM-yyyy'}}</td>
            <td class="textalign">{{data?.costtot}}</td>
            <td class="textalign">{{data?.valuetot}}</td>
            <td class="text-wrap">{{(data?.make=="None")?"":data?.make}}</td>
            <td class="text-wrap">{{(data?.model=="None")?"":data?.model}}</td>
            <td class="text-wrap">{{(data?.spec=="None")?"":data?.spec}}</td>
            <td class="text-wrap">{{data?.serial_no}}</td>
            </tr>
            <tr *ngIf="Querylist.length==0; else pagination" class="text-center">
                <td colspan="19">No Records Found..</td>
            </tr>
            <ng-template #pagination>
                <tr>
            
                    <td colspan='19'>
                        <div class="paginationstyle">
                            Total Count:{{count}}
                            <br />
                            <button mat-icon-button [disabled]="has_previous === false" color="primary" (click)=" previousClick()">
                                <mat-icon>arrow_back</mat-icon>
                            </button>
                            {{presentpage}}
                            <button mat-icon-button [disabled]="has_next === false" color="primary" (click)=" nextClick()">
                                <mat-icon>arrow_forward</mat-icon>
                            </button>
                        </div>
                    </td>
            
                </tr>
            </ng-template>
          

        </tbody>
    </table>            
</div>