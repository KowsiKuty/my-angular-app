



<div class="col-md-12">
    <br>
    <div class="row col-md-12">
        <div class="col-md-8">
            <h2>Vendor Report</h2>
        </div>
        <div class="col-md-4 radio">

                <mat-radio-group [(ngModel)]="selectedValue" (change)="selectedValues($event)" class="radio">
                    <mat-radio-button value="1">Contract</mat-radio-button> &nbsp; &nbsp;
                    <mat-radio-button value="2">Risk Assessment</mat-radio-button>
                </mat-radio-group>
        
        </div>
    </div>    
    <br>

    <form [formGroup]="vendorSearchForm">
        <div class="row col-md-12">
            <div class="col-md-3">
                <mat-form-field class="example-full-width">
                    <mat-label>Vendor</mat-label>
                    <input type="text" #vendorInput placeholder="Vendor" (click)="vendorget()" aria-label="Number" matInput
                        formControlName='name' [matAutocomplete]="autov">
                    <mat-autocomplete [panelWidth]="250" #autov="matAutocomplete" [displayWith]="displayFnvendor"
                    (opened)="vendorscroll()">
                        <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                        <ng-container *ngIf="!isLoading">
                            <!-- <mat-option  matTooltipClass="example-tooltip-red1" [matTooltip]="p.code" *ngFor="let p of vendordata" [value]="p"> -->
                                <!-- {{p.code}} -->
                                <mat-option  matTooltipClass="example-tooltip-red1" [matTooltip]="p.name" *ngFor="let p of vendordata" [value]="p">
                                {{ (p.name.length > 10 )?(p.name | slice:0.10)+'..' :(p.name) }}

                            </mat-option>
                        </ng-container>
                    </mat-autocomplete>
                </mat-form-field>
            </div>

            <div class="col-md-3">
                <mat-form-field class="example-full-width" (click)="supplierget()">
                    <mat-label>Supplier </mat-label>
                    <input #SupplierInput placeholder="Supplier" matInput
                        formControlName='supplier_name' [matAutocomplete]="supplier">
                    <mat-autocomplete [panelWidth]="250" #supplier="matAutocomplete" [displayWith]="displayFnSupplier"
                       (opened)="supplierscroll()">
                        <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                        <ng-container *ngIf="!isLoading">
                            <!-- <mat-option  matTooltipClass="example-tooltip-red1" [matTooltip]="p.code" *ngFor="let p of supplierdata" [value]="p"> -->
                                <!-- {{p.code}} -->
                            <mat-option  matTooltipClass="example-tooltip-red1" [matTooltip]="p.name" *ngFor="let p of supplierdata" [value]="p">
                                {{ (p.name.length > 25) ? (p.name | slice:0:25) + '..' : p.name }}

                            </mat-option>
                        </ng-container>
                    </mat-autocomplete>
                </mat-form-field>
            </div>

            <div class="col-md-3">
                <mat-form-field class="example-full-width">
                    <mat-label> KVB Branch</mat-label>
                    <input type="text" placeholder="Branch" #branchInput (click)="branchget()" aria-label="Number"
                        matInput formControlName='branch_id' [matAutocomplete]="auto2">
                    <mat-autocomplete [panelWidth]="250" #auto2="matAutocomplete" [displayWith]="displayFnbranch"
                    (opened)="branchScroll()">
                        <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                        <ng-container *ngIf="!isLoading">
                            <mat-option matTooltipClass="example-tooltip-red1" [matTooltip]="p.name" *ngFor="let p of branch_data" [value]="p">
                                <!-- {{p.name}} -->
                                {{ (p.name.length > 25) ? (p.name | slice:0:25) + '..' : p.name }}

                            </mat-option>
                        </ng-container>
                    </mat-autocomplete>
                </mat-form-field>
            </div>
            <div class="col-md-3"  *ngIf="contract">
                <mat-form-field style="width:200px" >
                    <mat-label>Status</mat-label>
                    <mat-select formControlName="email_status" >
                        <mat-option *ngFor="let state of statusdropdown" [value]="state.id" >
                            {{state.name}}
                        </mat-option>
                    </mat-select>
                    
                </mat-form-field>
            </div>
            <div class="col-md-3"  *ngIf="risk">
                <mat-form-field style="width:200px" >
                    <mat-label>Status</mat-label>
                    <mat-select formControlName="risk_status" >
                        <mat-option *ngFor="let state of riskstatus" [value]="state.id" >
                            {{state.name}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <!-- <div class="col-md-3" *ngIf="risk || contract">
                <mat-form-field>
                    <mat-label>Request Status</mat-label>
                    <mat-select formControlName="request_for">
                        <mat-option *ngFor="let mode of VendorstatusesList" [value]="mode.id">{{mode.name}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div> -->
            <!-- <div class="col-md-3"> 
                <mat-form-field>
                    <mat-label>Vendor Status</mat-label>
                    <mat-select formControlName="vendor_status">
                        <mat-option *ngFor="let mode of Vendorrequests" [value]="mode.id">{{mode.name}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div> -->
    <!-- <div class="row col-md-12"> -->
            <div class="col-md-3" *ngIf="contract">
                <mat-form-field class="example-full-width">
                    <mat-label>Activity Description</mat-label>
                    <input type="text" #activityInput placeholder="Activity Description" (click)="description_get()"
                        aria-label="Number" matInput formControlName='description' [matAutocomplete]="auto11">
                    <mat-autocomplete [panelWidth]="250" #auto11="matAutocomplete" [displayWith]="displayFndesc"
                    (opened)="activityscroll()">

                        <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                        <ng-container *ngIf="!isLoading">
                            <mat-option  matTooltipClass="example-tooltip-red1" [matTooltip]="p.code" *ngFor="let p of description_data" [value]="p">
                                {{p.name}}
                            </mat-option>
                        </ng-container>
                    </mat-autocomplete>
                </mat-form-field>
                <!-- 
                <mat-form-field class="example-full-width">
                    <input class="toolbar-search" type="text" matInput autocomplete="off" formControlName="description">
                    <mat-placeholder>Activity Description</mat-placeholder>
                </mat-form-field> -->
            </div>

            <div class="col-md-3"  *ngIf="contract">
                <mat-form-field (click)="classifyname()">
                    <mat-label>Classification</mat-label>
                    <input #classifyInput placeholder="Select classification" matInput formControlName="classification"
                        [matAutocomplete]="classify">
                    <mat-autocomplete #classify="matAutocomplete" [displayWith]="displayFnclassify">
                        <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                        <ng-container *ngIf="!isLoading">
                            <mat-option matTooltipClass="example-tooltip-red1" [matTooltip]="classification.text" *ngFor="let classification of classificationList" [value]="classification">
                                {{classification.text}}
                            </mat-option>
                        </ng-container>
                    </mat-autocomplete>
                </mat-form-field>
            </div>

           

            <!-- <div class="col-md-3 checkbox1">
                <mat-checkbox class="example-margin" (change)="is_contract($event)" formControlName="contract_flag">
                    Contract</mat-checkbox>

            </div> -->
            <div class="col-md-3 dates"  *ngIf="contract">
                
                    <mat-checkbox class="example-margin" (change)="is_from($event)" formControlName="from_date">
                        Agreement Start Date</mat-checkbox>
            </div>
            <div class="col-md-3 dates"  *ngIf="contract">

                
                    <mat-checkbox class="example-margin" (change)="is_to($event)" formControlName="from_to">
                        Agreement End Date</mat-checkbox>
                
                <!-- <mat-form-field>
                    <mat-label>Agreement</mat-label>
                    <mat-select formControlName="from_to">
                        <mat-option *ngFor="let mode of filter_base" (click)="is_from_to(mode)" [value]="mode.id">
                            {{mode.name}}
                        </mat-option>
                    </mat-select>
                </mat-form-field> -->

            </div>


            <div class="col-md-3" *ngIf="from_flag">
                <mat-form-field>
                    <mat-label>From </mat-label>
                    <input matInput [matDatepicker]="one" formControlName="contractdate_from_start"
                        (dateChange)="fromDateSelection($event.value)">
                    <mat-datepicker-toggle matSuffix [for]="one"></mat-datepicker-toggle>
                    <mat-datepicker #one></mat-datepicker>
                </mat-form-field>
            </div>

            <div class="col-md-3" *ngIf="from_flag">
                <mat-form-field>
                    <mat-label> To </mat-label>
                    <input matInput [matDatepicker]="three" formControlName="contractdate_from_end" [min]="select">
                    <mat-datepicker-toggle matSuffix [for]="three"></mat-datepicker-toggle>
                    <mat-datepicker #three></mat-datepicker>
                </mat-form-field>
            </div>

            <div class="col-md-3" *ngIf="to_flag">
                <mat-form-field>
                    <mat-label>From </mat-label>
                    <input matInput [matDatepicker]="two" formControlName="contractdate_to_start"
                        (dateChange)="fromDateSelection($event.value)">
                    <mat-datepicker-toggle matSuffix [for]="two"></mat-datepicker-toggle>
                    <mat-datepicker #two></mat-datepicker>
                </mat-form-field>
            </div>
            <div class="col-md-3" *ngIf="to_flag">
                <mat-form-field>
                    <mat-label> To </mat-label>
                    <input matInput [matDatepicker]="four" formControlName="contractdate_to_end" [min]="select">
                    <mat-datepicker-toggle matSuffix [for]="four"></mat-datepicker-toggle>
                    <mat-datepicker #four></mat-datepicker>
                </mat-form-field>
            </div>
           </div>
           <br>
           <div class="row">
            <div class="col-md-11 text-center">
                <button class="btn btn-outline-primary" (click)="vendorsearch(1)"
                 color="primary" matTooltip="Search" >
                <i class="fa fa-search"></i></button>&nbsp;&nbsp;&nbsp;&nbsp;
               
            <button class="btn btn-outline-secondary" (click)="clearsearch()"
            color="primary" matTooltip="Clear">
            <i  class="fa fa-refresh" aria-hidden="true"></i>
        </button>&nbsp;&nbsp;&nbsp;&nbsp;
        <button class="btn btn-outline-success" (click)="vendorreport()"
        color="primary" matTooltip="Download Excel">
       <i  class="fa fa-download"></i>
   </button>
            </div>
            <br>

            <!-- <div class="col-md-3">`
                <mat-form-field>
                    <mat-label>Vendor From Date</mat-label>
                    <input matInput [matDatepicker]="excemfrom" formControlName="from_date">
                    <mat-datepicker-toggle matSuffix [for]="excemfrom"></mat-datepicker-toggle>
                    <mat-datepicker #excemfrom disabled="false"></mat-datepicker>
                </mat-form-field>
            </div>

            <div class="col-md-3">
                <mat-form-field>
                    <mat-label>Vendor To Date </mat-label>
                    <input matInput [matDatepicker]="excemto" formControlName="to_date">
                    <mat-datepicker-toggle matSuffix [for]="excemto"></mat-datepicker-toggle>
                    <mat-datepicker #excemto disabled="false"></mat-datepicker>
                </mat-form-field>
            </div> -->

        
            <!-- <div>

            
                <div>

                    <button class="btn btn-outline-primary" (click)="vendorsearch(1)"
                    style="border-radius:40px;margin-left: 10px;" color="primary">
                    <i matTooltip="search" class="fa fa-search"></i></button>&nbsp;
                </div>

                <div>
                    <button class="btn btn-outline-primary" (click)="vendorreport()"
                    style="border-radius:40px;margin-left: 84px;margin-top: -67px;" color="primary">
                    <i matTooltip="Download Excel" class="fa fa-download"></i>
                </button>&nbsp;&nbsp;
                </div>

                <div>
                    <button class="btn btn-outline-primary" (click)="clearsearch()"
                    style="border-radius:40px;margin: left 120px;margin-top: -79px;" color="primary">
                    <i matTooltip="refresh" class="fa fa-refresh" aria-hidden="true"></i>
                </button>
                </div>


                
            </div> -->
            
    </div>
           

    </form>
    <br>
    <br>

    <div class="container-fluid">

        <table class="table table-responsive  table-bordered">
            <thead class="table_header" style="text-align: left;">
                <tr>
                    <th>S.no</th>
                    <th>Vendor </th>
                                        <!-- //bug id:9331 -->
                    <th>Supplier</th>
                    <th>KVB Branch</th>
                    <th>DO</th>
                    <th>Classification</th>
                    <th *ngIf="contract">Agreement Start Date</th>
                    <th *ngIf="contract">Agreement End Date</th>
                    <th *ngIf="risk">Assessment Start Date</th>
                    <th *ngIf="risk">Assessment End Date</th>
                    <th>Activity Description</th>
                    <th>Status</th>
                    <th>Send Mail</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let  i of vendorSummaryList; index as j">
                    <td> {{(presentpage - 1)*10 +j+1 }} </td>
                    <td *ngIf="contract" (click)="invendorproductsummary(i)" data-toggle="modal" data-target="#vendor" style="cursor: pointer;color:blue;">
                        {{i.vendor_name}}--{{i.vendor_code}}</td>
                    <td *ngIf="risk" (click)="particularRisk(i,1)" data-toggle="modal" data-target="#risk" style="cursor: pointer;color:blue;">
                        {{i.vendor_name}}--{{i.vendor_code}}</td>
                                            <!-- //bug id:9331 -->
                    <td>{{i.supplier_name}}--{{i.supplier_code }}</td> 
                    <td>
                        <ng-container>
                            <p>{{i.s_b.name}}</p>
                        </ng-container>
                    </td>

                    <td>{{i.s_b.branch_DO}}</td>
                    <td>{{i.classification}}</td>
                    <td *ngIf="contract">{{i.contractdate_from}}</td>
                    <td *ngIf="contract" >{{i.contractdate_to}}</td>
                    <td *ngIf="risk">{{i.period_start}}</td>
                    <td *ngIf="risk">{{i.period_end}}</td>
                    <td>{{i.description}}</td>
                    <td *ngIf="contract"
                     (click)="questionnairehistoryreport(i?.activity_id,i?.vendor_id,i)" data-toggle="modal" data-target="#questionnairehistory" style="cursor: pointer;color:blue;" >
                        <!-- {{(i.e_mailstatus?.id == 1)? 'Level 2 Approval Waiting': (i.e_mailstatus?.id == 2)? 'Document Pending':(i.e_mailstatus?.id == 3)? 'Renewal Rejected':(i.e_mailstatus?.id == 4)? 'Live':(i.e_mailstatus?.id == 5)? 'Renewal Expired':'' }} -->
                        <!-- {{(i.e_mailstatus?.id == null)? i?.mail_status?.text : (i.e_mailstatus?.id == 1)? 'Renewal Pending': (i.e_mailstatus?.id == 2)? 'Renewal Documents Pending':(i.e_mailstatus?.id == 3)? 'Renewal Rejected':''}} -->
                        {{i.e_mailstatus?.text}}
                    </td>
                    <td *ngIf="risk">
                        {{i.risk_status_name}}
                    </td>
                    <td *ngIf="((contract) && (i.e_mailstatus?.id == 5 || i.e_mailstatus?.id == 3 || i.e_mailstatus?.id == 7))">
                        <button type="button" class="sent" (click)="send_mail_(i)" data-toggle="modal"
                        data-target="#reportpopup">
                        <span class="fa fa-paper-plane"></span>
                            <!-- <img src="../../../assets/images/send.jpg">   -->
                        </button>
                    </td>
                    <!-- <td *ngIf="((risk) && (i.risk_status_name == 'Risk Pending'))"> -->
                        <td *ngIf="((risk) && (i.risk_status_name == 'RA Pending'))">
                        <!-- <mat-checkbox (change)="send_mail_(i,$event)"  #checkbox    [(ngModel)]="i.email" data-toggle="modal"data-target="#reportpopup"
                            class="example-margin"></mat-checkbox> -->
                        <!-- <button type="button" class="sent" (click)="send_mail_(i)" data-toggle="modal"
                        data-target="#reportpopup"> -->
                        <!-- <button type="button" class="sent" (click)="send_mail_(i)" data-toggle="modal"
                        data-target="#file"> -->
                        <button type="button" class="sent" (click)="send_mail_1(i)">
                        <!-- <mat-icon>send</mat-icon> -->
                        <span class="fa fa-paper-plane"></span>
                            <!-- <img src="../../../assets/images/send.jpg">   -->
                        </button>
                    </td>




                </tr>
                <tr>
                    <td *ngIf="vendorSummaryList.length == 0" colspan="6"> No Records found</td>
                </tr>
                <tr>
                    <td colspan="4"></td>
                    <td>Count: <code>{{count}}</code></td>
                    <td colspan="2">
                        <div class="col-sm-12" style="font-size: small;text-align: right;margin-bottom: 5%;">
                            <button mat-icon-button [disabled]="has_previous === false" color="primary"
                                (click)="previousClick()">
                                <mat-icon>arrow_back</mat-icon>
                            </button>
                            {{presentpage}}
                            <button mat-icon-button [disabled]="has_next === false" color="primary"
                                (click)="nextClick()">
                                <mat-icon>arrow_forward</mat-icon>
                            </button>
                        </div>
                    </td>
                </tr>

            </tbody>


        </table>
       

    </div>

</div>
<div class="modal fade" id="file" tabindex="-1" role="dialog" aria-labelledby="Employee" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content ">
            <div class="modal-header text-center" style="background: #ddefdd">
                <!-- <h4 class="modal-title  w-100 font-weight-bold" id="Employee">Employee Personal Info</h4> -->
                <h2 class="modal-title" >Upload a File</h2>

                <button type="button" #closebutton class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true" #modalclose>&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form [formGroup]="email_form" autocomplete="off">
                    <div class="row">

                        <div class="col-md-7">
                         Filled Vendor Performance Monitoring Control Sheet in PDF/ JPG/ JPEG/ PNG format 
                         <!-- <br><br> --></div>
                          <div class="col-md-5">
                         <input type="file" class="file" autocomplete="off" (change)="fileSelected($event)"
                         accept=".pdf,.jpg,.jpeg,.png">                        
                        </div>

                     

                    </div>





                </form>

            </div>
            <div class="modal-footer">
                <div class="text-right">
                    <button class="btn btn-outline-success" type="button" data-dismiss="modal">
                        Cancel </button> &nbsp;&nbsp;
                    <button class="btn btn-outline-primary" type="submit" (click)="submitForm()">
                        Send</button>

                </div>
            </div>



        </div>

    </div>
</div>

<div class="modal fade" id="reportpopup" tabindex="-1" role="dialog" aria-labelledby="Employee" aria-hidden="true">
    <div class="modal-dialog modal-lg " role="document">
        <div class="modal-content ">
            <div class="modal-header text-center" style="background: #ddefdd">
                <!-- <h4 class="modal-title  w-100 font-weight-bold" id="Employee">Employee Personal Info</h4> -->
                <h4 class="modal-title" style="font-weight: 500;">{{maildata?.vendor_name}} - ({{maildata?.s_b?.branch_DO}}) - ({{maildata?.description}})</h4>

                <button type="button" #closebutton class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true" #modalclose>&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form [formGroup]="email_form" autocomplete="off">
                    <div>

                        <div>
                            <p class="marginzero" >Hi {{maildata?.description}} Team,</p><br>
                            <p class="marginzero" >The renewal questionnaire has been sent to your email address, for vendor {{maildata?.vendor_name}}, request you to action the same</p>

                        </div>

                        <!-- <mat-label> Email Content</mat-label><br> -->
                        <!-- <input matInput [readonly] ="true"   formControlName="name"> -->
                        <!-- <textarea rows="8" cols="80" formControlName="mail_content"></textarea> -->
                        <mat-form-field style="width:750px" >
                            <textarea matInput formControlName="mail_content" ></textarea>
                        </mat-form-field>
                        <!-- <p>Kindly update</p><br> -->

                        <div class="regards" >
                            <p class="marginzero" >Regard,</p>
                            <p class="marginzero" >KVB</p>
                        </div>

                    </div>





                </form>

            </div>
            <div class="modal-footer">
                <div class="text-right">
                    <button class="btn btn-outline-success" type="button" data-toggle="modal"
                        data-target="#reportpopup">
                        Cancel </button> &nbsp;&nbsp;
                    <button class="btn btn-outline-primary" type="submit" (click)="submitForm()">
                        Send</button>

                </div>
            </div>



        </div>

    </div>
</div>


<div class="modal fade" id="vendor">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">

            <!-- Modal Header -->
            <div class="modal-header">
                <h4 class="modal-title" style="font-weight: 500;"></h4>
                <button type="button" class="close" (click)="closeinvendorpopup()" data-dismiss="modal">&times;</button>
            </div>

            <!-- Modal body -->
            <div class="modal-body">
                <div class="table-responsive" >
                <table class="table   table-bordered" id="reporttable" #reporttable >
                    <thead class="table_header" style="text-align: left;">
                        <tr>
                            <th>S.No</th>
                            <th>Activity Type</th>
                            <th>Activity/product/category</th>
                            <th>Activity/Product/Catalog/name</th>
                            <th>UOM</th>
                            <th>Unitprice </th> 
                            <th>Catalog/Specification</th>
                            <th>KVB Branch</th>   
                            <th>DO</th>   
                            <th>From date</th>
                            <th>To Date</th>
                        </tr>

                    </thead>
                        <tr *ngFor="let data of invendorsummary;let i=index " >
                            <td>{{i+1}}</td>
                            <td>
                                <p *ngIf="data.activity_type == 'S'" >Service</p>
                                <p *ngIf="data.activity_type == 'P'" >Product</p>
                            </td>
                            <td>{{data.activitydetail_name}}</td>
                            <td>{{data.catalogue_name}}</td>
                            <td>{{data.productname.name}}</td>
                            <td>{{data.unitprice}}</td>
                            <td>{{data.specification}}</td>
                            <td>{{data.service_branch?.name}}</td>
                            <td>{{data.service_branch?.branch_DO}}</td>
                            <td>{{data.fromdate}}</td>
                            <td>{{data.todate}}</td>

                        </tr> 
                    <tr>

                    </tr>
                </table>
            </div>
                <div>
                    <!-- <td *ngIf="vendorSummaryList.length == 0" colspan="6"> No Records found</td> -->
                    <p *ngIf="invendorsummary?.length == 0" style="text-align: center;" > No Records Found</p>
                    <div *ngIf="invendorsummary?.length != 0" class="col-sm-12" style="font-size: small;text-align: right;">
                        <button mat-icon-button [disabled]="invendor_has_previous === false" color="primary"
                            (click)="invendorsummaryprevious()">
                            <mat-icon>arrow_back</mat-icon>
                        </button>
                        {{invendor_presentpage}}
                        <button mat-icon-button [disabled]="invendor_has_next === false" color="primary"
                            (click)="invendorsummarynext()">
                            <mat-icon>arrow_forward</mat-icon>
                        </button>
                    </div>
                </div>
                <div> 
                    <button class="btn btn-outline-primary" (click)="generarPDF()" style="border-radius:40px;margin:15px;float:right" 
                    color="primary">
                    <i matTooltip="Download Excel" class="fa fa-download"></i>
                </button>
                </div>
            </div>
   


        </div>
    </div>
</div>

<div class="modal fade" id="risk">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">

            <!-- Modal Header -->
            <div class="modal-header">
                <h2 class="modal-title">Risk Assessment Details</h2>
                <button type="button" class="close" (click)="closepopup()" data-dismiss="modal">&times;</button>
            </div>

            <!-- Modal body -->
            <div class="modal-body">
                <div class="row">
                    <div class="col">
                        <b>Vendor : </b> {{vendor_name}}
                    </div>
                    <div class="col">
                        <b>Supplier : </b> {{supplier_name}}
                    </div>
                </div>
                <br>
                <div class="row">
                    <div class="col">
                        <b>Branch : </b> {{s_b}}
                    </div>
                   
                    <div class="col">
                        <b>Activity : </b> {{description}}
                    </div>
                    
                </div>
                <br>
                <div class="row">
                    <div class="col">
                        <b>Status : </b> {{risk_status_name}}
                    </div>
                </div>
                <br><br>
                <div class="table-responsive" >
                <table class="table   table-bordered" id="reporttable" #reporttable >
                    <thead class="table_header" style="text-align: left;">
                        <tr>
                            <th>S.No</th>
                            <th>Assessment From Date </th>
                            <th>Submit Date</th>
                            <th>Assessment End Date </th>
                            <th>Questionnaire Report</th>   
                            <th>Performance Monitoring Sheet File</th>
                            <th>Transaction</th>

                        </tr>

                    </thead>
                        <tr *ngFor="let data of riskSummary;let i=index " >

                            <td> {{(riskpresentpage - 1)*10 +i+1 }}</td>
                             <!-- <td>{{i+1}}</td> -->
                            <td>{{data?.start_date}}-{{data?.start_user}}</td>
                            <td>{{data?.submit_date}}-{{data?.submit_user}}</td>
                            <td>{{data?.end_date}}-{{data?.end_user}}</td>
                            <td><mat-icon  (click)="download(data.que_v_map_id)">download</mat-icon></td>
                            <td><mat-icon matTooltip="Download Vendor Performance Monitoring Control Sheet"
                                 (click)="downloadpdf(data.file_id)">download</mat-icon></td>
                            <td><span class="material-icons history" (click)="gettranhistory(data)" data-toggle="modal"
                                data-target="#transmodal" style="color:blue;cursor: pointer;">
                                history
                            </span></td>

                        </tr> 
                    <tr>

                    </tr>
                </table>
            </div>
                <div>
                    <!-- <td *ngIf="vendorSummaryList.length == 0" colspan="6"> No Records found</td> -->
                    <p *ngIf="riskSummary?.length == 0" style="text-align: center;" > No Records Found</p>
                    <div *ngIf="riskSummary?.length != 0" class="col-sm-12" style="font-size: small;text-align: right;">
                        <button mat-icon-button [disabled]="risk_previous === false" color="primary"
                            (click)="riskPrevious()">
                            <mat-icon>arrow_back</mat-icon>
                        </button>
                        {{riskpresentpage}}
                        <button mat-icon-button [disabled]="risk_next === false" color="primary"
                            (click)="riskNext()">
                            <mat-icon>arrow_forward</mat-icon>
                        </button>
                    </div>
                </div>
                <!-- <div> 
                    <button class="btn btn-outline-primary" (click)="generarPDF()" style="border-radius:40px;margin:15px;float:right" 
                    color="primary">
                    <i matTooltip="Download Excel" class="fa fa-download"></i>
                </button>
                </div> -->
            </div>
   


        </div>
    </div>
</div>

<div class="modal fade" id="questionnairehistory" data-backdrop="static" data-keyboard="false" >
    <div class="modal-dialog modal-xl">
        <div class="modal-content">

            <!-- Modal Header -->
            <div class="modal-header">
                <h4 class="modal-title" style="font-weight: 500;">{{maildata?.vendor_name}} - ({{maildata?.s_b?.branch_DO}}) - ({{maildata?.description}})</h4>
                <button type="button" class="close" (click)="resethistory()" data-dismiss="modal">&times;</button>
            </div>

            <!-- Modal body -->
            <div class="modal-body">
                <div class="table-responsive" >
                <table class="table   table-bordered" >
                    <thead class="table_header" style="text-align: left;">
                        <tr>
                            <th>S.No</th>
                            <th>Employee Name</th>
                            <th>Date</th>
                            <th>Status</th>
                            <th>Remarks</th>
                        </tr>

                    </thead>
                        <tr *ngFor="let data of questionnairehistory?.history;let i=index " >
                            <td>{{i+1}}</td>
                            <td>{{data?.name}}</td>
                            <td>{{data?.created_date  | date: 'd/M/y' }}</td>
                            <td>
                        {{(data.status?.id == 1)? (questionnairehistory?.history[questionnairehistory?.history?.length-1]?.status?.id != 2  )? 'Level 1 Created':'Level 1 Created' : (data.status?.id == 2)? 'Level 2 Approved':(data.status?.id == 3)? 'Level 2 Declined'  :'' }}
                        <!-- <button *ngIf="data.status?.id == 3" mat-icon-button><mat-icon>more</mat-icon></button> -->
                        <a *ngIf="data.status?.id == 2 || data.status?.id == 3" target="_blank" [href]="currenturl"> View</a>
                        <!-- <a  [href]="currenturl" *ngIf="data.status?.id == 3 " target="_blank"  title="{{data?.remarks}}">View</a> -->
                    </td>
                    <td>
                        {{data?.remarks}}
                    </td>
                        
                        </tr> 
                    <tr>

                    </tr>
                </table>
            </div>
                <div>
                    <!-- <td *ngIf="vendorSummaryList.length == 0" colspan="6"> No Records found</td> -->
                    <p *ngIf="questionnairehistory?.history?.length == 0" style="text-align: center;" > No Records Found</p>
                    <div *ngIf="questionnairehistory?.history?.length != 0" class="col-sm-12" style="font-size: small;text-align: right;">
                        <!-- <button mat-icon-button [disabled]="invendor_has_previous === false" color="primary"
                            (click)="invendorsummaryprevious()">
                            <mat-icon>arrow_back</mat-icon>
                        </button>
                        {{invendor_presentpage}}
                        <button mat-icon-button [disabled]="invendor_has_next === false" color="primary"
                            (click)="invendorsummarynext()">
                            <mat-icon>arrow_forward</mat-icon>
                        </button> -->
                    </div>
                </div>
                
            </div>
   


        </div>
    </div>
</div>
<div class="modal fade" id="transmodal" tabindex="-1" role="dialog" aria-labelledby="grnmodalLabel"
    aria-hidden="true" data-backdrop="static" data-keyboard="false">

    <div class="modal-dialog modal-xl" role="document">
        <!-- <div class="modal-dialog modal-xl"> -->

        <div class="modal-content1">

            <div class="modal-header text-center">

                <h4 class="modal-title  w-100 font-weight-bold" id="grnmodalLabel">Transaction History</h4>
                
                <button type="button" #closebttn class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <!-- <div class="row">
                    <div class="col-6">
                <h4 style="text-align: left;margin-left: 50px;font-weight: bold;">PO No : {{prno}}</h4>
              </div>
              <div class="col-6">
                <span class="fa fa-download" style="margin-left: 500px;" aria-hidden="true"
                                    (click)="download()" [class.disabled]="PrList?.length==0"></span>
                                    </div>
                                    </div> -->
                <div     class="table-responsive" style="margin-top: 2%;width: 95%;margin-left: 50px;">
                    <table class="table scrolltable table-bordered">
                        <thead>
                            <tr class="table_header">
                            <th>S.No</th>
                            <th>From User </th>
                            <th>To User</th>
                            <th>Status </th>
                            <th>Transaction Date</th>   
                            <th>Remarks</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let trans of transList; index as i">
                                <td> {{(transpresentpage - 1)*10 +i+1 }} </td>
                                <!-- <td>{{i+1}}</td> -->
                                <td >{{ trans?.from_user?.emp_name }} --{{trans?.from_user?.code}}</td>
                                <td >{{ trans?.to_user?.emp_name }} --{{trans?.to_user?.code}}</td>
                                <td>{{ trans?.status_name}}</td>
                                <td>{{trans?.created_date}}</td>
                                <td>{{trans?.remarks}}</td>
                                
                                 
                        </tbody>
                    </table>
                    <div *ngIf="transList?.length==0">No Records Found...</div>
                    <ng-template>
                        <div class="col-sm-12" style="font-size: small;text-align: right;margin-bottom: 5%;">
                            <button mat-icon-button [disabled]="transhas_previous === false" color="primary" (click)="transpreviousClick()">
                                <mat-icon>arrow_back</mat-icon>
                            </button>
                             {{transpresentpage}}
                            <button mat-icon-button [disabled]="transhas_next === false" color="primary" (click)="transnextClick()">
                                <mat-icon>arrow_forward</mat-icon>
                            </button>
                        </div>
                    </ng-template>
                </div>

            </div>
        </div>
    </div>
</div> 