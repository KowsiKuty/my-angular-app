<div class="pl-5 pr-5 pt-3">
    <form [formGroup]="roaSearchForm">

        <div class="row mb-3">
            <div class="ml-3 mr-3">
                <mat-form-field (click)="finyear_search_dropdown()" appearance="outline">
                    <mat-label>Fin Year</mat-label>
                    <input placeholder="Fin Year" matInput formControlName="finyear" #finyearInputs
                        [matAutocomplete]="fin_year">
                    <mat-autocomplete #fin_year="matAutocomplete" [displayWith]="displayfn_serchfinyear">
                        <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                        <ng-container *ngIf="!isLoading">
                            <mat-option *ngFor="let finyearname of finyearLists" [value]="finyearname">
                                {{finyearname.finyer}} </mat-option>
                        </ng-container>
                    </mat-autocomplete>
                </mat-form-field>
            </div>
            <div class="ml-3 mr-3">
                <mat-form-field appearance="outline">
                    <mat-label>Month</mat-label>
                    <mat-select formControlName="frommonth">
                        <mat-option *ngFor="let month of from_month" [value]="month">
                            {{month.month}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <!-- <div class="ml-3 mr-3" >
            <mat-form-field (click)="branchname_search()" appearance="outline">
                <mat-label>Branch</mat-label>
                <input #branchInput placeholder="Branch" matInput formControlName="branch_id"
                    #branchContactInputss [matAutocomplete]="branchname" >
                <mat-autocomplete #branchname="matAutocomplete" [displayWith]="displayfnbranch_search"
                    (opened)="autocompletebranchnameScroll_search()">
                    <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                    <ng-container *ngIf="!isLoading">
                        <mat-option *ngFor="let branch of branchLists" [value]="branch">
                            {{branch.code}}-{{branch.name}} </mat-option>
                    </ng-container>
                </mat-autocomplete>
            </mat-form-field> 
        </div> -->
            <div class="ml-3 mr-3">
                <mat-form-field (click)="Business_search_dropdown()" appearance="outline">
                    <mat-label>Business</mat-label>
                    <input placeholder="Business" matInput formControlName="business" #businessInputs
                        [matAutocomplete]="business_names" (keyup)="Business_search_dropdown()">
                    <mat-autocomplete #business_names="matAutocomplete" [displayWith]="displayfnbusiness_search"
                        (opened)="autocompletebusinessnameScroll_search()">
                        <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                        <ng-container *ngIf="!isLoading">
                            <mat-option *ngFor="let business of businessLists" [value]="business">
                                {{business.name}}
                            </mat-option>
                        </ng-container>
                    </mat-autocomplete>
                </mat-form-field>
            </div>
            <div class="ml-3 mr-3 mt-2">
                <button class="btn btn-outline-primary" type="submit" (click)="Roa_manual_summary(roaSearchForm.value)"
                    style="border-radius:40px; margin-left: 10%;" color="primary"><i class="fa fa-search"
                        aria-hidden="true"></i></button>
            </div>
            <div class="ml-3 mr-3 mt-2">
                <button type="button" style="border-radius: 40px;margin-left: 10%;" class="btn btn-outline-primary"
                    (click)="roa_summary_clear()">Reset</button>
            </div>
            <div class="ml-3 mr-3 mt-2">
                <button type="button" style="border-radius: 40px;" class="btn btn-outline-primary"
                  (click)="Roa_manual_create()">
                    Add
                </button>
            </div>
            <div class="ml-3 mr-3 mt-2">
                <button class="btn btn-outline-primary" matTooltip="Upload" style="border-radius: 40px;"
                    (click)="openfile_upload()">
                    <i class="fa fa-upload" aria-hidden="true"></i>
                </button>
            </div>
        </div>
    </form>

    <div class="margin_left_align">
        <!-- <form [formGroup]="roa_manual"> -->
            <div style="margin-top: 6%; white-space: nowrap;overflow-x: auto;" class="tableFixHead">
                <!-- formArrayName="Roa_manual_arr"> -->
                <table class="table table-bordered" id="commonstyle" fixed-header>
                    <thead style="background-color: #ddefdd;">
                        <th>S.No</th>
                        <th>Finyear</th>
                        <th>Month</th>
                        <th>Label</th>
                        <!-- <th>Branch</th>      -->
                        <!-- <th>Vertical Label</th>   -->
                        <th>Avg Assets</th>
                        <th>Avg Liability</th>
                        <th>Average Asset</th>
                        <th>Yield on Advances/Funds%</th>
                        <th>Cost of Deposits/Funds%</th>
                        <!-- <th>Status</th>                         -->
                        <th>Action</th>
                    </thead>
                    <!-- <ng-container *ngIf="Roa_manual_array?.length!=0"> -->
                    <tbody>
                        <!-- <ng-container > -->
                        <!-- <ng-container *ngIf="roa_manual.controls.Roa_manual_arr['controls'].length > 0; else noData"> -->
                        <tr *ngFor="let arr_val of Roa_manual_array; let ind=index">
                            <td>{{(presentpage - 1)*10 + ind+1 }}</td>
                            <td>
                                <!-- <div *ngIf="arr_val.value.isEditable==true;else label_nameelse"> -->
                                {{arr_val.finyear?.finyer}}
                                <!-- </div> -->
                                <!-- <ng-template #label_nameelse>
                                    <mat-form-field (click)="finyear_dropdown()" >
                                        <mat-label>Fin Year</mat-label>
                                        <input  matInput formControlName="finyear" #finyearInput
                                            [matAutocomplete]="fin_year" required>
                                        <mat-autocomplete #fin_year="matAutocomplete" [displayWith]="displayfnfinyear">
                                            <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                            <ng-container *ngIf="!isLoading">
                                                <mat-option *ngFor="let finyearname of finyearList" [value]="finyearname">
                                                    {{finyearname.finyer}} </mat-option>
                                            </ng-container>
                                        </mat-autocomplete>
                                    </mat-form-field>  
                                </ng-template> -->
                            </td>
                            <td>
                                <!-- <div *ngIf="arr_val.value.isEditable==true;else label_else"> -->
                                {{arr_val.transactionmonth?.month}}
                                <!-- </div> -->
                                <!-- <ng-template #label_else>                                    
                                    <mat-form-field >
                                        <mat-label>Month</mat-label>
                                        <mat-select formControlName="month">
                                            <mat-option *ngFor="let month of from_month"  [value]="month">
                                                {{month.month}}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </ng-template> -->
                            </td>
                            <td>
                                <!-- <div *ngIf="arr_val.value.isEditable==true;else label_buss_else"> -->
                                {{arr_val.business?.name}}
                                <!-- </div>
                                <ng-template #label_buss_else>                                    
                                    <mat-form-field (click)="Business_dropdown()"  >
                                        <mat-label>Label Name</mat-label>
                                        <input  matInput  formControlName="business" #businessInput
                                            [matAutocomplete]="business_name" (keyup)="Business_dropdown()">
                                        <mat-autocomplete #business_name="matAutocomplete" [displayWith]="displayfnbusiness"
                                            (opened)="autocompletebusinessnameScroll()">
                                            <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                            <ng-container *ngIf="!isLoading">
                                                <mat-option *ngFor="let business of businessList" 
                                                    [value]="business">
                                                    {{business.name}}
                                                </mat-option>
                                            </ng-container>
                                        </mat-autocomplete>
                                    </mat-form-field>
                                </ng-template> -->

                            </td>
                            <!-- <td>
                                <div *ngIf="arr_val.value.isEditable==true;else label_branch_else">
                                    {{arr_val.value?.branch?.name}}
                                </div>
                                <ng-template #label_branch_else>                                 
                                  
                                    <mat-form-field (click)="branchname()" >
                                        <mat-label>Branch</mat-label>
                                        <input #branchInput  matInput  formControlName="branch"
                                            #branchContactInput [matAutocomplete]="branch">
                                        <mat-autocomplete #branch="matAutocomplete" [displayWith]="displayfnbranch"
                                            (opened)="autocompletebranchnameScroll()">
                                            <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                            <ng-container *ngIf="!isLoading">
                                                <mat-option *ngFor="let branch of branchList" [value]="branch">
                                                    {{branch.code}}-{{branch.name}} </mat-option>
                                            </ng-container>
                                        </mat-autocomplete>
                                    </mat-form-field>
                                </ng-template>
                              
                            </td> -->
                            <!-- <td>
                                <div *ngIf="arr_val.value.isEditable==true;else label_name_else">
                                    {{arr_val.value?.vertical_label?.name}}
                                </div>
                                <ng-template #label_name_else>                                    
                                    <mat-form-field (click)="label_dd()"  >
                                        <mat-label>Vertical Label Name</mat-label>
                                        <input placeholder="Vertical Label" matInput  formControlName="vertical_label" #labelContactInput
                                            [matAutocomplete]="label">
                                        <mat-autocomplete #label="matAutocomplete" [displayWith]="displaylabel"
                                            (opened)="autocompletelabelScroll()">
                                            <mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
                                            <ng-container *ngIf="!isLoading">
                                                <mat-option *ngFor="let label of labelList" 
                                                    [value]="label">
                                                    {{label.name}}
                                                </mat-option>
                                            </ng-container>
                                        </mat-autocomplete>
                                    </mat-form-field>
                                </ng-template>
                              
                            </td> -->
                            <td style="text-align: right;">
                                <!-- <div *ngIf="arr_val.value.isEditable==true;else temp_arrelse"> -->
                                {{arr_val.avg_asset}}
                                <!-- </div>
                                <ng-template #temp_arrelse>
                                    <mat-form-field   >
                                        <mat-label>Avg Assets </mat-label>
                                        <input  matInput formControlName="avg_asset" 
                                        appTwoDigitDecimalNumber>                                        
                                    </mat-form-field>   
                                </ng-template> -->
                            </td>
                            <td style="text-align: right;">
                                <!-- <div *ngIf="arr_val.value.isEditable==true;else temp_libarrelse"> -->
                                {{arr_val.avg_liability}}
                                <!-- </div>
                                <ng-template #temp_libarrelse>
                                    <mat-form-field   >
                                        <mat-label>Avg Liability</mat-label>
                                        <input  matInput formControlName="avg_liability"  (keyup)="avg_asset_value($event.target.value)"
                                        appTwoDigitDecimalNumber>                                        
                                    </mat-form-field>   
                                </ng-template> -->
                            </td>
                            <td style="text-align: right;">
                                <!-- <div *ngIf="arr_val.value.isEditable==true;else temp_assarrelse"> -->
                                {{arr_val.avg_assets}}
                                <!-- </div>
                                <ng-template #temp_assarrelse>
                                    <mat-form-field   >
                                        <mat-label>Average Asset </mat-label>
                                        <input  matInput formControlName="avg_assets" 
                                        appTwoDigitDecimalNumber>                                        
                                    </mat-form-field>   
                                </ng-template> -->
                            </td>
                            <td style="text-align: right;">
                                <!-- <div *ngIf="arr_val.value.isEditable==true;else temp_yeildarrelse"> -->
                                {{arr_val.yield_perc}}
                                <!-- </div>
                                <ng-template #temp_yeildarrelse>
                                    <mat-form-field   >
                                        <mat-label>Yield on Advances/Funds%</mat-label>
                                        <input  matInput formControlName="yield_perc" 
                                        appTwoDigitDecimalNumber>                                        
                                    </mat-form-field>   
                                </ng-template> -->
                            </td>
                            <td style="text-align: right;">
                                <!-- <div *ngIf="arr_val.value.isEditable==true;else temp_costarrelse"> -->
                                {{arr_val.cof_perc}}
                                <!-- </div>
                                <ng-template #temp_costarrelse>
                                    <mat-form-field   >
                                        <mat-label>Cost of Deposits/Funds%</mat-label>
                                        <input  matInput formControlName="cof_perc" 
                                        appTwoDigitDecimalNumber>                                        
                                    </mat-form-field>   
                                </ng-template> -->
                            </td>
                            <!-- <td>{{arr_val.value.status===0?'In-Active':'Active'}}</td> -->

                            <td style="font-size: 13px;">
                                <!-- <button mat-icon-button class="material-icons app-toolbar-menu save-button" matTooltip="Save Changes"
                                 (click)="saveroa_manual(arr_val,ind)"
                                  *ngIf="!arr_val.value.isEditable" style="color:'#0297ff'">
                                  <mat-icon>check_circle</mat-icon>
                                </button>
              
                                <button mat-icon-button class="material-icons app-toolbar-menu cancel-button"
                                  matTooltip="Cancel Changes" color="warn" (click)="cancel_roa_master(arr_val,ind)"
                                  *ngIf="!arr_val.value.isEditable">
                                  <mat-icon>cancel</mat-icon>
                                </button> -->

                                <button mat-icon-button class="material-icons app-toolbar-menu save-button"
                                    matTooltip="Edit" style="color:'#66bb6a'"  (click)="Edit_roa_master(arr_val,ind,'edit')">
                                    <mat-icon>edit</mat-icon>
                                </button>

                                <button mat-icon-button class="material-icons app-toolbar-menu delete-button"
                                    (click)="deletelabel(arr_val,ind)" color="warn">
                                    <mat-icon>delete</mat-icon>
                                </button>

                            </td>
                        </tr>
                        <!-- </ng-container> -->
                        <!-- </ng-container> -->
                        <!-- <ng-template #noData>
                  <tr>
                    <td colspan="9" style="text-align: center;">
                      <h3>No Data Found...</h3>
                    </td>
                  </tr>
                </ng-template> -->
                    </tbody>
                    <!-- </ng-container> -->
                    <!-- <div *ngIf="Roa_manual_array?.length==0" style="margin-left: 182%;">
                        <h3> Sorry no data found!.. </h3>
                    </div> -->
                </table>
            </div>
        <!-- </form> -->
        <div style="margin-bottom: 5%;font-size: small;text-align:right;">
            <button mat-icon-button [disabled]="has_previous === false" color="primary" (click)="previousClick()">
                <mat-icon>arrow_back</mat-icon>
            </button> {{presentpage}}
            <button mat-icon-button [disabled]="has_next === false" color="primary" (click)="nextClick()">
                <mat-icon>arrow_forward</mat-icon>
            </button>

        </div>
    </div>

    <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabels" aria-hidden="true"
        id="file_upload" #file_upload>
        <div class="modal-dialog modal-lg" >
            <div class="modal-content">
                <div class="modal-header" style="    background-color: #deefde;">
                    <h2 class="modal-title"> &nbsp;&nbsp; File Upload</h2>
                    <button type="button" (click)="clear_data()" class="close" #closepop data-dismiss="modal"
                        aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" style="white-space: nowrap;">
                    <div class="card">
                        <div class="card-body" style="margin-top: 2%;margin-bottom: 2%;">

                            <div class="input-group mb-3">
                                <form [formGroup]="roa_fileuploade">
                                    <div class="col-md-12">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="custom-file" style=" margin-top: 7%;">
                                                    <label>File:</label> &nbsp;&nbsp;
                                                    <input type="file" style="width: 200%;" formControlName='roa_file'
                                                        accept=".xlsx" class="choose" (change)="roa_file_data($event)">
                                                    <!-- accept=".xlsx,.csv" -->
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </form>

                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-outline-secondary" type="button" class="btn btn-outline-primary"
                                style="float: right ;" (click)="roa_file_data_upload(roa_fileuploade.value)">
                                Upload
                            </button>
                            <button class="btn btn-outline-secondary" type="button" data-dismiss="modal"
                                style="float: right ;" (click)="clear_data()">
                                Close
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>



    </div>

</div>
<div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="boxlevelform" aria-hidden="true" id="manual_edit"
    #manual_edit>
    <div class="modal-dialog modal-xl" >
        <div class="modal-content">
            <div class="modal-header" style="    background-color: #deefde;">
                <h2 class="modal-title"> &nbsp;&nbsp; ROA Master</h2>
                <button type="button" (click)="clear_data_edit()" class="close" #closepopedit data-dismiss="modal"
                    aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" style="white-space: nowrap;">
                <div class="card">
                    <div class="card-body" style="margin-top: 2%;margin-bottom: 2%;">

                        <div class="input-group mb-3">
                            <form [formGroup]="edit_form_manual">
                                <div class="col-md-12">
                                    <div class="row">
                                        <div class="col-md-3" >
                                            <!-- <mat-form-field (click)="finyear_dropdown()" appearance="outline">
                                                <mat-label>Fin Year</mat-label>
                                                <input matInput formControlName="finyear" #finyearInput
                                                    [matAutocomplete]="fin_year" required>
                                                <mat-autocomplete #fin_year="matAutocomplete"
                                                    [displayWith]="displayfnfinyear">
                                                    <mat-option *ngIf="isLoading"
                                                        class="is-loading">Loading...</mat-option>
                                                    <ng-container *ngIf="!isLoading">
                                                        <mat-option *ngFor="let finyearname of finyearList"
                                                            [value]="finyearname">
                                                            {{finyearname.finyer}} </mat-option>
                                                    </ng-container>
                                                </mat-autocomplete>
                                            </mat-form-field> -->
                                            <mat-form-field (click)="finyear_search_dropdown()" appearance="outline">
                                                <mat-label>Fin Year</mat-label>
                                                <input matInput formControlName="finyear" #finyearInput
                                                    [matAutocomplete]="fin_year" required>
                                                <mat-autocomplete #fin_year="matAutocomplete"
                                                    [displayWith]="displayfnfinyear">
                                                    <mat-option *ngIf="isLoading"
                                                        class="is-loading">Loading...</mat-option>
                                                    <ng-container *ngIf="!isLoading">
                                                        <mat-option *ngFor="let finyearname of finyearList" [value]="finyearname">
                                                            {{finyearname.finyer}} </mat-option>
                                                    </ng-container>
                                                </mat-autocomplete>
                                            </mat-form-field>
                                        </div>
                                        <div class="col-md-3">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Month</mat-label>
                                                <mat-select formControlName="month">
                                                    <mat-option *ngFor="let month of from_month" [value]="month">
                                                        {{month.month}}
                                                    </mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                        </div>
                                        <div class="col-md-3" >
                                            <mat-form-field (click)="Business_dropdown()" appearance="outline">
                                                <mat-label>Label Name</mat-label>
                                                <input matInput formControlName="business" #businessInput
                                                    [matAutocomplete]="business_name" (keyup)="Business_dropdown()">
                                                <mat-autocomplete #business_name="matAutocomplete"
                                                    [displayWith]="displayfnbusiness"
                                                    (opened)="autocompletebusinessnameScroll()">
                                                    <mat-option *ngIf="isLoading"
                                                        class="is-loading">Loading...</mat-option>
                                                    <ng-container *ngIf="!isLoading">
                                                        <mat-option *ngFor="let business of businessList"
                                                            [value]="business">
                                                            {{business.name}}
                                                        </mat-option>
                                                    </ng-container>
                                                </mat-autocomplete>
                                            </mat-form-field>
                                        </div>
                                        <div class="col-md-3" style="padding: 1%;">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Avg Assets </mat-label>
                                                <input matInput formControlName="avg_asset" appTwoDigitDecimalNumber>
                                            </mat-form-field>
                                        </div>
                                        <div class="col-md-3" >
                                            <mat-form-field appearance="outline">
                                                <mat-label>Avg Liability</mat-label>
                                                <input matInput formControlName="avg_liability"
                                                    (keyup)="avg_asset_value($event.target.value)"
                                                    appTwoDigitDecimalNumber>
                                            </mat-form-field>
                                        </div>
                                        <div class="col-md-3">
                                            <mat-form-field   appearance="outline">
                                                <mat-label>Avg Assets </mat-label>
                                                <input  matInput formControlName="avg_assets" 
                                                appTwoDigitDecimalNumber>                                        
                                            </mat-form-field> 
                                        </div>
                                        <div class="col-md-3" style="padding: 1%;">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Yield on Advances/Funds%</mat-label>
                                                <input matInput formControlName="yield_perc" appTwoDigitDecimalNumber>
                                            </mat-form-field>
                                        </div>
                                        <div class="col-md-3" style="padding: 1%;">
                                            <mat-form-field appearance="outline">
                                                <mat-label>Cost of Deposits/Funds%</mat-label>
                                                <input matInput formControlName="cof_perc" appTwoDigitDecimalNumber>
                                            </mat-form-field>
                                        </div>
                                    </div>
                                </div>

                            </form>

                        </div>
                    </div>
                    <div class="modal-footer">
                        <button  class="btn btn-outline-primary" (click)="saveroa_manual(edit_form_manual.value,'')"
                            >
                            Submit
                        </button>
                        <button class="btn btn-outline-secondary" type="button" data-dismiss="modal"
                            style="float: right ;" (click)="clear_data_edit()">
                            Close
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>