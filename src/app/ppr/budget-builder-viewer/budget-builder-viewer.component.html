<div class="container">
	<br>
	<h2>Budget  Viewer</h2>
	<form [formGroup]="pprSearchForm">
		<div class="col-md-12">
			<div class="row">
				<div class="col-md-3">
					<mat-form-field (click)="finyear_dropdown()">
						<mat-label>Fin Year</mat-label>
						<input placeholder="Fin Year" matInput formControlName="finyear" #finyearInput
							[matAutocomplete]="fin_year" required>
						<mat-autocomplete #fin_year="matAutocomplete" [displayWith]="displayfnfinyear">
							<mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
							<ng-container *ngIf="!isLoading">
								<mat-option *ngFor="let finyearname of finyearList" [value]="finyearname">
									{{finyearname.finyer}} </mat-option>
							</ng-container>
						</mat-autocomplete>
					</mat-form-field>
				</div>
				<div class="col-md-3">
					<mat-label>Select Year Terms</mat-label>
					<br>
					<mat-radio-group aria-label="Select Quarterly or Monthly" formControlName="year_term"
						#group="matRadioGroup">
						<mat-radio-button value="Monthly"> Monthly</mat-radio-button>
					</mat-radio-group>
				</div>

				<div class="col-md-3">
					<mat-label>Select Amount</mat-label>
					<br>
					<mat-radio-group aria-label="Select Quarterly or Monthly" formControlName="divAmount"
						#group="matRadioGroup">
						<mat-radio-button value="L">In Lakhs</mat-radio-button>&nbsp;&nbsp;&nbsp;
						<mat-radio-button value="T"> In Thousands</mat-radio-button>
					</mat-radio-group>
				</div>
				<div class="col-md-3">
					<mat-form-field >
						<mat-label>ALEI</mat-label>
						<mat-select formControlName="flag" required>
						<mat-option *ngFor="let flag of alei" [value]="flag">
							{{flag.name}}
						</mat-option>
						</mat-select>
					</mat-form-field>
				</div>
				<div class="col-md-3">
					<mat-form-field (click)="branchname()">
						<mat-label>Branch</mat-label>
						<input #branchInput placeholder="Branch" matInput formControlName="branchid"
							#branchContactInput [matAutocomplete]="branch">
						<mat-autocomplete #branch="matAutocomplete" [displayWith]="displayfnbranch"
							(opened)="autocompletebranchnameScroll()">
							<mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
							<ng-container *ngIf="!isLoading">
								<mat-option *ngFor="let branch of branchList" [value]="branch">
									{{branch.code}}-{{branch.name}} </mat-option>
							</ng-container>
						</mat-autocomplete>
					</mat-form-field>
				</div>
			
				<div class="col-md-3">
					<mat-form-field (click)="Sector_dropdown()">
						<mat-label>Sector</mat-label>
						<input placeholder="Sector" matInput formControlName="sectorname" #sectornameInput
							[matAutocomplete]="sector_name" required>
						<mat-autocomplete #sector_name="matAutocomplete" [displayWith]="displayfnsectorname" (opened)="autocompletesectorScroll()">
							<mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
							<ng-container *ngIf="!isLoading">
								<mat-option *ngFor="let sector of sectorList" [value]="sector"
									(click)="secotralldata_clear()" (focusout)="selectsectorSection(sector)">
									{{sector.name}} </mat-option>
							</ng-container>
						</mat-autocomplete>
					</mat-form-field>
				</div>
				<div class="col-md-3">
					<mat-form-field (click)="Business_dropdown()">
						<mat-label>Business</mat-label>
						<input placeholder="Business" matInput formControlName="businesscontrol" #businessInput
							[matAutocomplete]="business_name">
						<mat-autocomplete #business_name="matAutocomplete" [displayWith]="displayfnbusiness" (opened)="autocompletebusinessnameScroll()">
							<mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
							<ng-container *ngIf="!isLoading">
								<mat-option *ngFor="let business of businessList" 
									[value]="business" (focusout)="selectbusinessSection(business)"> {{business.name}}
								</mat-option>
							</ng-container>
						</mat-autocomplete>
					</mat-form-field>
				</div>
				<div class="col-md-3">
					<mat-form-field (click)="bsname_dropdown()">
						<mat-label>BS</mat-label>
						<input placeholder="BS" matInput formControlName="bs_id" #bsInput [matAutocomplete]="bs">
						<mat-autocomplete #bs="matAutocomplete" [displayWith]="displayfnbs"
							(opened)="autocompletebsnameScroll()">
							<mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
							<ng-container *ngIf="!isLoading">
								<mat-option *ngFor="let bs of bsList" [value]="bs" 
									(focusout)="selectbsSection(bs)"> {{bs.name}} </mat-option>
							</ng-container>
						</mat-autocomplete>
					</mat-form-field>
				</div>
				<div class="col-md-3">
					<mat-form-field (click)="ccname_dropdown()">
						<mat-label>CC</mat-label>
						<input #bsclear_nameInput placeholder="CC" matInput formControlName="cc_id" #ccInput
							[matAutocomplete]="cc_name">
						<mat-autocomplete #cc_name="matAutocomplete" [displayWith]="displayfncc"
							(opened)="autocompletccnameScroll()">
							<mat-option *ngIf="isLoading" class="is-loading">Loading...</mat-option>
							<ng-container *ngIf="!isLoading">
								<mat-option *ngFor="let cc of ccList" [value]="cc"> {{cc.name}} </mat-option>
							</ng-container>
						</mat-autocomplete>
					</mat-form-field>
				</div>
			
				<div  class="col-md-1">
					<div style="text-align: center;cursor: pointer;">
						<button class="btn btn-outline-primary" type="submit" style="border-radius: 40px;" (click)="excel_download()" color="primary">
							<i matTooltip="Download" class="fa fa-download" aria-hidden="true"></i>
						</button>
					</div>
				</div>
				<div class="col-md-3">
					<div style="text-align: center;cursor: pointer;"><button  data-toggle="modal" style="display: none;" #popup_eve data-target=".bd-examplepop-modal-lg"></button>
							<button style="border-radius: 40px;" class="btn btn-outline-primary" (click)="budgetbuildersearech_click(this.pprSearchForm.value)">
							Search
						</button>
					</div>
				</div>
				<div class="col-md-3">
					<button type="submit" style="border-radius: 40px;" class="btn btn-outline-primary"
						(click)="clear_budgetdata()">Reset</button>
				</div>
			</div>
		</div>

	</form>



	<div *ngIf="display==true" class="modal fade bd-examplepop-modal-lg" tabindex="-1" role="dialog"
		aria-labelledby="myLargeModalLabels" aria-hidden="true">
		<div class="modal-dialog modal-lg"
			style="max-width: 100%;max-height: 100%;width: 100%; height: 100%;border-radius: 0;  width: 100%;height: 100%;padding-left: 20px;padding-bottom: -264px; padding-right: 19px;display: block;">
			<div class="modal-content">
				<div class="modal-header">
					<h2 class="modal-title" >Budget  Viewer</h2>

					<button type="button" class="close"  data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div style="text-align: end;">
					<span style="color: #26722e;" *ngIf="branchcode!=undefined" ><label style="color: black;">Branch : </label>({{branchcode}}) {{branchName}}</span>&nbsp;&nbsp;&nbsp;
					<span style="color: #26722e;"><label style="color: black;">Budget :</label> {{fyer}}</span>&nbsp;&nbsp;&nbsp;
					<span style="color: #26722e;"><label style="color: black;">Amount :</label>{{amount_type}}</span>&nbsp;&nbsp;&nbsp;
					<span style="color: #26722e;" ><label style="color: black;">Sector :</label>{{pprSearchForm.value.sectorname?.name}}</span>&nbsp;&nbsp;&nbsp;
					<span style="color: #26722e;" *ngIf="pprSearchForm.value.masterbusinesssegment_name !=''"><label style="color: black;">Business :</label>{{pprSearchForm.value.businesscontrol?.name}}</span>&nbsp;&nbsp;&nbsp;
					<span style="color: #26722e;" *ngIf="pprSearchForm.value.bs_name !=''"><label style="color: black;">BS :</label>{{pprSearchForm.value.bs_id?.name}}</span>&nbsp;&nbsp;&nbsp;
					<span style="color: #26722e;" *ngIf="this.pprSearchForm.value.cc_name!=''"><label style="color: black;">CC :</label>{{pprSearchForm.value.cc_id?.name}}</span>&nbsp;&nbsp;&nbsp;
					<span>
						<label style="color: black;">Download:</label>
						<a class="btn-lg" type="submit" style="border-radius: 40px;" (click)="budget_builder_xlsx()">
							<i matTooltip="Download" class="fa fa-download" aria-hidden="true"></i>
						</a>
					</span>
				</div>

				<div style="height: 400px;overflow: auto;" [hidden]=headercheckone>

					<form [formGroup]="buildermonthForm">
						<table id="budgetbuilder" class="table table-bordered" fixed-header>

							<thead style="top:0;position: sticky;">
								<tr style="top:0;position: sticky;padding: 5px;">
									<th rowspan="2" style="background-color: #dae5f4;
					color: black;">Direct Cost</th>
									<th colspan="3" style="text-align: center; background-color: #b8d1f3;">YTD</th>
									<th colspan="3" style="text-align: center; background-color: #dae5f4;">Apr </th>
									<th colspan="3" style="text-align: center; background-color: #b8d1f3;">May </th>
									<th colspan="3" style="text-align: center; background-color: #dae5f4;">Jun </th>
									<th colspan="3" style="text-align: center;background-color: #b8d1f3;">Jul </th>
									<th colspan="3" style="text-align: center; background-color: #dae5f4;">Aug </th>
									<th colspan="3" style="text-align: center;background-color: #b8d1f3;">Sep</th>
									<th colspan="3" style="text-align: center;    background-color: #dae5f4;">Oct </th>
									<th colspan="3" style="text-align: center;background-color: #b8d1f3;">Nov </th>
									<th colspan="3" style="text-align: center;    background-color: #dae5f4;">Dec </th>
									<th colspan="3" style="text-align: center;background-color: #b8d1f3;">Jan </th>
									<th colspan="3" style="text-align: center;     background-color: #dae5f4;">Feb </th>
									<th colspan="3" style="text-align: center;background-color: #b8d1f3;">Mar </th>
									


								</tr>
								<tr>
									<!-- 1 -->
									<!-- <th  style='border:none;'></th> -->
									<th style="text-align: center; background-color: #b8d1f3;">Bgt {{firstyear-1}}</th>
									<th style="text-align: center; background-color: #b8d1f3;">Act {{firstyear-1}}</th>
									<th style="text-align: center;width: 40px; background-color: #b8d1f3;">Bgt {{firstyear}}</th>
									<!-- 2 -->
									<th style="text-align: center;    background-color: #dae5f4;">Bgt {{firstyear-1}}</th>
									<th style="text-align: center;    background-color: #dae5f4;">Act {{firstyear-1}}</th>
									<th style="text-align: center;width: 40px;    background-color: #dae5f4;">Bgt {{firstyear}}</th>
									<!-- 3 -->
									<th style="text-align: center;background-color: #b8d1f3;">Bgt {{firstyear-1}}</th>
									<th style="text-align: center;background-color: #b8d1f3;">Act {{firstyear-1}}</th>
									<th style="text-align: center;width: 40px;background-color: #b8d1f3;">Bgt {{firstyear}}</th>
									<!-- 4 -->
									<th style="text-align: center;    background-color: #dae5f4;">Bgt {{firstyear-1}}</th>
									<th style="text-align: center;    background-color: #dae5f4;">Act {{firstyear-1}}</th>
									<th style="text-align: center;width: 40px;    background-color: #dae5f4;">Bgt {{firstyear}}</th>
									<!-- 5 -->
									<th style="text-align: center;background-color: #b8d1f3;">Bgt {{firstyear-1}}</th>
									<th style="text-align: center;background-color: #b8d1f3;">Act {{firstyear-1}}</th>
									<th style="text-align: center;background-color: #b8d1f3;">Bgt {{firstyear}}</th>
									<!-- 6 -->
									<th style="text-align: center;    background-color: #dae5f4;">Bgt {{firstyear-1}}</th>
									<th style="text-align: center;    background-color: #dae5f4;">Act {{firstyear-1}}</th>
									<th style="text-align: center;    background-color: #dae5f4;">Bgt {{firstyear}}</th>
									<!-- 7 -->
									<th style="text-align: center;background-color: #b8d1f3;">Bgt {{firstyear-1}}</th>
									<th style="text-align: center;background-color: #b8d1f3;">Act {{firstyear-1}}</th>
									<th style="text-align: center;background-color: #b8d1f3;">Bgt {{firstyear}}</th>
									<!-- 8 -->
									<th style="text-align: center;    background-color: #dae5f4;">Bgt {{firstyear-1}}</th>
									<th style="text-align: center;    background-color: #dae5f4;">Act {{firstyear-1}}</th>
									<th style="text-align: center;    background-color: #dae5f4;">Bgt {{firstyear}}</th>
									<!-- 9 -->
									<th style="text-align: center;background-color: #b8d1f3;">Bgt {{firstyear-1}}</th>
									<th style="text-align: center;background-color: #b8d1f3;">Act {{firstyear-1}}</th>
									<th style="text-align: center;background-color: #b8d1f3;">Bgt {{firstyear}}</th>
									<!-- 10 -->
									<th style="text-align: center;    background-color: #dae5f4;">Bgt {{firstyear-1}}</th>
									<th style="text-align: center;    background-color: #dae5f4;">Act {{firstyear-1}}</th>
									<th style="text-align: center;    background-color: #dae5f4;">Bgt {{firstyear}}</th>
									<!-- 11 -->
									<th style="text-align: center;background-color: #b8d1f3;">Bgt {{firstyear}}</th>
									<th style="text-align: center;background-color: #b8d1f3;">Act {{firstyear}}</th>
									<th style="text-align: center;background-color: #b8d1f3;">Bgt {{firstyear+1}}</th>
									<!-- 12 -->
									<th style="text-align: center;    background-color: #dae5f4;">Bgt {{firstyear}}</th>
									<th style="text-align: center;    background-color: #dae5f4;">Act {{firstyear}}</th>
									<th style="text-align: center;    background-color: #dae5f4;">Bgt {{firstyear+1}}</th>
									<!-- 13 -->
									<th style="text-align: center;background-color: #b8d1f3;">Bgt {{firstyear}}</th>
									<th style="text-align: center;background-color: #b8d1f3;">Act {{firstyear}}</th>
									<th style="text-align: center;background-color: #b8d1f3;">Bgt {{firstyear+1}}</th>
									
								</tr>
							</thead>

							<tbody>
								<tr *ngFor="let ppr of summarydata; index as i">
									<td [ngStyle]="{'padding':ppr.Padding,'padding-left':ppr.Padding_left}" style="background-color: #dae5f4;
					">
										<div *ngIf="supplier_chkval=='Y'">
											<div *ngIf="ppr.Padding_left!='120px'"> <a style="color: blue;"
													class="ng-binding"
													(click)="treelevel_click(i,ppr,summarydata,'mon')">
													{{ppr.name}}</a></div>
											<div *ngIf="ppr.Padding_left=='120px'">{{ppr.name}}</div>
										</div>
										<div *ngIf="supplier_chkval=='N'">
											<div *ngIf="ppr.Padding_left!='120px' && ppr.name!=''">

												<a *ngIf="ppr.name!='Total :' " style="color: blue;" class="ng-binding"
													(click)="treelevel_click(i,ppr,summarydata,'mon')">
													{{ppr.name}}</a>					
								 	<div *ngIf="ppr?.name=='Total :'" style="color: black;">
										{{ppr.name}}
									</div>
											</div>
											<div *ngIf="ppr.Padding_left=='120px' && ppr.new_data=='N'">{{ppr.name}}

											</div> 
										</div>
									</td>
								
									<td style="background-color: #b8d1f3;">
										<div style="overflow: auto;text-align:right;">{{ppr.YTD[0]}}</div>

									</td>
									<td style="background-color: #b8d1f3;">
										<div style="overflow: auto;text-align: right;">{{ppr.YTD[1]}}</div>
									</td>
									<td style="background-color: #b8d1f3;">
										
										<div style="overflow: auto;" >
											{{ppr.YTD[2]}}</div>
										
									</td>
									<td style="    background-color: #dae5f4;">
										<div style="overflow: auto; text-align: right;">{{ppr.Apr[0]}}</div>
									</td>
									<td style="    background-color: #dae5f4;">
										<div style="overflow: auto;text-align: right;">{{ppr.Apr[1]}}</div>
									</td>
									<td style="    background-color: #dae5f4;">
										<div style="overflow: auto;" >
											{{ppr.Apr[2]}}</div>
										
									</td>
									<td style="background-color: #b8d1f3;">
										<div style="overflow: auto;text-align: right;">{{ppr.May[0]}}</div>
									</td>
									<td style="background-color: #b8d1f3;">
										<div style="overflow: auto;text-align: right;">{{ppr.May[1]}}</div>
									</td>
									<td style="background-color: #b8d1f3;">
										<div style="overflow: auto;" >
											{{ppr.May[2]}}</div>
										
									</td>
									<td style="    background-color: #dae5f4;">
										<div style="overflow: auto;text-align: right;">{{ppr.Jun[0]}}</div>
									</td>
									<td style="    background-color: #dae5f4;">
										<div style="overflow: auto;text-align: right;">{{ppr.Jun[1]}}</div>
									</td>
									<td style="    background-color: #dae5f4;">
										<div style="overflow: auto;">
											{{ppr.Jun[2]}}</div>
										
									</td>
									<td style="background-color: #b8d1f3;">
										<div style="overflow: auto;text-align: right;">{{ppr.Jul[0]}}</div>
									</td>
									<td style="background-color: #b8d1f3;">
										<div style="overflow: auto;text-align: right;">{{ppr.Jul[1]}}</div>
									</td>
									<td style="background-color: #b8d1f3;">
										<div style="overflow: auto;" >
											{{ppr.Jul[2]}}</div>
										
									</td>

									<td style="    background-color: #dae5f4;">
										<div style="overflow: auto;text-align: right;">{{ppr.Aug[0]}}</div>
									</td>
									<td style="    background-color: #dae5f4;">
										<div style="overflow: auto;text-align: right;">{{ppr.Aug[1]}}</div>
									</td>
									<td style="    background-color: #dae5f4;">
										<div style="overflow: auto;" >
											{{ppr.Aug[2]}}</div>
									
									</td>
									<td style="background-color: #b8d1f3;">
										<div style="overflow: auto;text-align: right;">{{ppr.Sep[0]}}</div>
									</td>
									<td style="background-color: #b8d1f3;">
										<div style="overflow: auto;text-align: right;">{{ppr.Sep[1]}}</div>
									</td>
									<td style="background-color: #b8d1f3;">
										<div style="overflow: auto;">
											{{ppr.Sep[2]}}</div>
										
									</td>
									<td style="    background-color: #dae5f4;">
										<div style="overflow: auto;text-align: right;">{{ppr.Oct[0]}}</div>
									</td>
									<td style="    background-color: #dae5f4;">
										<div style="overflow: auto;text-align: right;">{{ppr.Oct[1]}}</div>
									</td>
									<td style="    background-color: #dae5f4;">
										<div style="overflow: auto;" >
											{{ppr.Oct[2]}}</div>
										
									</td>
									<td style="    background-color: #b8d1f3;">
										<div style="overflow: auto;text-align: right;">{{ppr.Nov[0]}}</div>
									</td>
									<td style="background-color: #b8d1f3;">
										<div style="overflow: auto;text-align: right;">{{ppr.Nov[1]}}</div>
									</td>
									<td style="background-color: #b8d1f3;">
										<div style="overflow: auto;" >
											{{ppr.Nov[2]}}</div>
										
									</td>
									<td style=" background-color: #dae5f4;">
										<div style="overflow: auto;text-align: right;">{{ppr.Dec[0]}}</div>

									</td>
									<td style=" background-color: #dae5f4;">
										<div style="overflow: auto;text-align: right;">{{ppr.Dec[1]}}</div>
									</td>
									<td style=" background-color: #dae5f4;">
										<div style="overflow: auto;">
											{{ppr.Dec[2]}}</div>
										
									</td>
									<td style="background-color: #b8d1f3;">
										<div style="overflow: auto;text-align: right;">{{ppr.Jan[0]}}</div>
									</td>
									<td style="background-color: #b8d1f3;">
										<div style="overflow: auto;text-align: right;">{{ppr.Jan[1]}}</div>
									</td>
									<td style="background-color: #b8d1f3;">
										<div style="overflow: auto;" >{{ppr.Jan[2]}}</div>
										
									</td>
									<td style=" background-color: #dae5f4;">
										<div style="overflow: auto;text-align: right;">{{ppr.Feb[0]}}</div>
									</td>
									<td style=" background-color: #dae5f4;">
										<div style="overflow: auto;text-align: right;">{{ppr.Feb[1]}}</div>
									</td>
									<td style=" background-color: #dae5f4;">
										<div style="overflow: auto;" >{{ppr.Feb[2]}}</div>
										
									</td>
									<td style="background-color: #b8d1f3;">
										<div style="overflow: auto;text-align: right;">{{ppr.Mar[0]}}</div>
									</td>
									<td style="background-color: #b8d1f3;">
										<div style="overflow: auto;text-align: right;">{{ppr.Mar[1]}}</div>
									</td>
									<td style="background-color: #b8d1f3;">
										<div style="overflow: auto;">{{ppr.Mar[2]}}</div>
										
									</td>
									
								</tr>


							</tbody>

						</table>
					</form>
				</div>

				<div *ngIf="summarydata ?.length == 0" style="margin-left: 42%;">
					<h3>Sorry data not found!.. </h3>
				</div>
				<div [hidden]=headercheck style="height: 400px;overflow: auto;">
					<form [formGroup]="buildermonthForm1">
						<table class="table table-bordered" fixed-header>

							<thead style="top:0;position: sticky;">
								<tr>
									<th rowspan="2">Direct Cost</th>
									<th colspan="3" style="text-align: center;">YTD </th>
									<th colspan="3" style="text-align: center;">Quarterly-1 </th>
									<th colspan="3" style="text-align: center;">Quarterly-2</th>
									<th colspan="3" style="text-align: center;">Quarterly-3</th>
									<th colspan="3" style="text-align: center;">Quarterly-4 </th>

								</tr>
								<tr>
									<!-- 1 -->
									<th>Bgt-{{firstyear}}</th>
									<th>Act-{{firstyear}}</th>
									<th>Bgt {{firstyear}}-{{lastyear}}</th>
									<!-- 2 -->
									<th>Bgt-{{firstyear}}</th>
									<th>Act-{{firstyear}}</th>
									<th>Bgt {{firstyear}}-{{lastyear}}</th>
									<!-- 3 -->
									<th>Bgt-{{firstyear}}</th>
									<th>Act-{{firstyear}}</th>
									<th>Bgt {{firstyear}}-{{lastyear}}</th>
									<!-- 4 -->
									<th>Bgt-{{firstyear}}</th>
									<th>Act-{{firstyear}}</th>
									<th>Bgt {{firstyear}}-{{lastyear}}</th>
									<!-- 5 -->
									<th>Bgt-{{firstyear}}</th>
									<th>Act-{{firstyear}}</th>
									<th>Bgt {{firstyear}}-{{lastyear}}</th>
								</tr>
							</thead>
							<tbody>

							</tbody>
						</table>
					</form>

					<div *ngIf="summarydata ?.length == 0" style="margin-left: 42%;">
						<h3>Sorry data not found!.. </h3>
					</div>


				</div>				
					<div class="modal-footer">
					
						<button type="button" class="btn btn-outline-dark" #closepopup data-dismiss="modal">
						Close
					</button></div>
				
			</div>
		</div>
	</div>

	<!-- <pre>
		{{buildermonthForm.value | json}}
	</pre> -->
