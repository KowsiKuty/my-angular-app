<mat-card>
   <h2 style="color: blue;margin-left: 35px;font-family: 'Times New Roman', Times, serif;font-size: 23px;">AMC & Warranty Summary</h2>
   <hr>
   <form [formGroup]="assetgroupform" >
      <div class="row" class="col-md-12">
         
            <mat-form-field style="width: 200px;margin-left: 35px">
               <mat-label>AMC/WAR Code</mat-label>
               <input matInput placeholder="Asset" formControlName="amc_code"  #assetidInput 
               autocomplete="off" (keypress)="kyenbdata($event)">
            </mat-form-field>
            
       
            <mat-form-field  style="width: 200px;margin-left: 40px;">
               <mat-label>Header Name</mat-label>
               <input class="toolbar-search" type="text" matInput autocomplete="off" matInput   formControlName="header_name" style="width:250px" (keypress)="kyenbdata($event)">
            </mat-form-field>
           
         
                   
         <mat-form-field style="margin-left: 35px;width:200px">
             <mat-label>Vendor Name</mat-label>
             <input class="toolbar-search" type="text" matInput autocomplete="off" [matAutocomplete]="checkersupplier" #vendorInput formControlName="vendor" style="width: 300px;" />
            
             <mat-autocomplete #checkersupplier="matAutocomplete" #vendor [displayWith]="vendorinterface" (opened)="autocompletesupname()">
                 <mat-option *ngIf="isLoading">Loading..</mat-option>
             <ng-container *ngIf="!isLoading">
                 <mat-option title="{{d.code+' - '+d.name}}"*ngFor="let d of vendorList" [value]="d" >
                     {{d.code+' - '+d.name}}
                 </mat-option>
             </ng-container> 
             </mat-autocomplete>
         </mat-form-field>
         <mat-form-field style="width: 200px; margin-left: 35px;">
            <mat-label>Asset Barcode </mat-label>
            <input matInput placeholder="Asset" formControlName="asset_id"  [matAutocomplete]="autoasset" #assetidInput autocomplete="off"   />
            <mat-autocomplete #autoasset="matAutocomplete" >
                <mat-option *ngIf="isLoading">Loading..</mat-option>
                <ng-container *ngIf="!isLoading">
                    <mat-option *ngFor="let d of assetidList" [value]="d.barcode">{{d.barcode}}</mat-option>
                </ng-container>
            </mat-autocomplete>
        </mat-form-field>
</div>
<div class="row" class="col-md-12">
        
         <mat-form-field class="example-full-width" style="margin-left: 35px;width: 200px;">
            <mat-label>Product Name</mat-label>
         <input class="toolbar-search" type="text" matInput autocomplete="off" matInput  [matAutocomplete]="checkerproduct"  formControlName="asset_name" >
            <mat-placeholder>Product Name</mat-placeholder>
            <mat-autocomplete #checkerproduct="matAutocomplete" #product [displayWith]="assetnameinterface" (opened)="autocompleteproductname()">
               <mat-option *ngIf="isLoading">Loading..</mat-option>
               <ng-container *ngIf="!isLoading">
                  <mat-option  title="{{d.name}}"*ngFor="let d of productlist" [value]="d" >
                  {{d.name}}
                  </mat-option>
               </ng-container> 
            </mat-autocomplete> 
         </mat-form-field>
      

         
         
         <mat-form-field style="width: 200px;margin-left: 35px ">
            <mat-label>Status </mat-label>
           <!-- <input matInput placeholder="status" formControlName="status"  />-->
            <mat-select formControlName="status">
                <mat-option value="PENDING">PENDING</mat-option>
                <mat-option value="APPROVED">APPROVED</mat-option>
                <mat-option value="REJECTED">REJECTED</mat-option>
                <mat-option value="PENDING_FOR_RENEWAL">PENDING FOR RENEWAL</mat-option>
                <mat-option value="RENEWAL_APPROVED">RENEWAL APPROVED</mat-option>
                <mat-option value="EXPIRED">EXPIRED</mat-option>
                <mat-option value="RENEWAL_REJECTED">RENEWAL_REJECTED</mat-option>
            </mat-select>
        </mat-form-field>
         
      
         <mat-form-field  style="margin-left: 35px;width: 200px;">
             <mat-label>Branch</mat-label>
             <input class="toolbar-search" type="text" matInput autocomplete="off" #branchidInput [matAutocomplete]="branchref" formControlName="branch" style="width: 250px;" (keypress)="kyenbdata($event)"/>
             <mat-autocomplete #branchref="matAutocomplete" [displayWith]="branchintreface" (opened)="autocompletebranchname()">
                 <mat-option *ngIf="isLoading">Loading..</mat-option>
                 <ng-container *ngIf="!isLoading">
                     <mat-option  title="{{d.code+' - '+d.name}}" *ngFor="let d of branchList" [value]="d">{{d.code+' - '+d.name}}</mat-option>
                 </ng-container>
             </mat-autocomplete>
         </mat-form-field>
     
     
      
     
           <button type="button" (click)="searchdataapi()" matTooltip="Search" class="btn btn-outline-success" style="border-radius: 40px;margin-left: 20px;">Search</button>
           <button type="button" (click)="resetdata()" matTooltip="Reset"  class="btn btn-outline-danger" style="border-radius: 40px;margin-left: 10px;">Reset</button>
       </div>
        <div class="row" class="col-md-12">
           <button
            style="margin-left: 35px;border-radius:40px" mat-raised-button class="btn btn-success"
               matTooltip="Create AMC"
              (click)="createAMC()"
              >AMC
              <mat-icon matSuffix>add</mat-icon>
           </button>
           <button
           style="margin-left: 10px;border-radius:40px"    matTooltip="Create Warranty" mat-raised-button class="btn btn-success"
               (click)="createWarranty()" 
              >WARRANTY
              <mat-icon matSuffix>add</mat-icon>
           </button>
           <button
           style="margin-left: 10px;border-radius:40px" mat-raised-button class="btn btn-success"
              matTooltip="Renewal AMC"
             (click)="Renewalamc()"
             >Renewal AMC
             <mat-icon matSuffix>add</mat-icon>
          </button>
           <button mat-raised-button type="button" class="btn btn-primary"  (click)="amc_war_summary_Download()"  style="border-radius: 40px;height: 40px;margin-left: 10px;">
              Download
                  <mat-icon *ngIf="first"><mat-spinner color="green" diameter="20">
                  </mat-spinner></mat-icon>
                  <mat-icon *ngIf="!first" inline=true style="color:rgb(245, 245, 245)">download</mat-icon>
          </button>
          
          <button mat-raised-button type="button" class="btn btn-primary"  style="border-radius: 40px;margin-left: 4%;" data-target="#tranpopups" data-toggle="modal">
            SMS Maker Upload
                <mat-icon *ngIf="second"><mat-spinner color="green" diameter="20">
                </mat-spinner></mat-icon>
                <mat-icon *ngIf="!second" inline=true style="color:rgb(245, 245, 245)">upload</mat-icon>
        </button>
        <button type="button" routerLink="/sms/smstransaction" class="btn btn-outline-primary" style="border-radius: 40px;margin-left: 40px;">Back</button>         
         </div>
   </form>
   <div  style="margin-left: 30px;font-size: 14px;">
     
         
         <table class="table table-bordered table-responsive" style="width: 97%;margin-top:2%">
            <thead class="table_header" >
               <tr>
                  <th>S.No <button mat-icon-button [ngClass]="glclr==false?'able':'disable'" matTooltip="asce" style="text-align: right;margin-bottom: 5%;" color="primary"
                     (click)="getamcascedesc('asce',1)"><mat-icon >arrow_upward</mat-icon></button>
                     <button mat-icon-button [ngClass]="glclr1==false?'able':'disable'" matTooltip="dece" style="text-align: right;margin-bottom: 5%;" color="primary"
                     (click)="getamcascedesc('desc',2)"><mat-icon >arrow_downward</mat-icon></button></th>
                  <th>AMC/WAR Code</th>
                 <!-- <th>Asset ID</th>-->
                  <!-- <th>Maker Name</th> -->
                  <th>Header Name</th>
                  <!-- <th>Header Type</th> -->
                  <th>Branch Name</th>
                  <th>Supplier Name</th>
                  <!-- <th>Asset Barcode</th> -->
                  <!-- <th>Product Name</th> -->
                  <th>Service Period From Date</th>
                  <th>Service Period To Date</th>
                  <th>Asset Category</th>
                  <th>Total Amount</th>
                  <th>Status</th>
                  <th>Action</th>
               </tr>
            </thead>
            <tbody >
               <tr  *ngFor="let assetcat of listcomments; index as listIndex" >
               <th scope="row">{{ (presentpagebuk-1)*pageSize+listIndex+1 }}</th>
               <td>{{assetcat.amcheader_code}}</td>
               <!-- <td>{{assetcat.id}}</td>-->
               <!-- <td></td> -->
               <td>{{assetcat.amcheader_name}}</td>
               <!-- <td>{{assetcat.amcheader_type}}</td> -->
               <td>{{assetcat.branch_name.code+' - '+assetcat.branch_name.name}}</td>
               <td style="width: 250px;">{{assetcat.supplier_name}}</td>
               <!-- <td>{{assetcat.barcode}}</td> -->
               <!-- <td>{{assetcat.product.name}}</td>  -->
               <td>{{assetcat.amcheader_period_from | date:'dd-MMM-yyyy' }}</td>
               <td>{{assetcat.amcheader_period_to | date:'dd-MMM-yyyy'}}</td>
               <td>{{assetcat.apcategory?assetcat.apcategory.name:'-'}}
               <td>{{assetcat.amcheader_amctotalamt|  number:'1.2-2'}}</td>
               <td>{{assetcat.status}}</td>
               <td style="width: 100px;">
                  <button mat-icon-button color="primary" (click)="clicktoview(assetcat)">
                     <mat-icon matTooltip="Click to View">visibility</mat-icon>
                  </button>
                  <!-- <button mat-icon-button matTooltip="Click to Edit" class="iconbutton" 
                  (click)="clicktoedit(assetcat)" >
                  <mat-icon style="color: rgb(138, 15, 220);">edit</mat-icon>
              </button> -->
                  <!-- <button mat-icon-button color="success" matTooltip="Click to Active" [ngClass]="assetcat.status=='Inactive'?'inactive':'active'"
                     aria-label="arrow back icon" (click)="active()" aria-label="Example icon button with a home icon">
                     <mat-icon>wb_sunny</mat-icon>
                  </button> -->
                  <!-- <button mat-icon-button color="success" matTooltip="Edit"
                     aria-label="arrow back icon" (click)="editdata(assetcat)" aria-label="Example icon button with a home icon">
                     <mat-icon>create</mat-icon>
                  </button> -->
               </td>
            </tbody>
            <tfoot>
               <td class="text-left" colspan="3">
                  <span>Total Count:<br/> <b
                     class="text-centre"> {{listcomments[0]?.count}}</b></span>
               </td>
          
         <td class="text-right" colspan="7">
        
               <button mat-icon-button [disabled]="has_previousbuk === false" color="primary"
               (click)=" bukpreviousClick()">
               <mat-icon>arrow_back</mat-icon>
               </button>
               {{presentpagebuk}}
               <button mat-icon-button [disabled]="has_nextbuk === false" color="primary" (click)=" buknextClick()">
               <mat-icon>arrow_forward</mat-icon>
               </button>
               <!-- <pagination-controls  id="listing_pagination" maxSize="9" directionLinks="true" (pageChange)="page = $event"></pagination-controls>
               <pagination-controls (pageChange)="pageChange($event)" class="my-pagination"></pagination-controls> -->
            <!-- </div/ -->
         </td>
         </tfoot>
      </table>
         <!-- </div> -->
      </div>
  
</mat-card>
<ngx-spinner
   bdOpacity = 0.9
   bdColor = "rgba(51,51,51,0.8)"
   size = "default"
   color = "#fff"
   type = "ball-scale-multiple"
   [fullScreen] = "false">
   <p style="font-size: 20px; color: white">Loading...</p>
</ngx-spinner>
<br>
<br>
<ng-template #viewdata>
   <div class="card">
        <div class="card-header" style="background-color: rgb(165, 199, 165);position: sticky;">
           <h1>Asset Details</h1>
        </div>
        <div style="margin-left: 30px; margin-top: 30px; font-size: 14px;">
           <h3> <b> Supplier Name &nbsp;&nbsp;:&nbsp;{{summary_supplier}}</b></h3>
           <h3> <b>Total &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
              &nbsp;&nbsp;:&nbsp;{{summary_amount|  number:'1.2-2'}}</b></h3>
        </div>
        <div class="card-body" style="height: 400px;overflow-y: auto;">
           <table class="table table-bordered">
              <thead class="table_header">
                 <tr>
                    <th>S.No</th>
                    <th>Branch Name</th>
                    <th>Product Name</th>
                    <th>Asset Barcode</th>
                    <th>Asset Category</th>
                    <th>Asset Serial Number</th>
                    <th>Details Amount</th>
                 </tr>
              </thead>
              <tbody>
               <tr *ngFor="let d of summarydata;let i=index"> 
                    <td>{{(presentpagenew-1)*viewsize+i+1}}</td>
                    <td>{{d['branch_id'].code+' - '+d['branch_id'].name}}</td>
                    <td>{{d['product_id'].name}}</td>
                    <td>{{d.assetdetails_id}}</td>
                    <td>{{d.apcategory?d.apcategory.name:'-'}}</td>
                    <td>{{d.assetserialno ?d.assetserialno:'-'}}</td>
                    <td>{{d.amount|  number:'1.2-2'}}</td>
               </tr>
               <td class="text-right" colspan="7">
                    <div class="col-sm-12" style="font-size: small; text-align: right;">
                        <button mat-icon-button [disabled]="!has_previousnew" color="primary" (click)="newpreviousClick()">
                            <mat-icon>arrow_back</mat-icon>
                      </button>
                        {{presentpagenew}}
                       <button mat-icon-button [disabled]="!has_nextnew" color="primary" (click)="newnextClick()">
                            <mat-icon>arrow_forward</mat-icon>
                        </button>
                    </div>
                </td>
                 <tr *ngIf="summarydata.length==0">
                    <td colspan="5">
                          No Records Found..
                    </td>
                 </tr>
                 <!-- <tr>
                    <td colspan="5">
                       <div style="float: right;">
                             <button type="button" mat-icon-button [disabled]="!view_has_next"><mat-icon>arrow_back</mat-icon></button>
                             {{viewpage}}
                             <button type="button" mat-icon-button [disabled]="!view_has_pre"><mat-icon>arrow_forward</mat-icon></button>
                          </div>
                    </td>
                 </tr> -->
              </tbody>
           </table>
         
           <div class="card-header" style="background-color: rgb(165, 199, 165);position: sticky;">
            <h1>SMS Maker File Attachments Details</h1>
         </div>
      <div class="card-body" style="height: 400px;overflow-y: auto;">
         <table class="table table-bordered">
            <thead class="table_header">
               <tr>
                  <th>S.No</th>
                  <th>File Name </th>
                  <th>View file</th>
                  <th>Download file</th>
               </tr>

            </thead>
            <tbody>
               <tr *ngFor="let d of filedatalist;let j=index"> 
                  <td>{{(viewpage1-1)*viewsize1+j+1}}</td>
                  <td>{{d.name}}</td>
                  <td> <button mat-icon-button color="primary"  data-target="#my-modal" data-toggle="modal" (click)="maker_view_file(d.id,d.name)">
                     <mat-icon matTooltip="Click to Maker File View">visibility</mat-icon>
                  </button></td>
                  <td> <button  mat-icon-button color="primary"  (click)="maker_download_file(d.id,d.name)" >
                    
                        
                           
                     <mat-icon matTooltip="Click to Maker File Download" >download</mat-icon></button>

                  </td>
               </tr>
                     <tr *ngIf="filedatalist.length==0">
                     <td colspan="4">
                           No Records Found..
                     </td>
                     </tr>

            

            

                  
                  
              </tbody>

           </table>
         </div>
         <div class="card-header" style="background-color: rgb(165, 199, 165);position: sticky;">
            <h1>SMS Approval File Attachments Details</h1>
         </div>
      <div class="card-body" style="height: 400px;overflow-y: auto;">
         <table class="table table-bordered">
            <thead class="table_header">
               <tr>
                  <th>S.No</th>
                  <th>File Name </th>
                  <th>View file</th>
                  <th>Download file</th>
               </tr>

            </thead>
            <tbody>
               <tr *ngFor="let d of approverfiledatalist;let j=index"> 
                  <td>{{(viewpage1-1)*viewsize1+j+1}}</td>
                  <td>{{d.name}}</td>
                  <td> <button mat-icon-button color="primary"  data-target="#my-modal" data-toggle="modal" (click)="maker_view_file(d.id,d.name)">
                     <mat-icon matTooltip="Click to Approver File View">visibility</mat-icon>
                  </button></td>
                  <td> <button  mat-icon-button color="primary"  (click)="maker_download_file(d.id,d.name)" >
                        
                           
                     <mat-icon  matTooltip="Click to Approver File Download" >download</mat-icon></button>

                  </td>
               </tr>
                     <tr *ngIf="filedatalist.length==0">
                     <td colspan="4">
                           No Records Found..
                     </td>
                     </tr>

            

            

                  
                  
              </tbody>

           </table>
         </div>
        </div>
        
        <div style="text-align: center;">
           <button type="button" mat-raised-button (click)="closedata()">Cancel</button>
        </div>
   </div>
   <ng-template #viewfiledata>
      <div *ngIf="pdfview">
          <div style="float: right;">
              <button type="button" mat-icon-button (click)="zoom_in()"><mat-icon>zoom_in</mat-icon></button>
              <button type="button" mat-icon-button (click)="zoom_out()"><mat-icon>zoom_out</mat-icon></button>
          </div>
          <pdf-viewer *ngIf="pdfSrc !=undefined" [src]="pdfSrc"
              [render-text]="true"
              [original-size]="false"
              [zoom]="zoom_to"
              style="width: 795px; height: 318px">
          </pdf-viewer>
      </div>
      <div *ngIf="imgview">
          <img [src]="imgurl" alt="Failed To Load">
      </div>
      <div class="text-right">
          <button type="button" class="btn btn-outline-danger" (click)="closedialogdata()">Close</button>
      </div>
  </ng-template>
</ng-template>
      
<div *ngIf="showimageHeaderAPI" id="my-modal" class="modal fade" aria-labelledby="my-modalLabel" aria-hidden="true"
   tabindex="-1" role="dialog">
   <div class="modal-dialog modal-xl" data-dismiss="modal" style="width: 60%;height: 80%;">
         <div class="modal-content">
            <div class="modal-header" style="background:#e6ffe6">
               <h2 class="modal-title">SMS Attachments</h2>
                     <button type="button" class="text-right" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                     </button>
            </div>
            <div class="modal-body">
               <img src="{{jpgUrlsAPI}}" class="img-responsive" style="width: 100%;">
            
            </div>
         </div>
   </div>
</div>
<div *ngIf="showimagepdf" id="my-modal" class="modal fade" aria-labelledby="my-modalLabel" aria-hidden="true"
   tabindex="-1" role="dialog">
   <div class="modal-dialog modal-xl">
         <div class="modal-content">
            <div class="modal-header" style="background:#e6ffe6">
               <h2 class="modal-title">SMS Attachments</h2>
               <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                     <span aria-hidden="true">&times;</span>
               </button>
            </div>
            <pdf-viewer [src]="pdfurl" [original-size]="false" [render-text]='false' [show-borders]="true"
               [fit-to-page]="true" [show-all]="true" style="display: block; height: 600px;" [fit-to-page]="true">
            </pdf-viewer>
         </div>
   </div>
</div>
<div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true"
id="tranpopups">
<div class="modal-dialog modal-xl " style="width: 93%;">
<from [formGroup]="smsbulkuploadform" autocomplete="off">
    <div class="modal-content">
        <div class="modal-header"  style="background:rgba(23, 204, 23, 0.288);">
            <h2 class="modal-title" style="color:black ;text-align: center;font-weight: bold;"> SMS Maker Bulk Upload</h2>
            <button type="button" class="close" data-dismiss="modal" #closebutton aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div style="margin-left: 50px;margin-right: 80%;margin-top: 2%; width: 90%;">
            <div>
                <div class="row">
                    <div class="table-responsive" style="width:100%;margin-top: 1%;">
                        <table class="table table-bordered" fixed-header style="width: 99%;margin-top: 10px;">
                            <thead class="table_header" style="text-align: left;">
                                <tr>
                                    <th>S.No</th>
                                    <th *ngIf="issmsmakerdownload">Template Upload</th>
                                    <th>Templated Download</th>
                                    <th>File Upload</th>
                                    <th>Action</th>
                                    
                                </tr>
                            </thead>
                            <tbody >
                                <tr>
                                    <td>1</td>
                                    <td *ngIf="issmsmakerdownload"><input type="file"  #fileInput2 (change)="smsmasterUpload($event,'sms_maker_upload')" class="app-master-class-dfs2yr">
                                    </td>
                                    <td>
                                       <button mat-raised-button type="button"   class="custom-button app-master-class-kyttl4"  (click)="SMSMakerTemplateDownload('sms_maker_template_download')">
                                           SMS Maker Template Download
                                               <mat-icon *ngIf="first"><mat-spinner color="accent" diameter="20">
                                               </mat-spinner></mat-icon>
                                               <mat-icon *ngIf="!first" inline=true class="app-master-class-0ksb0s">download</mat-icon>
                                           </button>
                                   </td>
                                    <td>
                                        <input type="file" #fileInput id="uploadFile" formcontrolname="images" accept=".xlsx, .csv"
                                          style="width:250px;margin-top: 10px;" (change)="getFileDetails_upload($event,fileInput.value)"/>
                        
                                    </td>
                                    <td>
                                        <button type="button"  class="btn btn-outline-success" #submitbutton style="border-radius:40px;margin-left: 15px;" (click)="submitfileupload()">Submit</button>
                                    </td>
                                   
                                   
                                </tr>
                                
                            </tbody>
        
                            
                            <!-- </tbody> -->
                        </table> 
                       
                    </div>
                    <tr>
                        <td>
                            <button type="button" class="btn btn-light" style="border-radius:7px;margin-left:450px;
                            border-color: black; margin-bottom: 20px;
                            background-color: white;" (click)="tranback()">Back</button>
                        </td>
                    </tr>
                </div>
            </div>
        </div>
    </div>
</from>
</div>
</div>
