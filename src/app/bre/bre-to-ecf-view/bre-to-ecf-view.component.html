<div style="width:100%">
    <mat-card style="margin-top: 13px;margin-left: 20px;margin-right: 20px;margin-bottom: 20px;">
        <div style="margin-left: 10px;margin-top: 1%; width: 100%;">

            <h2 style="font-weight:bold;">Claim Approve</h2>
            <div>
                <form [formGroup]="bretoEcfviewForm" style="margin-left:2%;" >
                    <table style="margin-bottom: 2%;">
                        <div>
                            <tr>
                                <td>


                                    <mat-form-field style="width:200px;margin-left:-25px;">
                                        <input matInput placeholder="Branch" formControlName="branch" value="{{bretoECFData?.branch?.code}} - {{bretoECFData?.branch?.name}}"
                                            autocomplete="off" readonly  matTooltip="{{bretoECFData?.branch?.code}} - {{bretoECFData?.branch?.name}}" matTooltipClass="custom-tooltipnew" id="bre-to-ecf-view-0005">
                                    </mat-form-field>
                                </td>

                                <td>
                                    <mat-form-field style="width:200px;margin-left: 50px;">
                                        <input matInput placeholder="Supplier" formControlName="supplier" value="{{bretoECFData?.supplier_id?.name}}" 
                                        matTooltip="{{bretoECFData?.supplier_id?.name}}" matTooltipClass="custom-tooltipnew"
                                            autocomplete="off" readonly id="bre-to-ecf-view-0006">
                                    </mat-form-field>
                                </td>
                                <td>
                                    <mat-form-field style="width:200px;margin-left: 50px;">
                                        <input matInput placeholder="Commodity" formControlName="commodity" value="{{bretoECFData?.commodity_id?.name}}" 
                                        matTooltip="{{bretoECFData?.commodity_id?.name}}" matTooltipClass="custom-tooltipnew"
                                            autocomplete="off" readonly id="bre-to-ecf-view-0007">
                                    </mat-form-field>
                                </td>
                                <td>
                                    <mat-form-field
                                    style="width:300px;margin-left: 50px;font-family: 'Times New Roman', Times, serif;">
                                    <input matInput placeholder="Raiser Branch" formControlName="rsrbranch" value="{{bretoECFData?.raiser_branch?.code}} - {{bretoECFData?.raiser_branch?.name}}"
                                        autocomplete="off" readonly matTooltip="{{bretoECFData?.raiser_branch?.code}} - {{bretoECFData?.raiser_branch?.name}}" matTooltipClass="custom-tooltipnew" id="bre-to-ecf-view-0008">
                                    </mat-form-field>

                                </td>
                                 <td >
                                    <button type="button" class="btn btn-outline-primary" style="border-radius:40px;height: 50px; margin-left : 50px;font-size: medium;"
                                        data-toggle="modal" data-target="#bre-to-ecf-view-0004" (click)="viewtrn()" id="bre-to-ecf-view-0009">View Transaction
                                        </button> 
                                </td> 
                            </tr>
                           
                           
                        </div>
                    </table>
                </form>
            </div>

            
            <h2 style="margin-left: 1px;font-weight:bold;">Invoice Header</h2>
            
            <div>
                <div class="table-responsive" style="width:95%;margin-top: 1%;">
                <table class="table table-bordered" fixed-header style="width: 94%;margin-top: 10px;">
                    <thead class="table_header" style="text-align: center;">
                        <tr style="background: #a7e4ab;">
                            <th>S.No</th>
                            <th>CR No</th>
                            <th>Supplier Name</th>
                            <th>Supplier State</th>
                            <th>Invoice No</th>
                            <th>Invoice Date</th>
                            <th>Taxable Amount</th>
                            <th>Tax Amount</th>
                            <th>Total Amount</th>
                            <th>Attachments</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="text-align: center;">{{1}}</td>
                            <td>{{bretoECFData?.crno}}</td>
                            <td>{{bretoECFData?.supplier_id?.name}}</td>
                            <td>{{bretoECFData?.supplierstate_id?.name}}</td>
                            <td>{{bretoECFData?.invoiceno}}</td>
                            <td>{{bretoECFData?.invoicedate | date:'dd-MMM-yyyy'}}</td>
                            <td style="text-align: end;">{{bretoECFData?.totalamount - bretoECFData?.taxamount}}</td>
                            <td style="text-align: end;">{{bretoECFData?.taxamount}}</td>
                            <td style="text-align: end;">{{bretoECFData?.totalamount}}</td>
                            <td>
                                <span matTooltip="view" matTooltipClass="custom-tooltipnew" class=" fa fa-eye create " *ngIf="filearr?.length > 0 "
                                    data-target="#bre-to-ecf-view-0001" data-toggle="modal"
                                    style="cursor: pointer;color:blue;margin-left: 30px;"></span>
                            </td>
                        </tr>
                    </tbody>
                </table>
                </div>
            </div>

            <h2 style="margin-left: 1px;font-weight:bold;">Debit  Details</h2>
            
            <div>
                <div class="table-responsive" style="width:95%;margin-top: 1%;">
                <table class="table table-bordered" fixed-header style="width: 94%;margin-top: 10px;">
                    <thead class="table_header" style="text-align: center;">
                        <tr style="background: #a7e4ab;">
                            <th>S.No</th>
                            <th>Category Code</th>
                            <th>Sub Category Code</th>
                            <th>GL No</th>
                            <th>BS Code</th>
                            <th>CC Code</th>
                            <th style="width: 100px;">CCBS Percentage</th>
                            <th>Amount</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let cc of bretoECFData?.bscc_detail?.data; index as i;">
                            <td style="text-align: center;">{{i+1}}</td>
                            <td>{{bretoECFData?.category_code?.code}}</td>
                            <td>{{bretoECFData?.subcategory_code?.code}}</td>
                            <td>{{bretoECFData?.glno}}</td>
                            <td>{{cc?.bs_code?.name}}</td>
                            <td>{{cc?.cc_code?.name}}</td>
                            <td style="width: 100px;">{{cc?.ccbspercentage}}</td>
                            <td style="text-align: end;">{{cc?.ccbs_amount}}</td>
                        </tr>
                    </tbody>
                </table>
                </div>
            </div>

            <h2 style="margin-left: 1px;font-weight:bold;">Credit Details</h2>
            
            <div>
                <div class="table-responsive" style="width:95%;margin-top: 1%;">
                <table class="table table-bordered" fixed-header style="width: 94%;margin-top: 10px;">
                    <thead class="table_header" style="text-align: center;">
                        <tr style="background: #a7e4ab;">
                            <th>S.No</th>
                            <th>Paymode</th>
                            <th>Account No</th>
                            <th>Bank Name</th>
                            <th>Branch Name</th>
                            <th>IFSC Code</th>
                            <th>Beneficiary Name</th>
                            <th>Amount</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="text-align: center;">{{1}}</td>
                            <td>{{bretoECFData?.supplier_detail?.data[0]?.paymode_id?.name}}</td>
                            <td>{{bretoECFData?.account_no}}</td>
                            <td>{{bretoECFData?.supplier_detail?.data[0]?.bank_id?.name}}</td>
                            <td>{{bretoECFData?.supplier_detail?.data[0]?.branch_id?.name}}</td>
                            <td>{{bretoECFData?.supplier_detail?.data[0]?.branch_id?.ifsccode}}</td>
                            <td>{{bretoECFData?.supplier_detail?.data[0]?.beneficiary}}</td>
                            <td style="text-align: end;">{{bretoECFData?.totalamount}}</td>
                        </tr>
                    </tbody>
                </table>
                </div>
            </div>
          
                <div *ngIf="bretoECFData?.apstatus?.id != 3 && bretoECFData?.apstatus?.id != 4">
                    <form [formGroup]="bretoEcfApproverForm">

                        <tr>                            
                        <td>      
                        <mat-form-field style="width: 150px;margin-left: 400px;">
                            <mat-label>Remarks<label style="color:red">*</label></mat-label>
                            <input matInput placeholder="Remarks" formControlName="remark" autocomplete="off"  id="bre-to-ecf-view-0010">
                        </mat-form-field>   
                        </td>
                
                     <button
                     style="border-radius:40px;margin-left: 10px;margin-bottom: 0px;"
                     class="btn btn-outline-success" (click)="Approve()" [disabled]="disabled" id="bre-to-ecf-view-0011">
                     Approve </button>
                    <button type="button"    class="btn btn-outline-danger" style="border-radius:40px;margin-left:10px;
                     margin-bottom: 0px; 
                    " (click)="Reject()" [disabled]="disabled" id="bre-to-ecf-view-0012">Reject</button> 
                   <button type="button"    class="btn btn-outline-primary" style="border-radius:40px;margin-left:10px;
                     margin-bottom: 0px;
                   " (click)="back()" id="bre-to-ecf-view-0013">Back</button>
                </tr>
                </form>
            </div>
            <div *ngIf="bretoECFData?.apstatus?.id == 3 || bretoECFData?.apstatus?.id == 4">
                <button type="button"    class="btn btn-outline-primary" style="border-radius:40px;margin-left:700px;
                margin-bottom: 0px;
              " (click)="back()" id="bre-to-ecf-view-0014">Back</button>
            </div>
        </div>
    </mat-card>

</div>

<div class="modal fade" tabindex="-1" role="dialog" data-backdrop="static" aria-labelledby="exampleModalLongTitle" aria-hidden="true" 
        id="bre-to-ecf-view-0001">
        <div class="modal-dialog modal-lg " style="width: 750px;">
            <div class="modal-content">
                <div class="modal-header" style="background: rgba(23, 204, 23, 0.288);">
                    <h2 class="modal-title" style="color:black ;text-align: center;font-weight: bold;">Attachments
                    </h2>
                    <button type="button" class="close" data-dismiss="modal" #closedbuttons aria-label="Close" id="bre-to-ecf-view-0015">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>

                <div style="margin-left: 25px;margin-top: 2%;margin-right: 25px; ">
                    <div class="container">
                        <div class="row">
                            <div class="table-responsive" style="width:100%;margin-top: 1%;">
                                <h3 style="font-weight: bold;">Attached Files</h3>
                                <table class="table table-bordered" fixed-header style="width: 99%;margin-top: 10px;">
                                    <thead class="table_header" style="text-align: left;background: #a7e4ab;">
                                    <tr>
                                        <th style="text-align: center;width: 100px;">S.No</th>
                                        <th style="text-align: center;width:350px">File Name</th>
                                        <th style="text-align: center;width:100px">View</th>
                                        <th style="text-align: center;">Download</th>   
                                    </tr>
                                    </thead>
                                    <tbody>
                                         <tr  *ngFor="let files of filearr; let index = index">
                                            <td style="text-align: center;width: 100px;">{{index+1}}</td>
                                            <td style="width: 350px;">
                                                {{files?.file_name}} 
                                            </td>
                                            <td style="text-align: center;width:100px" >
                                            <i class="fa fa-external-link" aria-hidden="true" style="color:blue;font-size: 24px;margin-left: 20px;" (click)="data1(files)" data-toggle="modal"
                                            data-target="#bre-to-ecf-view-0002"></i>
                                            </td>

                                            <td style="text-align: center;">
                                                <button class="btn btn-outline-primary" type="submit"
                                                    (click)="getfiles(files)"
                                                    style="border-radius:40px;margin-left: 15px;" color="primary" id="bre-to-ecf-view-0016">
                                                    <i matTooltip="Download" matTooltipClass="custom-tooltipnew" class="fa fa-download"
                                                        aria-hidden="true"></i>
                                                </button>
                                            </td>
                                         </tr>
                                        
                                    </tbody>
                                </table>
                            </div>
                            <tr>
                                <td>

                                    <button type="button" class="btn btn-light" style="border-radius:7px;margin-left:320px;
                                                            border-color: black; margin-bottom: 20px;
                                                            background-color: white;" (click)="fileback()" id="bre-to-ecf-view-0017">Back</button>

                                </td>
                            </tr>
                        </div>
                    </div>


                </div>
            </div>
        </div>
</div>
<div *ngIf="showimageHeaderPreview" id="bre-to-ecf-view-0002" class="modal fade" aria-labelledby="my-modalLabel"
    aria-hidden="true" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-xl" data-dismiss="modal" style="width: 60%;height: 80%;">
        <div class="modal-content">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="bre-to-ecf-view-0018">
                <span aria-hidden="true">&times;</span>
            </button>
            <div class="modal-body">
                <img src="{{jpgUrls}}" class="img-responsive" style="width: 100%;">
            </div>
        </div>
    </div>
</div>
<div *ngIf="showimageHeaderPreviewPDF" id="bre-to-ecf-view-0002" class="modal fade" aria-labelledby="my-modalLabel"
    aria-hidden="true" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header" style="background: rgba(23, 204, 23, 0.288);">
                <h2 class="modal-title"> ECF Attachments</h2>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="bre-to-ecf-view-0019">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <pdf-viewer [src]="pdfurl" [original-size]="false" [render-text]='false' [show-borders]="true"
                [fit-to-page]="true" [show-all]="true" style="display: block; height: 600px;" [fit-to-page]="true">
            </pdf-viewer>
        </div>
    </div>
</div>

<!-- View Trancation -->
<div class="modal fade" tabindex="-1" data-backdrop="static" role="dialog" aria-labelledby="exampleModalLabels" aria-hidden="true"
id="bre-to-ecf-view-0004">
<div class="modal-dialog modal-xl" style="width:80%;height:200%;">
    <div class="modal-content">
        <div class="modal-header" style="text-align:center;background: #a7e4ab;">
            <h2 class="modal-title" style="text-align:center;margin-left:42%">View Transaction</h2>
        <button class="close" type="button" data-dismiss="modal" id="bre-to-ecf-view-0020">x</button>      
        </div>
        <div>
            <table class="table table-bordered" style="width: 100%;text-align: center;">
                <thead class="table_header" style="background: #a7e4ab;">
                <tr>
                    <th>S.No</th>
                    <th>Status</th>
                    <th>From Date</th>
                    <th>Remarks</th>
                    <th>Employee Name</th>
                </tr>
                </thead>
                <tr *ngFor="let dt of viewtrnlist;let i=index">
                    <td>{{i+1}}</td>
                    <td>{{dt.comments}}</td>
                    <td>{{dt.created_date| date:'dd-MMM-yyyy'}}</td>
                    <td>{{dt.remarks}}</td>
                    <td>{{dt?.emp?.name}}
                    <br>
                    <div *ngIf="dt.from_user_id==-1; else deta"></div>
                        <ng-template #deta>
                            <a style="color: green;cursor: pointer;"  (click)="view(dt)">View Details</a>
                        </ng-template>
                    </td>
                </tr>
            </table>
        </div>
        <div class="modal-footer" >
            <table  style="width: 100%;text-align: center;">
                <tr>
                    <td>Employee Name: &nbsp;{{this.name}}</td>
                    <td>Branch Name : &nbsp;{{this.branch}}</td>
                    <td>Designation : &nbsp;{{this.desig}}</td>
                 </tr>
                 <tr><td colspan="3"><button type="button" class="btn btn-outline-primary" style="border-radius:40px;height: 44px; margin-top: 12px;" data-dismiss="modal"  id="bre-to-ecf-view-0021">Back</button></td></tr>
            </table>
        </div>
         
    </div>   
    
</div>
</div>

